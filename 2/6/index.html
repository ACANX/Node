
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Spring-IoC容器源码解析">
      
      
        <meta name="author" content="ACANX">
      
      
        <link rel="canonical" href="https://acanx.github.io/Node/2/6/">
      
      <link rel="icon" href="https://image.3001.net/images/20200922/16007336487809.jpg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-8.5.1">
    
    
      
        <title>Spring-IoC容器源码导读 - Node</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2e8b5541.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spring-ioc" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="Node" class="md-header__button md-logo" aria-label="Node" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M220.8 123.3c1 .5 1.8 1.7 3 1.7 1.1 0 2.8-.4 2.9-1.5.2-1.4-1.9-2.3-3.2-2.9-1.7-.7-3.9-1-5.5-.1-.4.2-.8.7-.6 1.1.3 1.3 2.3 1.1 3.4 1.7m-21.9 1.7c1.2 0 2-1.2 3-1.7 1.1-.6 3.1-.4 3.5-1.6.2-.4-.2-.9-.6-1.1-1.6-.9-3.8-.6-5.5.1-1.3.6-3.4 1.5-3.2 2.9.1 1 1.8 1.5 2.8 1.4M420 403.8c-3.6-4-5.3-11.6-7.2-19.7-1.8-8.1-3.9-16.8-10.5-22.4-1.3-1.1-2.6-2.1-4-2.9-1.3-.8-2.7-1.5-4.1-2 9.2-27.3 5.6-54.5-3.7-79.1-11.4-30.1-31.3-56.4-46.5-74.4-17.1-21.5-33.7-41.9-33.4-72C311.1 85.4 315.7.1 234.8 0 132.4-.2 158 103.4 156.9 135.2c-1.7 23.4-6.4 41.8-22.5 64.7-18.9 22.5-45.5 58.8-58.1 96.7-6 17.9-8.8 36.1-6.2 53.3-6.5 5.8-11.4 14.7-16.6 20.2-4.2 4.3-10.3 5.9-17 8.3s-14 6-18.5 14.5c-2.1 3.9-2.8 8.1-2.8 12.4 0 3.9.6 7.9 1.2 11.8 1.2 8.1 2.5 15.7.8 20.8-5.2 14.4-5.9 24.4-2.2 31.7 3.8 7.3 11.4 10.5 20.1 12.3 17.3 3.6 40.8 2.7 59.3 12.5 19.8 10.4 39.9 14.1 55.9 10.4 11.6-2.6 21.1-9.6 25.9-20.2 12.5-.1 26.3-5.4 48.3-6.6 14.9-1.2 33.6 5.3 55.1 4.1.6 2.3 1.4 4.6 2.5 6.7v.1c8.3 16.7 23.8 24.3 40.3 23 16.6-1.3 34.1-11 48.3-27.9 13.6-16.4 36-23.2 50.9-32.2 7.4-4.5 13.4-10.1 13.9-18.3.4-8.2-4.4-17.3-15.5-29.7M223.7 87.3c9.8-22.2 34.2-21.8 44-.4 6.5 14.2 3.6 30.9-4.3 40.4-1.6-.8-5.9-2.6-12.6-4.9 1.1-1.2 3.1-2.7 3.9-4.6 4.8-11.8-.2-27-9.1-27.3-7.3-.5-13.9 10.8-11.8 23-4.1-2-9.4-3.5-13-4.4-1-6.9-.3-14.6 2.9-21.8M183 75.8c10.1 0 20.8 14.2 19.1 33.5-3.5 1-7.1 2.5-10.2 4.6 1.2-8.9-3.3-20.1-9.6-19.6-8.4.7-9.8 21.2-1.8 28.1 1 .8 1.9-.2-5.9 5.5-15.6-14.6-10.5-52.1 8.4-52.1m-13.6 60.7c6.2-4.6 13.6-10 14.1-10.5 4.7-4.4 13.5-14.2 27.9-14.2 7.1 0 15.6 2.3 25.9 8.9 6.3 4.1 11.3 4.4 22.6 9.3 8.4 3.5 13.7 9.7 10.5 18.2-2.6 7.1-11 14.4-22.7 18.1-11.1 3.6-19.8 16-38.2 14.9-3.9-.2-7-1-9.6-2.1-8-3.5-12.2-10.4-20-15-8.6-4.8-13.2-10.4-14.7-15.3q-2.1-7.35 4.2-12.3m3.3 334c-2.7 35.1-43.9 34.4-75.3 18-29.9-15.8-68.6-6.5-76.5-21.9-2.4-4.7-2.4-12.7 2.6-26.4v-.2c2.4-7.6.6-16-.6-23.9-1.2-7.8-1.8-15 .9-20 3.5-6.7 8.5-9.1 14.8-11.3 10.3-3.7 11.8-3.4 19.6-9.9 5.5-5.7 9.5-12.9 14.3-18 5.1-5.5 10-8.1 17.7-6.9 8.1 1.2 15.1 6.8 21.9 16l19.6 35.6c9.5 19.9 43.1 48.4 41 68.9m-1.4-25.9c-4.1-6.6-9.6-13.6-14.4-19.6 7.1 0 14.2-2.2 16.7-8.9 2.3-6.2 0-14.9-7.4-24.9-13.5-18.2-38.3-32.5-38.3-32.5-13.5-8.4-21.1-18.7-24.6-29.9s-3-23.3-.3-35.2c5.2-22.9 18.6-45.2 27.2-59.2 2.3-1.7.8 3.2-8.7 20.8-8.5 16.1-24.4 53.3-2.6 82.4.6-20.7 5.5-41.8 13.8-61.5 12-27.4 37.3-74.9 39.3-112.7 1.1.8 4.6 3.2 6.2 4.1 4.6 2.7 8.1 6.7 12.6 10.3 12.4 10 28.5 9.2 42.4 1.2 6.2-3.5 11.2-7.5 15.9-9 9.9-3.1 17.8-8.6 22.3-15 7.7 30.4 25.7 74.3 37.2 95.7 6.1 11.4 18.3 35.5 23.6 64.6 3.3-.1 7 .4 10.9 1.4 13.8-35.7-11.7-74.2-23.3-84.9-4.7-4.6-4.9-6.6-2.6-6.5 12.6 11.2 29.2 33.7 35.2 59 2.8 11.6 3.3 23.7.4 35.7 16.4 6.8 35.9 17.9 30.7 34.8-2.2-.1-3.2 0-4.2 0 3.2-10.1-3.9-17.6-22.8-26.1-19.6-8.6-36-8.6-38.3 12.5-12.1 4.2-18.3 14.7-21.4 27.3-2.8 11.2-3.6 24.7-4.4 39.9-.5 7.7-3.6 18-6.8 29-32.1 22.9-76.7 32.9-114.3 7.2m257.4-11.5c-.9 16.8-41.2 19.9-63.2 46.5-13.2 15.7-29.4 24.4-43.6 25.5s-26.5-4.8-33.7-19.3c-4.7-11.1-2.4-23.1 1.1-36.3 3.7-14.2 9.2-28.8 9.9-40.6.8-15.2 1.7-28.5 4.2-38.7 2.6-10.3 6.6-17.2 13.7-21.1.3-.2.7-.3 1-.5.8 13.2 7.3 26.6 18.8 29.5 12.6 3.3 30.7-7.5 38.4-16.3 9-.3 15.7-.9 22.6 5.1 9.9 8.5 7.1 30.3 17.1 41.6 10.6 11.6 14 19.5 13.7 24.6M173.3 148.7c2 1.9 4.7 4.5 8 7.1 6.6 5.2 15.8 10.6 27.3 10.6 11.6 0 22.5-5.9 31.8-10.8 4.9-2.6 10.9-7 14.8-10.4s5.9-6.3 3.1-6.6-2.6 2.6-6 5.1c-4.4 3.2-9.7 7.4-13.9 9.8-7.4 4.2-19.5 10.2-29.9 10.2s-18.7-4.8-24.9-9.7c-3.1-2.5-5.7-5-7.7-6.9-1.5-1.4-1.9-4.6-4.3-4.9-1.4-.1-1.8 3.7 1.7 6.5"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Node
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Spring-IoC容器源码导读
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="切换深色模式"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="切换深色模式" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue"  aria-label="切换浅色模式"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="切换浅色模式" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
            </label>
          
        
      </form>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/ACANX/Node" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    ACANX/Node
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      主页
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../1/1/" class="md-tabs__link">
        节点
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../1/" class="md-tabs__link md-tabs__link--active">
        Spring
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../3/1/" class="md-tabs__link">
        K8S
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../4/1/" class="md-tabs__link">
        进阶
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../5/1/" class="md-tabs__link">
        路由
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../6/1/" class="md-tabs__link">
        群晖
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../7/1/" class="md-tabs__link">
        苹果
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../8/1/" class="md-tabs__link">
        穿透
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv6
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv7
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv8
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv9
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../11/1/" class="md-tabs__link">
        IPv10
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../12/1/" class="md-tabs__link">
        IPv11
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../8/1/" class="md-tabs__link">
        穿透
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv16
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv17
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv18
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv19
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../11/1/" class="md-tabs__link">
        IPv20
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../12/1/" class="md-tabs__link">
        IPv21
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv27
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv28
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../9/1/" class="md-tabs__link">
        IPv29
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../11/1/" class="md-tabs__link">
        IPv30
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../12/1/" class="md-tabs__link">
        IPv31
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Node" class="md-nav__button md-logo" aria-label="Node" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M220.8 123.3c1 .5 1.8 1.7 3 1.7 1.1 0 2.8-.4 2.9-1.5.2-1.4-1.9-2.3-3.2-2.9-1.7-.7-3.9-1-5.5-.1-.4.2-.8.7-.6 1.1.3 1.3 2.3 1.1 3.4 1.7m-21.9 1.7c1.2 0 2-1.2 3-1.7 1.1-.6 3.1-.4 3.5-1.6.2-.4-.2-.9-.6-1.1-1.6-.9-3.8-.6-5.5.1-1.3.6-3.4 1.5-3.2 2.9.1 1 1.8 1.5 2.8 1.4M420 403.8c-3.6-4-5.3-11.6-7.2-19.7-1.8-8.1-3.9-16.8-10.5-22.4-1.3-1.1-2.6-2.1-4-2.9-1.3-.8-2.7-1.5-4.1-2 9.2-27.3 5.6-54.5-3.7-79.1-11.4-30.1-31.3-56.4-46.5-74.4-17.1-21.5-33.7-41.9-33.4-72C311.1 85.4 315.7.1 234.8 0 132.4-.2 158 103.4 156.9 135.2c-1.7 23.4-6.4 41.8-22.5 64.7-18.9 22.5-45.5 58.8-58.1 96.7-6 17.9-8.8 36.1-6.2 53.3-6.5 5.8-11.4 14.7-16.6 20.2-4.2 4.3-10.3 5.9-17 8.3s-14 6-18.5 14.5c-2.1 3.9-2.8 8.1-2.8 12.4 0 3.9.6 7.9 1.2 11.8 1.2 8.1 2.5 15.7.8 20.8-5.2 14.4-5.9 24.4-2.2 31.7 3.8 7.3 11.4 10.5 20.1 12.3 17.3 3.6 40.8 2.7 59.3 12.5 19.8 10.4 39.9 14.1 55.9 10.4 11.6-2.6 21.1-9.6 25.9-20.2 12.5-.1 26.3-5.4 48.3-6.6 14.9-1.2 33.6 5.3 55.1 4.1.6 2.3 1.4 4.6 2.5 6.7v.1c8.3 16.7 23.8 24.3 40.3 23 16.6-1.3 34.1-11 48.3-27.9 13.6-16.4 36-23.2 50.9-32.2 7.4-4.5 13.4-10.1 13.9-18.3.4-8.2-4.4-17.3-15.5-29.7M223.7 87.3c9.8-22.2 34.2-21.8 44-.4 6.5 14.2 3.6 30.9-4.3 40.4-1.6-.8-5.9-2.6-12.6-4.9 1.1-1.2 3.1-2.7 3.9-4.6 4.8-11.8-.2-27-9.1-27.3-7.3-.5-13.9 10.8-11.8 23-4.1-2-9.4-3.5-13-4.4-1-6.9-.3-14.6 2.9-21.8M183 75.8c10.1 0 20.8 14.2 19.1 33.5-3.5 1-7.1 2.5-10.2 4.6 1.2-8.9-3.3-20.1-9.6-19.6-8.4.7-9.8 21.2-1.8 28.1 1 .8 1.9-.2-5.9 5.5-15.6-14.6-10.5-52.1 8.4-52.1m-13.6 60.7c6.2-4.6 13.6-10 14.1-10.5 4.7-4.4 13.5-14.2 27.9-14.2 7.1 0 15.6 2.3 25.9 8.9 6.3 4.1 11.3 4.4 22.6 9.3 8.4 3.5 13.7 9.7 10.5 18.2-2.6 7.1-11 14.4-22.7 18.1-11.1 3.6-19.8 16-38.2 14.9-3.9-.2-7-1-9.6-2.1-8-3.5-12.2-10.4-20-15-8.6-4.8-13.2-10.4-14.7-15.3q-2.1-7.35 4.2-12.3m3.3 334c-2.7 35.1-43.9 34.4-75.3 18-29.9-15.8-68.6-6.5-76.5-21.9-2.4-4.7-2.4-12.7 2.6-26.4v-.2c2.4-7.6.6-16-.6-23.9-1.2-7.8-1.8-15 .9-20 3.5-6.7 8.5-9.1 14.8-11.3 10.3-3.7 11.8-3.4 19.6-9.9 5.5-5.7 9.5-12.9 14.3-18 5.1-5.5 10-8.1 17.7-6.9 8.1 1.2 15.1 6.8 21.9 16l19.6 35.6c9.5 19.9 43.1 48.4 41 68.9m-1.4-25.9c-4.1-6.6-9.6-13.6-14.4-19.6 7.1 0 14.2-2.2 16.7-8.9 2.3-6.2 0-14.9-7.4-24.9-13.5-18.2-38.3-32.5-38.3-32.5-13.5-8.4-21.1-18.7-24.6-29.9s-3-23.3-.3-35.2c5.2-22.9 18.6-45.2 27.2-59.2 2.3-1.7.8 3.2-8.7 20.8-8.5 16.1-24.4 53.3-2.6 82.4.6-20.7 5.5-41.8 13.8-61.5 12-27.4 37.3-74.9 39.3-112.7 1.1.8 4.6 3.2 6.2 4.1 4.6 2.7 8.1 6.7 12.6 10.3 12.4 10 28.5 9.2 42.4 1.2 6.2-3.5 11.2-7.5 15.9-9 9.9-3.1 17.8-8.6 22.3-15 7.7 30.4 25.7 74.3 37.2 95.7 6.1 11.4 18.3 35.5 23.6 64.6 3.3-.1 7 .4 10.9 1.4 13.8-35.7-11.7-74.2-23.3-84.9-4.7-4.6-4.9-6.6-2.6-6.5 12.6 11.2 29.2 33.7 35.2 59 2.8 11.6 3.3 23.7.4 35.7 16.4 6.8 35.9 17.9 30.7 34.8-2.2-.1-3.2 0-4.2 0 3.2-10.1-3.9-17.6-22.8-26.1-19.6-8.6-36-8.6-38.3 12.5-12.1 4.2-18.3 14.7-21.4 27.3-2.8 11.2-3.6 24.7-4.4 39.9-.5 7.7-3.6 18-6.8 29-32.1 22.9-76.7 32.9-114.3 7.2m257.4-11.5c-.9 16.8-41.2 19.9-63.2 46.5-13.2 15.7-29.4 24.4-43.6 25.5s-26.5-4.8-33.7-19.3c-4.7-11.1-2.4-23.1 1.1-36.3 3.7-14.2 9.2-28.8 9.9-40.6.8-15.2 1.7-28.5 4.2-38.7 2.6-10.3 6.6-17.2 13.7-21.1.3-.2.7-.3 1-.5.8 13.2 7.3 26.6 18.8 29.5 12.6 3.3 30.7-7.5 38.4-16.3 9-.3 15.7-.9 22.6 5.1 9.9 8.5 7.1 30.3 17.1 41.6 10.6 11.6 14 19.5 13.7 24.6M173.3 148.7c2 1.9 4.7 4.5 8 7.1 6.6 5.2 15.8 10.6 27.3 10.6 11.6 0 22.5-5.9 31.8-10.8 4.9-2.6 10.9-7 14.8-10.4s5.9-6.3 3.1-6.6-2.6 2.6-6 5.1c-4.4 3.2-9.7 7.4-13.9 9.8-7.4 4.2-19.5 10.2-29.9 10.2s-18.7-4.8-24.9-9.7c-3.1-2.5-5.7-5-7.7-6.9-1.5-1.4-1.9-4.6-4.3-4.9-1.4-.1-1.8 3.7 1.7 6.5"/></svg>

    </a>
    Node
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ACANX/Node" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    ACANX/Node
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        主页
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          节点
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="节点" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          节点
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1/1/" class="md-nav__link">
        使用MKDocs发布Markdown文档
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1/2/" class="md-nav__link">
        系统选择
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1/3/" class="md-nav__link">
        磁盘划分
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1/4/" class="md-nav__link">
        架构规划
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Spring
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Spring" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Spring
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1/" class="md-nav__link">
        SpringBoot启动代码示例
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2/" class="md-nav__link">
        SpringBoot启动流程分析
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../3/" class="md-nav__link">
        Springboot启动流程源码解析（带流程图）
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../4/" class="md-nav__link">
        Spring-IoC启动代码示例
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../5/" class="md-nav__link">
        Spring-IoC启动流程分析
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Spring-IoC容器启动相关源码解析
      </a>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          K8S
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="K8S" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          K8S
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3/1/" class="md-nav__link">
        Kubernetes容器编排系统概念模型
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3/2/" class="md-nav__link">
        Kubernetes集群部署实战
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          进阶
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="进阶" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          进阶
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4/1/" class="md-nav__link">
        添加硬盘
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4/2/" class="md-nav__link">
        硬件直通
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4/3/" class="md-nav__link">
        配置证书
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4/4/" class="md-nav__link">
        硬盘迁移
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4/5/" class="md-nav__link">
        vGPU教程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4/6/" class="md-nav__link">
        功耗节能
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          路由
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="路由" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          路由
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5/1/" class="md-nav__link">
        基本操作
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5/2/" class="md-nav__link">
        硬盘扩容
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5/3/" class="md-nav__link">
        OpenClash
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5/4.md" class="md-nav__link">
        IPv6 配置
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          群晖
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="群晖" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          群晖
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/1/" class="md-nav__link">
        基本安装
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/2/" class="md-nav__link">
        存储划分
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/3/" class="md-nav__link">
        SSD缓存
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/4/" class="md-nav__link">
        CPU修正
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/5/" class="md-nav__link">
        直通独显
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/6/" class="md-nav__link">
        远程访问
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/7/" class="md-nav__link">
        添加证书
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/8/" class="md-nav__link">
        WebDAV
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/9/" class="md-nav__link">
        安装 alist
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/10/" class="md-nav__link">
        终端美化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6/11/" class="md-nav__link">
        Docker与IPv6
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          苹果
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="苹果" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          苹果
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7/1/" class="md-nav__link">
        准备工作
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7/2/" class="md-nav__link">
        修正配置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7/3/" class="md-nav__link">
        系统安装
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7/4/" class="md-nav__link">
        系统优化
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          穿透
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="穿透" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          穿透
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8/1/" class="md-nav__link">
        NAT类型
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8/2/" class="md-nav__link">
        ZeroTier
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8/3/" class="md-nav__link">
        IPv6 DDNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8/4/" class="md-nav__link">
        远程桌面
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          IPv6
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv6" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          IPv6
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          IPv7
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv7" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          IPv7
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          IPv8
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv8" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          IPv8
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13">
          IPv9
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv9" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          IPv9
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" type="checkbox" id="__nav_14" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14">
          IPv10
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv10" data-md-level="1">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          IPv10
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_15" type="checkbox" id="__nav_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_15">
          IPv11
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv11" data-md-level="1">
        <label class="md-nav__title" for="__nav_15">
          <span class="md-nav__icon md-icon"></span>
          IPv11
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_16" type="checkbox" id="__nav_16" >
      
      
      
      
        <label class="md-nav__link" for="__nav_16">
          穿透
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="穿透" data-md-level="1">
        <label class="md-nav__title" for="__nav_16">
          <span class="md-nav__icon md-icon"></span>
          穿透
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8/1/" class="md-nav__link">
        NAT类型
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8/2/" class="md-nav__link">
        ZeroTier
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8/3/" class="md-nav__link">
        IPv6 DDNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8/4/" class="md-nav__link">
        远程桌面
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_17" type="checkbox" id="__nav_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_17">
          IPv16
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv16" data-md-level="1">
        <label class="md-nav__title" for="__nav_17">
          <span class="md-nav__icon md-icon"></span>
          IPv16
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_18" type="checkbox" id="__nav_18" >
      
      
      
      
        <label class="md-nav__link" for="__nav_18">
          IPv17
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv17" data-md-level="1">
        <label class="md-nav__title" for="__nav_18">
          <span class="md-nav__icon md-icon"></span>
          IPv17
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_19" type="checkbox" id="__nav_19" >
      
      
      
      
        <label class="md-nav__link" for="__nav_19">
          IPv18
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv18" data-md-level="1">
        <label class="md-nav__title" for="__nav_19">
          <span class="md-nav__icon md-icon"></span>
          IPv18
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_20" type="checkbox" id="__nav_20" >
      
      
      
      
        <label class="md-nav__link" for="__nav_20">
          IPv19
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv19" data-md-level="1">
        <label class="md-nav__title" for="__nav_20">
          <span class="md-nav__icon md-icon"></span>
          IPv19
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_21" type="checkbox" id="__nav_21" >
      
      
      
      
        <label class="md-nav__link" for="__nav_21">
          IPv20
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv20" data-md-level="1">
        <label class="md-nav__title" for="__nav_21">
          <span class="md-nav__icon md-icon"></span>
          IPv20
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_22" type="checkbox" id="__nav_22" >
      
      
      
      
        <label class="md-nav__link" for="__nav_22">
          IPv21
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv21" data-md-level="1">
        <label class="md-nav__title" for="__nav_22">
          <span class="md-nav__icon md-icon"></span>
          IPv21
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_23" type="checkbox" id="__nav_23" >
      
      
      
      
        <label class="md-nav__link" for="__nav_23">
          IPv27
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv27" data-md-level="1">
        <label class="md-nav__title" for="__nav_23">
          <span class="md-nav__icon md-icon"></span>
          IPv27
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_24" type="checkbox" id="__nav_24" >
      
      
      
      
        <label class="md-nav__link" for="__nav_24">
          IPv28
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv28" data-md-level="1">
        <label class="md-nav__title" for="__nav_24">
          <span class="md-nav__icon md-icon"></span>
          IPv28
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_25" type="checkbox" id="__nav_25" >
      
      
      
      
        <label class="md-nav__link" for="__nav_25">
          IPv29
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv29" data-md-level="1">
        <label class="md-nav__title" for="__nav_25">
          <span class="md-nav__icon md-icon"></span>
          IPv29
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_26" type="checkbox" id="__nav_26" >
      
      
      
      
        <label class="md-nav__link" for="__nav_26">
          IPv30
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv30" data-md-level="1">
        <label class="md-nav__title" for="__nav_26">
          <span class="md-nav__icon md-icon"></span>
          IPv30
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../11/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_27" type="checkbox" id="__nav_27" >
      
      
      
      
        <label class="md-nav__link" for="__nav_27">
          IPv31
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="IPv31" data-md-level="1">
        <label class="md-nav__title" for="__nav_27">
          <span class="md-nav__icon md-icon"></span>
          IPv31
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/1/" class="md-nav__link">
        IPv6 基础
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/2/" class="md-nav__link">
        IPv6 场景
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/3/" class="md-nav__link">
        IPv6 使用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/4/" class="md-nav__link">
        IPv6 普及
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../12/5/" class="md-nav__link">
        IPv6与光猫
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/ACANX/Node/edit/main/docs/2/6.md" title="编辑此页" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
  </a>


<h1 id="spring-ioc">Spring-IoC容器源码导读<a class="headerlink" href="#spring-ioc" title="Permanent link">&para;</a></h1>
<h1 id="1">1.几个重要类/接口<a class="headerlink" href="#1" title="Permanent link">&para;</a></h1>
<h2 id="_1">阅读前的准备<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<ul>
<li>源码下载：<ul>
<li>https://github.com/spring-projects/spring-framework  </li>
<li>https://github.com/spring-projects/spring-framework.git</li>
</ul>
</li>
<li>源码版本：v5.2.1.RELEASE</li>
</ul>
<h2 id="11-beanfactory-ioc">1.1 BeanFactory 顶级接口（低配版的IoC容器）<a class="headerlink" href="#11-beanfactory-ioc" title="Permanent link">&para;</a></h2>
<h3 id="beanfactory">BeanFactory接口定义说明<a class="headerlink" href="#beanfactory" title="Permanent link">&para;</a></h3>
<ul>
<li>BeanFactory是低配版的IoC容器，定义了Ioc容器基本的功能</li>
</ul>
<h3 id="_2">完整版源码：<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="cm">/*</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="cm"> * Copyright 2002-2019 the original author or authors.</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="cm"> *</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="cm"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="cm"> * you may not use this file except in compliance with the License.</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="cm"> * You may obtain a copy of the License at</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="cm"> *</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="cm"> *      https://www.apache.org/licenses/LICENSE-2.0</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="cm"> *</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="cm"> * Unless required by applicable law or agreed to in writing, software</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="cm"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="cm"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="cm"> * See the License for the specific language governing permissions and</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="cm"> * limitations under the License.</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="cm"> */</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="kn">package</span><span class="w"> </span><span class="nn">org.springframework.beans.factory</span><span class="p">;</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.BeansException</span><span class="p">;</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.ResolvableType</span><span class="p">;</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.lang.Nullable</span><span class="p">;</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="cm">/**</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="cm"> * The root interface for accessing a Spring bean container.</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="cm"> * This is the basic client view of a bean container;</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="cm"> * further interfaces such as {@link ListableBeanFactory} and</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="cm"> * {@link org.springframework.beans.factory.config.ConfigurableBeanFactory}</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="cm"> * are available for specific purposes.</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="cm"> *</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="cm"> * &lt;p&gt;This interface is implemented by objects that hold a number of bean definitions,</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="cm"> * each uniquely identified by a String name. Depending on the bean definition,</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="cm"> * the factory will return either an independent instance of a contained object</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="cm"> * (the Prototype design pattern), or a single shared instance (a superior</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="cm"> * alternative to the Singleton design pattern, in which the instance is a</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="cm"> * singleton in the scope of the factory). Which type of instance will be returned</span>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="cm"> * depends on the bean factory configuration: the API is the same. Since Spring</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="cm"> * 2.0, further scopes are available depending on the concrete application</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="cm"> * context (e.g. &quot;request&quot; and &quot;session&quot; scopes in a web environment).</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="cm"> *</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="cm"> * &lt;p&gt;The point of this approach is that the BeanFactory is a central registry</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="cm"> * of application components, and centralizes configuration of application</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="cm"> * components (no more do individual objects need to read properties files,</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="cm"> * for example). See chapters 4 and 11 of &quot;Expert One-on-One J2EE Design and</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="cm"> * Development&quot; for a discussion of the benefits of this approach.</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="cm"> *</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="cm"> * &lt;p&gt;Note that it is generally better to rely on Dependency Injection</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="cm"> * (&quot;push&quot; configuration) to configure application objects through setters</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="cm"> * or constructors, rather than use any form of &quot;pull&quot; configuration like a</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="cm"> * BeanFactory lookup. Spring&#39;s Dependency Injection functionality is</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="cm"> * implemented using this BeanFactory interface and its subinterfaces.</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="cm"> *</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a><span class="cm"> * &lt;p&gt;Normally a BeanFactory will load bean definitions stored in a configuration</span>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="cm"> * source (such as an XML document), and use the {@code org.springframework.beans}</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="cm"> * package to configure the beans. However, an implementation could simply return</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a><span class="cm"> * Java objects it creates as necessary directly in Java code. There are no</span>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a><span class="cm"> * constraints on how the definitions could be stored: LDAP, RDBMS, XML,</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span class="cm"> * properties file, etc. Implementations are encouraged to support references</span>
</span><span id="__span-0-58"><a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a><span class="cm"> * amongst beans (Dependency Injection).</span>
</span><span id="__span-0-59"><a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="cm"> *</span>
</span><span id="__span-0-60"><a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a><span class="cm"> * &lt;p&gt;In contrast to the methods in {@link ListableBeanFactory}, all of the</span>
</span><span id="__span-0-61"><a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a><span class="cm"> * operations in this interface will also check parent factories if this is a</span>
</span><span id="__span-0-62"><a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a><span class="cm"> * {@link HierarchicalBeanFactory}. If a bean is not found in this factory instance,</span>
</span><span id="__span-0-63"><a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a><span class="cm"> * the immediate parent factory will be asked. Beans in this factory instance</span>
</span><span id="__span-0-64"><a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a><span class="cm"> * are supposed to override beans of the same name in any parent factory.</span>
</span><span id="__span-0-65"><a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a><span class="cm"> *</span>
</span><span id="__span-0-66"><a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a><span class="cm"> * &lt;p&gt;Bean factory implementations should support the standard bean lifecycle interfaces</span>
</span><span id="__span-0-67"><a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a><span class="cm"> * as far as possible. The full set of initialization methods and their standard order is:</span>
</span><span id="__span-0-68"><a id="__codelineno-0-68" name="__codelineno-0-68" href="#__codelineno-0-68"></a><span class="cm"> * &lt;ol&gt;</span>
</span><span id="__span-0-69"><a id="__codelineno-0-69" name="__codelineno-0-69" href="#__codelineno-0-69"></a><span class="cm"> * &lt;li&gt;BeanNameAware&#39;s {@code setBeanName}</span>
</span><span id="__span-0-70"><a id="__codelineno-0-70" name="__codelineno-0-70" href="#__codelineno-0-70"></a><span class="cm"> * &lt;li&gt;BeanClassLoaderAware&#39;s {@code setBeanClassLoader}</span>
</span><span id="__span-0-71"><a id="__codelineno-0-71" name="__codelineno-0-71" href="#__codelineno-0-71"></a><span class="cm"> * &lt;li&gt;BeanFactoryAware&#39;s {@code setBeanFactory}</span>
</span><span id="__span-0-72"><a id="__codelineno-0-72" name="__codelineno-0-72" href="#__codelineno-0-72"></a><span class="cm"> * &lt;li&gt;EnvironmentAware&#39;s {@code setEnvironment}</span>
</span><span id="__span-0-73"><a id="__codelineno-0-73" name="__codelineno-0-73" href="#__codelineno-0-73"></a><span class="cm"> * &lt;li&gt;EmbeddedValueResolverAware&#39;s {@code setEmbeddedValueResolver}</span>
</span><span id="__span-0-74"><a id="__codelineno-0-74" name="__codelineno-0-74" href="#__codelineno-0-74"></a><span class="cm"> * &lt;li&gt;ResourceLoaderAware&#39;s {@code setResourceLoader}</span>
</span><span id="__span-0-75"><a id="__codelineno-0-75" name="__codelineno-0-75" href="#__codelineno-0-75"></a><span class="cm"> * (only applicable when running in an application context)</span>
</span><span id="__span-0-76"><a id="__codelineno-0-76" name="__codelineno-0-76" href="#__codelineno-0-76"></a><span class="cm"> * &lt;li&gt;ApplicationEventPublisherAware&#39;s {@code setApplicationEventPublisher}</span>
</span><span id="__span-0-77"><a id="__codelineno-0-77" name="__codelineno-0-77" href="#__codelineno-0-77"></a><span class="cm"> * (only applicable when running in an application context)</span>
</span><span id="__span-0-78"><a id="__codelineno-0-78" name="__codelineno-0-78" href="#__codelineno-0-78"></a><span class="cm"> * &lt;li&gt;MessageSourceAware&#39;s {@code setMessageSource}</span>
</span><span id="__span-0-79"><a id="__codelineno-0-79" name="__codelineno-0-79" href="#__codelineno-0-79"></a><span class="cm"> * (only applicable when running in an application context)</span>
</span><span id="__span-0-80"><a id="__codelineno-0-80" name="__codelineno-0-80" href="#__codelineno-0-80"></a><span class="cm"> * &lt;li&gt;ApplicationContextAware&#39;s {@code setApplicationContext}</span>
</span><span id="__span-0-81"><a id="__codelineno-0-81" name="__codelineno-0-81" href="#__codelineno-0-81"></a><span class="cm"> * (only applicable when running in an application context)</span>
</span><span id="__span-0-82"><a id="__codelineno-0-82" name="__codelineno-0-82" href="#__codelineno-0-82"></a><span class="cm"> * &lt;li&gt;ServletContextAware&#39;s {@code setServletContext}</span>
</span><span id="__span-0-83"><a id="__codelineno-0-83" name="__codelineno-0-83" href="#__codelineno-0-83"></a><span class="cm"> * (only applicable when running in a web application context)</span>
</span><span id="__span-0-84"><a id="__codelineno-0-84" name="__codelineno-0-84" href="#__codelineno-0-84"></a><span class="cm"> * &lt;li&gt;{@code postProcessBeforeInitialization} methods of BeanPostProcessors</span>
</span><span id="__span-0-85"><a id="__codelineno-0-85" name="__codelineno-0-85" href="#__codelineno-0-85"></a><span class="cm"> * &lt;li&gt;InitializingBean&#39;s {@code afterPropertiesSet}</span>
</span><span id="__span-0-86"><a id="__codelineno-0-86" name="__codelineno-0-86" href="#__codelineno-0-86"></a><span class="cm"> * &lt;li&gt;a custom init-method definition</span>
</span><span id="__span-0-87"><a id="__codelineno-0-87" name="__codelineno-0-87" href="#__codelineno-0-87"></a><span class="cm"> * &lt;li&gt;{@code postProcessAfterInitialization} methods of BeanPostProcessors</span>
</span><span id="__span-0-88"><a id="__codelineno-0-88" name="__codelineno-0-88" href="#__codelineno-0-88"></a><span class="cm"> * &lt;/ol&gt;</span>
</span><span id="__span-0-89"><a id="__codelineno-0-89" name="__codelineno-0-89" href="#__codelineno-0-89"></a><span class="cm"> *</span>
</span><span id="__span-0-90"><a id="__codelineno-0-90" name="__codelineno-0-90" href="#__codelineno-0-90"></a><span class="cm"> * &lt;p&gt;On shutdown of a bean factory, the following lifecycle methods apply:</span>
</span><span id="__span-0-91"><a id="__codelineno-0-91" name="__codelineno-0-91" href="#__codelineno-0-91"></a><span class="cm"> * &lt;ol&gt;</span>
</span><span id="__span-0-92"><a id="__codelineno-0-92" name="__codelineno-0-92" href="#__codelineno-0-92"></a><span class="cm"> * &lt;li&gt;{@code postProcessBeforeDestruction} methods of DestructionAwareBeanPostProcessors</span>
</span><span id="__span-0-93"><a id="__codelineno-0-93" name="__codelineno-0-93" href="#__codelineno-0-93"></a><span class="cm"> * &lt;li&gt;DisposableBean&#39;s {@code destroy}</span>
</span><span id="__span-0-94"><a id="__codelineno-0-94" name="__codelineno-0-94" href="#__codelineno-0-94"></a><span class="cm"> * &lt;li&gt;a custom destroy-method definition</span>
</span><span id="__span-0-95"><a id="__codelineno-0-95" name="__codelineno-0-95" href="#__codelineno-0-95"></a><span class="cm"> * &lt;/ol&gt;</span>
</span><span id="__span-0-96"><a id="__codelineno-0-96" name="__codelineno-0-96" href="#__codelineno-0-96"></a><span class="cm"> *</span>
</span><span id="__span-0-97"><a id="__codelineno-0-97" name="__codelineno-0-97" href="#__codelineno-0-97"></a><span class="cm"> * @author Rod Johnson</span>
</span><span id="__span-0-98"><a id="__codelineno-0-98" name="__codelineno-0-98" href="#__codelineno-0-98"></a><span class="cm"> * @author Juergen Hoeller</span>
</span><span id="__span-0-99"><a id="__codelineno-0-99" name="__codelineno-0-99" href="#__codelineno-0-99"></a><span class="cm"> * @author Chris Beams</span>
</span><span id="__span-0-100"><a id="__codelineno-0-100" name="__codelineno-0-100" href="#__codelineno-0-100"></a><span class="cm"> * @since 13 April 2001</span>
</span><span id="__span-0-101"><a id="__codelineno-0-101" name="__codelineno-0-101" href="#__codelineno-0-101"></a><span class="cm"> * @see BeanNameAware#setBeanName</span>
</span><span id="__span-0-102"><a id="__codelineno-0-102" name="__codelineno-0-102" href="#__codelineno-0-102"></a><span class="cm"> * @see BeanClassLoaderAware#setBeanClassLoader</span>
</span><span id="__span-0-103"><a id="__codelineno-0-103" name="__codelineno-0-103" href="#__codelineno-0-103"></a><span class="cm"> * @see BeanFactoryAware#setBeanFactory</span>
</span><span id="__span-0-104"><a id="__codelineno-0-104" name="__codelineno-0-104" href="#__codelineno-0-104"></a><span class="cm"> * @see org.springframework.context.ResourceLoaderAware#setResourceLoader</span>
</span><span id="__span-0-105"><a id="__codelineno-0-105" name="__codelineno-0-105" href="#__codelineno-0-105"></a><span class="cm"> * @see org.springframework.context.ApplicationEventPublisherAware#setApplicationEventPublisher</span>
</span><span id="__span-0-106"><a id="__codelineno-0-106" name="__codelineno-0-106" href="#__codelineno-0-106"></a><span class="cm"> * @see org.springframework.context.MessageSourceAware#setMessageSource</span>
</span><span id="__span-0-107"><a id="__codelineno-0-107" name="__codelineno-0-107" href="#__codelineno-0-107"></a><span class="cm"> * @see org.springframework.context.ApplicationContextAware#setApplicationContext</span>
</span><span id="__span-0-108"><a id="__codelineno-0-108" name="__codelineno-0-108" href="#__codelineno-0-108"></a><span class="cm"> * @see org.springframework.web.context.ServletContextAware#setServletContext</span>
</span><span id="__span-0-109"><a id="__codelineno-0-109" name="__codelineno-0-109" href="#__codelineno-0-109"></a><span class="cm"> * @see org.springframework.beans.factory.config.BeanPostProcessor#postProcessBeforeInitialization</span>
</span><span id="__span-0-110"><a id="__codelineno-0-110" name="__codelineno-0-110" href="#__codelineno-0-110"></a><span class="cm"> * @see InitializingBean#afterPropertiesSet</span>
</span><span id="__span-0-111"><a id="__codelineno-0-111" name="__codelineno-0-111" href="#__codelineno-0-111"></a><span class="cm"> * @see org.springframework.beans.factory.support.RootBeanDefinition#getInitMethodName</span>
</span><span id="__span-0-112"><a id="__codelineno-0-112" name="__codelineno-0-112" href="#__codelineno-0-112"></a><span class="cm"> * @see org.springframework.beans.factory.config.BeanPostProcessor#postProcessAfterInitialization</span>
</span><span id="__span-0-113"><a id="__codelineno-0-113" name="__codelineno-0-113" href="#__codelineno-0-113"></a><span class="cm"> * @see DisposableBean#destroy</span>
</span><span id="__span-0-114"><a id="__codelineno-0-114" name="__codelineno-0-114" href="#__codelineno-0-114"></a><span class="cm"> * @see org.springframework.beans.factory.support.RootBeanDefinition#getDestroyMethodName</span>
</span><span id="__span-0-115"><a id="__codelineno-0-115" name="__codelineno-0-115" href="#__codelineno-0-115"></a><span class="cm"> */</span>
</span><span id="__span-0-116"><a id="__codelineno-0-116" name="__codelineno-0-116" href="#__codelineno-0-116"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">BeanFactory</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-117"><a id="__codelineno-0-117" name="__codelineno-0-117" href="#__codelineno-0-117"></a>
</span><span id="__span-0-118"><a id="__codelineno-0-118" name="__codelineno-0-118" href="#__codelineno-0-118"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-119"><a id="__codelineno-0-119" name="__codelineno-0-119" href="#__codelineno-0-119"></a><span class="cm">     * Used to dereference a {@link FactoryBean} instance and distinguish it from</span>
</span><span id="__span-0-120"><a id="__codelineno-0-120" name="__codelineno-0-120" href="#__codelineno-0-120"></a><span class="cm">     * beans &lt;i&gt;created&lt;/i&gt; by the FactoryBean. For example, if the bean named</span>
</span><span id="__span-0-121"><a id="__codelineno-0-121" name="__codelineno-0-121" href="#__codelineno-0-121"></a><span class="cm">     * {@code myJndiObject} is a FactoryBean, getting {@code &amp;myJndiObject}</span>
</span><span id="__span-0-122"><a id="__codelineno-0-122" name="__codelineno-0-122" href="#__codelineno-0-122"></a><span class="cm">     * will return the factory, not the instance returned by the factory.</span>
</span><span id="__span-0-123"><a id="__codelineno-0-123" name="__codelineno-0-123" href="#__codelineno-0-123"></a><span class="cm">     */</span>
</span><span id="__span-0-124"><a id="__codelineno-0-124" name="__codelineno-0-124" href="#__codelineno-0-124"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">FACTORY_BEAN_PREFIX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&amp;&quot;</span><span class="p">;</span>
</span><span id="__span-0-125"><a id="__codelineno-0-125" name="__codelineno-0-125" href="#__codelineno-0-125"></a>
</span><span id="__span-0-126"><a id="__codelineno-0-126" name="__codelineno-0-126" href="#__codelineno-0-126"></a>
</span><span id="__span-0-127"><a id="__codelineno-0-127" name="__codelineno-0-127" href="#__codelineno-0-127"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-128"><a id="__codelineno-0-128" name="__codelineno-0-128" href="#__codelineno-0-128"></a><span class="cm">     * Return an instance, which may be shared or independent, of the specified bean.</span>
</span><span id="__span-0-129"><a id="__codelineno-0-129" name="__codelineno-0-129" href="#__codelineno-0-129"></a><span class="cm">     * &lt;p&gt;This method allows a Spring BeanFactory to be used as a replacement for the</span>
</span><span id="__span-0-130"><a id="__codelineno-0-130" name="__codelineno-0-130" href="#__codelineno-0-130"></a><span class="cm">     * Singleton or Prototype design pattern. Callers may retain references to</span>
</span><span id="__span-0-131"><a id="__codelineno-0-131" name="__codelineno-0-131" href="#__codelineno-0-131"></a><span class="cm">     * returned objects in the case of Singleton beans.</span>
</span><span id="__span-0-132"><a id="__codelineno-0-132" name="__codelineno-0-132" href="#__codelineno-0-132"></a><span class="cm">     * &lt;p&gt;Translates aliases back to the corresponding canonical bean name.</span>
</span><span id="__span-0-133"><a id="__codelineno-0-133" name="__codelineno-0-133" href="#__codelineno-0-133"></a><span class="cm">     * Will ask the parent factory if the bean cannot be found in this factory instance.</span>
</span><span id="__span-0-134"><a id="__codelineno-0-134" name="__codelineno-0-134" href="#__codelineno-0-134"></a><span class="cm">     * @param name the name of the bean to retrieve</span>
</span><span id="__span-0-135"><a id="__codelineno-0-135" name="__codelineno-0-135" href="#__codelineno-0-135"></a><span class="cm">     * @return an instance of the bean</span>
</span><span id="__span-0-136"><a id="__codelineno-0-136" name="__codelineno-0-136" href="#__codelineno-0-136"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no bean with the specified name</span>
</span><span id="__span-0-137"><a id="__codelineno-0-137" name="__codelineno-0-137" href="#__codelineno-0-137"></a><span class="cm">     * @throws BeansException if the bean could not be obtained</span>
</span><span id="__span-0-138"><a id="__codelineno-0-138" name="__codelineno-0-138" href="#__codelineno-0-138"></a><span class="cm">     */</span>
</span><span id="__span-0-139"><a id="__codelineno-0-139" name="__codelineno-0-139" href="#__codelineno-0-139"></a><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-0-140"><a id="__codelineno-0-140" name="__codelineno-0-140" href="#__codelineno-0-140"></a>
</span><span id="__span-0-141"><a id="__codelineno-0-141" name="__codelineno-0-141" href="#__codelineno-0-141"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-142"><a id="__codelineno-0-142" name="__codelineno-0-142" href="#__codelineno-0-142"></a><span class="cm">     * Return an instance, which may be shared or independent, of the specified bean.</span>
</span><span id="__span-0-143"><a id="__codelineno-0-143" name="__codelineno-0-143" href="#__codelineno-0-143"></a><span class="cm">     * &lt;p&gt;Behaves the same as {@link #getBean(String)}, but provides a measure of type</span>
</span><span id="__span-0-144"><a id="__codelineno-0-144" name="__codelineno-0-144" href="#__codelineno-0-144"></a><span class="cm">     * safety by throwing a BeanNotOfRequiredTypeException if the bean is not of the</span>
</span><span id="__span-0-145"><a id="__codelineno-0-145" name="__codelineno-0-145" href="#__codelineno-0-145"></a><span class="cm">     * required type. This means that ClassCastException can&#39;t be thrown on casting</span>
</span><span id="__span-0-146"><a id="__codelineno-0-146" name="__codelineno-0-146" href="#__codelineno-0-146"></a><span class="cm">     * the result correctly, as can happen with {@link #getBean(String)}.</span>
</span><span id="__span-0-147"><a id="__codelineno-0-147" name="__codelineno-0-147" href="#__codelineno-0-147"></a><span class="cm">     * &lt;p&gt;Translates aliases back to the corresponding canonical bean name.</span>
</span><span id="__span-0-148"><a id="__codelineno-0-148" name="__codelineno-0-148" href="#__codelineno-0-148"></a><span class="cm">     * Will ask the parent factory if the bean cannot be found in this factory instance.</span>
</span><span id="__span-0-149"><a id="__codelineno-0-149" name="__codelineno-0-149" href="#__codelineno-0-149"></a><span class="cm">     * @param name the name of the bean to retrieve</span>
</span><span id="__span-0-150"><a id="__codelineno-0-150" name="__codelineno-0-150" href="#__codelineno-0-150"></a><span class="cm">     * @param requiredType type the bean must match; can be an interface or superclass</span>
</span><span id="__span-0-151"><a id="__codelineno-0-151" name="__codelineno-0-151" href="#__codelineno-0-151"></a><span class="cm">     * @return an instance of the bean</span>
</span><span id="__span-0-152"><a id="__codelineno-0-152" name="__codelineno-0-152" href="#__codelineno-0-152"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no such bean definition</span>
</span><span id="__span-0-153"><a id="__codelineno-0-153" name="__codelineno-0-153" href="#__codelineno-0-153"></a><span class="cm">     * @throws BeanNotOfRequiredTypeException if the bean is not of the required type</span>
</span><span id="__span-0-154"><a id="__codelineno-0-154" name="__codelineno-0-154" href="#__codelineno-0-154"></a><span class="cm">     * @throws BeansException if the bean could not be created</span>
</span><span id="__span-0-155"><a id="__codelineno-0-155" name="__codelineno-0-155" href="#__codelineno-0-155"></a><span class="cm">     */</span>
</span><span id="__span-0-156"><a id="__codelineno-0-156" name="__codelineno-0-156" href="#__codelineno-0-156"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">requiredType</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-0-157"><a id="__codelineno-0-157" name="__codelineno-0-157" href="#__codelineno-0-157"></a>
</span><span id="__span-0-158"><a id="__codelineno-0-158" name="__codelineno-0-158" href="#__codelineno-0-158"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-159"><a id="__codelineno-0-159" name="__codelineno-0-159" href="#__codelineno-0-159"></a><span class="cm">     * Return an instance, which may be shared or independent, of the specified bean.</span>
</span><span id="__span-0-160"><a id="__codelineno-0-160" name="__codelineno-0-160" href="#__codelineno-0-160"></a><span class="cm">     * &lt;p&gt;Allows for specifying explicit constructor arguments / factory method arguments,</span>
</span><span id="__span-0-161"><a id="__codelineno-0-161" name="__codelineno-0-161" href="#__codelineno-0-161"></a><span class="cm">     * overriding the specified default arguments (if any) in the bean definition.</span>
</span><span id="__span-0-162"><a id="__codelineno-0-162" name="__codelineno-0-162" href="#__codelineno-0-162"></a><span class="cm">     * @param name the name of the bean to retrieve</span>
</span><span id="__span-0-163"><a id="__codelineno-0-163" name="__codelineno-0-163" href="#__codelineno-0-163"></a><span class="cm">     * @param args arguments to use when creating a bean instance using explicit arguments</span>
</span><span id="__span-0-164"><a id="__codelineno-0-164" name="__codelineno-0-164" href="#__codelineno-0-164"></a><span class="cm">     * (only applied when creating a new instance as opposed to retrieving an existing one)</span>
</span><span id="__span-0-165"><a id="__codelineno-0-165" name="__codelineno-0-165" href="#__codelineno-0-165"></a><span class="cm">     * @return an instance of the bean</span>
</span><span id="__span-0-166"><a id="__codelineno-0-166" name="__codelineno-0-166" href="#__codelineno-0-166"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no such bean definition</span>
</span><span id="__span-0-167"><a id="__codelineno-0-167" name="__codelineno-0-167" href="#__codelineno-0-167"></a><span class="cm">     * @throws BeanDefinitionStoreException if arguments have been given but</span>
</span><span id="__span-0-168"><a id="__codelineno-0-168" name="__codelineno-0-168" href="#__codelineno-0-168"></a><span class="cm">     * the affected bean isn&#39;t a prototype</span>
</span><span id="__span-0-169"><a id="__codelineno-0-169" name="__codelineno-0-169" href="#__codelineno-0-169"></a><span class="cm">     * @throws BeansException if the bean could not be created</span>
</span><span id="__span-0-170"><a id="__codelineno-0-170" name="__codelineno-0-170" href="#__codelineno-0-170"></a><span class="cm">     * @since 2.5</span>
</span><span id="__span-0-171"><a id="__codelineno-0-171" name="__codelineno-0-171" href="#__codelineno-0-171"></a><span class="cm">     */</span>
</span><span id="__span-0-172"><a id="__codelineno-0-172" name="__codelineno-0-172" href="#__codelineno-0-172"></a><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-0-173"><a id="__codelineno-0-173" name="__codelineno-0-173" href="#__codelineno-0-173"></a>
</span><span id="__span-0-174"><a id="__codelineno-0-174" name="__codelineno-0-174" href="#__codelineno-0-174"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-175"><a id="__codelineno-0-175" name="__codelineno-0-175" href="#__codelineno-0-175"></a><span class="cm">     * Return the bean instance that uniquely matches the given object type, if any.</span>
</span><span id="__span-0-176"><a id="__codelineno-0-176" name="__codelineno-0-176" href="#__codelineno-0-176"></a><span class="cm">     * &lt;p&gt;This method goes into {@link ListableBeanFactory} by-type lookup territory</span>
</span><span id="__span-0-177"><a id="__codelineno-0-177" name="__codelineno-0-177" href="#__codelineno-0-177"></a><span class="cm">     * but may also be translated into a conventional by-name lookup based on the name</span>
</span><span id="__span-0-178"><a id="__codelineno-0-178" name="__codelineno-0-178" href="#__codelineno-0-178"></a><span class="cm">     * of the given type. For more extensive retrieval operations across sets of beans,</span>
</span><span id="__span-0-179"><a id="__codelineno-0-179" name="__codelineno-0-179" href="#__codelineno-0-179"></a><span class="cm">     * use {@link ListableBeanFactory} and/or {@link BeanFactoryUtils}.</span>
</span><span id="__span-0-180"><a id="__codelineno-0-180" name="__codelineno-0-180" href="#__codelineno-0-180"></a><span class="cm">     * @param requiredType type the bean must match; can be an interface or superclass</span>
</span><span id="__span-0-181"><a id="__codelineno-0-181" name="__codelineno-0-181" href="#__codelineno-0-181"></a><span class="cm">     * @return an instance of the single bean matching the required type</span>
</span><span id="__span-0-182"><a id="__codelineno-0-182" name="__codelineno-0-182" href="#__codelineno-0-182"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if no bean of the given type was found</span>
</span><span id="__span-0-183"><a id="__codelineno-0-183" name="__codelineno-0-183" href="#__codelineno-0-183"></a><span class="cm">     * @throws NoUniqueBeanDefinitionException if more than one bean of the given type was found</span>
</span><span id="__span-0-184"><a id="__codelineno-0-184" name="__codelineno-0-184" href="#__codelineno-0-184"></a><span class="cm">     * @throws BeansException if the bean could not be created</span>
</span><span id="__span-0-185"><a id="__codelineno-0-185" name="__codelineno-0-185" href="#__codelineno-0-185"></a><span class="cm">     * @since 3.0</span>
</span><span id="__span-0-186"><a id="__codelineno-0-186" name="__codelineno-0-186" href="#__codelineno-0-186"></a><span class="cm">     * @see ListableBeanFactory</span>
</span><span id="__span-0-187"><a id="__codelineno-0-187" name="__codelineno-0-187" href="#__codelineno-0-187"></a><span class="cm">     */</span>
</span><span id="__span-0-188"><a id="__codelineno-0-188" name="__codelineno-0-188" href="#__codelineno-0-188"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">requiredType</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-0-189"><a id="__codelineno-0-189" name="__codelineno-0-189" href="#__codelineno-0-189"></a>
</span><span id="__span-0-190"><a id="__codelineno-0-190" name="__codelineno-0-190" href="#__codelineno-0-190"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-191"><a id="__codelineno-0-191" name="__codelineno-0-191" href="#__codelineno-0-191"></a><span class="cm">     * Return an instance, which may be shared or independent, of the specified bean.</span>
</span><span id="__span-0-192"><a id="__codelineno-0-192" name="__codelineno-0-192" href="#__codelineno-0-192"></a><span class="cm">     * &lt;p&gt;Allows for specifying explicit constructor arguments / factory method arguments,</span>
</span><span id="__span-0-193"><a id="__codelineno-0-193" name="__codelineno-0-193" href="#__codelineno-0-193"></a><span class="cm">     * overriding the specified default arguments (if any) in the bean definition.</span>
</span><span id="__span-0-194"><a id="__codelineno-0-194" name="__codelineno-0-194" href="#__codelineno-0-194"></a><span class="cm">     * &lt;p&gt;This method goes into {@link ListableBeanFactory} by-type lookup territory</span>
</span><span id="__span-0-195"><a id="__codelineno-0-195" name="__codelineno-0-195" href="#__codelineno-0-195"></a><span class="cm">     * but may also be translated into a conventional by-name lookup based on the name</span>
</span><span id="__span-0-196"><a id="__codelineno-0-196" name="__codelineno-0-196" href="#__codelineno-0-196"></a><span class="cm">     * of the given type. For more extensive retrieval operations across sets of beans,</span>
</span><span id="__span-0-197"><a id="__codelineno-0-197" name="__codelineno-0-197" href="#__codelineno-0-197"></a><span class="cm">     * use {@link ListableBeanFactory} and/or {@link BeanFactoryUtils}.</span>
</span><span id="__span-0-198"><a id="__codelineno-0-198" name="__codelineno-0-198" href="#__codelineno-0-198"></a><span class="cm">     * @param requiredType type the bean must match; can be an interface or superclass</span>
</span><span id="__span-0-199"><a id="__codelineno-0-199" name="__codelineno-0-199" href="#__codelineno-0-199"></a><span class="cm">     * @param args arguments to use when creating a bean instance using explicit arguments</span>
</span><span id="__span-0-200"><a id="__codelineno-0-200" name="__codelineno-0-200" href="#__codelineno-0-200"></a><span class="cm">     * (only applied when creating a new instance as opposed to retrieving an existing one)</span>
</span><span id="__span-0-201"><a id="__codelineno-0-201" name="__codelineno-0-201" href="#__codelineno-0-201"></a><span class="cm">     * @return an instance of the bean</span>
</span><span id="__span-0-202"><a id="__codelineno-0-202" name="__codelineno-0-202" href="#__codelineno-0-202"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no such bean definition</span>
</span><span id="__span-0-203"><a id="__codelineno-0-203" name="__codelineno-0-203" href="#__codelineno-0-203"></a><span class="cm">     * @throws BeanDefinitionStoreException if arguments have been given but</span>
</span><span id="__span-0-204"><a id="__codelineno-0-204" name="__codelineno-0-204" href="#__codelineno-0-204"></a><span class="cm">     * the affected bean isn&#39;t a prototype</span>
</span><span id="__span-0-205"><a id="__codelineno-0-205" name="__codelineno-0-205" href="#__codelineno-0-205"></a><span class="cm">     * @throws BeansException if the bean could not be created</span>
</span><span id="__span-0-206"><a id="__codelineno-0-206" name="__codelineno-0-206" href="#__codelineno-0-206"></a><span class="cm">     * @since 4.1</span>
</span><span id="__span-0-207"><a id="__codelineno-0-207" name="__codelineno-0-207" href="#__codelineno-0-207"></a><span class="cm">     */</span>
</span><span id="__span-0-208"><a id="__codelineno-0-208" name="__codelineno-0-208" href="#__codelineno-0-208"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">requiredType</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-0-209"><a id="__codelineno-0-209" name="__codelineno-0-209" href="#__codelineno-0-209"></a>
</span><span id="__span-0-210"><a id="__codelineno-0-210" name="__codelineno-0-210" href="#__codelineno-0-210"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-211"><a id="__codelineno-0-211" name="__codelineno-0-211" href="#__codelineno-0-211"></a><span class="cm">     * Return a provider for the specified bean, allowing for lazy on-demand retrieval</span>
</span><span id="__span-0-212"><a id="__codelineno-0-212" name="__codelineno-0-212" href="#__codelineno-0-212"></a><span class="cm">     * of instances, including availability and uniqueness options.</span>
</span><span id="__span-0-213"><a id="__codelineno-0-213" name="__codelineno-0-213" href="#__codelineno-0-213"></a><span class="cm">     * @param requiredType type the bean must match; can be an interface or superclass</span>
</span><span id="__span-0-214"><a id="__codelineno-0-214" name="__codelineno-0-214" href="#__codelineno-0-214"></a><span class="cm">     * @return a corresponding provider handle</span>
</span><span id="__span-0-215"><a id="__codelineno-0-215" name="__codelineno-0-215" href="#__codelineno-0-215"></a><span class="cm">     * @since 5.1</span>
</span><span id="__span-0-216"><a id="__codelineno-0-216" name="__codelineno-0-216" href="#__codelineno-0-216"></a><span class="cm">     * @see #getBeanProvider(ResolvableType)</span>
</span><span id="__span-0-217"><a id="__codelineno-0-217" name="__codelineno-0-217" href="#__codelineno-0-217"></a><span class="cm">     */</span>
</span><span id="__span-0-218"><a id="__codelineno-0-218" name="__codelineno-0-218" href="#__codelineno-0-218"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeanProvider</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">requiredType</span><span class="p">);</span>
</span><span id="__span-0-219"><a id="__codelineno-0-219" name="__codelineno-0-219" href="#__codelineno-0-219"></a>
</span><span id="__span-0-220"><a id="__codelineno-0-220" name="__codelineno-0-220" href="#__codelineno-0-220"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-221"><a id="__codelineno-0-221" name="__codelineno-0-221" href="#__codelineno-0-221"></a><span class="cm">     * Return a provider for the specified bean, allowing for lazy on-demand retrieval</span>
</span><span id="__span-0-222"><a id="__codelineno-0-222" name="__codelineno-0-222" href="#__codelineno-0-222"></a><span class="cm">     * of instances, including availability and uniqueness options.</span>
</span><span id="__span-0-223"><a id="__codelineno-0-223" name="__codelineno-0-223" href="#__codelineno-0-223"></a><span class="cm">     * @param requiredType type the bean must match; can be a generic type declaration.</span>
</span><span id="__span-0-224"><a id="__codelineno-0-224" name="__codelineno-0-224" href="#__codelineno-0-224"></a><span class="cm">     * Note that collection types are not supported here, in contrast to reflective</span>
</span><span id="__span-0-225"><a id="__codelineno-0-225" name="__codelineno-0-225" href="#__codelineno-0-225"></a><span class="cm">     * injection points. For programmatically retrieving a list of beans matching a</span>
</span><span id="__span-0-226"><a id="__codelineno-0-226" name="__codelineno-0-226" href="#__codelineno-0-226"></a><span class="cm">     * specific type, specify the actual bean type as an argument here and subsequently</span>
</span><span id="__span-0-227"><a id="__codelineno-0-227" name="__codelineno-0-227" href="#__codelineno-0-227"></a><span class="cm">     * use {@link ObjectProvider#orderedStream()} or its lazy streaming/iteration options.</span>
</span><span id="__span-0-228"><a id="__codelineno-0-228" name="__codelineno-0-228" href="#__codelineno-0-228"></a><span class="cm">     * @return a corresponding provider handle</span>
</span><span id="__span-0-229"><a id="__codelineno-0-229" name="__codelineno-0-229" href="#__codelineno-0-229"></a><span class="cm">     * @since 5.1</span>
</span><span id="__span-0-230"><a id="__codelineno-0-230" name="__codelineno-0-230" href="#__codelineno-0-230"></a><span class="cm">     * @see ObjectProvider#iterator()</span>
</span><span id="__span-0-231"><a id="__codelineno-0-231" name="__codelineno-0-231" href="#__codelineno-0-231"></a><span class="cm">     * @see ObjectProvider#stream()</span>
</span><span id="__span-0-232"><a id="__codelineno-0-232" name="__codelineno-0-232" href="#__codelineno-0-232"></a><span class="cm">     * @see ObjectProvider#orderedStream()</span>
</span><span id="__span-0-233"><a id="__codelineno-0-233" name="__codelineno-0-233" href="#__codelineno-0-233"></a><span class="cm">     */</span>
</span><span id="__span-0-234"><a id="__codelineno-0-234" name="__codelineno-0-234" href="#__codelineno-0-234"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeanProvider</span><span class="p">(</span><span class="n">ResolvableType</span><span class="w"> </span><span class="n">requiredType</span><span class="p">);</span>
</span><span id="__span-0-235"><a id="__codelineno-0-235" name="__codelineno-0-235" href="#__codelineno-0-235"></a>
</span><span id="__span-0-236"><a id="__codelineno-0-236" name="__codelineno-0-236" href="#__codelineno-0-236"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-237"><a id="__codelineno-0-237" name="__codelineno-0-237" href="#__codelineno-0-237"></a><span class="cm">     * Does this bean factory contain a bean definition or externally registered singleton</span>
</span><span id="__span-0-238"><a id="__codelineno-0-238" name="__codelineno-0-238" href="#__codelineno-0-238"></a><span class="cm">     * instance with the given name?</span>
</span><span id="__span-0-239"><a id="__codelineno-0-239" name="__codelineno-0-239" href="#__codelineno-0-239"></a><span class="cm">     * &lt;p&gt;If the given name is an alias, it will be translated back to the corresponding</span>
</span><span id="__span-0-240"><a id="__codelineno-0-240" name="__codelineno-0-240" href="#__codelineno-0-240"></a><span class="cm">     * canonical bean name.</span>
</span><span id="__span-0-241"><a id="__codelineno-0-241" name="__codelineno-0-241" href="#__codelineno-0-241"></a><span class="cm">     * &lt;p&gt;If this factory is hierarchical, will ask any parent factory if the bean cannot</span>
</span><span id="__span-0-242"><a id="__codelineno-0-242" name="__codelineno-0-242" href="#__codelineno-0-242"></a><span class="cm">     * be found in this factory instance.</span>
</span><span id="__span-0-243"><a id="__codelineno-0-243" name="__codelineno-0-243" href="#__codelineno-0-243"></a><span class="cm">     * &lt;p&gt;If a bean definition or singleton instance matching the given name is found,</span>
</span><span id="__span-0-244"><a id="__codelineno-0-244" name="__codelineno-0-244" href="#__codelineno-0-244"></a><span class="cm">     * this method will return {@code true} whether the named bean definition is concrete</span>
</span><span id="__span-0-245"><a id="__codelineno-0-245" name="__codelineno-0-245" href="#__codelineno-0-245"></a><span class="cm">     * or abstract, lazy or eager, in scope or not. Therefore, note that a {@code true}</span>
</span><span id="__span-0-246"><a id="__codelineno-0-246" name="__codelineno-0-246" href="#__codelineno-0-246"></a><span class="cm">     * return value from this method does not necessarily indicate that {@link #getBean}</span>
</span><span id="__span-0-247"><a id="__codelineno-0-247" name="__codelineno-0-247" href="#__codelineno-0-247"></a><span class="cm">     * will be able to obtain an instance for the same name.</span>
</span><span id="__span-0-248"><a id="__codelineno-0-248" name="__codelineno-0-248" href="#__codelineno-0-248"></a><span class="cm">     * @param name the name of the bean to query</span>
</span><span id="__span-0-249"><a id="__codelineno-0-249" name="__codelineno-0-249" href="#__codelineno-0-249"></a><span class="cm">     * @return whether a bean with the given name is present</span>
</span><span id="__span-0-250"><a id="__codelineno-0-250" name="__codelineno-0-250" href="#__codelineno-0-250"></a><span class="cm">     */</span>
</span><span id="__span-0-251"><a id="__codelineno-0-251" name="__codelineno-0-251" href="#__codelineno-0-251"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">containsBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-0-252"><a id="__codelineno-0-252" name="__codelineno-0-252" href="#__codelineno-0-252"></a>
</span><span id="__span-0-253"><a id="__codelineno-0-253" name="__codelineno-0-253" href="#__codelineno-0-253"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-254"><a id="__codelineno-0-254" name="__codelineno-0-254" href="#__codelineno-0-254"></a><span class="cm">     * Is this bean a shared singleton? That is, will {@link #getBean} always</span>
</span><span id="__span-0-255"><a id="__codelineno-0-255" name="__codelineno-0-255" href="#__codelineno-0-255"></a><span class="cm">     * return the same instance?</span>
</span><span id="__span-0-256"><a id="__codelineno-0-256" name="__codelineno-0-256" href="#__codelineno-0-256"></a><span class="cm">     * &lt;p&gt;Note: This method returning {@code false} does not clearly indicate</span>
</span><span id="__span-0-257"><a id="__codelineno-0-257" name="__codelineno-0-257" href="#__codelineno-0-257"></a><span class="cm">     * independent instances. It indicates non-singleton instances, which may correspond</span>
</span><span id="__span-0-258"><a id="__codelineno-0-258" name="__codelineno-0-258" href="#__codelineno-0-258"></a><span class="cm">     * to a scoped bean as well. Use the {@link #isPrototype} operation to explicitly</span>
</span><span id="__span-0-259"><a id="__codelineno-0-259" name="__codelineno-0-259" href="#__codelineno-0-259"></a><span class="cm">     * check for independent instances.</span>
</span><span id="__span-0-260"><a id="__codelineno-0-260" name="__codelineno-0-260" href="#__codelineno-0-260"></a><span class="cm">     * &lt;p&gt;Translates aliases back to the corresponding canonical bean name.</span>
</span><span id="__span-0-261"><a id="__codelineno-0-261" name="__codelineno-0-261" href="#__codelineno-0-261"></a><span class="cm">     * Will ask the parent factory if the bean cannot be found in this factory instance.</span>
</span><span id="__span-0-262"><a id="__codelineno-0-262" name="__codelineno-0-262" href="#__codelineno-0-262"></a><span class="cm">     * @param name the name of the bean to query</span>
</span><span id="__span-0-263"><a id="__codelineno-0-263" name="__codelineno-0-263" href="#__codelineno-0-263"></a><span class="cm">     * @return whether this bean corresponds to a singleton instance</span>
</span><span id="__span-0-264"><a id="__codelineno-0-264" name="__codelineno-0-264" href="#__codelineno-0-264"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no bean with the given name</span>
</span><span id="__span-0-265"><a id="__codelineno-0-265" name="__codelineno-0-265" href="#__codelineno-0-265"></a><span class="cm">     * @see #getBean</span>
</span><span id="__span-0-266"><a id="__codelineno-0-266" name="__codelineno-0-266" href="#__codelineno-0-266"></a><span class="cm">     * @see #isPrototype</span>
</span><span id="__span-0-267"><a id="__codelineno-0-267" name="__codelineno-0-267" href="#__codelineno-0-267"></a><span class="cm">     */</span>
</span><span id="__span-0-268"><a id="__codelineno-0-268" name="__codelineno-0-268" href="#__codelineno-0-268"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isSingleton</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-0-269"><a id="__codelineno-0-269" name="__codelineno-0-269" href="#__codelineno-0-269"></a>
</span><span id="__span-0-270"><a id="__codelineno-0-270" name="__codelineno-0-270" href="#__codelineno-0-270"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-271"><a id="__codelineno-0-271" name="__codelineno-0-271" href="#__codelineno-0-271"></a><span class="cm">     * Is this bean a prototype? That is, will {@link #getBean} always return</span>
</span><span id="__span-0-272"><a id="__codelineno-0-272" name="__codelineno-0-272" href="#__codelineno-0-272"></a><span class="cm">     * independent instances?</span>
</span><span id="__span-0-273"><a id="__codelineno-0-273" name="__codelineno-0-273" href="#__codelineno-0-273"></a><span class="cm">     * &lt;p&gt;Note: This method returning {@code false} does not clearly indicate</span>
</span><span id="__span-0-274"><a id="__codelineno-0-274" name="__codelineno-0-274" href="#__codelineno-0-274"></a><span class="cm">     * a singleton object. It indicates non-independent instances, which may correspond</span>
</span><span id="__span-0-275"><a id="__codelineno-0-275" name="__codelineno-0-275" href="#__codelineno-0-275"></a><span class="cm">     * to a scoped bean as well. Use the {@link #isSingleton} operation to explicitly</span>
</span><span id="__span-0-276"><a id="__codelineno-0-276" name="__codelineno-0-276" href="#__codelineno-0-276"></a><span class="cm">     * check for a shared singleton instance.</span>
</span><span id="__span-0-277"><a id="__codelineno-0-277" name="__codelineno-0-277" href="#__codelineno-0-277"></a><span class="cm">     * &lt;p&gt;Translates aliases back to the corresponding canonical bean name.</span>
</span><span id="__span-0-278"><a id="__codelineno-0-278" name="__codelineno-0-278" href="#__codelineno-0-278"></a><span class="cm">     * Will ask the parent factory if the bean cannot be found in this factory instance.</span>
</span><span id="__span-0-279"><a id="__codelineno-0-279" name="__codelineno-0-279" href="#__codelineno-0-279"></a><span class="cm">     * @param name the name of the bean to query</span>
</span><span id="__span-0-280"><a id="__codelineno-0-280" name="__codelineno-0-280" href="#__codelineno-0-280"></a><span class="cm">     * @return whether this bean will always deliver independent instances</span>
</span><span id="__span-0-281"><a id="__codelineno-0-281" name="__codelineno-0-281" href="#__codelineno-0-281"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no bean with the given name</span>
</span><span id="__span-0-282"><a id="__codelineno-0-282" name="__codelineno-0-282" href="#__codelineno-0-282"></a><span class="cm">     * @since 2.0.3</span>
</span><span id="__span-0-283"><a id="__codelineno-0-283" name="__codelineno-0-283" href="#__codelineno-0-283"></a><span class="cm">     * @see #getBean</span>
</span><span id="__span-0-284"><a id="__codelineno-0-284" name="__codelineno-0-284" href="#__codelineno-0-284"></a><span class="cm">     * @see #isSingleton</span>
</span><span id="__span-0-285"><a id="__codelineno-0-285" name="__codelineno-0-285" href="#__codelineno-0-285"></a><span class="cm">     */</span>
</span><span id="__span-0-286"><a id="__codelineno-0-286" name="__codelineno-0-286" href="#__codelineno-0-286"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isPrototype</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-0-287"><a id="__codelineno-0-287" name="__codelineno-0-287" href="#__codelineno-0-287"></a>
</span><span id="__span-0-288"><a id="__codelineno-0-288" name="__codelineno-0-288" href="#__codelineno-0-288"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-289"><a id="__codelineno-0-289" name="__codelineno-0-289" href="#__codelineno-0-289"></a><span class="cm">     * Check whether the bean with the given name matches the specified type.</span>
</span><span id="__span-0-290"><a id="__codelineno-0-290" name="__codelineno-0-290" href="#__codelineno-0-290"></a><span class="cm">     * More specifically, check whether a {@link #getBean} call for the given name</span>
</span><span id="__span-0-291"><a id="__codelineno-0-291" name="__codelineno-0-291" href="#__codelineno-0-291"></a><span class="cm">     * would return an object that is assignable to the specified target type.</span>
</span><span id="__span-0-292"><a id="__codelineno-0-292" name="__codelineno-0-292" href="#__codelineno-0-292"></a><span class="cm">     * &lt;p&gt;Translates aliases back to the corresponding canonical bean name.</span>
</span><span id="__span-0-293"><a id="__codelineno-0-293" name="__codelineno-0-293" href="#__codelineno-0-293"></a><span class="cm">     * Will ask the parent factory if the bean cannot be found in this factory instance.</span>
</span><span id="__span-0-294"><a id="__codelineno-0-294" name="__codelineno-0-294" href="#__codelineno-0-294"></a><span class="cm">     * @param name the name of the bean to query</span>
</span><span id="__span-0-295"><a id="__codelineno-0-295" name="__codelineno-0-295" href="#__codelineno-0-295"></a><span class="cm">     * @param typeToMatch the type to match against (as a {@code ResolvableType})</span>
</span><span id="__span-0-296"><a id="__codelineno-0-296" name="__codelineno-0-296" href="#__codelineno-0-296"></a><span class="cm">     * @return {@code true} if the bean type matches,</span>
</span><span id="__span-0-297"><a id="__codelineno-0-297" name="__codelineno-0-297" href="#__codelineno-0-297"></a><span class="cm">     * {@code false} if it doesn&#39;t match or cannot be determined yet</span>
</span><span id="__span-0-298"><a id="__codelineno-0-298" name="__codelineno-0-298" href="#__codelineno-0-298"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no bean with the given name</span>
</span><span id="__span-0-299"><a id="__codelineno-0-299" name="__codelineno-0-299" href="#__codelineno-0-299"></a><span class="cm">     * @since 4.2</span>
</span><span id="__span-0-300"><a id="__codelineno-0-300" name="__codelineno-0-300" href="#__codelineno-0-300"></a><span class="cm">     * @see #getBean</span>
</span><span id="__span-0-301"><a id="__codelineno-0-301" name="__codelineno-0-301" href="#__codelineno-0-301"></a><span class="cm">     * @see #getType</span>
</span><span id="__span-0-302"><a id="__codelineno-0-302" name="__codelineno-0-302" href="#__codelineno-0-302"></a><span class="cm">     */</span>
</span><span id="__span-0-303"><a id="__codelineno-0-303" name="__codelineno-0-303" href="#__codelineno-0-303"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isTypeMatch</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">ResolvableType</span><span class="w"> </span><span class="n">typeToMatch</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-0-304"><a id="__codelineno-0-304" name="__codelineno-0-304" href="#__codelineno-0-304"></a>
</span><span id="__span-0-305"><a id="__codelineno-0-305" name="__codelineno-0-305" href="#__codelineno-0-305"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-306"><a id="__codelineno-0-306" name="__codelineno-0-306" href="#__codelineno-0-306"></a><span class="cm">     * Check whether the bean with the given name matches the specified type.</span>
</span><span id="__span-0-307"><a id="__codelineno-0-307" name="__codelineno-0-307" href="#__codelineno-0-307"></a><span class="cm">     * More specifically, check whether a {@link #getBean} call for the given name</span>
</span><span id="__span-0-308"><a id="__codelineno-0-308" name="__codelineno-0-308" href="#__codelineno-0-308"></a><span class="cm">     * would return an object that is assignable to the specified target type.</span>
</span><span id="__span-0-309"><a id="__codelineno-0-309" name="__codelineno-0-309" href="#__codelineno-0-309"></a><span class="cm">     * &lt;p&gt;Translates aliases back to the corresponding canonical bean name.</span>
</span><span id="__span-0-310"><a id="__codelineno-0-310" name="__codelineno-0-310" href="#__codelineno-0-310"></a><span class="cm">     * Will ask the parent factory if the bean cannot be found in this factory instance.</span>
</span><span id="__span-0-311"><a id="__codelineno-0-311" name="__codelineno-0-311" href="#__codelineno-0-311"></a><span class="cm">     * @param name the name of the bean to query</span>
</span><span id="__span-0-312"><a id="__codelineno-0-312" name="__codelineno-0-312" href="#__codelineno-0-312"></a><span class="cm">     * @param typeToMatch the type to match against (as a {@code Class})</span>
</span><span id="__span-0-313"><a id="__codelineno-0-313" name="__codelineno-0-313" href="#__codelineno-0-313"></a><span class="cm">     * @return {@code true} if the bean type matches,</span>
</span><span id="__span-0-314"><a id="__codelineno-0-314" name="__codelineno-0-314" href="#__codelineno-0-314"></a><span class="cm">     * {@code false} if it doesn&#39;t match or cannot be determined yet</span>
</span><span id="__span-0-315"><a id="__codelineno-0-315" name="__codelineno-0-315" href="#__codelineno-0-315"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no bean with the given name</span>
</span><span id="__span-0-316"><a id="__codelineno-0-316" name="__codelineno-0-316" href="#__codelineno-0-316"></a><span class="cm">     * @since 2.0.1</span>
</span><span id="__span-0-317"><a id="__codelineno-0-317" name="__codelineno-0-317" href="#__codelineno-0-317"></a><span class="cm">     * @see #getBean</span>
</span><span id="__span-0-318"><a id="__codelineno-0-318" name="__codelineno-0-318" href="#__codelineno-0-318"></a><span class="cm">     * @see #getType</span>
</span><span id="__span-0-319"><a id="__codelineno-0-319" name="__codelineno-0-319" href="#__codelineno-0-319"></a><span class="cm">     */</span>
</span><span id="__span-0-320"><a id="__codelineno-0-320" name="__codelineno-0-320" href="#__codelineno-0-320"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isTypeMatch</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">typeToMatch</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-0-321"><a id="__codelineno-0-321" name="__codelineno-0-321" href="#__codelineno-0-321"></a>
</span><span id="__span-0-322"><a id="__codelineno-0-322" name="__codelineno-0-322" href="#__codelineno-0-322"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-323"><a id="__codelineno-0-323" name="__codelineno-0-323" href="#__codelineno-0-323"></a><span class="cm">     * Determine the type of the bean with the given name. More specifically,</span>
</span><span id="__span-0-324"><a id="__codelineno-0-324" name="__codelineno-0-324" href="#__codelineno-0-324"></a><span class="cm">     * determine the type of object that {@link #getBean} would return for the given name.</span>
</span><span id="__span-0-325"><a id="__codelineno-0-325" name="__codelineno-0-325" href="#__codelineno-0-325"></a><span class="cm">     * &lt;p&gt;For a {@link FactoryBean}, return the type of object that the FactoryBean creates,</span>
</span><span id="__span-0-326"><a id="__codelineno-0-326" name="__codelineno-0-326" href="#__codelineno-0-326"></a><span class="cm">     * as exposed by {@link FactoryBean#getObjectType()}. This may lead to the initialization</span>
</span><span id="__span-0-327"><a id="__codelineno-0-327" name="__codelineno-0-327" href="#__codelineno-0-327"></a><span class="cm">     * of a previously uninitialized {@code FactoryBean} (see {@link #getType(String, boolean)}).</span>
</span><span id="__span-0-328"><a id="__codelineno-0-328" name="__codelineno-0-328" href="#__codelineno-0-328"></a><span class="cm">     * &lt;p&gt;Translates aliases back to the corresponding canonical bean name.</span>
</span><span id="__span-0-329"><a id="__codelineno-0-329" name="__codelineno-0-329" href="#__codelineno-0-329"></a><span class="cm">     * Will ask the parent factory if the bean cannot be found in this factory instance.</span>
</span><span id="__span-0-330"><a id="__codelineno-0-330" name="__codelineno-0-330" href="#__codelineno-0-330"></a><span class="cm">     * @param name the name of the bean to query</span>
</span><span id="__span-0-331"><a id="__codelineno-0-331" name="__codelineno-0-331" href="#__codelineno-0-331"></a><span class="cm">     * @return the type of the bean, or {@code null} if not determinable</span>
</span><span id="__span-0-332"><a id="__codelineno-0-332" name="__codelineno-0-332" href="#__codelineno-0-332"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no bean with the given name</span>
</span><span id="__span-0-333"><a id="__codelineno-0-333" name="__codelineno-0-333" href="#__codelineno-0-333"></a><span class="cm">     * @since 1.1.2</span>
</span><span id="__span-0-334"><a id="__codelineno-0-334" name="__codelineno-0-334" href="#__codelineno-0-334"></a><span class="cm">     * @see #getBean</span>
</span><span id="__span-0-335"><a id="__codelineno-0-335" name="__codelineno-0-335" href="#__codelineno-0-335"></a><span class="cm">     * @see #isTypeMatch</span>
</span><span id="__span-0-336"><a id="__codelineno-0-336" name="__codelineno-0-336" href="#__codelineno-0-336"></a><span class="cm">     */</span>
</span><span id="__span-0-337"><a id="__codelineno-0-337" name="__codelineno-0-337" href="#__codelineno-0-337"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-0-338"><a id="__codelineno-0-338" name="__codelineno-0-338" href="#__codelineno-0-338"></a><span class="w">    </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">getType</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-0-339"><a id="__codelineno-0-339" name="__codelineno-0-339" href="#__codelineno-0-339"></a>
</span><span id="__span-0-340"><a id="__codelineno-0-340" name="__codelineno-0-340" href="#__codelineno-0-340"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-341"><a id="__codelineno-0-341" name="__codelineno-0-341" href="#__codelineno-0-341"></a><span class="cm">     * Determine the type of the bean with the given name. More specifically,</span>
</span><span id="__span-0-342"><a id="__codelineno-0-342" name="__codelineno-0-342" href="#__codelineno-0-342"></a><span class="cm">     * determine the type of object that {@link #getBean} would return for the given name.</span>
</span><span id="__span-0-343"><a id="__codelineno-0-343" name="__codelineno-0-343" href="#__codelineno-0-343"></a><span class="cm">     * &lt;p&gt;For a {@link FactoryBean}, return the type of object that the FactoryBean creates,</span>
</span><span id="__span-0-344"><a id="__codelineno-0-344" name="__codelineno-0-344" href="#__codelineno-0-344"></a><span class="cm">     * as exposed by {@link FactoryBean#getObjectType()}. Depending on the</span>
</span><span id="__span-0-345"><a id="__codelineno-0-345" name="__codelineno-0-345" href="#__codelineno-0-345"></a><span class="cm">     * {@code allowFactoryBeanInit} flag, this may lead to the initialization of a previously</span>
</span><span id="__span-0-346"><a id="__codelineno-0-346" name="__codelineno-0-346" href="#__codelineno-0-346"></a><span class="cm">     * uninitialized {@code FactoryBean} if no early type information is available.</span>
</span><span id="__span-0-347"><a id="__codelineno-0-347" name="__codelineno-0-347" href="#__codelineno-0-347"></a><span class="cm">     * &lt;p&gt;Translates aliases back to the corresponding canonical bean name.</span>
</span><span id="__span-0-348"><a id="__codelineno-0-348" name="__codelineno-0-348" href="#__codelineno-0-348"></a><span class="cm">     * Will ask the parent factory if the bean cannot be found in this factory instance.</span>
</span><span id="__span-0-349"><a id="__codelineno-0-349" name="__codelineno-0-349" href="#__codelineno-0-349"></a><span class="cm">     * @param name the name of the bean to query</span>
</span><span id="__span-0-350"><a id="__codelineno-0-350" name="__codelineno-0-350" href="#__codelineno-0-350"></a><span class="cm">     * @param allowFactoryBeanInit whether a {@code FactoryBean} may get initialized</span>
</span><span id="__span-0-351"><a id="__codelineno-0-351" name="__codelineno-0-351" href="#__codelineno-0-351"></a><span class="cm">     * just for the purpose of determining its object type</span>
</span><span id="__span-0-352"><a id="__codelineno-0-352" name="__codelineno-0-352" href="#__codelineno-0-352"></a><span class="cm">     * @return the type of the bean, or {@code null} if not determinable</span>
</span><span id="__span-0-353"><a id="__codelineno-0-353" name="__codelineno-0-353" href="#__codelineno-0-353"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no bean with the given name</span>
</span><span id="__span-0-354"><a id="__codelineno-0-354" name="__codelineno-0-354" href="#__codelineno-0-354"></a><span class="cm">     * @since 5.2</span>
</span><span id="__span-0-355"><a id="__codelineno-0-355" name="__codelineno-0-355" href="#__codelineno-0-355"></a><span class="cm">     * @see #getBean</span>
</span><span id="__span-0-356"><a id="__codelineno-0-356" name="__codelineno-0-356" href="#__codelineno-0-356"></a><span class="cm">     * @see #isTypeMatch</span>
</span><span id="__span-0-357"><a id="__codelineno-0-357" name="__codelineno-0-357" href="#__codelineno-0-357"></a><span class="cm">     */</span>
</span><span id="__span-0-358"><a id="__codelineno-0-358" name="__codelineno-0-358" href="#__codelineno-0-358"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-0-359"><a id="__codelineno-0-359" name="__codelineno-0-359" href="#__codelineno-0-359"></a><span class="w">    </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">getType</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">allowFactoryBeanInit</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-0-360"><a id="__codelineno-0-360" name="__codelineno-0-360" href="#__codelineno-0-360"></a>
</span><span id="__span-0-361"><a id="__codelineno-0-361" name="__codelineno-0-361" href="#__codelineno-0-361"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-0-362"><a id="__codelineno-0-362" name="__codelineno-0-362" href="#__codelineno-0-362"></a><span class="cm">     * Return the aliases for the given bean name, if any.</span>
</span><span id="__span-0-363"><a id="__codelineno-0-363" name="__codelineno-0-363" href="#__codelineno-0-363"></a><span class="cm">     * All of those aliases point to the same bean when used in a {@link #getBean} call.</span>
</span><span id="__span-0-364"><a id="__codelineno-0-364" name="__codelineno-0-364" href="#__codelineno-0-364"></a><span class="cm">     * &lt;p&gt;If the given name is an alias, the corresponding original bean name</span>
</span><span id="__span-0-365"><a id="__codelineno-0-365" name="__codelineno-0-365" href="#__codelineno-0-365"></a><span class="cm">     * and other aliases (if any) will be returned, with the original bean name</span>
</span><span id="__span-0-366"><a id="__codelineno-0-366" name="__codelineno-0-366" href="#__codelineno-0-366"></a><span class="cm">     * being the first element in the array.</span>
</span><span id="__span-0-367"><a id="__codelineno-0-367" name="__codelineno-0-367" href="#__codelineno-0-367"></a><span class="cm">     * &lt;p&gt;Will ask the parent factory if the bean cannot be found in this factory instance.</span>
</span><span id="__span-0-368"><a id="__codelineno-0-368" name="__codelineno-0-368" href="#__codelineno-0-368"></a><span class="cm">     * @param name the bean name to check for aliases</span>
</span><span id="__span-0-369"><a id="__codelineno-0-369" name="__codelineno-0-369" href="#__codelineno-0-369"></a><span class="cm">     * @return the aliases, or an empty array if none</span>
</span><span id="__span-0-370"><a id="__codelineno-0-370" name="__codelineno-0-370" href="#__codelineno-0-370"></a><span class="cm">     * @see #getBean</span>
</span><span id="__span-0-371"><a id="__codelineno-0-371" name="__codelineno-0-371" href="#__codelineno-0-371"></a><span class="cm">     */</span>
</span><span id="__span-0-372"><a id="__codelineno-0-372" name="__codelineno-0-372" href="#__codelineno-0-372"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getAliases</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-0-373"><a id="__codelineno-0-373" name="__codelineno-0-373" href="#__codelineno-0-373"></a>
</span><span id="__span-0-374"><a id="__codelineno-0-374" name="__codelineno-0-374" href="#__codelineno-0-374"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="beanfactory_1">BeanFactory方法属性摘要<a class="headerlink" href="#beanfactory_1" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">BeanFactory</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="cm">     */</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">FACTORY_BEAN_PREFIX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&amp;&quot;</span><span class="p">;</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="cm">     */</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="cm">     */</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">requiredType</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="cm">     */</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="cm">     */</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">requiredType</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="cm">     */</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">requiredType</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="cm">     */</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeanProvider</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">requiredType</span><span class="p">);</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="cm">     */</span>
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeanProvider</span><span class="p">(</span><span class="n">ResolvableType</span><span class="w"> </span><span class="n">requiredType</span><span class="p">);</span>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="cm">     */</span>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">containsBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a><span class="cm">     */</span>
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isSingleton</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a><span class="cm">     */</span>
</span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isPrototype</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-1-47"><a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>
</span><span id="__span-1-48"><a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-49"><a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a><span class="cm">     */</span>
</span><span id="__span-1-50"><a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isTypeMatch</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">ResolvableType</span><span class="w"> </span><span class="n">typeToMatch</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-1-51"><a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a>
</span><span id="__span-1-52"><a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-53"><a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a><span class="cm">     */</span>
</span><span id="__span-1-54"><a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isTypeMatch</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">typeToMatch</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-1-55"><a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a>
</span><span id="__span-1-56"><a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-57"><a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a><span class="cm">     */</span>
</span><span id="__span-1-58"><a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-1-59"><a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a><span class="w">    </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">getType</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-1-60"><a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a>
</span><span id="__span-1-61"><a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-62"><a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a><span class="cm">     */</span>
</span><span id="__span-1-63"><a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-1-64"><a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a><span class="w">    </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">getType</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">allowFactoryBeanInit</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-1-65"><a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a>
</span><span id="__span-1-66"><a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-1-67"><a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a><span class="cm">     */</span>
</span><span id="__span-1-68"><a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getAliases</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-1-69"><a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a>
</span><span id="__span-1-70"><a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="12-hierarchicalbeanfactory">1.2 HierarchicalBeanFactory接口<a class="headerlink" href="#12-hierarchicalbeanfactory" title="Permanent link">&para;</a></h3>
<h3 id="_3">完整版源码：<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="cm">/*</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="cm"> * Copyright 2002-2012 the original author or authors.</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="cm"> *</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="cm"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="cm"> * you may not use this file except in compliance with the License.</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="cm"> * You may obtain a copy of the License at</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="cm"> *</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="cm"> *      https://www.apache.org/licenses/LICENSE-2.0</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="cm"> *</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="cm"> * Unless required by applicable law or agreed to in writing, software</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="cm"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="cm"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="cm"> * See the License for the specific language governing permissions and</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="cm"> * limitations under the License.</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="cm"> */</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="kn">package</span><span class="w"> </span><span class="nn">org.springframework.beans.factory</span><span class="p">;</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.lang.Nullable</span><span class="p">;</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="cm">/**</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="cm"> * Sub-interface implemented by bean factories that can be part</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="cm"> * of a hierarchy.</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="cm"> *</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="cm"> * &lt;p&gt;The corresponding {@code setParentBeanFactory} method for bean</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="cm"> * factories that allow setting the parent in a configurable</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="cm"> * fashion can be found in the ConfigurableBeanFactory interface.</span>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="cm"> *</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="cm"> * @author Rod Johnson</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="cm"> * @author Juergen Hoeller</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="cm"> * @since 07.07.2003</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="cm"> * @see org.springframework.beans.factory.config.ConfigurableBeanFactory#setParentBeanFactory</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a><span class="cm"> */</span>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">HierarchicalBeanFactory</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BeanFactory</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a><span class="cm">     * Return the parent bean factory, or {@code null} if there is none.</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="cm">     */</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a><span class="w">    </span><span class="n">BeanFactory</span><span class="w"> </span><span class="nf">getParentBeanFactory</span><span class="p">();</span>
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a>
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a><span class="cm">     * Return whether the local bean factory contains a bean of the given name,</span>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a><span class="cm">     * ignoring beans defined in ancestor contexts.</span>
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a><span class="cm">     * &lt;p&gt;This is an alternative to {@code containsBean}, ignoring a bean</span>
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a><span class="cm">     * of the given name from an ancestor bean factory.</span>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a><span class="cm">     * @param name the name of the bean to query</span>
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a><span class="cm">     * @return whether a bean with the given name is defined in the local factory</span>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a><span class="cm">     * @see BeanFactory#containsBean</span>
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a><span class="cm">     */</span>
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">containsLocalBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a>
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="hierarchicalbeanfactory">HierarchicalBeanFactory方法属性摘要<a class="headerlink" href="#hierarchicalbeanfactory" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">HierarchicalBeanFactory</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BeanFactory</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="cm">     */</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">    </span><span class="n">BeanFactory</span><span class="w"> </span><span class="nf">getParentBeanFactory</span><span class="p">();</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="cm">     */</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">containsLocalBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="13-listablebeanfactory">1.3 ListableBeanFactory接口<a class="headerlink" href="#13-listablebeanfactory" title="Permanent link">&para;</a></h3>
<h3 id="_4">完整版源码：<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="cm">/*</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="cm"> * Copyright 2002-2019 the original author or authors.</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="cm"> *</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="cm"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="cm"> * you may not use this file except in compliance with the License.</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="cm"> * You may obtain a copy of the License at</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="cm"> *</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="cm"> *      https://www.apache.org/licenses/LICENSE-2.0</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="cm"> *</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="cm"> * Unless required by applicable law or agreed to in writing, software</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="cm"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="cm"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="cm"> * See the License for the specific language governing permissions and</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="cm"> * limitations under the License.</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="cm"> */</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="kn">package</span><span class="w"> </span><span class="nn">org.springframework.beans.factory</span><span class="p">;</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.lang.annotation.Annotation</span><span class="p">;</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.BeansException</span><span class="p">;</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.ResolvableType</span><span class="p">;</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.lang.Nullable</span><span class="p">;</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="cm">/**</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="cm"> * Extension of the {@link BeanFactory} interface to be implemented by bean factories</span>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="cm"> * that can enumerate all their bean instances, rather than attempting bean lookup</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="cm"> * by name one by one as requested by clients. BeanFactory implementations that</span>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a><span class="cm"> * preload all their bean definitions (such as XML-based factories) may implement</span>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="cm"> * this interface.</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="cm"> *</span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a><span class="cm"> * &lt;p&gt;If this is a {@link HierarchicalBeanFactory}, the return values will &lt;i&gt;not&lt;/i&gt;</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="cm"> * take any BeanFactory hierarchy into account, but will relate only to the beans</span>
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a><span class="cm"> * defined in the current factory. Use the {@link BeanFactoryUtils} helper class</span>
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a><span class="cm"> * to consider beans in ancestor factories too.</span>
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="cm"> *</span>
</span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a><span class="cm"> * &lt;p&gt;The methods in this interface will just respect bean definitions of this factory.</span>
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a><span class="cm"> * They will ignore any singleton beans that have been registered by other means like</span>
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a><span class="cm"> * {@link org.springframework.beans.factory.config.ConfigurableBeanFactory}&#39;s</span>
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a><span class="cm"> * {@code registerSingleton} method, with the exception of</span>
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a><span class="cm"> * {@code getBeanNamesOfType} and {@code getBeansOfType} which will check</span>
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a><span class="cm"> * such manually registered singletons too. Of course, BeanFactory&#39;s {@code getBean}</span>
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a><span class="cm"> * does allow transparent access to such special beans as well. However, in typical</span>
</span><span id="__span-4-45"><a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a><span class="cm"> * scenarios, all beans will be defined by external bean definitions anyway, so most</span>
</span><span id="__span-4-46"><a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a><span class="cm"> * applications don&#39;t need to worry about this differentiation.</span>
</span><span id="__span-4-47"><a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a><span class="cm"> *</span>
</span><span id="__span-4-48"><a id="__codelineno-4-48" name="__codelineno-4-48" href="#__codelineno-4-48"></a><span class="cm"> * &lt;p&gt;&lt;b&gt;NOTE:&lt;/b&gt; With the exception of {@code getBeanDefinitionCount}</span>
</span><span id="__span-4-49"><a id="__codelineno-4-49" name="__codelineno-4-49" href="#__codelineno-4-49"></a><span class="cm"> * and {@code containsBeanDefinition}, the methods in this interface</span>
</span><span id="__span-4-50"><a id="__codelineno-4-50" name="__codelineno-4-50" href="#__codelineno-4-50"></a><span class="cm"> * are not designed for frequent invocation. Implementations may be slow.</span>
</span><span id="__span-4-51"><a id="__codelineno-4-51" name="__codelineno-4-51" href="#__codelineno-4-51"></a><span class="cm"> *</span>
</span><span id="__span-4-52"><a id="__codelineno-4-52" name="__codelineno-4-52" href="#__codelineno-4-52"></a><span class="cm"> * @author Rod Johnson</span>
</span><span id="__span-4-53"><a id="__codelineno-4-53" name="__codelineno-4-53" href="#__codelineno-4-53"></a><span class="cm"> * @author Juergen Hoeller</span>
</span><span id="__span-4-54"><a id="__codelineno-4-54" name="__codelineno-4-54" href="#__codelineno-4-54"></a><span class="cm"> * @since 16 April 2001</span>
</span><span id="__span-4-55"><a id="__codelineno-4-55" name="__codelineno-4-55" href="#__codelineno-4-55"></a><span class="cm"> * @see HierarchicalBeanFactory</span>
</span><span id="__span-4-56"><a id="__codelineno-4-56" name="__codelineno-4-56" href="#__codelineno-4-56"></a><span class="cm"> * @see BeanFactoryUtils</span>
</span><span id="__span-4-57"><a id="__codelineno-4-57" name="__codelineno-4-57" href="#__codelineno-4-57"></a><span class="cm"> */</span>
</span><span id="__span-4-58"><a id="__codelineno-4-58" name="__codelineno-4-58" href="#__codelineno-4-58"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ListableBeanFactory</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BeanFactory</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-59"><a id="__codelineno-4-59" name="__codelineno-4-59" href="#__codelineno-4-59"></a>
</span><span id="__span-4-60"><a id="__codelineno-4-60" name="__codelineno-4-60" href="#__codelineno-4-60"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-61"><a id="__codelineno-4-61" name="__codelineno-4-61" href="#__codelineno-4-61"></a><span class="cm">     * Check if this bean factory contains a bean definition with the given name.</span>
</span><span id="__span-4-62"><a id="__codelineno-4-62" name="__codelineno-4-62" href="#__codelineno-4-62"></a><span class="cm">     * &lt;p&gt;Does not consider any hierarchy this factory may participate in,</span>
</span><span id="__span-4-63"><a id="__codelineno-4-63" name="__codelineno-4-63" href="#__codelineno-4-63"></a><span class="cm">     * and ignores any singleton beans that have been registered by</span>
</span><span id="__span-4-64"><a id="__codelineno-4-64" name="__codelineno-4-64" href="#__codelineno-4-64"></a><span class="cm">     * other means than bean definitions.</span>
</span><span id="__span-4-65"><a id="__codelineno-4-65" name="__codelineno-4-65" href="#__codelineno-4-65"></a><span class="cm">     * @param beanName the name of the bean to look for</span>
</span><span id="__span-4-66"><a id="__codelineno-4-66" name="__codelineno-4-66" href="#__codelineno-4-66"></a><span class="cm">     * @return if this bean factory contains a bean definition with the given name</span>
</span><span id="__span-4-67"><a id="__codelineno-4-67" name="__codelineno-4-67" href="#__codelineno-4-67"></a><span class="cm">     * @see #containsBean</span>
</span><span id="__span-4-68"><a id="__codelineno-4-68" name="__codelineno-4-68" href="#__codelineno-4-68"></a><span class="cm">     */</span>
</span><span id="__span-4-69"><a id="__codelineno-4-69" name="__codelineno-4-69" href="#__codelineno-4-69"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">containsBeanDefinition</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-4-70"><a id="__codelineno-4-70" name="__codelineno-4-70" href="#__codelineno-4-70"></a>
</span><span id="__span-4-71"><a id="__codelineno-4-71" name="__codelineno-4-71" href="#__codelineno-4-71"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-72"><a id="__codelineno-4-72" name="__codelineno-4-72" href="#__codelineno-4-72"></a><span class="cm">     * Return the number of beans defined in the factory.</span>
</span><span id="__span-4-73"><a id="__codelineno-4-73" name="__codelineno-4-73" href="#__codelineno-4-73"></a><span class="cm">     * &lt;p&gt;Does not consider any hierarchy this factory may participate in,</span>
</span><span id="__span-4-74"><a id="__codelineno-4-74" name="__codelineno-4-74" href="#__codelineno-4-74"></a><span class="cm">     * and ignores any singleton beans that have been registered by</span>
</span><span id="__span-4-75"><a id="__codelineno-4-75" name="__codelineno-4-75" href="#__codelineno-4-75"></a><span class="cm">     * other means than bean definitions.</span>
</span><span id="__span-4-76"><a id="__codelineno-4-76" name="__codelineno-4-76" href="#__codelineno-4-76"></a><span class="cm">     * @return the number of beans defined in the factory</span>
</span><span id="__span-4-77"><a id="__codelineno-4-77" name="__codelineno-4-77" href="#__codelineno-4-77"></a><span class="cm">     */</span>
</span><span id="__span-4-78"><a id="__codelineno-4-78" name="__codelineno-4-78" href="#__codelineno-4-78"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">getBeanDefinitionCount</span><span class="p">();</span>
</span><span id="__span-4-79"><a id="__codelineno-4-79" name="__codelineno-4-79" href="#__codelineno-4-79"></a>
</span><span id="__span-4-80"><a id="__codelineno-4-80" name="__codelineno-4-80" href="#__codelineno-4-80"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-81"><a id="__codelineno-4-81" name="__codelineno-4-81" href="#__codelineno-4-81"></a><span class="cm">     * Return the names of all beans defined in this factory.</span>
</span><span id="__span-4-82"><a id="__codelineno-4-82" name="__codelineno-4-82" href="#__codelineno-4-82"></a><span class="cm">     * &lt;p&gt;Does not consider any hierarchy this factory may participate in,</span>
</span><span id="__span-4-83"><a id="__codelineno-4-83" name="__codelineno-4-83" href="#__codelineno-4-83"></a><span class="cm">     * and ignores any singleton beans that have been registered by</span>
</span><span id="__span-4-84"><a id="__codelineno-4-84" name="__codelineno-4-84" href="#__codelineno-4-84"></a><span class="cm">     * other means than bean definitions.</span>
</span><span id="__span-4-85"><a id="__codelineno-4-85" name="__codelineno-4-85" href="#__codelineno-4-85"></a><span class="cm">     * @return the names of all beans defined in this factory,</span>
</span><span id="__span-4-86"><a id="__codelineno-4-86" name="__codelineno-4-86" href="#__codelineno-4-86"></a><span class="cm">     * or an empty array if none defined</span>
</span><span id="__span-4-87"><a id="__codelineno-4-87" name="__codelineno-4-87" href="#__codelineno-4-87"></a><span class="cm">     */</span>
</span><span id="__span-4-88"><a id="__codelineno-4-88" name="__codelineno-4-88" href="#__codelineno-4-88"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanDefinitionNames</span><span class="p">();</span>
</span><span id="__span-4-89"><a id="__codelineno-4-89" name="__codelineno-4-89" href="#__codelineno-4-89"></a>
</span><span id="__span-4-90"><a id="__codelineno-4-90" name="__codelineno-4-90" href="#__codelineno-4-90"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-91"><a id="__codelineno-4-91" name="__codelineno-4-91" href="#__codelineno-4-91"></a><span class="cm">     * Return the names of beans matching the given type (including subclasses),</span>
</span><span id="__span-4-92"><a id="__codelineno-4-92" name="__codelineno-4-92" href="#__codelineno-4-92"></a><span class="cm">     * judging from either bean definitions or the value of {@code getObjectType}</span>
</span><span id="__span-4-93"><a id="__codelineno-4-93" name="__codelineno-4-93" href="#__codelineno-4-93"></a><span class="cm">     * in the case of FactoryBeans.</span>
</span><span id="__span-4-94"><a id="__codelineno-4-94" name="__codelineno-4-94" href="#__codelineno-4-94"></a><span class="cm">     * &lt;p&gt;&lt;b&gt;NOTE: This method introspects top-level beans only.&lt;/b&gt; It does &lt;i&gt;not&lt;/i&gt;</span>
</span><span id="__span-4-95"><a id="__codelineno-4-95" name="__codelineno-4-95" href="#__codelineno-4-95"></a><span class="cm">     * check nested beans which might match the specified type as well.</span>
</span><span id="__span-4-96"><a id="__codelineno-4-96" name="__codelineno-4-96" href="#__codelineno-4-96"></a><span class="cm">     * &lt;p&gt;Does consider objects created by FactoryBeans, which means that FactoryBeans</span>
</span><span id="__span-4-97"><a id="__codelineno-4-97" name="__codelineno-4-97" href="#__codelineno-4-97"></a><span class="cm">     * will get initialized. If the object created by the FactoryBean doesn&#39;t match,</span>
</span><span id="__span-4-98"><a id="__codelineno-4-98" name="__codelineno-4-98" href="#__codelineno-4-98"></a><span class="cm">     * the raw FactoryBean itself will be matched against the type.</span>
</span><span id="__span-4-99"><a id="__codelineno-4-99" name="__codelineno-4-99" href="#__codelineno-4-99"></a><span class="cm">     * &lt;p&gt;Does not consider any hierarchy this factory may participate in.</span>
</span><span id="__span-4-100"><a id="__codelineno-4-100" name="__codelineno-4-100" href="#__codelineno-4-100"></a><span class="cm">     * Use BeanFactoryUtils&#39; {@code beanNamesForTypeIncludingAncestors}</span>
</span><span id="__span-4-101"><a id="__codelineno-4-101" name="__codelineno-4-101" href="#__codelineno-4-101"></a><span class="cm">     * to include beans in ancestor factories too.</span>
</span><span id="__span-4-102"><a id="__codelineno-4-102" name="__codelineno-4-102" href="#__codelineno-4-102"></a><span class="cm">     * &lt;p&gt;Note: Does &lt;i&gt;not&lt;/i&gt; ignore singleton beans that have been registered</span>
</span><span id="__span-4-103"><a id="__codelineno-4-103" name="__codelineno-4-103" href="#__codelineno-4-103"></a><span class="cm">     * by other means than bean definitions.</span>
</span><span id="__span-4-104"><a id="__codelineno-4-104" name="__codelineno-4-104" href="#__codelineno-4-104"></a><span class="cm">     * &lt;p&gt;This version of {@code getBeanNamesForType} matches all kinds of beans,</span>
</span><span id="__span-4-105"><a id="__codelineno-4-105" name="__codelineno-4-105" href="#__codelineno-4-105"></a><span class="cm">     * be it singletons, prototypes, or FactoryBeans. In most implementations, the</span>
</span><span id="__span-4-106"><a id="__codelineno-4-106" name="__codelineno-4-106" href="#__codelineno-4-106"></a><span class="cm">     * result will be the same as for {@code getBeanNamesForType(type, true, true)}.</span>
</span><span id="__span-4-107"><a id="__codelineno-4-107" name="__codelineno-4-107" href="#__codelineno-4-107"></a><span class="cm">     * &lt;p&gt;Bean names returned by this method should always return bean names &lt;i&gt;in the</span>
</span><span id="__span-4-108"><a id="__codelineno-4-108" name="__codelineno-4-108" href="#__codelineno-4-108"></a><span class="cm">     * order of definition&lt;/i&gt; in the backend configuration, as far as possible.</span>
</span><span id="__span-4-109"><a id="__codelineno-4-109" name="__codelineno-4-109" href="#__codelineno-4-109"></a><span class="cm">     * @param type the generically typed class or interface to match</span>
</span><span id="__span-4-110"><a id="__codelineno-4-110" name="__codelineno-4-110" href="#__codelineno-4-110"></a><span class="cm">     * @return the names of beans (or objects created by FactoryBeans) matching</span>
</span><span id="__span-4-111"><a id="__codelineno-4-111" name="__codelineno-4-111" href="#__codelineno-4-111"></a><span class="cm">     * the given object type (including subclasses), or an empty array if none</span>
</span><span id="__span-4-112"><a id="__codelineno-4-112" name="__codelineno-4-112" href="#__codelineno-4-112"></a><span class="cm">     * @since 4.2</span>
</span><span id="__span-4-113"><a id="__codelineno-4-113" name="__codelineno-4-113" href="#__codelineno-4-113"></a><span class="cm">     * @see #isTypeMatch(String, ResolvableType)</span>
</span><span id="__span-4-114"><a id="__codelineno-4-114" name="__codelineno-4-114" href="#__codelineno-4-114"></a><span class="cm">     * @see FactoryBean#getObjectType</span>
</span><span id="__span-4-115"><a id="__codelineno-4-115" name="__codelineno-4-115" href="#__codelineno-4-115"></a><span class="cm">     * @see BeanFactoryUtils#beanNamesForTypeIncludingAncestors(ListableBeanFactory, ResolvableType)</span>
</span><span id="__span-4-116"><a id="__codelineno-4-116" name="__codelineno-4-116" href="#__codelineno-4-116"></a><span class="cm">     */</span>
</span><span id="__span-4-117"><a id="__codelineno-4-117" name="__codelineno-4-117" href="#__codelineno-4-117"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanNamesForType</span><span class="p">(</span><span class="n">ResolvableType</span><span class="w"> </span><span class="n">type</span><span class="p">);</span>
</span><span id="__span-4-118"><a id="__codelineno-4-118" name="__codelineno-4-118" href="#__codelineno-4-118"></a>
</span><span id="__span-4-119"><a id="__codelineno-4-119" name="__codelineno-4-119" href="#__codelineno-4-119"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-120"><a id="__codelineno-4-120" name="__codelineno-4-120" href="#__codelineno-4-120"></a><span class="cm">     * Return the names of beans matching the given type (including subclasses),</span>
</span><span id="__span-4-121"><a id="__codelineno-4-121" name="__codelineno-4-121" href="#__codelineno-4-121"></a><span class="cm">     * judging from either bean definitions or the value of {@code getObjectType}</span>
</span><span id="__span-4-122"><a id="__codelineno-4-122" name="__codelineno-4-122" href="#__codelineno-4-122"></a><span class="cm">     * in the case of FactoryBeans.</span>
</span><span id="__span-4-123"><a id="__codelineno-4-123" name="__codelineno-4-123" href="#__codelineno-4-123"></a><span class="cm">     * &lt;p&gt;&lt;b&gt;NOTE: This method introspects top-level beans only.&lt;/b&gt; It does &lt;i&gt;not&lt;/i&gt;</span>
</span><span id="__span-4-124"><a id="__codelineno-4-124" name="__codelineno-4-124" href="#__codelineno-4-124"></a><span class="cm">     * check nested beans which might match the specified type as well.</span>
</span><span id="__span-4-125"><a id="__codelineno-4-125" name="__codelineno-4-125" href="#__codelineno-4-125"></a><span class="cm">     * &lt;p&gt;Does consider objects created by FactoryBeans if the &quot;allowEagerInit&quot; flag is set,</span>
</span><span id="__span-4-126"><a id="__codelineno-4-126" name="__codelineno-4-126" href="#__codelineno-4-126"></a><span class="cm">     * which means that FactoryBeans will get initialized. If the object created by the</span>
</span><span id="__span-4-127"><a id="__codelineno-4-127" name="__codelineno-4-127" href="#__codelineno-4-127"></a><span class="cm">     * FactoryBean doesn&#39;t match, the raw FactoryBean itself will be matched against the</span>
</span><span id="__span-4-128"><a id="__codelineno-4-128" name="__codelineno-4-128" href="#__codelineno-4-128"></a><span class="cm">     * type. If &quot;allowEagerInit&quot; is not set, only raw FactoryBeans will be checked</span>
</span><span id="__span-4-129"><a id="__codelineno-4-129" name="__codelineno-4-129" href="#__codelineno-4-129"></a><span class="cm">     * (which doesn&#39;t require initialization of each FactoryBean).</span>
</span><span id="__span-4-130"><a id="__codelineno-4-130" name="__codelineno-4-130" href="#__codelineno-4-130"></a><span class="cm">     * &lt;p&gt;Does not consider any hierarchy this factory may participate in.</span>
</span><span id="__span-4-131"><a id="__codelineno-4-131" name="__codelineno-4-131" href="#__codelineno-4-131"></a><span class="cm">     * Use BeanFactoryUtils&#39; {@code beanNamesForTypeIncludingAncestors}</span>
</span><span id="__span-4-132"><a id="__codelineno-4-132" name="__codelineno-4-132" href="#__codelineno-4-132"></a><span class="cm">     * to include beans in ancestor factories too.</span>
</span><span id="__span-4-133"><a id="__codelineno-4-133" name="__codelineno-4-133" href="#__codelineno-4-133"></a><span class="cm">     * &lt;p&gt;Note: Does &lt;i&gt;not&lt;/i&gt; ignore singleton beans that have been registered</span>
</span><span id="__span-4-134"><a id="__codelineno-4-134" name="__codelineno-4-134" href="#__codelineno-4-134"></a><span class="cm">     * by other means than bean definitions.</span>
</span><span id="__span-4-135"><a id="__codelineno-4-135" name="__codelineno-4-135" href="#__codelineno-4-135"></a><span class="cm">     * &lt;p&gt;Bean names returned by this method should always return bean names &lt;i&gt;in the</span>
</span><span id="__span-4-136"><a id="__codelineno-4-136" name="__codelineno-4-136" href="#__codelineno-4-136"></a><span class="cm">     * order of definition&lt;/i&gt; in the backend configuration, as far as possible.</span>
</span><span id="__span-4-137"><a id="__codelineno-4-137" name="__codelineno-4-137" href="#__codelineno-4-137"></a><span class="cm">     * @param type the generically typed class or interface to match</span>
</span><span id="__span-4-138"><a id="__codelineno-4-138" name="__codelineno-4-138" href="#__codelineno-4-138"></a><span class="cm">     * @param includeNonSingletons whether to include prototype or scoped beans too</span>
</span><span id="__span-4-139"><a id="__codelineno-4-139" name="__codelineno-4-139" href="#__codelineno-4-139"></a><span class="cm">     * or just singletons (also applies to FactoryBeans)</span>
</span><span id="__span-4-140"><a id="__codelineno-4-140" name="__codelineno-4-140" href="#__codelineno-4-140"></a><span class="cm">     * @param allowEagerInit whether to initialize &lt;i&gt;lazy-init singletons&lt;/i&gt; and</span>
</span><span id="__span-4-141"><a id="__codelineno-4-141" name="__codelineno-4-141" href="#__codelineno-4-141"></a><span class="cm">     * &lt;i&gt;objects created by FactoryBeans&lt;/i&gt; (or by factory methods with a</span>
</span><span id="__span-4-142"><a id="__codelineno-4-142" name="__codelineno-4-142" href="#__codelineno-4-142"></a><span class="cm">     * &quot;factory-bean&quot; reference) for the type check. Note that FactoryBeans need to be</span>
</span><span id="__span-4-143"><a id="__codelineno-4-143" name="__codelineno-4-143" href="#__codelineno-4-143"></a><span class="cm">     * eagerly initialized to determine their type: So be aware that passing in &quot;true&quot;</span>
</span><span id="__span-4-144"><a id="__codelineno-4-144" name="__codelineno-4-144" href="#__codelineno-4-144"></a><span class="cm">     * for this flag will initialize FactoryBeans and &quot;factory-bean&quot; references.</span>
</span><span id="__span-4-145"><a id="__codelineno-4-145" name="__codelineno-4-145" href="#__codelineno-4-145"></a><span class="cm">     * @return the names of beans (or objects created by FactoryBeans) matching</span>
</span><span id="__span-4-146"><a id="__codelineno-4-146" name="__codelineno-4-146" href="#__codelineno-4-146"></a><span class="cm">     * the given object type (including subclasses), or an empty array if none</span>
</span><span id="__span-4-147"><a id="__codelineno-4-147" name="__codelineno-4-147" href="#__codelineno-4-147"></a><span class="cm">     * @since 5.2</span>
</span><span id="__span-4-148"><a id="__codelineno-4-148" name="__codelineno-4-148" href="#__codelineno-4-148"></a><span class="cm">     * @see FactoryBean#getObjectType</span>
</span><span id="__span-4-149"><a id="__codelineno-4-149" name="__codelineno-4-149" href="#__codelineno-4-149"></a><span class="cm">     * @see BeanFactoryUtils#beanNamesForTypeIncludingAncestors(ListableBeanFactory, ResolvableType, boolean, boolean)</span>
</span><span id="__span-4-150"><a id="__codelineno-4-150" name="__codelineno-4-150" href="#__codelineno-4-150"></a><span class="cm">     */</span>
</span><span id="__span-4-151"><a id="__codelineno-4-151" name="__codelineno-4-151" href="#__codelineno-4-151"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanNamesForType</span><span class="p">(</span><span class="n">ResolvableType</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">includeNonSingletons</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">allowEagerInit</span><span class="p">);</span>
</span><span id="__span-4-152"><a id="__codelineno-4-152" name="__codelineno-4-152" href="#__codelineno-4-152"></a>
</span><span id="__span-4-153"><a id="__codelineno-4-153" name="__codelineno-4-153" href="#__codelineno-4-153"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-154"><a id="__codelineno-4-154" name="__codelineno-4-154" href="#__codelineno-4-154"></a><span class="cm">     * Return the names of beans matching the given type (including subclasses),</span>
</span><span id="__span-4-155"><a id="__codelineno-4-155" name="__codelineno-4-155" href="#__codelineno-4-155"></a><span class="cm">     * judging from either bean definitions or the value of {@code getObjectType}</span>
</span><span id="__span-4-156"><a id="__codelineno-4-156" name="__codelineno-4-156" href="#__codelineno-4-156"></a><span class="cm">     * in the case of FactoryBeans.</span>
</span><span id="__span-4-157"><a id="__codelineno-4-157" name="__codelineno-4-157" href="#__codelineno-4-157"></a><span class="cm">     * &lt;p&gt;&lt;b&gt;NOTE: This method introspects top-level beans only.&lt;/b&gt; It does &lt;i&gt;not&lt;/i&gt;</span>
</span><span id="__span-4-158"><a id="__codelineno-4-158" name="__codelineno-4-158" href="#__codelineno-4-158"></a><span class="cm">     * check nested beans which might match the specified type as well.</span>
</span><span id="__span-4-159"><a id="__codelineno-4-159" name="__codelineno-4-159" href="#__codelineno-4-159"></a><span class="cm">     * &lt;p&gt;Does consider objects created by FactoryBeans, which means that FactoryBeans</span>
</span><span id="__span-4-160"><a id="__codelineno-4-160" name="__codelineno-4-160" href="#__codelineno-4-160"></a><span class="cm">     * will get initialized. If the object created by the FactoryBean doesn&#39;t match,</span>
</span><span id="__span-4-161"><a id="__codelineno-4-161" name="__codelineno-4-161" href="#__codelineno-4-161"></a><span class="cm">     * the raw FactoryBean itself will be matched against the type.</span>
</span><span id="__span-4-162"><a id="__codelineno-4-162" name="__codelineno-4-162" href="#__codelineno-4-162"></a><span class="cm">     * &lt;p&gt;Does not consider any hierarchy this factory may participate in.</span>
</span><span id="__span-4-163"><a id="__codelineno-4-163" name="__codelineno-4-163" href="#__codelineno-4-163"></a><span class="cm">     * Use BeanFactoryUtils&#39; {@code beanNamesForTypeIncludingAncestors}</span>
</span><span id="__span-4-164"><a id="__codelineno-4-164" name="__codelineno-4-164" href="#__codelineno-4-164"></a><span class="cm">     * to include beans in ancestor factories too.</span>
</span><span id="__span-4-165"><a id="__codelineno-4-165" name="__codelineno-4-165" href="#__codelineno-4-165"></a><span class="cm">     * &lt;p&gt;Note: Does &lt;i&gt;not&lt;/i&gt; ignore singleton beans that have been registered</span>
</span><span id="__span-4-166"><a id="__codelineno-4-166" name="__codelineno-4-166" href="#__codelineno-4-166"></a><span class="cm">     * by other means than bean definitions.</span>
</span><span id="__span-4-167"><a id="__codelineno-4-167" name="__codelineno-4-167" href="#__codelineno-4-167"></a><span class="cm">     * &lt;p&gt;This version of {@code getBeanNamesForType} matches all kinds of beans,</span>
</span><span id="__span-4-168"><a id="__codelineno-4-168" name="__codelineno-4-168" href="#__codelineno-4-168"></a><span class="cm">     * be it singletons, prototypes, or FactoryBeans. In most implementations, the</span>
</span><span id="__span-4-169"><a id="__codelineno-4-169" name="__codelineno-4-169" href="#__codelineno-4-169"></a><span class="cm">     * result will be the same as for {@code getBeanNamesForType(type, true, true)}.</span>
</span><span id="__span-4-170"><a id="__codelineno-4-170" name="__codelineno-4-170" href="#__codelineno-4-170"></a><span class="cm">     * &lt;p&gt;Bean names returned by this method should always return bean names &lt;i&gt;in the</span>
</span><span id="__span-4-171"><a id="__codelineno-4-171" name="__codelineno-4-171" href="#__codelineno-4-171"></a><span class="cm">     * order of definition&lt;/i&gt; in the backend configuration, as far as possible.</span>
</span><span id="__span-4-172"><a id="__codelineno-4-172" name="__codelineno-4-172" href="#__codelineno-4-172"></a><span class="cm">     * @param type the class or interface to match, or {@code null} for all bean names</span>
</span><span id="__span-4-173"><a id="__codelineno-4-173" name="__codelineno-4-173" href="#__codelineno-4-173"></a><span class="cm">     * @return the names of beans (or objects created by FactoryBeans) matching</span>
</span><span id="__span-4-174"><a id="__codelineno-4-174" name="__codelineno-4-174" href="#__codelineno-4-174"></a><span class="cm">     * the given object type (including subclasses), or an empty array if none</span>
</span><span id="__span-4-175"><a id="__codelineno-4-175" name="__codelineno-4-175" href="#__codelineno-4-175"></a><span class="cm">     * @see FactoryBean#getObjectType</span>
</span><span id="__span-4-176"><a id="__codelineno-4-176" name="__codelineno-4-176" href="#__codelineno-4-176"></a><span class="cm">     * @see BeanFactoryUtils#beanNamesForTypeIncludingAncestors(ListableBeanFactory, Class)</span>
</span><span id="__span-4-177"><a id="__codelineno-4-177" name="__codelineno-4-177" href="#__codelineno-4-177"></a><span class="cm">     */</span>
</span><span id="__span-4-178"><a id="__codelineno-4-178" name="__codelineno-4-178" href="#__codelineno-4-178"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanNamesForType</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">type</span><span class="p">);</span>
</span><span id="__span-4-179"><a id="__codelineno-4-179" name="__codelineno-4-179" href="#__codelineno-4-179"></a>
</span><span id="__span-4-180"><a id="__codelineno-4-180" name="__codelineno-4-180" href="#__codelineno-4-180"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-181"><a id="__codelineno-4-181" name="__codelineno-4-181" href="#__codelineno-4-181"></a><span class="cm">     * Return the names of beans matching the given type (including subclasses),</span>
</span><span id="__span-4-182"><a id="__codelineno-4-182" name="__codelineno-4-182" href="#__codelineno-4-182"></a><span class="cm">     * judging from either bean definitions or the value of {@code getObjectType}</span>
</span><span id="__span-4-183"><a id="__codelineno-4-183" name="__codelineno-4-183" href="#__codelineno-4-183"></a><span class="cm">     * in the case of FactoryBeans.</span>
</span><span id="__span-4-184"><a id="__codelineno-4-184" name="__codelineno-4-184" href="#__codelineno-4-184"></a><span class="cm">     * &lt;p&gt;&lt;b&gt;NOTE: This method introspects top-level beans only.&lt;/b&gt; It does &lt;i&gt;not&lt;/i&gt;</span>
</span><span id="__span-4-185"><a id="__codelineno-4-185" name="__codelineno-4-185" href="#__codelineno-4-185"></a><span class="cm">     * check nested beans which might match the specified type as well.</span>
</span><span id="__span-4-186"><a id="__codelineno-4-186" name="__codelineno-4-186" href="#__codelineno-4-186"></a><span class="cm">     * &lt;p&gt;Does consider objects created by FactoryBeans if the &quot;allowEagerInit&quot; flag is set,</span>
</span><span id="__span-4-187"><a id="__codelineno-4-187" name="__codelineno-4-187" href="#__codelineno-4-187"></a><span class="cm">     * which means that FactoryBeans will get initialized. If the object created by the</span>
</span><span id="__span-4-188"><a id="__codelineno-4-188" name="__codelineno-4-188" href="#__codelineno-4-188"></a><span class="cm">     * FactoryBean doesn&#39;t match, the raw FactoryBean itself will be matched against the</span>
</span><span id="__span-4-189"><a id="__codelineno-4-189" name="__codelineno-4-189" href="#__codelineno-4-189"></a><span class="cm">     * type. If &quot;allowEagerInit&quot; is not set, only raw FactoryBeans will be checked</span>
</span><span id="__span-4-190"><a id="__codelineno-4-190" name="__codelineno-4-190" href="#__codelineno-4-190"></a><span class="cm">     * (which doesn&#39;t require initialization of each FactoryBean).</span>
</span><span id="__span-4-191"><a id="__codelineno-4-191" name="__codelineno-4-191" href="#__codelineno-4-191"></a><span class="cm">     * &lt;p&gt;Does not consider any hierarchy this factory may participate in.</span>
</span><span id="__span-4-192"><a id="__codelineno-4-192" name="__codelineno-4-192" href="#__codelineno-4-192"></a><span class="cm">     * Use BeanFactoryUtils&#39; {@code beanNamesForTypeIncludingAncestors}</span>
</span><span id="__span-4-193"><a id="__codelineno-4-193" name="__codelineno-4-193" href="#__codelineno-4-193"></a><span class="cm">     * to include beans in ancestor factories too.</span>
</span><span id="__span-4-194"><a id="__codelineno-4-194" name="__codelineno-4-194" href="#__codelineno-4-194"></a><span class="cm">     * &lt;p&gt;Note: Does &lt;i&gt;not&lt;/i&gt; ignore singleton beans that have been registered</span>
</span><span id="__span-4-195"><a id="__codelineno-4-195" name="__codelineno-4-195" href="#__codelineno-4-195"></a><span class="cm">     * by other means than bean definitions.</span>
</span><span id="__span-4-196"><a id="__codelineno-4-196" name="__codelineno-4-196" href="#__codelineno-4-196"></a><span class="cm">     * &lt;p&gt;Bean names returned by this method should always return bean names &lt;i&gt;in the</span>
</span><span id="__span-4-197"><a id="__codelineno-4-197" name="__codelineno-4-197" href="#__codelineno-4-197"></a><span class="cm">     * order of definition&lt;/i&gt; in the backend configuration, as far as possible.</span>
</span><span id="__span-4-198"><a id="__codelineno-4-198" name="__codelineno-4-198" href="#__codelineno-4-198"></a><span class="cm">     * @param type the class or interface to match, or {@code null} for all bean names</span>
</span><span id="__span-4-199"><a id="__codelineno-4-199" name="__codelineno-4-199" href="#__codelineno-4-199"></a><span class="cm">     * @param includeNonSingletons whether to include prototype or scoped beans too</span>
</span><span id="__span-4-200"><a id="__codelineno-4-200" name="__codelineno-4-200" href="#__codelineno-4-200"></a><span class="cm">     * or just singletons (also applies to FactoryBeans)</span>
</span><span id="__span-4-201"><a id="__codelineno-4-201" name="__codelineno-4-201" href="#__codelineno-4-201"></a><span class="cm">     * @param allowEagerInit whether to initialize &lt;i&gt;lazy-init singletons&lt;/i&gt; and</span>
</span><span id="__span-4-202"><a id="__codelineno-4-202" name="__codelineno-4-202" href="#__codelineno-4-202"></a><span class="cm">     * &lt;i&gt;objects created by FactoryBeans&lt;/i&gt; (or by factory methods with a</span>
</span><span id="__span-4-203"><a id="__codelineno-4-203" name="__codelineno-4-203" href="#__codelineno-4-203"></a><span class="cm">     * &quot;factory-bean&quot; reference) for the type check. Note that FactoryBeans need to be</span>
</span><span id="__span-4-204"><a id="__codelineno-4-204" name="__codelineno-4-204" href="#__codelineno-4-204"></a><span class="cm">     * eagerly initialized to determine their type: So be aware that passing in &quot;true&quot;</span>
</span><span id="__span-4-205"><a id="__codelineno-4-205" name="__codelineno-4-205" href="#__codelineno-4-205"></a><span class="cm">     * for this flag will initialize FactoryBeans and &quot;factory-bean&quot; references.</span>
</span><span id="__span-4-206"><a id="__codelineno-4-206" name="__codelineno-4-206" href="#__codelineno-4-206"></a><span class="cm">     * @return the names of beans (or objects created by FactoryBeans) matching</span>
</span><span id="__span-4-207"><a id="__codelineno-4-207" name="__codelineno-4-207" href="#__codelineno-4-207"></a><span class="cm">     * the given object type (including subclasses), or an empty array if none</span>
</span><span id="__span-4-208"><a id="__codelineno-4-208" name="__codelineno-4-208" href="#__codelineno-4-208"></a><span class="cm">     * @see FactoryBean#getObjectType</span>
</span><span id="__span-4-209"><a id="__codelineno-4-209" name="__codelineno-4-209" href="#__codelineno-4-209"></a><span class="cm">     * @see BeanFactoryUtils#beanNamesForTypeIncludingAncestors(ListableBeanFactory, Class, boolean, boolean)</span>
</span><span id="__span-4-210"><a id="__codelineno-4-210" name="__codelineno-4-210" href="#__codelineno-4-210"></a><span class="cm">     */</span>
</span><span id="__span-4-211"><a id="__codelineno-4-211" name="__codelineno-4-211" href="#__codelineno-4-211"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanNamesForType</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">includeNonSingletons</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">allowEagerInit</span><span class="p">);</span>
</span><span id="__span-4-212"><a id="__codelineno-4-212" name="__codelineno-4-212" href="#__codelineno-4-212"></a>
</span><span id="__span-4-213"><a id="__codelineno-4-213" name="__codelineno-4-213" href="#__codelineno-4-213"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-214"><a id="__codelineno-4-214" name="__codelineno-4-214" href="#__codelineno-4-214"></a><span class="cm">     * Return the bean instances that match the given object type (including</span>
</span><span id="__span-4-215"><a id="__codelineno-4-215" name="__codelineno-4-215" href="#__codelineno-4-215"></a><span class="cm">     * subclasses), judging from either bean definitions or the value of</span>
</span><span id="__span-4-216"><a id="__codelineno-4-216" name="__codelineno-4-216" href="#__codelineno-4-216"></a><span class="cm">     * {@code getObjectType} in the case of FactoryBeans.</span>
</span><span id="__span-4-217"><a id="__codelineno-4-217" name="__codelineno-4-217" href="#__codelineno-4-217"></a><span class="cm">     * &lt;p&gt;&lt;b&gt;NOTE: This method introspects top-level beans only.&lt;/b&gt; It does &lt;i&gt;not&lt;/i&gt;</span>
</span><span id="__span-4-218"><a id="__codelineno-4-218" name="__codelineno-4-218" href="#__codelineno-4-218"></a><span class="cm">     * check nested beans which might match the specified type as well.</span>
</span><span id="__span-4-219"><a id="__codelineno-4-219" name="__codelineno-4-219" href="#__codelineno-4-219"></a><span class="cm">     * &lt;p&gt;Does consider objects created by FactoryBeans, which means that FactoryBeans</span>
</span><span id="__span-4-220"><a id="__codelineno-4-220" name="__codelineno-4-220" href="#__codelineno-4-220"></a><span class="cm">     * will get initialized. If the object created by the FactoryBean doesn&#39;t match,</span>
</span><span id="__span-4-221"><a id="__codelineno-4-221" name="__codelineno-4-221" href="#__codelineno-4-221"></a><span class="cm">     * the raw FactoryBean itself will be matched against the type.</span>
</span><span id="__span-4-222"><a id="__codelineno-4-222" name="__codelineno-4-222" href="#__codelineno-4-222"></a><span class="cm">     * &lt;p&gt;Does not consider any hierarchy this factory may participate in.</span>
</span><span id="__span-4-223"><a id="__codelineno-4-223" name="__codelineno-4-223" href="#__codelineno-4-223"></a><span class="cm">     * Use BeanFactoryUtils&#39; {@code beansOfTypeIncludingAncestors}</span>
</span><span id="__span-4-224"><a id="__codelineno-4-224" name="__codelineno-4-224" href="#__codelineno-4-224"></a><span class="cm">     * to include beans in ancestor factories too.</span>
</span><span id="__span-4-225"><a id="__codelineno-4-225" name="__codelineno-4-225" href="#__codelineno-4-225"></a><span class="cm">     * &lt;p&gt;Note: Does &lt;i&gt;not&lt;/i&gt; ignore singleton beans that have been registered</span>
</span><span id="__span-4-226"><a id="__codelineno-4-226" name="__codelineno-4-226" href="#__codelineno-4-226"></a><span class="cm">     * by other means than bean definitions.</span>
</span><span id="__span-4-227"><a id="__codelineno-4-227" name="__codelineno-4-227" href="#__codelineno-4-227"></a><span class="cm">     * &lt;p&gt;This version of getBeansOfType matches all kinds of beans, be it</span>
</span><span id="__span-4-228"><a id="__codelineno-4-228" name="__codelineno-4-228" href="#__codelineno-4-228"></a><span class="cm">     * singletons, prototypes, or FactoryBeans. In most implementations, the</span>
</span><span id="__span-4-229"><a id="__codelineno-4-229" name="__codelineno-4-229" href="#__codelineno-4-229"></a><span class="cm">     * result will be the same as for {@code getBeansOfType(type, true, true)}.</span>
</span><span id="__span-4-230"><a id="__codelineno-4-230" name="__codelineno-4-230" href="#__codelineno-4-230"></a><span class="cm">     * &lt;p&gt;The Map returned by this method should always return bean names and</span>
</span><span id="__span-4-231"><a id="__codelineno-4-231" name="__codelineno-4-231" href="#__codelineno-4-231"></a><span class="cm">     * corresponding bean instances &lt;i&gt;in the order of definition&lt;/i&gt; in the</span>
</span><span id="__span-4-232"><a id="__codelineno-4-232" name="__codelineno-4-232" href="#__codelineno-4-232"></a><span class="cm">     * backend configuration, as far as possible.</span>
</span><span id="__span-4-233"><a id="__codelineno-4-233" name="__codelineno-4-233" href="#__codelineno-4-233"></a><span class="cm">     * @param type the class or interface to match, or {@code null} for all concrete beans</span>
</span><span id="__span-4-234"><a id="__codelineno-4-234" name="__codelineno-4-234" href="#__codelineno-4-234"></a><span class="cm">     * @return a Map with the matching beans, containing the bean names as</span>
</span><span id="__span-4-235"><a id="__codelineno-4-235" name="__codelineno-4-235" href="#__codelineno-4-235"></a><span class="cm">     * keys and the corresponding bean instances as values</span>
</span><span id="__span-4-236"><a id="__codelineno-4-236" name="__codelineno-4-236" href="#__codelineno-4-236"></a><span class="cm">     * @throws BeansException if a bean could not be created</span>
</span><span id="__span-4-237"><a id="__codelineno-4-237" name="__codelineno-4-237" href="#__codelineno-4-237"></a><span class="cm">     * @since 1.1.2</span>
</span><span id="__span-4-238"><a id="__codelineno-4-238" name="__codelineno-4-238" href="#__codelineno-4-238"></a><span class="cm">     * @see FactoryBean#getObjectType</span>
</span><span id="__span-4-239"><a id="__codelineno-4-239" name="__codelineno-4-239" href="#__codelineno-4-239"></a><span class="cm">     * @see BeanFactoryUtils#beansOfTypeIncludingAncestors(ListableBeanFactory, Class)</span>
</span><span id="__span-4-240"><a id="__codelineno-4-240" name="__codelineno-4-240" href="#__codelineno-4-240"></a><span class="cm">     */</span>
</span><span id="__span-4-241"><a id="__codelineno-4-241" name="__codelineno-4-241" href="#__codelineno-4-241"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeansOfType</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-4-242"><a id="__codelineno-4-242" name="__codelineno-4-242" href="#__codelineno-4-242"></a>
</span><span id="__span-4-243"><a id="__codelineno-4-243" name="__codelineno-4-243" href="#__codelineno-4-243"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-244"><a id="__codelineno-4-244" name="__codelineno-4-244" href="#__codelineno-4-244"></a><span class="cm">     * Return the bean instances that match the given object type (including</span>
</span><span id="__span-4-245"><a id="__codelineno-4-245" name="__codelineno-4-245" href="#__codelineno-4-245"></a><span class="cm">     * subclasses), judging from either bean definitions or the value of</span>
</span><span id="__span-4-246"><a id="__codelineno-4-246" name="__codelineno-4-246" href="#__codelineno-4-246"></a><span class="cm">     * {@code getObjectType} in the case of FactoryBeans.</span>
</span><span id="__span-4-247"><a id="__codelineno-4-247" name="__codelineno-4-247" href="#__codelineno-4-247"></a><span class="cm">     * &lt;p&gt;&lt;b&gt;NOTE: This method introspects top-level beans only.&lt;/b&gt; It does &lt;i&gt;not&lt;/i&gt;</span>
</span><span id="__span-4-248"><a id="__codelineno-4-248" name="__codelineno-4-248" href="#__codelineno-4-248"></a><span class="cm">     * check nested beans which might match the specified type as well.</span>
</span><span id="__span-4-249"><a id="__codelineno-4-249" name="__codelineno-4-249" href="#__codelineno-4-249"></a><span class="cm">     * &lt;p&gt;Does consider objects created by FactoryBeans if the &quot;allowEagerInit&quot; flag is set,</span>
</span><span id="__span-4-250"><a id="__codelineno-4-250" name="__codelineno-4-250" href="#__codelineno-4-250"></a><span class="cm">     * which means that FactoryBeans will get initialized. If the object created by the</span>
</span><span id="__span-4-251"><a id="__codelineno-4-251" name="__codelineno-4-251" href="#__codelineno-4-251"></a><span class="cm">     * FactoryBean doesn&#39;t match, the raw FactoryBean itself will be matched against the</span>
</span><span id="__span-4-252"><a id="__codelineno-4-252" name="__codelineno-4-252" href="#__codelineno-4-252"></a><span class="cm">     * type. If &quot;allowEagerInit&quot; is not set, only raw FactoryBeans will be checked</span>
</span><span id="__span-4-253"><a id="__codelineno-4-253" name="__codelineno-4-253" href="#__codelineno-4-253"></a><span class="cm">     * (which doesn&#39;t require initialization of each FactoryBean).</span>
</span><span id="__span-4-254"><a id="__codelineno-4-254" name="__codelineno-4-254" href="#__codelineno-4-254"></a><span class="cm">     * &lt;p&gt;Does not consider any hierarchy this factory may participate in.</span>
</span><span id="__span-4-255"><a id="__codelineno-4-255" name="__codelineno-4-255" href="#__codelineno-4-255"></a><span class="cm">     * Use BeanFactoryUtils&#39; {@code beansOfTypeIncludingAncestors}</span>
</span><span id="__span-4-256"><a id="__codelineno-4-256" name="__codelineno-4-256" href="#__codelineno-4-256"></a><span class="cm">     * to include beans in ancestor factories too.</span>
</span><span id="__span-4-257"><a id="__codelineno-4-257" name="__codelineno-4-257" href="#__codelineno-4-257"></a><span class="cm">     * &lt;p&gt;Note: Does &lt;i&gt;not&lt;/i&gt; ignore singleton beans that have been registered</span>
</span><span id="__span-4-258"><a id="__codelineno-4-258" name="__codelineno-4-258" href="#__codelineno-4-258"></a><span class="cm">     * by other means than bean definitions.</span>
</span><span id="__span-4-259"><a id="__codelineno-4-259" name="__codelineno-4-259" href="#__codelineno-4-259"></a><span class="cm">     * &lt;p&gt;The Map returned by this method should always return bean names and</span>
</span><span id="__span-4-260"><a id="__codelineno-4-260" name="__codelineno-4-260" href="#__codelineno-4-260"></a><span class="cm">     * corresponding bean instances &lt;i&gt;in the order of definition&lt;/i&gt; in the</span>
</span><span id="__span-4-261"><a id="__codelineno-4-261" name="__codelineno-4-261" href="#__codelineno-4-261"></a><span class="cm">     * backend configuration, as far as possible.</span>
</span><span id="__span-4-262"><a id="__codelineno-4-262" name="__codelineno-4-262" href="#__codelineno-4-262"></a><span class="cm">     * @param type the class or interface to match, or {@code null} for all concrete beans</span>
</span><span id="__span-4-263"><a id="__codelineno-4-263" name="__codelineno-4-263" href="#__codelineno-4-263"></a><span class="cm">     * @param includeNonSingletons whether to include prototype or scoped beans too</span>
</span><span id="__span-4-264"><a id="__codelineno-4-264" name="__codelineno-4-264" href="#__codelineno-4-264"></a><span class="cm">     * or just singletons (also applies to FactoryBeans)</span>
</span><span id="__span-4-265"><a id="__codelineno-4-265" name="__codelineno-4-265" href="#__codelineno-4-265"></a><span class="cm">     * @param allowEagerInit whether to initialize &lt;i&gt;lazy-init singletons&lt;/i&gt; and</span>
</span><span id="__span-4-266"><a id="__codelineno-4-266" name="__codelineno-4-266" href="#__codelineno-4-266"></a><span class="cm">     * &lt;i&gt;objects created by FactoryBeans&lt;/i&gt; (or by factory methods with a</span>
</span><span id="__span-4-267"><a id="__codelineno-4-267" name="__codelineno-4-267" href="#__codelineno-4-267"></a><span class="cm">     * &quot;factory-bean&quot; reference) for the type check. Note that FactoryBeans need to be</span>
</span><span id="__span-4-268"><a id="__codelineno-4-268" name="__codelineno-4-268" href="#__codelineno-4-268"></a><span class="cm">     * eagerly initialized to determine their type: So be aware that passing in &quot;true&quot;</span>
</span><span id="__span-4-269"><a id="__codelineno-4-269" name="__codelineno-4-269" href="#__codelineno-4-269"></a><span class="cm">     * for this flag will initialize FactoryBeans and &quot;factory-bean&quot; references.</span>
</span><span id="__span-4-270"><a id="__codelineno-4-270" name="__codelineno-4-270" href="#__codelineno-4-270"></a><span class="cm">     * @return a Map with the matching beans, containing the bean names as</span>
</span><span id="__span-4-271"><a id="__codelineno-4-271" name="__codelineno-4-271" href="#__codelineno-4-271"></a><span class="cm">     * keys and the corresponding bean instances as values</span>
</span><span id="__span-4-272"><a id="__codelineno-4-272" name="__codelineno-4-272" href="#__codelineno-4-272"></a><span class="cm">     * @throws BeansException if a bean could not be created</span>
</span><span id="__span-4-273"><a id="__codelineno-4-273" name="__codelineno-4-273" href="#__codelineno-4-273"></a><span class="cm">     * @see FactoryBean#getObjectType</span>
</span><span id="__span-4-274"><a id="__codelineno-4-274" name="__codelineno-4-274" href="#__codelineno-4-274"></a><span class="cm">     * @see BeanFactoryUtils#beansOfTypeIncludingAncestors(ListableBeanFactory, Class, boolean, boolean)</span>
</span><span id="__span-4-275"><a id="__codelineno-4-275" name="__codelineno-4-275" href="#__codelineno-4-275"></a><span class="cm">     */</span>
</span><span id="__span-4-276"><a id="__codelineno-4-276" name="__codelineno-4-276" href="#__codelineno-4-276"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeansOfType</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">includeNonSingletons</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">allowEagerInit</span><span class="p">)</span>
</span><span id="__span-4-277"><a id="__codelineno-4-277" name="__codelineno-4-277" href="#__codelineno-4-277"></a><span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-4-278"><a id="__codelineno-4-278" name="__codelineno-4-278" href="#__codelineno-4-278"></a>
</span><span id="__span-4-279"><a id="__codelineno-4-279" name="__codelineno-4-279" href="#__codelineno-4-279"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-280"><a id="__codelineno-4-280" name="__codelineno-4-280" href="#__codelineno-4-280"></a><span class="cm">     * Find all names of beans which are annotated with the supplied {@link Annotation}</span>
</span><span id="__span-4-281"><a id="__codelineno-4-281" name="__codelineno-4-281" href="#__codelineno-4-281"></a><span class="cm">     * type, without creating corresponding bean instances yet.</span>
</span><span id="__span-4-282"><a id="__codelineno-4-282" name="__codelineno-4-282" href="#__codelineno-4-282"></a><span class="cm">     * &lt;p&gt;Note that this method considers objects created by FactoryBeans, which means</span>
</span><span id="__span-4-283"><a id="__codelineno-4-283" name="__codelineno-4-283" href="#__codelineno-4-283"></a><span class="cm">     * that FactoryBeans will get initialized in order to determine their object type.</span>
</span><span id="__span-4-284"><a id="__codelineno-4-284" name="__codelineno-4-284" href="#__codelineno-4-284"></a><span class="cm">     * @param annotationType the type of annotation to look for</span>
</span><span id="__span-4-285"><a id="__codelineno-4-285" name="__codelineno-4-285" href="#__codelineno-4-285"></a><span class="cm">     * (at class, interface or factory method level of the specified bean)</span>
</span><span id="__span-4-286"><a id="__codelineno-4-286" name="__codelineno-4-286" href="#__codelineno-4-286"></a><span class="cm">     * @return the names of all matching beans</span>
</span><span id="__span-4-287"><a id="__codelineno-4-287" name="__codelineno-4-287" href="#__codelineno-4-287"></a><span class="cm">     * @since 4.0</span>
</span><span id="__span-4-288"><a id="__codelineno-4-288" name="__codelineno-4-288" href="#__codelineno-4-288"></a><span class="cm">     * @see #findAnnotationOnBean</span>
</span><span id="__span-4-289"><a id="__codelineno-4-289" name="__codelineno-4-289" href="#__codelineno-4-289"></a><span class="cm">     */</span>
</span><span id="__span-4-290"><a id="__codelineno-4-290" name="__codelineno-4-290" href="#__codelineno-4-290"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanNamesForAnnotation</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Annotation</span><span class="o">&gt;</span><span class="w"> </span><span class="n">annotationType</span><span class="p">);</span>
</span><span id="__span-4-291"><a id="__codelineno-4-291" name="__codelineno-4-291" href="#__codelineno-4-291"></a>
</span><span id="__span-4-292"><a id="__codelineno-4-292" name="__codelineno-4-292" href="#__codelineno-4-292"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-293"><a id="__codelineno-4-293" name="__codelineno-4-293" href="#__codelineno-4-293"></a><span class="cm">     * Find all beans which are annotated with the supplied {@link Annotation} type,</span>
</span><span id="__span-4-294"><a id="__codelineno-4-294" name="__codelineno-4-294" href="#__codelineno-4-294"></a><span class="cm">     * returning a Map of bean names with corresponding bean instances.</span>
</span><span id="__span-4-295"><a id="__codelineno-4-295" name="__codelineno-4-295" href="#__codelineno-4-295"></a><span class="cm">     * &lt;p&gt;Note that this method considers objects created by FactoryBeans, which means</span>
</span><span id="__span-4-296"><a id="__codelineno-4-296" name="__codelineno-4-296" href="#__codelineno-4-296"></a><span class="cm">     * that FactoryBeans will get initialized in order to determine their object type.</span>
</span><span id="__span-4-297"><a id="__codelineno-4-297" name="__codelineno-4-297" href="#__codelineno-4-297"></a><span class="cm">     * @param annotationType the type of annotation to look for</span>
</span><span id="__span-4-298"><a id="__codelineno-4-298" name="__codelineno-4-298" href="#__codelineno-4-298"></a><span class="cm">     * (at class, interface or factory method level of the specified bean)</span>
</span><span id="__span-4-299"><a id="__codelineno-4-299" name="__codelineno-4-299" href="#__codelineno-4-299"></a><span class="cm">     * @return a Map with the matching beans, containing the bean names as</span>
</span><span id="__span-4-300"><a id="__codelineno-4-300" name="__codelineno-4-300" href="#__codelineno-4-300"></a><span class="cm">     * keys and the corresponding bean instances as values</span>
</span><span id="__span-4-301"><a id="__codelineno-4-301" name="__codelineno-4-301" href="#__codelineno-4-301"></a><span class="cm">     * @throws BeansException if a bean could not be created</span>
</span><span id="__span-4-302"><a id="__codelineno-4-302" name="__codelineno-4-302" href="#__codelineno-4-302"></a><span class="cm">     * @since 3.0</span>
</span><span id="__span-4-303"><a id="__codelineno-4-303" name="__codelineno-4-303" href="#__codelineno-4-303"></a><span class="cm">     * @see #findAnnotationOnBean</span>
</span><span id="__span-4-304"><a id="__codelineno-4-304" name="__codelineno-4-304" href="#__codelineno-4-304"></a><span class="cm">     */</span>
</span><span id="__span-4-305"><a id="__codelineno-4-305" name="__codelineno-4-305" href="#__codelineno-4-305"></a><span class="w">    </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeansWithAnnotation</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Annotation</span><span class="o">&gt;</span><span class="w"> </span><span class="n">annotationType</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-4-306"><a id="__codelineno-4-306" name="__codelineno-4-306" href="#__codelineno-4-306"></a>
</span><span id="__span-4-307"><a id="__codelineno-4-307" name="__codelineno-4-307" href="#__codelineno-4-307"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-4-308"><a id="__codelineno-4-308" name="__codelineno-4-308" href="#__codelineno-4-308"></a><span class="cm">     * Find an {@link Annotation} of {@code annotationType} on the specified bean,</span>
</span><span id="__span-4-309"><a id="__codelineno-4-309" name="__codelineno-4-309" href="#__codelineno-4-309"></a><span class="cm">     * traversing its interfaces and super classes if no annotation can be found on</span>
</span><span id="__span-4-310"><a id="__codelineno-4-310" name="__codelineno-4-310" href="#__codelineno-4-310"></a><span class="cm">     * the given class itself, as well as checking the bean&#39;s factory method (if any).</span>
</span><span id="__span-4-311"><a id="__codelineno-4-311" name="__codelineno-4-311" href="#__codelineno-4-311"></a><span class="cm">     * @param beanName the name of the bean to look for annotations on</span>
</span><span id="__span-4-312"><a id="__codelineno-4-312" name="__codelineno-4-312" href="#__codelineno-4-312"></a><span class="cm">     * @param annotationType the type of annotation to look for</span>
</span><span id="__span-4-313"><a id="__codelineno-4-313" name="__codelineno-4-313" href="#__codelineno-4-313"></a><span class="cm">     * (at class, interface or factory method level of the specified bean)</span>
</span><span id="__span-4-314"><a id="__codelineno-4-314" name="__codelineno-4-314" href="#__codelineno-4-314"></a><span class="cm">     * @return the annotation of the given type if found, or {@code null} otherwise</span>
</span><span id="__span-4-315"><a id="__codelineno-4-315" name="__codelineno-4-315" href="#__codelineno-4-315"></a><span class="cm">     * @throws NoSuchBeanDefinitionException if there is no bean with the given name</span>
</span><span id="__span-4-316"><a id="__codelineno-4-316" name="__codelineno-4-316" href="#__codelineno-4-316"></a><span class="cm">     * @since 3.0</span>
</span><span id="__span-4-317"><a id="__codelineno-4-317" name="__codelineno-4-317" href="#__codelineno-4-317"></a><span class="cm">     * @see #getBeanNamesForAnnotation</span>
</span><span id="__span-4-318"><a id="__codelineno-4-318" name="__codelineno-4-318" href="#__codelineno-4-318"></a><span class="cm">     * @see #getBeansWithAnnotation</span>
</span><span id="__span-4-319"><a id="__codelineno-4-319" name="__codelineno-4-319" href="#__codelineno-4-319"></a><span class="cm">     */</span>
</span><span id="__span-4-320"><a id="__codelineno-4-320" name="__codelineno-4-320" href="#__codelineno-4-320"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-4-321"><a id="__codelineno-4-321" name="__codelineno-4-321" href="#__codelineno-4-321"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">A</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Annotation</span><span class="o">&gt;</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="nf">findAnnotationOnBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span><span class="w"> </span><span class="n">annotationType</span><span class="p">)</span>
</span><span id="__span-4-322"><a id="__codelineno-4-322" name="__codelineno-4-322" href="#__codelineno-4-322"></a><span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-4-323"><a id="__codelineno-4-323" name="__codelineno-4-323" href="#__codelineno-4-323"></a>
</span><span id="__span-4-324"><a id="__codelineno-4-324" name="__codelineno-4-324" href="#__codelineno-4-324"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="listablebeanfactory">ListableBeanFactory方法属性摘要<a class="headerlink" href="#listablebeanfactory" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ListableBeanFactory</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BeanFactory</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="cm">     */</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">containsBeanDefinition</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="cm">     */</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">getBeanDefinitionCount</span><span class="p">();</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="cm">     */</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanDefinitionNames</span><span class="p">();</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="cm">     */</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanNamesForType</span><span class="p">(</span><span class="n">ResolvableType</span><span class="w"> </span><span class="n">type</span><span class="p">);</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="cm">     */</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanNamesForType</span><span class="p">(</span><span class="n">ResolvableType</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">includeNonSingletons</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">allowEagerInit</span><span class="p">);</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="cm">     */</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanNamesForType</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">type</span><span class="p">);</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="cm">     */</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanNamesForType</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">includeNonSingletons</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">allowEagerInit</span><span class="p">);</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeansOfType</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeansOfType</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">includeNonSingletons</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">allowEagerInit</span><span class="p">)</span>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a><span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-5-37"><a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>
</span><span id="__span-5-38"><a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a>
</span><span id="__span-5-39"><a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getBeanNamesForAnnotation</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Annotation</span><span class="o">&gt;</span><span class="w"> </span><span class="n">annotationType</span><span class="p">);</span>
</span><span id="__span-5-40"><a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a>
</span><span id="__span-5-41"><a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>
</span><span id="__span-5-42"><a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a><span class="w">    </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeansWithAnnotation</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Annotation</span><span class="o">&gt;</span><span class="w"> </span><span class="n">annotationType</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">;</span>
</span><span id="__span-5-43"><a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a>
</span><span id="__span-5-44"><a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a>
</span><span id="__span-5-45"><a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-5-46"><a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a><span class="w">    </span><span class="o">&lt;</span><span class="n">A</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Annotation</span><span class="o">&gt;</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="nf">findAnnotationOnBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span><span class="w"> </span><span class="n">annotationType</span><span class="p">)</span>
</span><span id="__span-5-47"><a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a><span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">NoSuchBeanDefinitionException</span><span class="p">;</span>
</span><span id="__span-5-48"><a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a>
</span><span id="__span-5-49"><a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="14-applicationcontext">1.4 ApplicationContext接口<a class="headerlink" href="#14-applicationcontext" title="Permanent link">&para;</a></h2>
<h3 id="applicationcontext">ApplicationContext接口解析<a class="headerlink" href="#applicationcontext" title="Permanent link">&para;</a></h3>
<ul>
<li>相比于BeanFactory,ApplicationContext是高配版的Ioc容器，其在BeanFactory的基础上实现了更加复杂的扩展功能</li>
<li>ListableBeanFactory, HierarchicalBeanFactory都是BeanFactory的子接口，ApplicationContext继承了这两个接口，ApplicationContext进一步扩展了BeanFactory接口的功能</li>
<li>. . .</li>
</ul>
<h3 id="_5">完整版源码：<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="cm">/*</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="cm"> * Copyright 2002-2014 the original author or authors.</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="cm"> *</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="cm"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="cm"> * you may not use this file except in compliance with the License.</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="cm"> * You may obtain a copy of the License at</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="cm"> *</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="cm"> *      https://www.apache.org/licenses/LICENSE-2.0</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="cm"> *</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="cm"> * Unless required by applicable law or agreed to in writing, software</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="cm"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="cm"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="cm"> * See the License for the specific language governing permissions and</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="cm"> * limitations under the License.</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="cm"> */</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="kn">package</span><span class="w"> </span><span class="nn">org.springframework.context</span><span class="p">;</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.HierarchicalBeanFactory</span><span class="p">;</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.ListableBeanFactory</span><span class="p">;</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.config.AutowireCapableBeanFactory</span><span class="p">;</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.env.EnvironmentCapable</span><span class="p">;</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.io.support.ResourcePatternResolver</span><span class="p">;</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.lang.Nullable</span><span class="p">;</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="cm">/**</span>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="cm"> * Central interface to provide configuration for an application.</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="cm"> * This is read-only while the application is running, but may be</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="cm"> * reloaded if the implementation supports this.</span>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a><span class="cm"> *</span>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a><span class="cm"> * &lt;p&gt;An ApplicationContext provides:</span>
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a><span class="cm"> * &lt;ul&gt;</span>
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a><span class="cm"> * &lt;li&gt;Bean factory methods for accessing application components.</span>
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a><span class="cm"> * Inherited from {@link org.springframework.beans.factory.ListableBeanFactory}.</span>
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a><span class="cm"> * &lt;li&gt;The ability to load file resources in a generic fashion.</span>
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a><span class="cm"> * Inherited from the {@link org.springframework.core.io.ResourceLoader} interface.</span>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a><span class="cm"> * &lt;li&gt;The ability to publish events to registered listeners.</span>
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="cm"> * Inherited from the {@link ApplicationEventPublisher} interface.</span>
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a><span class="cm"> * &lt;li&gt;The ability to resolve messages, supporting internationalization.</span>
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a><span class="cm"> * Inherited from the {@link MessageSource} interface.</span>
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a><span class="cm"> * &lt;li&gt;Inheritance from a parent context. Definitions in a descendant context</span>
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a><span class="cm"> * will always take priority. This means, for example, that a single parent</span>
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a><span class="cm"> * context can be used by an entire web application, while each servlet has</span>
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a><span class="cm"> * its own child context that is independent of that of any other servlet.</span>
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a><span class="cm"> * &lt;/ul&gt;</span>
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a><span class="cm"> *</span>
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a><span class="cm"> * &lt;p&gt;In addition to standard {@link org.springframework.beans.factory.BeanFactory}</span>
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a><span class="cm"> * lifecycle capabilities, ApplicationContext implementations detect and invoke</span>
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a><span class="cm"> * {@link ApplicationContextAware} beans as well as {@link ResourceLoaderAware},</span>
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a><span class="cm"> * {@link ApplicationEventPublisherAware} and {@link MessageSourceAware} beans.</span>
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a><span class="cm"> *</span>
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a><span class="cm"> * @author Rod Johnson</span>
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a><span class="cm"> * @author Juergen Hoeller</span>
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a><span class="cm"> * @see ConfigurableApplicationContext</span>
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a><span class="cm"> * @see org.springframework.beans.factory.BeanFactory</span>
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a><span class="cm"> * @see org.springframework.core.io.ResourceLoader</span>
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a><span class="cm"> */</span>
</span><span id="__span-6-58"><a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ApplicationContext</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">EnvironmentCapable</span><span class="p">,</span><span class="w"> </span><span class="n">ListableBeanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">HierarchicalBeanFactory</span><span class="p">,</span>
</span><span id="__span-6-59"><a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a><span class="w">        </span><span class="n">MessageSource</span><span class="p">,</span><span class="w"> </span><span class="n">ApplicationEventPublisher</span><span class="p">,</span><span class="w"> </span><span class="n">ResourcePatternResolver</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-60"><a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a>
</span><span id="__span-6-61"><a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-6-62"><a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a><span class="cm">     * Return the unique id of this application context.</span>
</span><span id="__span-6-63"><a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a><span class="cm">     * @return the unique id of the context, or {@code null} if none</span>
</span><span id="__span-6-64"><a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a><span class="cm">     */</span>
</span><span id="__span-6-65"><a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-6-66"><a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getId</span><span class="p">();</span>
</span><span id="__span-6-67"><a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a>
</span><span id="__span-6-68"><a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-6-69"><a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a><span class="cm">     * Return a name for the deployed application that this context belongs to.</span>
</span><span id="__span-6-70"><a id="__codelineno-6-70" name="__codelineno-6-70" href="#__codelineno-6-70"></a><span class="cm">     * @return a name for the deployed application, or the empty String by default</span>
</span><span id="__span-6-71"><a id="__codelineno-6-71" name="__codelineno-6-71" href="#__codelineno-6-71"></a><span class="cm">     */</span>
</span><span id="__span-6-72"><a id="__codelineno-6-72" name="__codelineno-6-72" href="#__codelineno-6-72"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getApplicationName</span><span class="p">();</span>
</span><span id="__span-6-73"><a id="__codelineno-6-73" name="__codelineno-6-73" href="#__codelineno-6-73"></a>
</span><span id="__span-6-74"><a id="__codelineno-6-74" name="__codelineno-6-74" href="#__codelineno-6-74"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-6-75"><a id="__codelineno-6-75" name="__codelineno-6-75" href="#__codelineno-6-75"></a><span class="cm">     * Return a friendly name for this context.</span>
</span><span id="__span-6-76"><a id="__codelineno-6-76" name="__codelineno-6-76" href="#__codelineno-6-76"></a><span class="cm">     * @return a display name for this context (never {@code null})</span>
</span><span id="__span-6-77"><a id="__codelineno-6-77" name="__codelineno-6-77" href="#__codelineno-6-77"></a><span class="cm">     */</span>
</span><span id="__span-6-78"><a id="__codelineno-6-78" name="__codelineno-6-78" href="#__codelineno-6-78"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getDisplayName</span><span class="p">();</span>
</span><span id="__span-6-79"><a id="__codelineno-6-79" name="__codelineno-6-79" href="#__codelineno-6-79"></a>
</span><span id="__span-6-80"><a id="__codelineno-6-80" name="__codelineno-6-80" href="#__codelineno-6-80"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-6-81"><a id="__codelineno-6-81" name="__codelineno-6-81" href="#__codelineno-6-81"></a><span class="cm">     * Return the timestamp when this context was first loaded.</span>
</span><span id="__span-6-82"><a id="__codelineno-6-82" name="__codelineno-6-82" href="#__codelineno-6-82"></a><span class="cm">     * @return the timestamp (ms) when this context was first loaded</span>
</span><span id="__span-6-83"><a id="__codelineno-6-83" name="__codelineno-6-83" href="#__codelineno-6-83"></a><span class="cm">     */</span>
</span><span id="__span-6-84"><a id="__codelineno-6-84" name="__codelineno-6-84" href="#__codelineno-6-84"></a><span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="nf">getStartupDate</span><span class="p">();</span>
</span><span id="__span-6-85"><a id="__codelineno-6-85" name="__codelineno-6-85" href="#__codelineno-6-85"></a>
</span><span id="__span-6-86"><a id="__codelineno-6-86" name="__codelineno-6-86" href="#__codelineno-6-86"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-6-87"><a id="__codelineno-6-87" name="__codelineno-6-87" href="#__codelineno-6-87"></a><span class="cm">     * Return the parent context, or {@code null} if there is no parent</span>
</span><span id="__span-6-88"><a id="__codelineno-6-88" name="__codelineno-6-88" href="#__codelineno-6-88"></a><span class="cm">     * and this is the root of the context hierarchy.</span>
</span><span id="__span-6-89"><a id="__codelineno-6-89" name="__codelineno-6-89" href="#__codelineno-6-89"></a><span class="cm">     * @return the parent context, or {@code null} if there is no parent</span>
</span><span id="__span-6-90"><a id="__codelineno-6-90" name="__codelineno-6-90" href="#__codelineno-6-90"></a><span class="cm">     */</span>
</span><span id="__span-6-91"><a id="__codelineno-6-91" name="__codelineno-6-91" href="#__codelineno-6-91"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-6-92"><a id="__codelineno-6-92" name="__codelineno-6-92" href="#__codelineno-6-92"></a><span class="w">    </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="nf">getParent</span><span class="p">();</span>
</span><span id="__span-6-93"><a id="__codelineno-6-93" name="__codelineno-6-93" href="#__codelineno-6-93"></a>
</span><span id="__span-6-94"><a id="__codelineno-6-94" name="__codelineno-6-94" href="#__codelineno-6-94"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-6-95"><a id="__codelineno-6-95" name="__codelineno-6-95" href="#__codelineno-6-95"></a><span class="cm">     * Expose AutowireCapableBeanFactory functionality for this context.</span>
</span><span id="__span-6-96"><a id="__codelineno-6-96" name="__codelineno-6-96" href="#__codelineno-6-96"></a><span class="cm">     * &lt;p&gt;This is not typically used by application code, except for the purpose of</span>
</span><span id="__span-6-97"><a id="__codelineno-6-97" name="__codelineno-6-97" href="#__codelineno-6-97"></a><span class="cm">     * initializing bean instances that live outside of the application context,</span>
</span><span id="__span-6-98"><a id="__codelineno-6-98" name="__codelineno-6-98" href="#__codelineno-6-98"></a><span class="cm">     * applying the Spring bean lifecycle (fully or partly) to them.</span>
</span><span id="__span-6-99"><a id="__codelineno-6-99" name="__codelineno-6-99" href="#__codelineno-6-99"></a><span class="cm">     * &lt;p&gt;Alternatively, the internal BeanFactory exposed by the</span>
</span><span id="__span-6-100"><a id="__codelineno-6-100" name="__codelineno-6-100" href="#__codelineno-6-100"></a><span class="cm">     * {@link ConfigurableApplicationContext} interface offers access to the</span>
</span><span id="__span-6-101"><a id="__codelineno-6-101" name="__codelineno-6-101" href="#__codelineno-6-101"></a><span class="cm">     * {@link AutowireCapableBeanFactory} interface too. The present method mainly</span>
</span><span id="__span-6-102"><a id="__codelineno-6-102" name="__codelineno-6-102" href="#__codelineno-6-102"></a><span class="cm">     * serves as a convenient, specific facility on the ApplicationContext interface.</span>
</span><span id="__span-6-103"><a id="__codelineno-6-103" name="__codelineno-6-103" href="#__codelineno-6-103"></a><span class="cm">     * &lt;p&gt;&lt;b&gt;NOTE: As of 4.2, this method will consistently throw IllegalStateException</span>
</span><span id="__span-6-104"><a id="__codelineno-6-104" name="__codelineno-6-104" href="#__codelineno-6-104"></a><span class="cm">     * after the application context has been closed.&lt;/b&gt; In current Spring Framework</span>
</span><span id="__span-6-105"><a id="__codelineno-6-105" name="__codelineno-6-105" href="#__codelineno-6-105"></a><span class="cm">     * versions, only refreshable application contexts behave that way; as of 4.2,</span>
</span><span id="__span-6-106"><a id="__codelineno-6-106" name="__codelineno-6-106" href="#__codelineno-6-106"></a><span class="cm">     * all application context implementations will be required to comply.</span>
</span><span id="__span-6-107"><a id="__codelineno-6-107" name="__codelineno-6-107" href="#__codelineno-6-107"></a><span class="cm">     * @return the AutowireCapableBeanFactory for this context</span>
</span><span id="__span-6-108"><a id="__codelineno-6-108" name="__codelineno-6-108" href="#__codelineno-6-108"></a><span class="cm">     * @throws IllegalStateException if the context does not support the</span>
</span><span id="__span-6-109"><a id="__codelineno-6-109" name="__codelineno-6-109" href="#__codelineno-6-109"></a><span class="cm">     * {@link AutowireCapableBeanFactory} interface, or does not hold an</span>
</span><span id="__span-6-110"><a id="__codelineno-6-110" name="__codelineno-6-110" href="#__codelineno-6-110"></a><span class="cm">     * autowire-capable bean factory yet (e.g. if {@code refresh()} has</span>
</span><span id="__span-6-111"><a id="__codelineno-6-111" name="__codelineno-6-111" href="#__codelineno-6-111"></a><span class="cm">     * never been called), or if the context has been closed already</span>
</span><span id="__span-6-112"><a id="__codelineno-6-112" name="__codelineno-6-112" href="#__codelineno-6-112"></a><span class="cm">     * @see ConfigurableApplicationContext#refresh()</span>
</span><span id="__span-6-113"><a id="__codelineno-6-113" name="__codelineno-6-113" href="#__codelineno-6-113"></a><span class="cm">     * @see ConfigurableApplicationContext#getBeanFactory()</span>
</span><span id="__span-6-114"><a id="__codelineno-6-114" name="__codelineno-6-114" href="#__codelineno-6-114"></a><span class="cm">     */</span>
</span><span id="__span-6-115"><a id="__codelineno-6-115" name="__codelineno-6-115" href="#__codelineno-6-115"></a><span class="w">    </span><span class="n">AutowireCapableBeanFactory</span><span class="w"> </span><span class="nf">getAutowireCapableBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">;</span>
</span><span id="__span-6-116"><a id="__codelineno-6-116" name="__codelineno-6-116" href="#__codelineno-6-116"></a>
</span><span id="__span-6-117"><a id="__codelineno-6-117" name="__codelineno-6-117" href="#__codelineno-6-117"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="applicationcontext_1">ApplicationContext方法属性摘要<a class="headerlink" href="#applicationcontext_1" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ApplicationContext</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">EnvironmentCapable</span><span class="p">,</span><span class="w"> </span><span class="n">ListableBeanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">HierarchicalBeanFactory</span><span class="p">,</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">        </span><span class="n">MessageSource</span><span class="p">,</span><span class="w"> </span><span class="n">ApplicationEventPublisher</span><span class="p">,</span><span class="w"> </span><span class="n">ResourcePatternResolver</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getId</span><span class="p">();</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getApplicationName</span><span class="p">();</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getDisplayName</span><span class="p">();</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="nf">getStartupDate</span><span class="p">();</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">    </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="nf">getParent</span><span class="p">();</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="w">    </span><span class="n">AutowireCapableBeanFactory</span><span class="w"> </span><span class="nf">getAutowireCapableBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">;</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="15-beandefination">1.5 BeanDefination接口<a class="headerlink" href="#15-beandefination" title="Permanent link">&para;</a></h2>
<h3 id="beandefination">BeanDefination接口定义解析<a class="headerlink" href="#beandefination" title="Permanent link">&para;</a></h3>
<ul>
<li>BeanDefination用于管理Ioc容器中JavaBean与JavaBean之间的依赖关系，其抽象了Java开发人员对于JavaBean的定义</li>
<li>Spring将开发人员定义的JavaBean的数据结构转化为内存中的BeanDefination数据结构进行维护</li>
</ul>
<h3 id="_6">完整版源码：<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="cm">/*</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="cm"> * Copyright 2002-2019 the original author or authors.</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="cm"> *</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="cm"> * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="cm"> * you may not use this file except in compliance with the License.</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="cm"> * You may obtain a copy of the License at</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="cm"> *</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="cm"> *      https://www.apache.org/licenses/LICENSE-2.0</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="cm"> *</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="cm"> * Unless required by applicable law or agreed to in writing, software</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="cm"> * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="cm"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="cm"> * See the License for the specific language governing permissions and</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="cm"> * limitations under the License.</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="cm"> */</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="kn">package</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.config</span><span class="p">;</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.BeanMetadataElement</span><span class="p">;</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.MutablePropertyValues</span><span class="p">;</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.AttributeAccessor</span><span class="p">;</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.core.ResolvableType</span><span class="p">;</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.lang.Nullable</span><span class="p">;</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="cm">/**</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="cm"> * A BeanDefinition describes a bean instance, which has property values,</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="cm"> * constructor argument values, and further information supplied by</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="cm"> * concrete implementations.</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="cm"> *</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="cm"> * &lt;p&gt;This is just a minimal interface: The main intention is to allow a</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="cm"> * {@link BeanFactoryPostProcessor} to introspect and modify property values</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="cm"> * and other bean metadata.</span>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="cm"> *</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a><span class="cm"> * @author Juergen Hoeller</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a><span class="cm"> * @author Rob Harrop</span>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a><span class="cm"> * @since 19.03.2004</span>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a><span class="cm"> * @see ConfigurableListableBeanFactory#getBeanDefinition</span>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a><span class="cm"> * @see org.springframework.beans.factory.support.RootBeanDefinition</span>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a><span class="cm"> * @see org.springframework.beans.factory.support.ChildBeanDefinition</span>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a><span class="cm"> */</span>
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">BeanDefinition</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">AttributeAccessor</span><span class="p">,</span><span class="w"> </span><span class="n">BeanMetadataElement</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a>
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a><span class="cm">     * Scope identifier for the standard singleton scope: &quot;singleton&quot;.</span>
</span><span id="__span-8-45"><a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a><span class="cm">     * &lt;p&gt;Note that extended bean factories might support further scopes.</span>
</span><span id="__span-8-46"><a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a><span class="cm">     * @see #setScope</span>
</span><span id="__span-8-47"><a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a><span class="cm">     */</span>
</span><span id="__span-8-48"><a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">SCOPE_SINGLETON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ConfigurableBeanFactory</span><span class="p">.</span><span class="na">SCOPE_SINGLETON</span><span class="p">;</span>
</span><span id="__span-8-49"><a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a>
</span><span id="__span-8-50"><a id="__codelineno-8-50" name="__codelineno-8-50" href="#__codelineno-8-50"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-51"><a id="__codelineno-8-51" name="__codelineno-8-51" href="#__codelineno-8-51"></a><span class="cm">     * Scope identifier for the standard prototype scope: &quot;prototype&quot;.</span>
</span><span id="__span-8-52"><a id="__codelineno-8-52" name="__codelineno-8-52" href="#__codelineno-8-52"></a><span class="cm">     * &lt;p&gt;Note that extended bean factories might support further scopes.</span>
</span><span id="__span-8-53"><a id="__codelineno-8-53" name="__codelineno-8-53" href="#__codelineno-8-53"></a><span class="cm">     * @see #setScope</span>
</span><span id="__span-8-54"><a id="__codelineno-8-54" name="__codelineno-8-54" href="#__codelineno-8-54"></a><span class="cm">     */</span>
</span><span id="__span-8-55"><a id="__codelineno-8-55" name="__codelineno-8-55" href="#__codelineno-8-55"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">SCOPE_PROTOTYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ConfigurableBeanFactory</span><span class="p">.</span><span class="na">SCOPE_PROTOTYPE</span><span class="p">;</span>
</span><span id="__span-8-56"><a id="__codelineno-8-56" name="__codelineno-8-56" href="#__codelineno-8-56"></a>
</span><span id="__span-8-57"><a id="__codelineno-8-57" name="__codelineno-8-57" href="#__codelineno-8-57"></a>
</span><span id="__span-8-58"><a id="__codelineno-8-58" name="__codelineno-8-58" href="#__codelineno-8-58"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-59"><a id="__codelineno-8-59" name="__codelineno-8-59" href="#__codelineno-8-59"></a><span class="cm">     * Role hint indicating that a {@code BeanDefinition} is a major part</span>
</span><span id="__span-8-60"><a id="__codelineno-8-60" name="__codelineno-8-60" href="#__codelineno-8-60"></a><span class="cm">     * of the application. Typically corresponds to a user-defined bean.</span>
</span><span id="__span-8-61"><a id="__codelineno-8-61" name="__codelineno-8-61" href="#__codelineno-8-61"></a><span class="cm">     */</span>
</span><span id="__span-8-62"><a id="__codelineno-8-62" name="__codelineno-8-62" href="#__codelineno-8-62"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ROLE_APPLICATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-8-63"><a id="__codelineno-8-63" name="__codelineno-8-63" href="#__codelineno-8-63"></a>
</span><span id="__span-8-64"><a id="__codelineno-8-64" name="__codelineno-8-64" href="#__codelineno-8-64"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-65"><a id="__codelineno-8-65" name="__codelineno-8-65" href="#__codelineno-8-65"></a><span class="cm">     * Role hint indicating that a {@code BeanDefinition} is a supporting</span>
</span><span id="__span-8-66"><a id="__codelineno-8-66" name="__codelineno-8-66" href="#__codelineno-8-66"></a><span class="cm">     * part of some larger configuration, typically an outer</span>
</span><span id="__span-8-67"><a id="__codelineno-8-67" name="__codelineno-8-67" href="#__codelineno-8-67"></a><span class="cm">     * {@link org.springframework.beans.factory.parsing.ComponentDefinition}.</span>
</span><span id="__span-8-68"><a id="__codelineno-8-68" name="__codelineno-8-68" href="#__codelineno-8-68"></a><span class="cm">     * {@code SUPPORT} beans are considered important enough to be aware</span>
</span><span id="__span-8-69"><a id="__codelineno-8-69" name="__codelineno-8-69" href="#__codelineno-8-69"></a><span class="cm">     * of when looking more closely at a particular</span>
</span><span id="__span-8-70"><a id="__codelineno-8-70" name="__codelineno-8-70" href="#__codelineno-8-70"></a><span class="cm">     * {@link org.springframework.beans.factory.parsing.ComponentDefinition},</span>
</span><span id="__span-8-71"><a id="__codelineno-8-71" name="__codelineno-8-71" href="#__codelineno-8-71"></a><span class="cm">     * but not when looking at the overall configuration of an application.</span>
</span><span id="__span-8-72"><a id="__codelineno-8-72" name="__codelineno-8-72" href="#__codelineno-8-72"></a><span class="cm">     */</span>
</span><span id="__span-8-73"><a id="__codelineno-8-73" name="__codelineno-8-73" href="#__codelineno-8-73"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ROLE_SUPPORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-8-74"><a id="__codelineno-8-74" name="__codelineno-8-74" href="#__codelineno-8-74"></a>
</span><span id="__span-8-75"><a id="__codelineno-8-75" name="__codelineno-8-75" href="#__codelineno-8-75"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-76"><a id="__codelineno-8-76" name="__codelineno-8-76" href="#__codelineno-8-76"></a><span class="cm">     * Role hint indicating that a {@code BeanDefinition} is providing an</span>
</span><span id="__span-8-77"><a id="__codelineno-8-77" name="__codelineno-8-77" href="#__codelineno-8-77"></a><span class="cm">     * entirely background role and has no relevance to the end-user. This hint is</span>
</span><span id="__span-8-78"><a id="__codelineno-8-78" name="__codelineno-8-78" href="#__codelineno-8-78"></a><span class="cm">     * used when registering beans that are completely part of the internal workings</span>
</span><span id="__span-8-79"><a id="__codelineno-8-79" name="__codelineno-8-79" href="#__codelineno-8-79"></a><span class="cm">     * of a {@link org.springframework.beans.factory.parsing.ComponentDefinition}.</span>
</span><span id="__span-8-80"><a id="__codelineno-8-80" name="__codelineno-8-80" href="#__codelineno-8-80"></a><span class="cm">     */</span>
</span><span id="__span-8-81"><a id="__codelineno-8-81" name="__codelineno-8-81" href="#__codelineno-8-81"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ROLE_INFRASTRUCTURE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span id="__span-8-82"><a id="__codelineno-8-82" name="__codelineno-8-82" href="#__codelineno-8-82"></a>
</span><span id="__span-8-83"><a id="__codelineno-8-83" name="__codelineno-8-83" href="#__codelineno-8-83"></a>
</span><span id="__span-8-84"><a id="__codelineno-8-84" name="__codelineno-8-84" href="#__codelineno-8-84"></a><span class="w">    </span><span class="c1">// Modifiable attributes</span>
</span><span id="__span-8-85"><a id="__codelineno-8-85" name="__codelineno-8-85" href="#__codelineno-8-85"></a>
</span><span id="__span-8-86"><a id="__codelineno-8-86" name="__codelineno-8-86" href="#__codelineno-8-86"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-87"><a id="__codelineno-8-87" name="__codelineno-8-87" href="#__codelineno-8-87"></a><span class="cm">     * Set the name of the parent definition of this bean definition, if any.</span>
</span><span id="__span-8-88"><a id="__codelineno-8-88" name="__codelineno-8-88" href="#__codelineno-8-88"></a><span class="cm">     */</span>
</span><span id="__span-8-89"><a id="__codelineno-8-89" name="__codelineno-8-89" href="#__codelineno-8-89"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setParentName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">parentName</span><span class="p">);</span>
</span><span id="__span-8-90"><a id="__codelineno-8-90" name="__codelineno-8-90" href="#__codelineno-8-90"></a>
</span><span id="__span-8-91"><a id="__codelineno-8-91" name="__codelineno-8-91" href="#__codelineno-8-91"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-92"><a id="__codelineno-8-92" name="__codelineno-8-92" href="#__codelineno-8-92"></a><span class="cm">     * Return the name of the parent definition of this bean definition, if any.</span>
</span><span id="__span-8-93"><a id="__codelineno-8-93" name="__codelineno-8-93" href="#__codelineno-8-93"></a><span class="cm">     */</span>
</span><span id="__span-8-94"><a id="__codelineno-8-94" name="__codelineno-8-94" href="#__codelineno-8-94"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-95"><a id="__codelineno-8-95" name="__codelineno-8-95" href="#__codelineno-8-95"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getParentName</span><span class="p">();</span>
</span><span id="__span-8-96"><a id="__codelineno-8-96" name="__codelineno-8-96" href="#__codelineno-8-96"></a>
</span><span id="__span-8-97"><a id="__codelineno-8-97" name="__codelineno-8-97" href="#__codelineno-8-97"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-98"><a id="__codelineno-8-98" name="__codelineno-8-98" href="#__codelineno-8-98"></a><span class="cm">     * Specify the bean class name of this bean definition.</span>
</span><span id="__span-8-99"><a id="__codelineno-8-99" name="__codelineno-8-99" href="#__codelineno-8-99"></a><span class="cm">     * &lt;p&gt;The class name can be modified during bean factory post-processing,</span>
</span><span id="__span-8-100"><a id="__codelineno-8-100" name="__codelineno-8-100" href="#__codelineno-8-100"></a><span class="cm">     * typically replacing the original class name with a parsed variant of it.</span>
</span><span id="__span-8-101"><a id="__codelineno-8-101" name="__codelineno-8-101" href="#__codelineno-8-101"></a><span class="cm">     * @see #setParentName</span>
</span><span id="__span-8-102"><a id="__codelineno-8-102" name="__codelineno-8-102" href="#__codelineno-8-102"></a><span class="cm">     * @see #setFactoryBeanName</span>
</span><span id="__span-8-103"><a id="__codelineno-8-103" name="__codelineno-8-103" href="#__codelineno-8-103"></a><span class="cm">     * @see #setFactoryMethodName</span>
</span><span id="__span-8-104"><a id="__codelineno-8-104" name="__codelineno-8-104" href="#__codelineno-8-104"></a><span class="cm">     */</span>
</span><span id="__span-8-105"><a id="__codelineno-8-105" name="__codelineno-8-105" href="#__codelineno-8-105"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setBeanClassName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">beanClassName</span><span class="p">);</span>
</span><span id="__span-8-106"><a id="__codelineno-8-106" name="__codelineno-8-106" href="#__codelineno-8-106"></a>
</span><span id="__span-8-107"><a id="__codelineno-8-107" name="__codelineno-8-107" href="#__codelineno-8-107"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-108"><a id="__codelineno-8-108" name="__codelineno-8-108" href="#__codelineno-8-108"></a><span class="cm">     * Return the current bean class name of this bean definition.</span>
</span><span id="__span-8-109"><a id="__codelineno-8-109" name="__codelineno-8-109" href="#__codelineno-8-109"></a><span class="cm">     * &lt;p&gt;Note that this does not have to be the actual class name used at runtime, in</span>
</span><span id="__span-8-110"><a id="__codelineno-8-110" name="__codelineno-8-110" href="#__codelineno-8-110"></a><span class="cm">     * case of a child definition overriding/inheriting the class name from its parent.</span>
</span><span id="__span-8-111"><a id="__codelineno-8-111" name="__codelineno-8-111" href="#__codelineno-8-111"></a><span class="cm">     * Also, this may just be the class that a factory method is called on, or it may</span>
</span><span id="__span-8-112"><a id="__codelineno-8-112" name="__codelineno-8-112" href="#__codelineno-8-112"></a><span class="cm">     * even be empty in case of a factory bean reference that a method is called on.</span>
</span><span id="__span-8-113"><a id="__codelineno-8-113" name="__codelineno-8-113" href="#__codelineno-8-113"></a><span class="cm">     * Hence, do &lt;i&gt;not&lt;/i&gt; consider this to be the definitive bean type at runtime but</span>
</span><span id="__span-8-114"><a id="__codelineno-8-114" name="__codelineno-8-114" href="#__codelineno-8-114"></a><span class="cm">     * rather only use it for parsing purposes at the individual bean definition level.</span>
</span><span id="__span-8-115"><a id="__codelineno-8-115" name="__codelineno-8-115" href="#__codelineno-8-115"></a><span class="cm">     * @see #getParentName()</span>
</span><span id="__span-8-116"><a id="__codelineno-8-116" name="__codelineno-8-116" href="#__codelineno-8-116"></a><span class="cm">     * @see #getFactoryBeanName()</span>
</span><span id="__span-8-117"><a id="__codelineno-8-117" name="__codelineno-8-117" href="#__codelineno-8-117"></a><span class="cm">     * @see #getFactoryMethodName()</span>
</span><span id="__span-8-118"><a id="__codelineno-8-118" name="__codelineno-8-118" href="#__codelineno-8-118"></a><span class="cm">     */</span>
</span><span id="__span-8-119"><a id="__codelineno-8-119" name="__codelineno-8-119" href="#__codelineno-8-119"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-120"><a id="__codelineno-8-120" name="__codelineno-8-120" href="#__codelineno-8-120"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getBeanClassName</span><span class="p">();</span>
</span><span id="__span-8-121"><a id="__codelineno-8-121" name="__codelineno-8-121" href="#__codelineno-8-121"></a>
</span><span id="__span-8-122"><a id="__codelineno-8-122" name="__codelineno-8-122" href="#__codelineno-8-122"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-123"><a id="__codelineno-8-123" name="__codelineno-8-123" href="#__codelineno-8-123"></a><span class="cm">     * Override the target scope of this bean, specifying a new scope name.</span>
</span><span id="__span-8-124"><a id="__codelineno-8-124" name="__codelineno-8-124" href="#__codelineno-8-124"></a><span class="cm">     * @see #SCOPE_SINGLETON</span>
</span><span id="__span-8-125"><a id="__codelineno-8-125" name="__codelineno-8-125" href="#__codelineno-8-125"></a><span class="cm">     * @see #SCOPE_PROTOTYPE</span>
</span><span id="__span-8-126"><a id="__codelineno-8-126" name="__codelineno-8-126" href="#__codelineno-8-126"></a><span class="cm">     */</span>
</span><span id="__span-8-127"><a id="__codelineno-8-127" name="__codelineno-8-127" href="#__codelineno-8-127"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setScope</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">scope</span><span class="p">);</span>
</span><span id="__span-8-128"><a id="__codelineno-8-128" name="__codelineno-8-128" href="#__codelineno-8-128"></a>
</span><span id="__span-8-129"><a id="__codelineno-8-129" name="__codelineno-8-129" href="#__codelineno-8-129"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-130"><a id="__codelineno-8-130" name="__codelineno-8-130" href="#__codelineno-8-130"></a><span class="cm">     * Return the name of the current target scope for this bean,</span>
</span><span id="__span-8-131"><a id="__codelineno-8-131" name="__codelineno-8-131" href="#__codelineno-8-131"></a><span class="cm">     * or {@code null} if not known yet.</span>
</span><span id="__span-8-132"><a id="__codelineno-8-132" name="__codelineno-8-132" href="#__codelineno-8-132"></a><span class="cm">     */</span>
</span><span id="__span-8-133"><a id="__codelineno-8-133" name="__codelineno-8-133" href="#__codelineno-8-133"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-134"><a id="__codelineno-8-134" name="__codelineno-8-134" href="#__codelineno-8-134"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getScope</span><span class="p">();</span>
</span><span id="__span-8-135"><a id="__codelineno-8-135" name="__codelineno-8-135" href="#__codelineno-8-135"></a>
</span><span id="__span-8-136"><a id="__codelineno-8-136" name="__codelineno-8-136" href="#__codelineno-8-136"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-137"><a id="__codelineno-8-137" name="__codelineno-8-137" href="#__codelineno-8-137"></a><span class="cm">     * Set whether this bean should be lazily initialized.</span>
</span><span id="__span-8-138"><a id="__codelineno-8-138" name="__codelineno-8-138" href="#__codelineno-8-138"></a><span class="cm">     * &lt;p&gt;If {@code false}, the bean will get instantiated on startup by bean</span>
</span><span id="__span-8-139"><a id="__codelineno-8-139" name="__codelineno-8-139" href="#__codelineno-8-139"></a><span class="cm">     * factories that perform eager initialization of singletons.</span>
</span><span id="__span-8-140"><a id="__codelineno-8-140" name="__codelineno-8-140" href="#__codelineno-8-140"></a><span class="cm">     */</span>
</span><span id="__span-8-141"><a id="__codelineno-8-141" name="__codelineno-8-141" href="#__codelineno-8-141"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setLazyInit</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">lazyInit</span><span class="p">);</span>
</span><span id="__span-8-142"><a id="__codelineno-8-142" name="__codelineno-8-142" href="#__codelineno-8-142"></a>
</span><span id="__span-8-143"><a id="__codelineno-8-143" name="__codelineno-8-143" href="#__codelineno-8-143"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-144"><a id="__codelineno-8-144" name="__codelineno-8-144" href="#__codelineno-8-144"></a><span class="cm">     * Return whether this bean should be lazily initialized, i.e. not</span>
</span><span id="__span-8-145"><a id="__codelineno-8-145" name="__codelineno-8-145" href="#__codelineno-8-145"></a><span class="cm">     * eagerly instantiated on startup. Only applicable to a singleton bean.</span>
</span><span id="__span-8-146"><a id="__codelineno-8-146" name="__codelineno-8-146" href="#__codelineno-8-146"></a><span class="cm">     */</span>
</span><span id="__span-8-147"><a id="__codelineno-8-147" name="__codelineno-8-147" href="#__codelineno-8-147"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isLazyInit</span><span class="p">();</span>
</span><span id="__span-8-148"><a id="__codelineno-8-148" name="__codelineno-8-148" href="#__codelineno-8-148"></a>
</span><span id="__span-8-149"><a id="__codelineno-8-149" name="__codelineno-8-149" href="#__codelineno-8-149"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-150"><a id="__codelineno-8-150" name="__codelineno-8-150" href="#__codelineno-8-150"></a><span class="cm">     * Set the names of the beans that this bean depends on being initialized.</span>
</span><span id="__span-8-151"><a id="__codelineno-8-151" name="__codelineno-8-151" href="#__codelineno-8-151"></a><span class="cm">     * The bean factory will guarantee that these beans get initialized first.</span>
</span><span id="__span-8-152"><a id="__codelineno-8-152" name="__codelineno-8-152" href="#__codelineno-8-152"></a><span class="cm">     */</span>
</span><span id="__span-8-153"><a id="__codelineno-8-153" name="__codelineno-8-153" href="#__codelineno-8-153"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setDependsOn</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="p">...</span><span class="w"> </span><span class="n">dependsOn</span><span class="p">);</span>
</span><span id="__span-8-154"><a id="__codelineno-8-154" name="__codelineno-8-154" href="#__codelineno-8-154"></a>
</span><span id="__span-8-155"><a id="__codelineno-8-155" name="__codelineno-8-155" href="#__codelineno-8-155"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-156"><a id="__codelineno-8-156" name="__codelineno-8-156" href="#__codelineno-8-156"></a><span class="cm">     * Return the bean names that this bean depends on.</span>
</span><span id="__span-8-157"><a id="__codelineno-8-157" name="__codelineno-8-157" href="#__codelineno-8-157"></a><span class="cm">     */</span>
</span><span id="__span-8-158"><a id="__codelineno-8-158" name="__codelineno-8-158" href="#__codelineno-8-158"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-159"><a id="__codelineno-8-159" name="__codelineno-8-159" href="#__codelineno-8-159"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getDependsOn</span><span class="p">();</span>
</span><span id="__span-8-160"><a id="__codelineno-8-160" name="__codelineno-8-160" href="#__codelineno-8-160"></a>
</span><span id="__span-8-161"><a id="__codelineno-8-161" name="__codelineno-8-161" href="#__codelineno-8-161"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-162"><a id="__codelineno-8-162" name="__codelineno-8-162" href="#__codelineno-8-162"></a><span class="cm">     * Set whether this bean is a candidate for getting autowired into some other bean.</span>
</span><span id="__span-8-163"><a id="__codelineno-8-163" name="__codelineno-8-163" href="#__codelineno-8-163"></a><span class="cm">     * &lt;p&gt;Note that this flag is designed to only affect type-based autowiring.</span>
</span><span id="__span-8-164"><a id="__codelineno-8-164" name="__codelineno-8-164" href="#__codelineno-8-164"></a><span class="cm">     * It does not affect explicit references by name, which will get resolved even</span>
</span><span id="__span-8-165"><a id="__codelineno-8-165" name="__codelineno-8-165" href="#__codelineno-8-165"></a><span class="cm">     * if the specified bean is not marked as an autowire candidate. As a consequence,</span>
</span><span id="__span-8-166"><a id="__codelineno-8-166" name="__codelineno-8-166" href="#__codelineno-8-166"></a><span class="cm">     * autowiring by name will nevertheless inject a bean if the name matches.</span>
</span><span id="__span-8-167"><a id="__codelineno-8-167" name="__codelineno-8-167" href="#__codelineno-8-167"></a><span class="cm">     */</span>
</span><span id="__span-8-168"><a id="__codelineno-8-168" name="__codelineno-8-168" href="#__codelineno-8-168"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setAutowireCandidate</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">autowireCandidate</span><span class="p">);</span>
</span><span id="__span-8-169"><a id="__codelineno-8-169" name="__codelineno-8-169" href="#__codelineno-8-169"></a>
</span><span id="__span-8-170"><a id="__codelineno-8-170" name="__codelineno-8-170" href="#__codelineno-8-170"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-171"><a id="__codelineno-8-171" name="__codelineno-8-171" href="#__codelineno-8-171"></a><span class="cm">     * Return whether this bean is a candidate for getting autowired into some other bean.</span>
</span><span id="__span-8-172"><a id="__codelineno-8-172" name="__codelineno-8-172" href="#__codelineno-8-172"></a><span class="cm">     */</span>
</span><span id="__span-8-173"><a id="__codelineno-8-173" name="__codelineno-8-173" href="#__codelineno-8-173"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isAutowireCandidate</span><span class="p">();</span>
</span><span id="__span-8-174"><a id="__codelineno-8-174" name="__codelineno-8-174" href="#__codelineno-8-174"></a>
</span><span id="__span-8-175"><a id="__codelineno-8-175" name="__codelineno-8-175" href="#__codelineno-8-175"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-176"><a id="__codelineno-8-176" name="__codelineno-8-176" href="#__codelineno-8-176"></a><span class="cm">     * Set whether this bean is a primary autowire candidate.</span>
</span><span id="__span-8-177"><a id="__codelineno-8-177" name="__codelineno-8-177" href="#__codelineno-8-177"></a><span class="cm">     * &lt;p&gt;If this value is {@code true} for exactly one bean among multiple</span>
</span><span id="__span-8-178"><a id="__codelineno-8-178" name="__codelineno-8-178" href="#__codelineno-8-178"></a><span class="cm">     * matching candidates, it will serve as a tie-breaker.</span>
</span><span id="__span-8-179"><a id="__codelineno-8-179" name="__codelineno-8-179" href="#__codelineno-8-179"></a><span class="cm">     */</span>
</span><span id="__span-8-180"><a id="__codelineno-8-180" name="__codelineno-8-180" href="#__codelineno-8-180"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPrimary</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">primary</span><span class="p">);</span>
</span><span id="__span-8-181"><a id="__codelineno-8-181" name="__codelineno-8-181" href="#__codelineno-8-181"></a>
</span><span id="__span-8-182"><a id="__codelineno-8-182" name="__codelineno-8-182" href="#__codelineno-8-182"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-183"><a id="__codelineno-8-183" name="__codelineno-8-183" href="#__codelineno-8-183"></a><span class="cm">     * Return whether this bean is a primary autowire candidate.</span>
</span><span id="__span-8-184"><a id="__codelineno-8-184" name="__codelineno-8-184" href="#__codelineno-8-184"></a><span class="cm">     */</span>
</span><span id="__span-8-185"><a id="__codelineno-8-185" name="__codelineno-8-185" href="#__codelineno-8-185"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isPrimary</span><span class="p">();</span>
</span><span id="__span-8-186"><a id="__codelineno-8-186" name="__codelineno-8-186" href="#__codelineno-8-186"></a>
</span><span id="__span-8-187"><a id="__codelineno-8-187" name="__codelineno-8-187" href="#__codelineno-8-187"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-188"><a id="__codelineno-8-188" name="__codelineno-8-188" href="#__codelineno-8-188"></a><span class="cm">     * Specify the factory bean to use, if any.</span>
</span><span id="__span-8-189"><a id="__codelineno-8-189" name="__codelineno-8-189" href="#__codelineno-8-189"></a><span class="cm">     * This the name of the bean to call the specified factory method on.</span>
</span><span id="__span-8-190"><a id="__codelineno-8-190" name="__codelineno-8-190" href="#__codelineno-8-190"></a><span class="cm">     * @see #setFactoryMethodName</span>
</span><span id="__span-8-191"><a id="__codelineno-8-191" name="__codelineno-8-191" href="#__codelineno-8-191"></a><span class="cm">     */</span>
</span><span id="__span-8-192"><a id="__codelineno-8-192" name="__codelineno-8-192" href="#__codelineno-8-192"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setFactoryBeanName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">factoryBeanName</span><span class="p">);</span>
</span><span id="__span-8-193"><a id="__codelineno-8-193" name="__codelineno-8-193" href="#__codelineno-8-193"></a>
</span><span id="__span-8-194"><a id="__codelineno-8-194" name="__codelineno-8-194" href="#__codelineno-8-194"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-195"><a id="__codelineno-8-195" name="__codelineno-8-195" href="#__codelineno-8-195"></a><span class="cm">     * Return the factory bean name, if any.</span>
</span><span id="__span-8-196"><a id="__codelineno-8-196" name="__codelineno-8-196" href="#__codelineno-8-196"></a><span class="cm">     */</span>
</span><span id="__span-8-197"><a id="__codelineno-8-197" name="__codelineno-8-197" href="#__codelineno-8-197"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-198"><a id="__codelineno-8-198" name="__codelineno-8-198" href="#__codelineno-8-198"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getFactoryBeanName</span><span class="p">();</span>
</span><span id="__span-8-199"><a id="__codelineno-8-199" name="__codelineno-8-199" href="#__codelineno-8-199"></a>
</span><span id="__span-8-200"><a id="__codelineno-8-200" name="__codelineno-8-200" href="#__codelineno-8-200"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-201"><a id="__codelineno-8-201" name="__codelineno-8-201" href="#__codelineno-8-201"></a><span class="cm">     * Specify a factory method, if any. This method will be invoked with</span>
</span><span id="__span-8-202"><a id="__codelineno-8-202" name="__codelineno-8-202" href="#__codelineno-8-202"></a><span class="cm">     * constructor arguments, or with no arguments if none are specified.</span>
</span><span id="__span-8-203"><a id="__codelineno-8-203" name="__codelineno-8-203" href="#__codelineno-8-203"></a><span class="cm">     * The method will be invoked on the specified factory bean, if any,</span>
</span><span id="__span-8-204"><a id="__codelineno-8-204" name="__codelineno-8-204" href="#__codelineno-8-204"></a><span class="cm">     * or otherwise as a static method on the local bean class.</span>
</span><span id="__span-8-205"><a id="__codelineno-8-205" name="__codelineno-8-205" href="#__codelineno-8-205"></a><span class="cm">     * @see #setFactoryBeanName</span>
</span><span id="__span-8-206"><a id="__codelineno-8-206" name="__codelineno-8-206" href="#__codelineno-8-206"></a><span class="cm">     * @see #setBeanClassName</span>
</span><span id="__span-8-207"><a id="__codelineno-8-207" name="__codelineno-8-207" href="#__codelineno-8-207"></a><span class="cm">     */</span>
</span><span id="__span-8-208"><a id="__codelineno-8-208" name="__codelineno-8-208" href="#__codelineno-8-208"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setFactoryMethodName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">factoryMethodName</span><span class="p">);</span>
</span><span id="__span-8-209"><a id="__codelineno-8-209" name="__codelineno-8-209" href="#__codelineno-8-209"></a>
</span><span id="__span-8-210"><a id="__codelineno-8-210" name="__codelineno-8-210" href="#__codelineno-8-210"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-211"><a id="__codelineno-8-211" name="__codelineno-8-211" href="#__codelineno-8-211"></a><span class="cm">     * Return a factory method, if any.</span>
</span><span id="__span-8-212"><a id="__codelineno-8-212" name="__codelineno-8-212" href="#__codelineno-8-212"></a><span class="cm">     */</span>
</span><span id="__span-8-213"><a id="__codelineno-8-213" name="__codelineno-8-213" href="#__codelineno-8-213"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-214"><a id="__codelineno-8-214" name="__codelineno-8-214" href="#__codelineno-8-214"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getFactoryMethodName</span><span class="p">();</span>
</span><span id="__span-8-215"><a id="__codelineno-8-215" name="__codelineno-8-215" href="#__codelineno-8-215"></a>
</span><span id="__span-8-216"><a id="__codelineno-8-216" name="__codelineno-8-216" href="#__codelineno-8-216"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-217"><a id="__codelineno-8-217" name="__codelineno-8-217" href="#__codelineno-8-217"></a><span class="cm">     * Return the constructor argument values for this bean.</span>
</span><span id="__span-8-218"><a id="__codelineno-8-218" name="__codelineno-8-218" href="#__codelineno-8-218"></a><span class="cm">     * &lt;p&gt;The returned instance can be modified during bean factory post-processing.</span>
</span><span id="__span-8-219"><a id="__codelineno-8-219" name="__codelineno-8-219" href="#__codelineno-8-219"></a><span class="cm">     * @return the ConstructorArgumentValues object (never {@code null})</span>
</span><span id="__span-8-220"><a id="__codelineno-8-220" name="__codelineno-8-220" href="#__codelineno-8-220"></a><span class="cm">     */</span>
</span><span id="__span-8-221"><a id="__codelineno-8-221" name="__codelineno-8-221" href="#__codelineno-8-221"></a><span class="w">    </span><span class="n">ConstructorArgumentValues</span><span class="w"> </span><span class="nf">getConstructorArgumentValues</span><span class="p">();</span>
</span><span id="__span-8-222"><a id="__codelineno-8-222" name="__codelineno-8-222" href="#__codelineno-8-222"></a>
</span><span id="__span-8-223"><a id="__codelineno-8-223" name="__codelineno-8-223" href="#__codelineno-8-223"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-224"><a id="__codelineno-8-224" name="__codelineno-8-224" href="#__codelineno-8-224"></a><span class="cm">     * Return if there are constructor argument values defined for this bean.</span>
</span><span id="__span-8-225"><a id="__codelineno-8-225" name="__codelineno-8-225" href="#__codelineno-8-225"></a><span class="cm">     * @since 5.0.2</span>
</span><span id="__span-8-226"><a id="__codelineno-8-226" name="__codelineno-8-226" href="#__codelineno-8-226"></a><span class="cm">     */</span>
</span><span id="__span-8-227"><a id="__codelineno-8-227" name="__codelineno-8-227" href="#__codelineno-8-227"></a><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">hasConstructorArgumentValues</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-228"><a id="__codelineno-8-228" name="__codelineno-8-228" href="#__codelineno-8-228"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">getConstructorArgumentValues</span><span class="p">().</span><span class="na">isEmpty</span><span class="p">();</span>
</span><span id="__span-8-229"><a id="__codelineno-8-229" name="__codelineno-8-229" href="#__codelineno-8-229"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-230"><a id="__codelineno-8-230" name="__codelineno-8-230" href="#__codelineno-8-230"></a>
</span><span id="__span-8-231"><a id="__codelineno-8-231" name="__codelineno-8-231" href="#__codelineno-8-231"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-232"><a id="__codelineno-8-232" name="__codelineno-8-232" href="#__codelineno-8-232"></a><span class="cm">     * Return the property values to be applied to a new instance of the bean.</span>
</span><span id="__span-8-233"><a id="__codelineno-8-233" name="__codelineno-8-233" href="#__codelineno-8-233"></a><span class="cm">     * &lt;p&gt;The returned instance can be modified during bean factory post-processing.</span>
</span><span id="__span-8-234"><a id="__codelineno-8-234" name="__codelineno-8-234" href="#__codelineno-8-234"></a><span class="cm">     * @return the MutablePropertyValues object (never {@code null})</span>
</span><span id="__span-8-235"><a id="__codelineno-8-235" name="__codelineno-8-235" href="#__codelineno-8-235"></a><span class="cm">     */</span>
</span><span id="__span-8-236"><a id="__codelineno-8-236" name="__codelineno-8-236" href="#__codelineno-8-236"></a><span class="w">    </span><span class="n">MutablePropertyValues</span><span class="w"> </span><span class="nf">getPropertyValues</span><span class="p">();</span>
</span><span id="__span-8-237"><a id="__codelineno-8-237" name="__codelineno-8-237" href="#__codelineno-8-237"></a>
</span><span id="__span-8-238"><a id="__codelineno-8-238" name="__codelineno-8-238" href="#__codelineno-8-238"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-239"><a id="__codelineno-8-239" name="__codelineno-8-239" href="#__codelineno-8-239"></a><span class="cm">     * Return if there are property values values defined for this bean.</span>
</span><span id="__span-8-240"><a id="__codelineno-8-240" name="__codelineno-8-240" href="#__codelineno-8-240"></a><span class="cm">     * @since 5.0.2</span>
</span><span id="__span-8-241"><a id="__codelineno-8-241" name="__codelineno-8-241" href="#__codelineno-8-241"></a><span class="cm">     */</span>
</span><span id="__span-8-242"><a id="__codelineno-8-242" name="__codelineno-8-242" href="#__codelineno-8-242"></a><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">hasPropertyValues</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-243"><a id="__codelineno-8-243" name="__codelineno-8-243" href="#__codelineno-8-243"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">getPropertyValues</span><span class="p">().</span><span class="na">isEmpty</span><span class="p">();</span>
</span><span id="__span-8-244"><a id="__codelineno-8-244" name="__codelineno-8-244" href="#__codelineno-8-244"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-8-245"><a id="__codelineno-8-245" name="__codelineno-8-245" href="#__codelineno-8-245"></a>
</span><span id="__span-8-246"><a id="__codelineno-8-246" name="__codelineno-8-246" href="#__codelineno-8-246"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-247"><a id="__codelineno-8-247" name="__codelineno-8-247" href="#__codelineno-8-247"></a><span class="cm">     * Set the name of the initializer method.</span>
</span><span id="__span-8-248"><a id="__codelineno-8-248" name="__codelineno-8-248" href="#__codelineno-8-248"></a><span class="cm">     * @since 5.1</span>
</span><span id="__span-8-249"><a id="__codelineno-8-249" name="__codelineno-8-249" href="#__codelineno-8-249"></a><span class="cm">     */</span>
</span><span id="__span-8-250"><a id="__codelineno-8-250" name="__codelineno-8-250" href="#__codelineno-8-250"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setInitMethodName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">initMethodName</span><span class="p">);</span>
</span><span id="__span-8-251"><a id="__codelineno-8-251" name="__codelineno-8-251" href="#__codelineno-8-251"></a>
</span><span id="__span-8-252"><a id="__codelineno-8-252" name="__codelineno-8-252" href="#__codelineno-8-252"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-253"><a id="__codelineno-8-253" name="__codelineno-8-253" href="#__codelineno-8-253"></a><span class="cm">     * Return the name of the initializer method.</span>
</span><span id="__span-8-254"><a id="__codelineno-8-254" name="__codelineno-8-254" href="#__codelineno-8-254"></a><span class="cm">     * @since 5.1</span>
</span><span id="__span-8-255"><a id="__codelineno-8-255" name="__codelineno-8-255" href="#__codelineno-8-255"></a><span class="cm">     */</span>
</span><span id="__span-8-256"><a id="__codelineno-8-256" name="__codelineno-8-256" href="#__codelineno-8-256"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-257"><a id="__codelineno-8-257" name="__codelineno-8-257" href="#__codelineno-8-257"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getInitMethodName</span><span class="p">();</span>
</span><span id="__span-8-258"><a id="__codelineno-8-258" name="__codelineno-8-258" href="#__codelineno-8-258"></a>
</span><span id="__span-8-259"><a id="__codelineno-8-259" name="__codelineno-8-259" href="#__codelineno-8-259"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-260"><a id="__codelineno-8-260" name="__codelineno-8-260" href="#__codelineno-8-260"></a><span class="cm">     * Set the name of the destroy method.</span>
</span><span id="__span-8-261"><a id="__codelineno-8-261" name="__codelineno-8-261" href="#__codelineno-8-261"></a><span class="cm">     * @since 5.1</span>
</span><span id="__span-8-262"><a id="__codelineno-8-262" name="__codelineno-8-262" href="#__codelineno-8-262"></a><span class="cm">     */</span>
</span><span id="__span-8-263"><a id="__codelineno-8-263" name="__codelineno-8-263" href="#__codelineno-8-263"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setDestroyMethodName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">destroyMethodName</span><span class="p">);</span>
</span><span id="__span-8-264"><a id="__codelineno-8-264" name="__codelineno-8-264" href="#__codelineno-8-264"></a>
</span><span id="__span-8-265"><a id="__codelineno-8-265" name="__codelineno-8-265" href="#__codelineno-8-265"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-266"><a id="__codelineno-8-266" name="__codelineno-8-266" href="#__codelineno-8-266"></a><span class="cm">     * Return the name of the destroy method.</span>
</span><span id="__span-8-267"><a id="__codelineno-8-267" name="__codelineno-8-267" href="#__codelineno-8-267"></a><span class="cm">     * @since 5.1</span>
</span><span id="__span-8-268"><a id="__codelineno-8-268" name="__codelineno-8-268" href="#__codelineno-8-268"></a><span class="cm">     */</span>
</span><span id="__span-8-269"><a id="__codelineno-8-269" name="__codelineno-8-269" href="#__codelineno-8-269"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-270"><a id="__codelineno-8-270" name="__codelineno-8-270" href="#__codelineno-8-270"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getDestroyMethodName</span><span class="p">();</span>
</span><span id="__span-8-271"><a id="__codelineno-8-271" name="__codelineno-8-271" href="#__codelineno-8-271"></a>
</span><span id="__span-8-272"><a id="__codelineno-8-272" name="__codelineno-8-272" href="#__codelineno-8-272"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-273"><a id="__codelineno-8-273" name="__codelineno-8-273" href="#__codelineno-8-273"></a><span class="cm">     * Set the role hint for this {@code BeanDefinition}. The role hint</span>
</span><span id="__span-8-274"><a id="__codelineno-8-274" name="__codelineno-8-274" href="#__codelineno-8-274"></a><span class="cm">     * provides the frameworks as well as tools with an indication of</span>
</span><span id="__span-8-275"><a id="__codelineno-8-275" name="__codelineno-8-275" href="#__codelineno-8-275"></a><span class="cm">     * the role and importance of a particular {@code BeanDefinition}.</span>
</span><span id="__span-8-276"><a id="__codelineno-8-276" name="__codelineno-8-276" href="#__codelineno-8-276"></a><span class="cm">     * @since 5.1</span>
</span><span id="__span-8-277"><a id="__codelineno-8-277" name="__codelineno-8-277" href="#__codelineno-8-277"></a><span class="cm">     * @see #ROLE_APPLICATION</span>
</span><span id="__span-8-278"><a id="__codelineno-8-278" name="__codelineno-8-278" href="#__codelineno-8-278"></a><span class="cm">     * @see #ROLE_SUPPORT</span>
</span><span id="__span-8-279"><a id="__codelineno-8-279" name="__codelineno-8-279" href="#__codelineno-8-279"></a><span class="cm">     * @see #ROLE_INFRASTRUCTURE</span>
</span><span id="__span-8-280"><a id="__codelineno-8-280" name="__codelineno-8-280" href="#__codelineno-8-280"></a><span class="cm">     */</span>
</span><span id="__span-8-281"><a id="__codelineno-8-281" name="__codelineno-8-281" href="#__codelineno-8-281"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setRole</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">role</span><span class="p">);</span>
</span><span id="__span-8-282"><a id="__codelineno-8-282" name="__codelineno-8-282" href="#__codelineno-8-282"></a>
</span><span id="__span-8-283"><a id="__codelineno-8-283" name="__codelineno-8-283" href="#__codelineno-8-283"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-284"><a id="__codelineno-8-284" name="__codelineno-8-284" href="#__codelineno-8-284"></a><span class="cm">     * Get the role hint for this {@code BeanDefinition}. The role hint</span>
</span><span id="__span-8-285"><a id="__codelineno-8-285" name="__codelineno-8-285" href="#__codelineno-8-285"></a><span class="cm">     * provides the frameworks as well as tools with an indication of</span>
</span><span id="__span-8-286"><a id="__codelineno-8-286" name="__codelineno-8-286" href="#__codelineno-8-286"></a><span class="cm">     * the role and importance of a particular {@code BeanDefinition}.</span>
</span><span id="__span-8-287"><a id="__codelineno-8-287" name="__codelineno-8-287" href="#__codelineno-8-287"></a><span class="cm">     * @see #ROLE_APPLICATION</span>
</span><span id="__span-8-288"><a id="__codelineno-8-288" name="__codelineno-8-288" href="#__codelineno-8-288"></a><span class="cm">     * @see #ROLE_SUPPORT</span>
</span><span id="__span-8-289"><a id="__codelineno-8-289" name="__codelineno-8-289" href="#__codelineno-8-289"></a><span class="cm">     * @see #ROLE_INFRASTRUCTURE</span>
</span><span id="__span-8-290"><a id="__codelineno-8-290" name="__codelineno-8-290" href="#__codelineno-8-290"></a><span class="cm">     */</span>
</span><span id="__span-8-291"><a id="__codelineno-8-291" name="__codelineno-8-291" href="#__codelineno-8-291"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">getRole</span><span class="p">();</span>
</span><span id="__span-8-292"><a id="__codelineno-8-292" name="__codelineno-8-292" href="#__codelineno-8-292"></a>
</span><span id="__span-8-293"><a id="__codelineno-8-293" name="__codelineno-8-293" href="#__codelineno-8-293"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-294"><a id="__codelineno-8-294" name="__codelineno-8-294" href="#__codelineno-8-294"></a><span class="cm">     * Set a human-readable description of this bean definition.</span>
</span><span id="__span-8-295"><a id="__codelineno-8-295" name="__codelineno-8-295" href="#__codelineno-8-295"></a><span class="cm">     * @since 5.1</span>
</span><span id="__span-8-296"><a id="__codelineno-8-296" name="__codelineno-8-296" href="#__codelineno-8-296"></a><span class="cm">     */</span>
</span><span id="__span-8-297"><a id="__codelineno-8-297" name="__codelineno-8-297" href="#__codelineno-8-297"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setDescription</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">description</span><span class="p">);</span>
</span><span id="__span-8-298"><a id="__codelineno-8-298" name="__codelineno-8-298" href="#__codelineno-8-298"></a>
</span><span id="__span-8-299"><a id="__codelineno-8-299" name="__codelineno-8-299" href="#__codelineno-8-299"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-300"><a id="__codelineno-8-300" name="__codelineno-8-300" href="#__codelineno-8-300"></a><span class="cm">     * Return a human-readable description of this bean definition.</span>
</span><span id="__span-8-301"><a id="__codelineno-8-301" name="__codelineno-8-301" href="#__codelineno-8-301"></a><span class="cm">     */</span>
</span><span id="__span-8-302"><a id="__codelineno-8-302" name="__codelineno-8-302" href="#__codelineno-8-302"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-303"><a id="__codelineno-8-303" name="__codelineno-8-303" href="#__codelineno-8-303"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getDescription</span><span class="p">();</span>
</span><span id="__span-8-304"><a id="__codelineno-8-304" name="__codelineno-8-304" href="#__codelineno-8-304"></a>
</span><span id="__span-8-305"><a id="__codelineno-8-305" name="__codelineno-8-305" href="#__codelineno-8-305"></a>
</span><span id="__span-8-306"><a id="__codelineno-8-306" name="__codelineno-8-306" href="#__codelineno-8-306"></a><span class="w">    </span><span class="c1">// Read-only attributes</span>
</span><span id="__span-8-307"><a id="__codelineno-8-307" name="__codelineno-8-307" href="#__codelineno-8-307"></a>
</span><span id="__span-8-308"><a id="__codelineno-8-308" name="__codelineno-8-308" href="#__codelineno-8-308"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-309"><a id="__codelineno-8-309" name="__codelineno-8-309" href="#__codelineno-8-309"></a><span class="cm">     * Return a resolvable type for this bean definition,</span>
</span><span id="__span-8-310"><a id="__codelineno-8-310" name="__codelineno-8-310" href="#__codelineno-8-310"></a><span class="cm">     * based on the bean class or other specific metadata.</span>
</span><span id="__span-8-311"><a id="__codelineno-8-311" name="__codelineno-8-311" href="#__codelineno-8-311"></a><span class="cm">     * &lt;p&gt;This is typically fully resolved on a runtime-merged bean definition</span>
</span><span id="__span-8-312"><a id="__codelineno-8-312" name="__codelineno-8-312" href="#__codelineno-8-312"></a><span class="cm">     * but not necessarily on a configuration-time definition instance.</span>
</span><span id="__span-8-313"><a id="__codelineno-8-313" name="__codelineno-8-313" href="#__codelineno-8-313"></a><span class="cm">     * @return the resolvable type (potentially {@link ResolvableType#NONE})</span>
</span><span id="__span-8-314"><a id="__codelineno-8-314" name="__codelineno-8-314" href="#__codelineno-8-314"></a><span class="cm">     * @since 5.2</span>
</span><span id="__span-8-315"><a id="__codelineno-8-315" name="__codelineno-8-315" href="#__codelineno-8-315"></a><span class="cm">     * @see ConfigurableBeanFactory#getMergedBeanDefinition</span>
</span><span id="__span-8-316"><a id="__codelineno-8-316" name="__codelineno-8-316" href="#__codelineno-8-316"></a><span class="cm">     */</span>
</span><span id="__span-8-317"><a id="__codelineno-8-317" name="__codelineno-8-317" href="#__codelineno-8-317"></a><span class="w">    </span><span class="n">ResolvableType</span><span class="w"> </span><span class="nf">getResolvableType</span><span class="p">();</span>
</span><span id="__span-8-318"><a id="__codelineno-8-318" name="__codelineno-8-318" href="#__codelineno-8-318"></a>
</span><span id="__span-8-319"><a id="__codelineno-8-319" name="__codelineno-8-319" href="#__codelineno-8-319"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-320"><a id="__codelineno-8-320" name="__codelineno-8-320" href="#__codelineno-8-320"></a><span class="cm">     * Return whether this a &lt;b&gt;Singleton&lt;/b&gt;, with a single, shared instance</span>
</span><span id="__span-8-321"><a id="__codelineno-8-321" name="__codelineno-8-321" href="#__codelineno-8-321"></a><span class="cm">     * returned on all calls.</span>
</span><span id="__span-8-322"><a id="__codelineno-8-322" name="__codelineno-8-322" href="#__codelineno-8-322"></a><span class="cm">     * @see #SCOPE_SINGLETON</span>
</span><span id="__span-8-323"><a id="__codelineno-8-323" name="__codelineno-8-323" href="#__codelineno-8-323"></a><span class="cm">     */</span>
</span><span id="__span-8-324"><a id="__codelineno-8-324" name="__codelineno-8-324" href="#__codelineno-8-324"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isSingleton</span><span class="p">();</span>
</span><span id="__span-8-325"><a id="__codelineno-8-325" name="__codelineno-8-325" href="#__codelineno-8-325"></a>
</span><span id="__span-8-326"><a id="__codelineno-8-326" name="__codelineno-8-326" href="#__codelineno-8-326"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-327"><a id="__codelineno-8-327" name="__codelineno-8-327" href="#__codelineno-8-327"></a><span class="cm">     * Return whether this a &lt;b&gt;Prototype&lt;/b&gt;, with an independent instance</span>
</span><span id="__span-8-328"><a id="__codelineno-8-328" name="__codelineno-8-328" href="#__codelineno-8-328"></a><span class="cm">     * returned for each call.</span>
</span><span id="__span-8-329"><a id="__codelineno-8-329" name="__codelineno-8-329" href="#__codelineno-8-329"></a><span class="cm">     * @since 3.0</span>
</span><span id="__span-8-330"><a id="__codelineno-8-330" name="__codelineno-8-330" href="#__codelineno-8-330"></a><span class="cm">     * @see #SCOPE_PROTOTYPE</span>
</span><span id="__span-8-331"><a id="__codelineno-8-331" name="__codelineno-8-331" href="#__codelineno-8-331"></a><span class="cm">     */</span>
</span><span id="__span-8-332"><a id="__codelineno-8-332" name="__codelineno-8-332" href="#__codelineno-8-332"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isPrototype</span><span class="p">();</span>
</span><span id="__span-8-333"><a id="__codelineno-8-333" name="__codelineno-8-333" href="#__codelineno-8-333"></a>
</span><span id="__span-8-334"><a id="__codelineno-8-334" name="__codelineno-8-334" href="#__codelineno-8-334"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-335"><a id="__codelineno-8-335" name="__codelineno-8-335" href="#__codelineno-8-335"></a><span class="cm">     * Return whether this bean is &quot;abstract&quot;, that is, not meant to be instantiated.</span>
</span><span id="__span-8-336"><a id="__codelineno-8-336" name="__codelineno-8-336" href="#__codelineno-8-336"></a><span class="cm">     */</span>
</span><span id="__span-8-337"><a id="__codelineno-8-337" name="__codelineno-8-337" href="#__codelineno-8-337"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isAbstract</span><span class="p">();</span>
</span><span id="__span-8-338"><a id="__codelineno-8-338" name="__codelineno-8-338" href="#__codelineno-8-338"></a>
</span><span id="__span-8-339"><a id="__codelineno-8-339" name="__codelineno-8-339" href="#__codelineno-8-339"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-340"><a id="__codelineno-8-340" name="__codelineno-8-340" href="#__codelineno-8-340"></a><span class="cm">     * Return a description of the resource that this bean definition</span>
</span><span id="__span-8-341"><a id="__codelineno-8-341" name="__codelineno-8-341" href="#__codelineno-8-341"></a><span class="cm">     * came from (for the purpose of showing context in case of errors).</span>
</span><span id="__span-8-342"><a id="__codelineno-8-342" name="__codelineno-8-342" href="#__codelineno-8-342"></a><span class="cm">     */</span>
</span><span id="__span-8-343"><a id="__codelineno-8-343" name="__codelineno-8-343" href="#__codelineno-8-343"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-344"><a id="__codelineno-8-344" name="__codelineno-8-344" href="#__codelineno-8-344"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getResourceDescription</span><span class="p">();</span>
</span><span id="__span-8-345"><a id="__codelineno-8-345" name="__codelineno-8-345" href="#__codelineno-8-345"></a>
</span><span id="__span-8-346"><a id="__codelineno-8-346" name="__codelineno-8-346" href="#__codelineno-8-346"></a><span class="w">    </span><span class="cm">/**</span>
</span><span id="__span-8-347"><a id="__codelineno-8-347" name="__codelineno-8-347" href="#__codelineno-8-347"></a><span class="cm">     * Return the originating BeanDefinition, or {@code null} if none.</span>
</span><span id="__span-8-348"><a id="__codelineno-8-348" name="__codelineno-8-348" href="#__codelineno-8-348"></a><span class="cm">     * Allows for retrieving the decorated bean definition, if any.</span>
</span><span id="__span-8-349"><a id="__codelineno-8-349" name="__codelineno-8-349" href="#__codelineno-8-349"></a><span class="cm">     * &lt;p&gt;Note that this method returns the immediate originator. Iterate through the</span>
</span><span id="__span-8-350"><a id="__codelineno-8-350" name="__codelineno-8-350" href="#__codelineno-8-350"></a><span class="cm">     * originator chain to find the original BeanDefinition as defined by the user.</span>
</span><span id="__span-8-351"><a id="__codelineno-8-351" name="__codelineno-8-351" href="#__codelineno-8-351"></a><span class="cm">     */</span>
</span><span id="__span-8-352"><a id="__codelineno-8-352" name="__codelineno-8-352" href="#__codelineno-8-352"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-8-353"><a id="__codelineno-8-353" name="__codelineno-8-353" href="#__codelineno-8-353"></a><span class="w">    </span><span class="n">BeanDefinition</span><span class="w"> </span><span class="nf">getOriginatingBeanDefinition</span><span class="p">();</span>
</span><span id="__span-8-354"><a id="__codelineno-8-354" name="__codelineno-8-354" href="#__codelineno-8-354"></a>
</span><span id="__span-8-355"><a id="__codelineno-8-355" name="__codelineno-8-355" href="#__codelineno-8-355"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="beandefination_1">BeanDefination方法属性摘要<a class="headerlink" href="#beandefination_1" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">BeanDefinition</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">AttributeAccessor</span><span class="p">,</span><span class="w"> </span><span class="n">BeanMetadataElement</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">SCOPE_SINGLETON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ConfigurableBeanFactory</span><span class="p">.</span><span class="na">SCOPE_SINGLETON</span><span class="p">;</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">SCOPE_PROTOTYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ConfigurableBeanFactory</span><span class="p">.</span><span class="na">SCOPE_PROTOTYPE</span><span class="p">;</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ROLE_APPLICATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ROLE_SUPPORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">    </span><span class="c1">// infrastructure</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ROLE_INFRASTRUCTURE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">    </span><span class="c1">// Modifiable attributes</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setParentName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">parentName</span><span class="p">);</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getParentName</span><span class="p">();</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setBeanClassName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">beanClassName</span><span class="p">);</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getBeanClassName</span><span class="p">();</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setScope</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">scope</span><span class="p">);</span>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a>
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getScope</span><span class="p">();</span>
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a>
</span><span id="__span-9-38"><a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a>
</span><span id="__span-9-39"><a id="__codelineno-9-39" name="__codelineno-9-39" href="#__codelineno-9-39"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setLazyInit</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">lazyInit</span><span class="p">);</span>
</span><span id="__span-9-40"><a id="__codelineno-9-40" name="__codelineno-9-40" href="#__codelineno-9-40"></a>
</span><span id="__span-9-41"><a id="__codelineno-9-41" name="__codelineno-9-41" href="#__codelineno-9-41"></a>
</span><span id="__span-9-42"><a id="__codelineno-9-42" name="__codelineno-9-42" href="#__codelineno-9-42"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isLazyInit</span><span class="p">();</span>
</span><span id="__span-9-43"><a id="__codelineno-9-43" name="__codelineno-9-43" href="#__codelineno-9-43"></a>
</span><span id="__span-9-44"><a id="__codelineno-9-44" name="__codelineno-9-44" href="#__codelineno-9-44"></a>
</span><span id="__span-9-45"><a id="__codelineno-9-45" name="__codelineno-9-45" href="#__codelineno-9-45"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setDependsOn</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="p">...</span><span class="w"> </span><span class="n">dependsOn</span><span class="p">);</span>
</span><span id="__span-9-46"><a id="__codelineno-9-46" name="__codelineno-9-46" href="#__codelineno-9-46"></a>
</span><span id="__span-9-47"><a id="__codelineno-9-47" name="__codelineno-9-47" href="#__codelineno-9-47"></a>
</span><span id="__span-9-48"><a id="__codelineno-9-48" name="__codelineno-9-48" href="#__codelineno-9-48"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-49"><a id="__codelineno-9-49" name="__codelineno-9-49" href="#__codelineno-9-49"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">getDependsOn</span><span class="p">();</span>
</span><span id="__span-9-50"><a id="__codelineno-9-50" name="__codelineno-9-50" href="#__codelineno-9-50"></a>
</span><span id="__span-9-51"><a id="__codelineno-9-51" name="__codelineno-9-51" href="#__codelineno-9-51"></a>
</span><span id="__span-9-52"><a id="__codelineno-9-52" name="__codelineno-9-52" href="#__codelineno-9-52"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setAutowireCandidate</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">autowireCandidate</span><span class="p">);</span>
</span><span id="__span-9-53"><a id="__codelineno-9-53" name="__codelineno-9-53" href="#__codelineno-9-53"></a>
</span><span id="__span-9-54"><a id="__codelineno-9-54" name="__codelineno-9-54" href="#__codelineno-9-54"></a>
</span><span id="__span-9-55"><a id="__codelineno-9-55" name="__codelineno-9-55" href="#__codelineno-9-55"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isAutowireCandidate</span><span class="p">();</span>
</span><span id="__span-9-56"><a id="__codelineno-9-56" name="__codelineno-9-56" href="#__codelineno-9-56"></a>
</span><span id="__span-9-57"><a id="__codelineno-9-57" name="__codelineno-9-57" href="#__codelineno-9-57"></a>
</span><span id="__span-9-58"><a id="__codelineno-9-58" name="__codelineno-9-58" href="#__codelineno-9-58"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPrimary</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">primary</span><span class="p">);</span>
</span><span id="__span-9-59"><a id="__codelineno-9-59" name="__codelineno-9-59" href="#__codelineno-9-59"></a>
</span><span id="__span-9-60"><a id="__codelineno-9-60" name="__codelineno-9-60" href="#__codelineno-9-60"></a>
</span><span id="__span-9-61"><a id="__codelineno-9-61" name="__codelineno-9-61" href="#__codelineno-9-61"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isPrimary</span><span class="p">();</span>
</span><span id="__span-9-62"><a id="__codelineno-9-62" name="__codelineno-9-62" href="#__codelineno-9-62"></a>
</span><span id="__span-9-63"><a id="__codelineno-9-63" name="__codelineno-9-63" href="#__codelineno-9-63"></a>
</span><span id="__span-9-64"><a id="__codelineno-9-64" name="__codelineno-9-64" href="#__codelineno-9-64"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setFactoryBeanName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">factoryBeanName</span><span class="p">);</span>
</span><span id="__span-9-65"><a id="__codelineno-9-65" name="__codelineno-9-65" href="#__codelineno-9-65"></a>
</span><span id="__span-9-66"><a id="__codelineno-9-66" name="__codelineno-9-66" href="#__codelineno-9-66"></a>
</span><span id="__span-9-67"><a id="__codelineno-9-67" name="__codelineno-9-67" href="#__codelineno-9-67"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-68"><a id="__codelineno-9-68" name="__codelineno-9-68" href="#__codelineno-9-68"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getFactoryBeanName</span><span class="p">();</span>
</span><span id="__span-9-69"><a id="__codelineno-9-69" name="__codelineno-9-69" href="#__codelineno-9-69"></a>
</span><span id="__span-9-70"><a id="__codelineno-9-70" name="__codelineno-9-70" href="#__codelineno-9-70"></a>
</span><span id="__span-9-71"><a id="__codelineno-9-71" name="__codelineno-9-71" href="#__codelineno-9-71"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setFactoryMethodName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">factoryMethodName</span><span class="p">);</span>
</span><span id="__span-9-72"><a id="__codelineno-9-72" name="__codelineno-9-72" href="#__codelineno-9-72"></a>
</span><span id="__span-9-73"><a id="__codelineno-9-73" name="__codelineno-9-73" href="#__codelineno-9-73"></a>
</span><span id="__span-9-74"><a id="__codelineno-9-74" name="__codelineno-9-74" href="#__codelineno-9-74"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-75"><a id="__codelineno-9-75" name="__codelineno-9-75" href="#__codelineno-9-75"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getFactoryMethodName</span><span class="p">();</span>
</span><span id="__span-9-76"><a id="__codelineno-9-76" name="__codelineno-9-76" href="#__codelineno-9-76"></a>
</span><span id="__span-9-77"><a id="__codelineno-9-77" name="__codelineno-9-77" href="#__codelineno-9-77"></a>
</span><span id="__span-9-78"><a id="__codelineno-9-78" name="__codelineno-9-78" href="#__codelineno-9-78"></a><span class="w">    </span><span class="n">ConstructorArgumentValues</span><span class="w"> </span><span class="nf">getConstructorArgumentValues</span><span class="p">();</span>
</span><span id="__span-9-79"><a id="__codelineno-9-79" name="__codelineno-9-79" href="#__codelineno-9-79"></a>
</span><span id="__span-9-80"><a id="__codelineno-9-80" name="__codelineno-9-80" href="#__codelineno-9-80"></a>
</span><span id="__span-9-81"><a id="__codelineno-9-81" name="__codelineno-9-81" href="#__codelineno-9-81"></a><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">hasConstructorArgumentValues</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-82"><a id="__codelineno-9-82" name="__codelineno-9-82" href="#__codelineno-9-82"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">getConstructorArgumentValues</span><span class="p">().</span><span class="na">isEmpty</span><span class="p">();</span>
</span><span id="__span-9-83"><a id="__codelineno-9-83" name="__codelineno-9-83" href="#__codelineno-9-83"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-84"><a id="__codelineno-9-84" name="__codelineno-9-84" href="#__codelineno-9-84"></a>
</span><span id="__span-9-85"><a id="__codelineno-9-85" name="__codelineno-9-85" href="#__codelineno-9-85"></a>
</span><span id="__span-9-86"><a id="__codelineno-9-86" name="__codelineno-9-86" href="#__codelineno-9-86"></a><span class="w">    </span><span class="n">MutablePropertyValues</span><span class="w"> </span><span class="nf">getPropertyValues</span><span class="p">();</span>
</span><span id="__span-9-87"><a id="__codelineno-9-87" name="__codelineno-9-87" href="#__codelineno-9-87"></a>
</span><span id="__span-9-88"><a id="__codelineno-9-88" name="__codelineno-9-88" href="#__codelineno-9-88"></a>
</span><span id="__span-9-89"><a id="__codelineno-9-89" name="__codelineno-9-89" href="#__codelineno-9-89"></a><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">hasPropertyValues</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-90"><a id="__codelineno-9-90" name="__codelineno-9-90" href="#__codelineno-9-90"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="o">!</span><span class="n">getPropertyValues</span><span class="p">().</span><span class="na">isEmpty</span><span class="p">();</span>
</span><span id="__span-9-91"><a id="__codelineno-9-91" name="__codelineno-9-91" href="#__codelineno-9-91"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-92"><a id="__codelineno-9-92" name="__codelineno-9-92" href="#__codelineno-9-92"></a>
</span><span id="__span-9-93"><a id="__codelineno-9-93" name="__codelineno-9-93" href="#__codelineno-9-93"></a>
</span><span id="__span-9-94"><a id="__codelineno-9-94" name="__codelineno-9-94" href="#__codelineno-9-94"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setInitMethodName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">initMethodName</span><span class="p">);</span>
</span><span id="__span-9-95"><a id="__codelineno-9-95" name="__codelineno-9-95" href="#__codelineno-9-95"></a>
</span><span id="__span-9-96"><a id="__codelineno-9-96" name="__codelineno-9-96" href="#__codelineno-9-96"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-97"><a id="__codelineno-9-97" name="__codelineno-9-97" href="#__codelineno-9-97"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getInitMethodName</span><span class="p">();</span>
</span><span id="__span-9-98"><a id="__codelineno-9-98" name="__codelineno-9-98" href="#__codelineno-9-98"></a>
</span><span id="__span-9-99"><a id="__codelineno-9-99" name="__codelineno-9-99" href="#__codelineno-9-99"></a>
</span><span id="__span-9-100"><a id="__codelineno-9-100" name="__codelineno-9-100" href="#__codelineno-9-100"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setDestroyMethodName</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">destroyMethodName</span><span class="p">);</span>
</span><span id="__span-9-101"><a id="__codelineno-9-101" name="__codelineno-9-101" href="#__codelineno-9-101"></a>
</span><span id="__span-9-102"><a id="__codelineno-9-102" name="__codelineno-9-102" href="#__codelineno-9-102"></a>
</span><span id="__span-9-103"><a id="__codelineno-9-103" name="__codelineno-9-103" href="#__codelineno-9-103"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-104"><a id="__codelineno-9-104" name="__codelineno-9-104" href="#__codelineno-9-104"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getDestroyMethodName</span><span class="p">();</span>
</span><span id="__span-9-105"><a id="__codelineno-9-105" name="__codelineno-9-105" href="#__codelineno-9-105"></a>
</span><span id="__span-9-106"><a id="__codelineno-9-106" name="__codelineno-9-106" href="#__codelineno-9-106"></a>
</span><span id="__span-9-107"><a id="__codelineno-9-107" name="__codelineno-9-107" href="#__codelineno-9-107"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setRole</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">role</span><span class="p">);</span>
</span><span id="__span-9-108"><a id="__codelineno-9-108" name="__codelineno-9-108" href="#__codelineno-9-108"></a>
</span><span id="__span-9-109"><a id="__codelineno-9-109" name="__codelineno-9-109" href="#__codelineno-9-109"></a>
</span><span id="__span-9-110"><a id="__codelineno-9-110" name="__codelineno-9-110" href="#__codelineno-9-110"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nf">getRole</span><span class="p">();</span>
</span><span id="__span-9-111"><a id="__codelineno-9-111" name="__codelineno-9-111" href="#__codelineno-9-111"></a>
</span><span id="__span-9-112"><a id="__codelineno-9-112" name="__codelineno-9-112" href="#__codelineno-9-112"></a>
</span><span id="__span-9-113"><a id="__codelineno-9-113" name="__codelineno-9-113" href="#__codelineno-9-113"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setDescription</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">description</span><span class="p">);</span>
</span><span id="__span-9-114"><a id="__codelineno-9-114" name="__codelineno-9-114" href="#__codelineno-9-114"></a>
</span><span id="__span-9-115"><a id="__codelineno-9-115" name="__codelineno-9-115" href="#__codelineno-9-115"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-116"><a id="__codelineno-9-116" name="__codelineno-9-116" href="#__codelineno-9-116"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getDescription</span><span class="p">();</span>
</span><span id="__span-9-117"><a id="__codelineno-9-117" name="__codelineno-9-117" href="#__codelineno-9-117"></a>
</span><span id="__span-9-118"><a id="__codelineno-9-118" name="__codelineno-9-118" href="#__codelineno-9-118"></a>
</span><span id="__span-9-119"><a id="__codelineno-9-119" name="__codelineno-9-119" href="#__codelineno-9-119"></a><span class="w">    </span><span class="c1">// Read-only attributes</span>
</span><span id="__span-9-120"><a id="__codelineno-9-120" name="__codelineno-9-120" href="#__codelineno-9-120"></a>
</span><span id="__span-9-121"><a id="__codelineno-9-121" name="__codelineno-9-121" href="#__codelineno-9-121"></a>
</span><span id="__span-9-122"><a id="__codelineno-9-122" name="__codelineno-9-122" href="#__codelineno-9-122"></a><span class="w">    </span><span class="n">ResolvableType</span><span class="w"> </span><span class="nf">getResolvableType</span><span class="p">();</span>
</span><span id="__span-9-123"><a id="__codelineno-9-123" name="__codelineno-9-123" href="#__codelineno-9-123"></a>
</span><span id="__span-9-124"><a id="__codelineno-9-124" name="__codelineno-9-124" href="#__codelineno-9-124"></a>
</span><span id="__span-9-125"><a id="__codelineno-9-125" name="__codelineno-9-125" href="#__codelineno-9-125"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isSingleton</span><span class="p">();</span>
</span><span id="__span-9-126"><a id="__codelineno-9-126" name="__codelineno-9-126" href="#__codelineno-9-126"></a>
</span><span id="__span-9-127"><a id="__codelineno-9-127" name="__codelineno-9-127" href="#__codelineno-9-127"></a>
</span><span id="__span-9-128"><a id="__codelineno-9-128" name="__codelineno-9-128" href="#__codelineno-9-128"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isPrototype</span><span class="p">();</span>
</span><span id="__span-9-129"><a id="__codelineno-9-129" name="__codelineno-9-129" href="#__codelineno-9-129"></a>
</span><span id="__span-9-130"><a id="__codelineno-9-130" name="__codelineno-9-130" href="#__codelineno-9-130"></a>
</span><span id="__span-9-131"><a id="__codelineno-9-131" name="__codelineno-9-131" href="#__codelineno-9-131"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isAbstract</span><span class="p">();</span>
</span><span id="__span-9-132"><a id="__codelineno-9-132" name="__codelineno-9-132" href="#__codelineno-9-132"></a>
</span><span id="__span-9-133"><a id="__codelineno-9-133" name="__codelineno-9-133" href="#__codelineno-9-133"></a>
</span><span id="__span-9-134"><a id="__codelineno-9-134" name="__codelineno-9-134" href="#__codelineno-9-134"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-135"><a id="__codelineno-9-135" name="__codelineno-9-135" href="#__codelineno-9-135"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">getResourceDescription</span><span class="p">();</span>
</span><span id="__span-9-136"><a id="__codelineno-9-136" name="__codelineno-9-136" href="#__codelineno-9-136"></a>
</span><span id="__span-9-137"><a id="__codelineno-9-137" name="__codelineno-9-137" href="#__codelineno-9-137"></a>
</span><span id="__span-9-138"><a id="__codelineno-9-138" name="__codelineno-9-138" href="#__codelineno-9-138"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-139"><a id="__codelineno-9-139" name="__codelineno-9-139" href="#__codelineno-9-139"></a><span class="w">    </span><span class="n">BeanDefinition</span><span class="w"> </span><span class="nf">getOriginatingBeanDefinition</span><span class="p">();</span>
</span><span id="__span-9-140"><a id="__codelineno-9-140" name="__codelineno-9-140" href="#__codelineno-9-140"></a>
</span><span id="__span-9-141"><a id="__codelineno-9-141" name="__codelineno-9-141" href="#__codelineno-9-141"></a><span class="p">}</span>
</span><span id="__span-9-142"><a id="__codelineno-9-142" name="__codelineno-9-142" href="#__codelineno-9-142"></a>
</span><span id="__span-9-143"><a id="__codelineno-9-143" name="__codelineno-9-143" href="#__codelineno-9-143"></a>
</span><span id="__span-9-144"><a id="__codelineno-9-144" name="__codelineno-9-144" href="#__codelineno-9-144"></a>
</span><span id="__span-9-145"><a id="__codelineno-9-145" name="__codelineno-9-145" href="#__codelineno-9-145"></a><span class="c1">// org.springframework.core.AttributeAccessor</span>
</span><span id="__span-9-146"><a id="__codelineno-9-146" name="__codelineno-9-146" href="#__codelineno-9-146"></a><span class="kn">package</span><span class="w"> </span><span class="nn">org.springframework.core</span><span class="p">;</span>
</span><span id="__span-9-147"><a id="__codelineno-9-147" name="__codelineno-9-147" href="#__codelineno-9-147"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">AttributeAccessor</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-148"><a id="__codelineno-9-148" name="__codelineno-9-148" href="#__codelineno-9-148"></a>
</span><span id="__span-9-149"><a id="__codelineno-9-149" name="__codelineno-9-149" href="#__codelineno-9-149"></a><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setAttribute</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
</span><span id="__span-9-150"><a id="__codelineno-9-150" name="__codelineno-9-150" href="#__codelineno-9-150"></a>
</span><span id="__span-9-151"><a id="__codelineno-9-151" name="__codelineno-9-151" href="#__codelineno-9-151"></a>
</span><span id="__span-9-152"><a id="__codelineno-9-152" name="__codelineno-9-152" href="#__codelineno-9-152"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-153"><a id="__codelineno-9-153" name="__codelineno-9-153" href="#__codelineno-9-153"></a><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="nf">getAttribute</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-9-154"><a id="__codelineno-9-154" name="__codelineno-9-154" href="#__codelineno-9-154"></a>
</span><span id="__span-9-155"><a id="__codelineno-9-155" name="__codelineno-9-155" href="#__codelineno-9-155"></a>
</span><span id="__span-9-156"><a id="__codelineno-9-156" name="__codelineno-9-156" href="#__codelineno-9-156"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-157"><a id="__codelineno-9-157" name="__codelineno-9-157" href="#__codelineno-9-157"></a><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="nf">removeAttribute</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-9-158"><a id="__codelineno-9-158" name="__codelineno-9-158" href="#__codelineno-9-158"></a>
</span><span id="__span-9-159"><a id="__codelineno-9-159" name="__codelineno-9-159" href="#__codelineno-9-159"></a>
</span><span id="__span-9-160"><a id="__codelineno-9-160" name="__codelineno-9-160" href="#__codelineno-9-160"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">hasAttribute</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-9-161"><a id="__codelineno-9-161" name="__codelineno-9-161" href="#__codelineno-9-161"></a>
</span><span id="__span-9-162"><a id="__codelineno-9-162" name="__codelineno-9-162" href="#__codelineno-9-162"></a>
</span><span id="__span-9-163"><a id="__codelineno-9-163" name="__codelineno-9-163" href="#__codelineno-9-163"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">attributeNames</span><span class="p">();</span>
</span><span id="__span-9-164"><a id="__codelineno-9-164" name="__codelineno-9-164" href="#__codelineno-9-164"></a>
</span><span id="__span-9-165"><a id="__codelineno-9-165" name="__codelineno-9-165" href="#__codelineno-9-165"></a><span class="p">}</span>
</span><span id="__span-9-166"><a id="__codelineno-9-166" name="__codelineno-9-166" href="#__codelineno-9-166"></a>
</span><span id="__span-9-167"><a id="__codelineno-9-167" name="__codelineno-9-167" href="#__codelineno-9-167"></a>
</span><span id="__span-9-168"><a id="__codelineno-9-168" name="__codelineno-9-168" href="#__codelineno-9-168"></a>
</span><span id="__span-9-169"><a id="__codelineno-9-169" name="__codelineno-9-169" href="#__codelineno-9-169"></a><span class="c1">// org.springframework.beans.BeanMetadataElemen</span>
</span><span id="__span-9-170"><a id="__codelineno-9-170" name="__codelineno-9-170" href="#__codelineno-9-170"></a><span class="kn">package</span><span class="w"> </span><span class="nn">org.springframework.beans</span><span class="p">;</span>
</span><span id="__span-9-171"><a id="__codelineno-9-171" name="__codelineno-9-171" href="#__codelineno-9-171"></a><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">BeanMetadataElement</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-172"><a id="__codelineno-9-172" name="__codelineno-9-172" href="#__codelineno-9-172"></a>
</span><span id="__span-9-173"><a id="__codelineno-9-173" name="__codelineno-9-173" href="#__codelineno-9-173"></a><span class="w">    </span><span class="nd">@Nullable</span>
</span><span id="__span-9-174"><a id="__codelineno-9-174" name="__codelineno-9-174" href="#__codelineno-9-174"></a><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">getSource</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-175"><a id="__codelineno-9-175" name="__codelineno-9-175" href="#__codelineno-9-175"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-9-176"><a id="__codelineno-9-176" name="__codelineno-9-176" href="#__codelineno-9-176"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-177"><a id="__codelineno-9-177" name="__codelineno-9-177" href="#__codelineno-9-177"></a>
</span><span id="__span-9-178"><a id="__codelineno-9-178" name="__codelineno-9-178" href="#__codelineno-9-178"></a><span class="p">}</span>
</span></code></pre></div>
<h1 id="2demo">2.从一个Demo程序开始<a class="headerlink" href="#2demo" title="Permanent link">&para;</a></h1>
<h2 id="21-demo">2.1 Demo项目配置<a class="headerlink" href="#21-demo" title="Permanent link">&para;</a></h2>
<h3 id="mavenpomxml">maven的pom.xml配置文件<a class="headerlink" href="#mavenpomxml" title="Permanent link">&para;</a></h3>
<div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="nt">&lt;project</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0&quot;</span><span class="w"> </span><span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">         </span><span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="cm">&lt;!--        &lt;parent&gt;--&gt;</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">    </span><span class="cm">&lt;!--            &lt;groupId&gt;com.acanx&lt;/groupId&gt;--&gt;</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">    </span><span class="cm">&lt;!--            &lt;artifactId&gt;ACANX-JavaEE-Dependencies&lt;/artifactId&gt;--&gt;</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">    </span><span class="cm">&lt;!--            &lt;version&gt;0.0.1&lt;/version&gt;--&gt;</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">    </span><span class="cm">&lt;!--        &lt;/parent&gt;--&gt;</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">    </span><span class="nt">&lt;groupId&gt;</span>com.acanx<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">    </span><span class="nt">&lt;artifactId&gt;</span>JavaWeb-Spring<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">    </span><span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">    </span><span class="nt">&lt;packaging&gt;</span>war<span class="nt">&lt;/packaging&gt;</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">    </span><span class="nt">&lt;name&gt;</span>JavaWeb-Spring<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">    </span><span class="nt">&lt;description&gt;</span>JavaWeb-Spring<span class="w"> </span>project<span class="nt">&lt;/description&gt;</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">    </span><span class="nt">&lt;properties&gt;</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">        </span><span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">        </span><span class="nt">&lt;project.reporting.outputEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.reporting.outputEncoding&gt;</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">        </span><span class="nt">&lt;java.version&gt;</span>11<span class="nt">&lt;/java.version&gt;</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">        </span><span class="nt">&lt;spring.version&gt;</span>5.2.1.RELEASE<span class="nt">&lt;/spring.version&gt;</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">        </span><span class="cm">&lt;!-- log4j日志文件管理包版本 --&gt;</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="w">        </span><span class="nt">&lt;slf4j.version&gt;</span>2.0.0-alpha1<span class="nt">&lt;/slf4j.version&gt;</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="w">        </span><span class="nt">&lt;logback.version&gt;</span>1.3.0-alpha5<span class="nt">&lt;/logback.version&gt;</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="w">        </span><span class="cm">&lt;!-- log4j日志包版本号 --&gt;</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">        </span><span class="nt">&lt;log4j2.version&gt;</span>2.8.2<span class="nt">&lt;/log4j2.version&gt;</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="w">        </span><span class="nt">&lt;log4j.version&gt;</span>1.2.17<span class="nt">&lt;/log4j.version&gt;</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="w">        </span><span class="nt">&lt;junit.version&gt;</span>4.12<span class="nt">&lt;/junit.version&gt;</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="w">        </span><span class="nt">&lt;fastjson.version&gt;</span>1.2.62<span class="nt">&lt;/fastjson.version&gt;</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="w">        </span><span class="nt">&lt;maven-compiler-plugin.version&gt;</span>3.8.1<span class="nt">&lt;/maven-compiler-plugin.version&gt;</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="w">    </span><span class="nt">&lt;/properties&gt;</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="w">    </span><span class="nt">&lt;dependencies&gt;</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="w">        </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="w">            </span><span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="w">            </span><span class="nt">&lt;artifactId&gt;</span>spring-context<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="w">            </span><span class="nt">&lt;version&gt;</span>${spring.version}<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="w">        </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a><span class="w">        </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="w">            </span><span class="nt">&lt;groupId&gt;</span>ch.qos.logback<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a><span class="w">            </span><span class="nt">&lt;artifactId&gt;</span>logback-classic<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a><span class="w">            </span><span class="nt">&lt;version&gt;</span>${logback.version}<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a><span class="w">        </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a><span class="w">        </span><span class="cm">&lt;!-- 添加fastjson --&gt;</span>
</span><span id="__span-10-48"><a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a><span class="w">        </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-10-49"><a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a><span class="w">            </span><span class="nt">&lt;groupId&gt;</span>com.alibaba<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-10-50"><a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a><span class="w">            </span><span class="nt">&lt;artifactId&gt;</span>fastjson<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-10-51"><a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a><span class="w">            </span><span class="nt">&lt;version&gt;</span>${fastjson.version}<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-10-52"><a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a><span class="w">        </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-10-53"><a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a><span class="w">        </span><span class="cm">&lt;!--  单元测试--&gt;</span>
</span><span id="__span-10-54"><a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a><span class="w">        </span><span class="cm">&lt;!-- https://mvnrepository.com/artifact/junit/junit --&gt;</span>
</span><span id="__span-10-55"><a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a><span class="w">        </span><span class="nt">&lt;dependency&gt;</span>
</span><span id="__span-10-56"><a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a><span class="w">            </span><span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-10-57"><a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a><span class="w">            </span><span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-10-58"><a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a><span class="w">            </span><span class="nt">&lt;version&gt;</span>${junit.version}<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-10-59"><a id="__codelineno-10-59" name="__codelineno-10-59" href="#__codelineno-10-59"></a><span class="w">            </span><span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
</span><span id="__span-10-60"><a id="__codelineno-10-60" name="__codelineno-10-60" href="#__codelineno-10-60"></a><span class="w">        </span><span class="nt">&lt;/dependency&gt;</span>
</span><span id="__span-10-61"><a id="__codelineno-10-61" name="__codelineno-10-61" href="#__codelineno-10-61"></a>
</span><span id="__span-10-62"><a id="__codelineno-10-62" name="__codelineno-10-62" href="#__codelineno-10-62"></a><span class="w">    </span><span class="nt">&lt;/dependencies&gt;</span>
</span><span id="__span-10-63"><a id="__codelineno-10-63" name="__codelineno-10-63" href="#__codelineno-10-63"></a>
</span><span id="__span-10-64"><a id="__codelineno-10-64" name="__codelineno-10-64" href="#__codelineno-10-64"></a><span class="w">    </span><span class="nt">&lt;build&gt;</span>
</span><span id="__span-10-65"><a id="__codelineno-10-65" name="__codelineno-10-65" href="#__codelineno-10-65"></a><span class="w">        </span><span class="nt">&lt;plugins&gt;</span>
</span><span id="__span-10-66"><a id="__codelineno-10-66" name="__codelineno-10-66" href="#__codelineno-10-66"></a><span class="w">            </span><span class="nt">&lt;plugin&gt;</span>
</span><span id="__span-10-67"><a id="__codelineno-10-67" name="__codelineno-10-67" href="#__codelineno-10-67"></a><span class="w">                </span><span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
</span><span id="__span-10-68"><a id="__codelineno-10-68" name="__codelineno-10-68" href="#__codelineno-10-68"></a><span class="w">                </span><span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span><span id="__span-10-69"><a id="__codelineno-10-69" name="__codelineno-10-69" href="#__codelineno-10-69"></a><span class="w">                </span><span class="nt">&lt;version&gt;</span>${maven-compiler-plugin.version}<span class="nt">&lt;/version&gt;</span>
</span><span id="__span-10-70"><a id="__codelineno-10-70" name="__codelineno-10-70" href="#__codelineno-10-70"></a><span class="w">                </span><span class="nt">&lt;configuration&gt;</span>
</span><span id="__span-10-71"><a id="__codelineno-10-71" name="__codelineno-10-71" href="#__codelineno-10-71"></a><span class="w">                    </span><span class="nt">&lt;target&gt;</span>11<span class="nt">&lt;/target&gt;</span>
</span><span id="__span-10-72"><a id="__codelineno-10-72" name="__codelineno-10-72" href="#__codelineno-10-72"></a><span class="w">                    </span><span class="nt">&lt;source&gt;</span>11<span class="nt">&lt;/source&gt;</span>
</span><span id="__span-10-73"><a id="__codelineno-10-73" name="__codelineno-10-73" href="#__codelineno-10-73"></a><span class="w">                </span><span class="nt">&lt;/configuration&gt;</span>
</span><span id="__span-10-74"><a id="__codelineno-10-74" name="__codelineno-10-74" href="#__codelineno-10-74"></a><span class="w">            </span><span class="nt">&lt;/plugin&gt;</span>
</span><span id="__span-10-75"><a id="__codelineno-10-75" name="__codelineno-10-75" href="#__codelineno-10-75"></a><span class="w">        </span><span class="nt">&lt;/plugins&gt;</span>
</span><span id="__span-10-76"><a id="__codelineno-10-76" name="__codelineno-10-76" href="#__codelineno-10-76"></a><span class="w">    </span><span class="nt">&lt;/build&gt;</span>
</span><span id="__span-10-77"><a id="__codelineno-10-77" name="__codelineno-10-77" href="#__codelineno-10-77"></a><span class="nt">&lt;/project&gt;</span>
</span></code></pre></div>
<h2 id="22-demo">2.2 Demo程序<a class="headerlink" href="#22-demo" title="Permanent link">&para;</a></h2>
<h3 id="221">2.2.1启动类<a class="headerlink" href="#221" title="Permanent link">&para;</a></h3>
<ul>
<li>代码位置:com.acanx.spring.xml.CspringIocConfigByFileSystemXmlApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.acanx.spring.xml</span><span class="p">;</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">com.acanx.spring.bean.Car</span><span class="p">;</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.logging.Log</span><span class="p">;</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.logging.LogFactory</span><span class="p">;</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.Logger</span><span class="p">;</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.LoggerFactory</span><span class="p">;</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.ApplicationContext</span><span class="p">;</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.support.FileSystemXmlApplicationContext</span><span class="p">;</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="cm">/**</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="cm"> * ACANX-JavaWeb / com.acanx.spring.xml / SpringIocConfigByXmlFileInClassPath.java</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="cm"> * 文件由 ACANX 创建于 2019/7/30 - 13:39</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="cm"> * Description  SpringIocConfigByXmlFileInClassPath:</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="cm"> * 补充说明： 使用FileSystemXmlApplicationContext加载文件系统下的配置文件</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="cm"> *</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="cm"> * @author ACANX</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="cm"> * @version 0.0.1.0</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="cm"> * @date 2019/7/30  13:39</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="cm"> * @since 0.0.1-SNAPSHOT</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="cm"> */</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CspringIocConfigByFileSystemXmlApplicationContext</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">   </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">logger</span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">CspringIocConfigByFileSystemXmlApplicationContext</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="w">   </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w">  </span><span class="p">{</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;-------------------&quot;</span><span class="p">);</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;org.apache.commons.logging.LogFactory&quot;</span><span class="p">));</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="s">&quot;org.apache.commons.logging.Log&quot;</span><span class="p">));</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;-------------------&quot;</span><span class="p">);</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">location</span><span class="o">=</span><span class="s">&quot;D:\\ProgramCode\\JavaCode\\ACANX-JavaWeb\\JavaWeb-Spring\\ApplicationContextC.xml&quot;</span><span class="p">;</span>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a><span class="w">        </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">applicationContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileSystemXmlApplicationContext</span><span class="p">(</span><span class="n">location</span><span class="p">);</span>
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a><span class="w">        </span><span class="n">Car</span><span class="w"> </span><span class="n">car</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Car</span><span class="p">)</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="s">&quot;myCar&quot;</span><span class="p">);</span>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="n">car</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>
</span><span id="__span-11-33"><a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a><span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;Info :{}&quot;</span><span class="p">,</span><span class="n">logger</span><span class="p">.</span><span class="na">isInfoEnabled</span><span class="p">());</span>
</span><span id="__span-11-34"><a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a><span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">beanNames</span><span class="o">=</span><span class="n">applicationContext</span><span class="p">.</span><span class="na">getBeanDefinitionNames</span><span class="p">();</span>
</span><span id="__span-11-35"><a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">:</span><span class="n">beanNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-36"><a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a><span class="w">             </span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="n">beanName</span><span class="o">+</span><span class="s">&quot;::::: &quot;</span><span class="o">+</span><span class="n">applicationContext</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">).</span><span class="na">toString</span><span class="p">());</span>
</span><span id="__span-11-37"><a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-11-38"><a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-39"><a id="__codelineno-11-39" name="__codelineno-11-39" href="#__codelineno-11-39"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="222bena">2.2.2使用到的Bena对象<a class="headerlink" href="#222bena" title="Permanent link">&para;</a></h3>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">package</span><span class="w"> </span><span class="nn">com.acanx.spring.bean</span><span class="p">;</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Car</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="kd">private</span><span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">;</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span><span class="kd">private</span><span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">price</span><span class="p">;</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">    </span><span class="c1">// get set 默认构造方法已省略</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="223-springcontextxmlapplicationcontextcxml">2.2.3 springContext的xml文件ApplicationContextC.xml<a class="headerlink" href="#223-springcontextxmlapplicationcontextcxml" title="Permanent link">&para;</a></h3>
<div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="nt">&lt;beans</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.springframework.org/schema/beans&quot;</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">       </span><span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">       </span><span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">    </span><span class="nt">&lt;bean</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;myCar&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;com.acanx.spring.bean.Car&quot;</span><span class="w"> </span><span class="nt">&gt;</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;QQAI&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="w">        </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;price&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;2222&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="w">    </span><span class="nt">&lt;/bean&gt;</span>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="nt">&lt;/beans&gt;</span>
</span></code></pre></div>
<h3 id="224-logbackxmlresources">2.2.4 配置日志 logback.xml（resources文件夹下）<a class="headerlink" href="#224-logbackxmlresources" title="Permanent link">&para;</a></h3>
<div class="language-xml highlight"><span class="filename">XML</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="nt">&lt;configuration</span><span class="w"> </span><span class="na">scan=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">scanPeriod=</span><span class="s">&quot;60 seconds&quot;</span><span class="w"> </span><span class="na">debug=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;LOG_PATH&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;.log&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;APP_NAME&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;IOCDemo&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">    </span><span class="cm">&lt;!--设置系统日志目录--&gt;</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;APP_DIR&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;app-IOCDemo&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;CONSOLE_LOG_PATTERN&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;[CLP]${CONSOLE_LOG_PATTERN:-%clr(%d{${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(%-15.15method){cyan} %clr([%4.4line{4}]){magenta} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;FILE_LOG_PATTERN&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;${FILE_LOG_PATTERN:-%d{${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}} ${LOG_LEVEL_PATTERN:-%5p} ${PID:- } --- [%t] %-40.40logger{39} : %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">    </span><span class="nt">&lt;property</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;CONSOLE_LOGBACK_PATTERN&quot;</span><span class="w"> </span><span class="na">value=</span><span class="s">&quot;[控制台] %d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level | %-80logger # %-40M [%4line] : %msg%n&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="w">    </span><span class="nt">&lt;contextName&gt;</span>logback<span class="nt">&lt;/contextName&gt;</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="w">    </span><span class="cm">&lt;!--输出到控制台--&gt;</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="w">    </span><span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;CONSOLE&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="w">        </span><span class="nt">&lt;filter</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="w">            </span><span class="nt">&lt;level&gt;</span>TRACE<span class="nt">&lt;/level&gt;</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="w">        </span><span class="nt">&lt;/filter&gt;</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="w">        </span><span class="nt">&lt;layout</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.PatternLayout&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="w">            </span><span class="nt">&lt;Pattern&gt;</span>${CONSOLE_LOGBACK_PATTERN}<span class="nt">&lt;/Pattern&gt;</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="w">        </span><span class="nt">&lt;/layout&gt;</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="w">        </span><span class="nt">&lt;encoder&gt;</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="w">            </span><span class="cm">&lt;!--  文件名 [%file]--&gt;</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="w">            </span><span class="nt">&lt;pattern&gt;</span>${CONSOLE_LOGBACK_PATTERN}<span class="nt">&lt;/pattern&gt;</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="w">        </span><span class="nt">&lt;/encoder&gt;</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="w">    </span><span class="nt">&lt;/appender&gt;</span>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="w">    </span><span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;ERROR_FILE&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="w">        </span><span class="nt">&lt;filter</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="w">            </span><span class="nt">&lt;level&gt;</span>ERROR<span class="nt">&lt;/level&gt;</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a><span class="w">            </span><span class="nt">&lt;onMatch&gt;</span>ACCEPT<span class="nt">&lt;/onMatch&gt;</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="w">            </span><span class="nt">&lt;onMismatch&gt;</span>DENY<span class="nt">&lt;/onMismatch&gt;</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a><span class="w">        </span><span class="nt">&lt;/filter&gt;</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a><span class="w">        </span><span class="nt">&lt;File&gt;</span>.log/ACANX-JavaWeb/LOG-ERROR.log<span class="nt">&lt;/File&gt;</span>
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a><span class="w">        </span><span class="nt">&lt;rollingPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a><span class="w">            </span><span class="nt">&lt;fileNamePattern&gt;</span>.log/server-error-%d{yyyyMMdd}.log.%i
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a><span class="w">            </span><span class="nt">&lt;/fileNamePattern&gt;</span>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a><span class="w">            </span><span class="nt">&lt;timeBasedFileNamingAndTriggeringPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a><span class="w">                </span><span class="nt">&lt;maxFileSize&gt;</span>5MB<span class="nt">&lt;/maxFileSize&gt;</span>
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a><span class="w">            </span><span class="nt">&lt;/timeBasedFileNamingAndTriggeringPolicy&gt;</span>
</span><span id="__span-14-42"><a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a><span class="w">            </span><span class="nt">&lt;maxHistory&gt;</span>2<span class="nt">&lt;/maxHistory&gt;</span>
</span><span id="__span-14-43"><a id="__codelineno-14-43" name="__codelineno-14-43" href="#__codelineno-14-43"></a><span class="w">        </span><span class="nt">&lt;/rollingPolicy&gt;</span>
</span><span id="__span-14-44"><a id="__codelineno-14-44" name="__codelineno-14-44" href="#__codelineno-14-44"></a><span class="w">        </span><span class="nt">&lt;layout</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.PatternLayout&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-45"><a id="__codelineno-14-45" name="__codelineno-14-45" href="#__codelineno-14-45"></a><span class="w">            </span><span class="nt">&lt;Pattern&gt;</span>${CONSOLE_LOGBACK_PATTERN}<span class="nt">&lt;/Pattern&gt;</span>
</span><span id="__span-14-46"><a id="__codelineno-14-46" name="__codelineno-14-46" href="#__codelineno-14-46"></a><span class="w">        </span><span class="nt">&lt;/layout&gt;</span>
</span><span id="__span-14-47"><a id="__codelineno-14-47" name="__codelineno-14-47" href="#__codelineno-14-47"></a><span class="w">    </span><span class="nt">&lt;/appender&gt;</span>
</span><span id="__span-14-48"><a id="__codelineno-14-48" name="__codelineno-14-48" href="#__codelineno-14-48"></a>
</span><span id="__span-14-49"><a id="__codelineno-14-49" name="__codelineno-14-49" href="#__codelineno-14-49"></a>
</span><span id="__span-14-50"><a id="__codelineno-14-50" name="__codelineno-14-50" href="#__codelineno-14-50"></a><span class="w">    </span><span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;WARN_FILE&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-51"><a id="__codelineno-14-51" name="__codelineno-14-51" href="#__codelineno-14-51"></a><span class="w">        </span><span class="nt">&lt;filter</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-52"><a id="__codelineno-14-52" name="__codelineno-14-52" href="#__codelineno-14-52"></a><span class="w">            </span><span class="nt">&lt;level&gt;</span>WARN<span class="nt">&lt;/level&gt;</span>
</span><span id="__span-14-53"><a id="__codelineno-14-53" name="__codelineno-14-53" href="#__codelineno-14-53"></a><span class="w">            </span><span class="nt">&lt;onMatch&gt;</span>ACCEPT<span class="nt">&lt;/onMatch&gt;</span>
</span><span id="__span-14-54"><a id="__codelineno-14-54" name="__codelineno-14-54" href="#__codelineno-14-54"></a><span class="w">            </span><span class="nt">&lt;onMismatch&gt;</span>DENY<span class="nt">&lt;/onMismatch&gt;</span>
</span><span id="__span-14-55"><a id="__codelineno-14-55" name="__codelineno-14-55" href="#__codelineno-14-55"></a><span class="w">        </span><span class="nt">&lt;/filter&gt;</span>
</span><span id="__span-14-56"><a id="__codelineno-14-56" name="__codelineno-14-56" href="#__codelineno-14-56"></a><span class="w">        </span><span class="nt">&lt;File&gt;</span>.log/ACANX-JavaWeb/LOG-WARN.log<span class="nt">&lt;/File&gt;</span>
</span><span id="__span-14-57"><a id="__codelineno-14-57" name="__codelineno-14-57" href="#__codelineno-14-57"></a><span class="w">        </span><span class="nt">&lt;rollingPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-58"><a id="__codelineno-14-58" name="__codelineno-14-58" href="#__codelineno-14-58"></a><span class="w">            </span><span class="nt">&lt;fileNamePattern&gt;</span>.log/ACANX-JavaWeb/server-WARN-%d{yyyyMMdd}.log.%i
</span><span id="__span-14-59"><a id="__codelineno-14-59" name="__codelineno-14-59" href="#__codelineno-14-59"></a><span class="w">            </span><span class="nt">&lt;/fileNamePattern&gt;</span>
</span><span id="__span-14-60"><a id="__codelineno-14-60" name="__codelineno-14-60" href="#__codelineno-14-60"></a><span class="w">            </span><span class="nt">&lt;timeBasedFileNamingAndTriggeringPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-61"><a id="__codelineno-14-61" name="__codelineno-14-61" href="#__codelineno-14-61"></a><span class="w">                </span><span class="nt">&lt;maxFileSize&gt;</span>5MB<span class="nt">&lt;/maxFileSize&gt;</span>
</span><span id="__span-14-62"><a id="__codelineno-14-62" name="__codelineno-14-62" href="#__codelineno-14-62"></a><span class="w">            </span><span class="nt">&lt;/timeBasedFileNamingAndTriggeringPolicy&gt;</span>
</span><span id="__span-14-63"><a id="__codelineno-14-63" name="__codelineno-14-63" href="#__codelineno-14-63"></a><span class="w">            </span><span class="nt">&lt;maxHistory&gt;</span>2<span class="nt">&lt;/maxHistory&gt;</span>
</span><span id="__span-14-64"><a id="__codelineno-14-64" name="__codelineno-14-64" href="#__codelineno-14-64"></a><span class="w">        </span><span class="nt">&lt;/rollingPolicy&gt;</span>
</span><span id="__span-14-65"><a id="__codelineno-14-65" name="__codelineno-14-65" href="#__codelineno-14-65"></a><span class="w">        </span><span class="nt">&lt;layout</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.PatternLayout&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-66"><a id="__codelineno-14-66" name="__codelineno-14-66" href="#__codelineno-14-66"></a><span class="w">            </span><span class="nt">&lt;Pattern&gt;</span>${CONSOLE_LOGBACK_PATTERN}<span class="nt">&lt;/Pattern&gt;</span>
</span><span id="__span-14-67"><a id="__codelineno-14-67" name="__codelineno-14-67" href="#__codelineno-14-67"></a><span class="w">        </span><span class="nt">&lt;/layout&gt;</span>
</span><span id="__span-14-68"><a id="__codelineno-14-68" name="__codelineno-14-68" href="#__codelineno-14-68"></a><span class="w">    </span><span class="nt">&lt;/appender&gt;</span>
</span><span id="__span-14-69"><a id="__codelineno-14-69" name="__codelineno-14-69" href="#__codelineno-14-69"></a>
</span><span id="__span-14-70"><a id="__codelineno-14-70" name="__codelineno-14-70" href="#__codelineno-14-70"></a><span class="w">    </span><span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;INFO_FILE&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-71"><a id="__codelineno-14-71" name="__codelineno-14-71" href="#__codelineno-14-71"></a><span class="w">        </span><span class="nt">&lt;File&gt;</span>.log/ACANX-JavaWeb/LOG-INFO.log<span class="nt">&lt;/File&gt;</span>
</span><span id="__span-14-72"><a id="__codelineno-14-72" name="__codelineno-14-72" href="#__codelineno-14-72"></a><span class="w">        </span><span class="nt">&lt;filter</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-73"><a id="__codelineno-14-73" name="__codelineno-14-73" href="#__codelineno-14-73"></a><span class="w">            </span><span class="nt">&lt;level&gt;</span>INFO<span class="nt">&lt;/level&gt;</span>
</span><span id="__span-14-74"><a id="__codelineno-14-74" name="__codelineno-14-74" href="#__codelineno-14-74"></a><span class="w">            </span><span class="nt">&lt;onMatch&gt;</span>ACCEPT<span class="nt">&lt;/onMatch&gt;</span>
</span><span id="__span-14-75"><a id="__codelineno-14-75" name="__codelineno-14-75" href="#__codelineno-14-75"></a><span class="w">            </span><span class="nt">&lt;onMismatch&gt;</span>DENY<span class="nt">&lt;/onMismatch&gt;</span>
</span><span id="__span-14-76"><a id="__codelineno-14-76" name="__codelineno-14-76" href="#__codelineno-14-76"></a><span class="w">        </span><span class="nt">&lt;/filter&gt;</span>
</span><span id="__span-14-77"><a id="__codelineno-14-77" name="__codelineno-14-77" href="#__codelineno-14-77"></a><span class="w">        </span><span class="nt">&lt;rollingPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-78"><a id="__codelineno-14-78" name="__codelineno-14-78" href="#__codelineno-14-78"></a><span class="w">            </span><span class="nt">&lt;fileNamePattern&gt;</span>.log/ACANX-JavaWeb/server-info-%d{yyyyMMdd}.log.%i<span class="nt">&lt;/fileNamePattern&gt;</span>
</span><span id="__span-14-79"><a id="__codelineno-14-79" name="__codelineno-14-79" href="#__codelineno-14-79"></a><span class="w">            </span><span class="nt">&lt;timeBasedFileNamingAndTriggeringPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-80"><a id="__codelineno-14-80" name="__codelineno-14-80" href="#__codelineno-14-80"></a><span class="w">                </span><span class="nt">&lt;maxFileSize&gt;</span>5MB<span class="nt">&lt;/maxFileSize&gt;</span>
</span><span id="__span-14-81"><a id="__codelineno-14-81" name="__codelineno-14-81" href="#__codelineno-14-81"></a><span class="w">            </span><span class="nt">&lt;/timeBasedFileNamingAndTriggeringPolicy&gt;</span>
</span><span id="__span-14-82"><a id="__codelineno-14-82" name="__codelineno-14-82" href="#__codelineno-14-82"></a><span class="w">            </span><span class="nt">&lt;maxHistory&gt;</span>2<span class="nt">&lt;/maxHistory&gt;</span>
</span><span id="__span-14-83"><a id="__codelineno-14-83" name="__codelineno-14-83" href="#__codelineno-14-83"></a><span class="w">        </span><span class="nt">&lt;/rollingPolicy&gt;</span>
</span><span id="__span-14-84"><a id="__codelineno-14-84" name="__codelineno-14-84" href="#__codelineno-14-84"></a><span class="w">        </span><span class="nt">&lt;layout</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.PatternLayout&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-85"><a id="__codelineno-14-85" name="__codelineno-14-85" href="#__codelineno-14-85"></a><span class="w">            </span><span class="nt">&lt;Pattern&gt;</span>${CONSOLE_LOGBACK_PATTERN}<span class="nt">&lt;/Pattern&gt;</span>
</span><span id="__span-14-86"><a id="__codelineno-14-86" name="__codelineno-14-86" href="#__codelineno-14-86"></a><span class="w">        </span><span class="nt">&lt;/layout&gt;</span>
</span><span id="__span-14-87"><a id="__codelineno-14-87" name="__codelineno-14-87" href="#__codelineno-14-87"></a><span class="w">        </span><span class="nt">&lt;encoder</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-88"><a id="__codelineno-14-88" name="__codelineno-14-88" href="#__codelineno-14-88"></a><span class="w">            </span><span class="cm">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符--&gt;</span>
</span><span id="__span-14-89"><a id="__codelineno-14-89" name="__codelineno-14-89" href="#__codelineno-14-89"></a><span class="w">            </span><span class="nt">&lt;pattern&gt;</span>${CONSOLE_LOGBACK_PATTERN}<span class="nt">&lt;/pattern&gt;</span>
</span><span id="__span-14-90"><a id="__codelineno-14-90" name="__codelineno-14-90" href="#__codelineno-14-90"></a><span class="w">        </span><span class="nt">&lt;/encoder&gt;</span>
</span><span id="__span-14-91"><a id="__codelineno-14-91" name="__codelineno-14-91" href="#__codelineno-14-91"></a><span class="w">    </span><span class="nt">&lt;/appender&gt;</span>
</span><span id="__span-14-92"><a id="__codelineno-14-92" name="__codelineno-14-92" href="#__codelineno-14-92"></a>
</span><span id="__span-14-93"><a id="__codelineno-14-93" name="__codelineno-14-93" href="#__codelineno-14-93"></a><span class="w">    </span><span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;TRACE_FILE&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-94"><a id="__codelineno-14-94" name="__codelineno-14-94" href="#__codelineno-14-94"></a><span class="w">        </span><span class="nt">&lt;filter</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-95"><a id="__codelineno-14-95" name="__codelineno-14-95" href="#__codelineno-14-95"></a><span class="w">            </span><span class="nt">&lt;level&gt;</span>TRACE<span class="nt">&lt;/level&gt;</span>
</span><span id="__span-14-96"><a id="__codelineno-14-96" name="__codelineno-14-96" href="#__codelineno-14-96"></a><span class="w">            </span><span class="nt">&lt;onMatch&gt;</span>ACCEPT<span class="nt">&lt;/onMatch&gt;</span>
</span><span id="__span-14-97"><a id="__codelineno-14-97" name="__codelineno-14-97" href="#__codelineno-14-97"></a><span class="w">            </span><span class="nt">&lt;onMismatch&gt;</span>DENY<span class="nt">&lt;/onMismatch&gt;</span>
</span><span id="__span-14-98"><a id="__codelineno-14-98" name="__codelineno-14-98" href="#__codelineno-14-98"></a><span class="w">        </span><span class="nt">&lt;/filter&gt;</span>
</span><span id="__span-14-99"><a id="__codelineno-14-99" name="__codelineno-14-99" href="#__codelineno-14-99"></a><span class="w">        </span><span class="nt">&lt;File&gt;</span>.log/ACANX-JavaWeb/LOG-TRACE.log<span class="nt">&lt;/File&gt;</span>
</span><span id="__span-14-100"><a id="__codelineno-14-100" name="__codelineno-14-100" href="#__codelineno-14-100"></a><span class="w">        </span><span class="nt">&lt;rollingPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-101"><a id="__codelineno-14-101" name="__codelineno-14-101" href="#__codelineno-14-101"></a><span class="w">            </span><span class="nt">&lt;fileNamePattern&gt;</span>.log/ACANX-JavaWeb/server-TRACE-%d{yyyyMMdd}.log.%i
</span><span id="__span-14-102"><a id="__codelineno-14-102" name="__codelineno-14-102" href="#__codelineno-14-102"></a><span class="w">            </span><span class="nt">&lt;/fileNamePattern&gt;</span>
</span><span id="__span-14-103"><a id="__codelineno-14-103" name="__codelineno-14-103" href="#__codelineno-14-103"></a><span class="w">            </span><span class="nt">&lt;timeBasedFileNamingAndTriggeringPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-104"><a id="__codelineno-14-104" name="__codelineno-14-104" href="#__codelineno-14-104"></a><span class="w">                </span><span class="nt">&lt;maxFileSize&gt;</span>5MB<span class="nt">&lt;/maxFileSize&gt;</span>
</span><span id="__span-14-105"><a id="__codelineno-14-105" name="__codelineno-14-105" href="#__codelineno-14-105"></a><span class="w">            </span><span class="nt">&lt;/timeBasedFileNamingAndTriggeringPolicy&gt;</span>
</span><span id="__span-14-106"><a id="__codelineno-14-106" name="__codelineno-14-106" href="#__codelineno-14-106"></a><span class="w">            </span><span class="nt">&lt;maxHistory&gt;</span>2<span class="nt">&lt;/maxHistory&gt;</span>
</span><span id="__span-14-107"><a id="__codelineno-14-107" name="__codelineno-14-107" href="#__codelineno-14-107"></a><span class="w">        </span><span class="nt">&lt;/rollingPolicy&gt;</span>
</span><span id="__span-14-108"><a id="__codelineno-14-108" name="__codelineno-14-108" href="#__codelineno-14-108"></a><span class="w">        </span><span class="nt">&lt;layout</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.PatternLayout&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-109"><a id="__codelineno-14-109" name="__codelineno-14-109" href="#__codelineno-14-109"></a><span class="w">            </span><span class="nt">&lt;Pattern&gt;</span>${CONSOLE_LOGBACK_PATTERN}<span class="nt">&lt;/Pattern&gt;</span>
</span><span id="__span-14-110"><a id="__codelineno-14-110" name="__codelineno-14-110" href="#__codelineno-14-110"></a><span class="w">        </span><span class="nt">&lt;/layout&gt;</span>
</span><span id="__span-14-111"><a id="__codelineno-14-111" name="__codelineno-14-111" href="#__codelineno-14-111"></a><span class="w">    </span><span class="nt">&lt;/appender&gt;</span>
</span><span id="__span-14-112"><a id="__codelineno-14-112" name="__codelineno-14-112" href="#__codelineno-14-112"></a>
</span><span id="__span-14-113"><a id="__codelineno-14-113" name="__codelineno-14-113" href="#__codelineno-14-113"></a><span class="w">    </span><span class="nt">&lt;appender</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;FULL_LEVEL_FILE&quot;</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-114"><a id="__codelineno-14-114" name="__codelineno-14-114" href="#__codelineno-14-114"></a><span class="w">        </span><span class="nt">&lt;File&gt;</span>.log/ACANX-JavaWeb/LOG-FULL.log<span class="nt">&lt;/File&gt;</span>
</span><span id="__span-14-115"><a id="__codelineno-14-115" name="__codelineno-14-115" href="#__codelineno-14-115"></a><span class="w">        </span><span class="nt">&lt;filter</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-116"><a id="__codelineno-14-116" name="__codelineno-14-116" href="#__codelineno-14-116"></a><span class="w">            </span><span class="nt">&lt;level&gt;</span>TRACE<span class="nt">&lt;/level&gt;</span>
</span><span id="__span-14-117"><a id="__codelineno-14-117" name="__codelineno-14-117" href="#__codelineno-14-117"></a><span class="w">        </span><span class="nt">&lt;/filter&gt;</span>
</span><span id="__span-14-118"><a id="__codelineno-14-118" name="__codelineno-14-118" href="#__codelineno-14-118"></a><span class="w">        </span><span class="nt">&lt;encoder&gt;</span>
</span><span id="__span-14-119"><a id="__codelineno-14-119" name="__codelineno-14-119" href="#__codelineno-14-119"></a><span class="w">            </span><span class="cm">&lt;!--  文件名 [%file] --&gt;</span>
</span><span id="__span-14-120"><a id="__codelineno-14-120" name="__codelineno-14-120" href="#__codelineno-14-120"></a><span class="w">            </span><span class="nt">&lt;pattern&gt;</span>${CONSOLE_LOGBACK_PATTERN}<span class="nt">&lt;/pattern&gt;</span>
</span><span id="__span-14-121"><a id="__codelineno-14-121" name="__codelineno-14-121" href="#__codelineno-14-121"></a><span class="w">        </span><span class="nt">&lt;/encoder&gt;</span>
</span><span id="__span-14-122"><a id="__codelineno-14-122" name="__codelineno-14-122" href="#__codelineno-14-122"></a><span class="w">        </span><span class="nt">&lt;rollingPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-123"><a id="__codelineno-14-123" name="__codelineno-14-123" href="#__codelineno-14-123"></a><span class="w">            </span><span class="nt">&lt;fileNamePattern&gt;</span>.log/ACANX-JavaWeb/LOG-FULL-%d{yyyyMMdd}.log.%i<span class="nt">&lt;/fileNamePattern&gt;</span>
</span><span id="__span-14-124"><a id="__codelineno-14-124" name="__codelineno-14-124" href="#__codelineno-14-124"></a><span class="w">            </span><span class="nt">&lt;timeBasedFileNamingAndTriggeringPolicy</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-125"><a id="__codelineno-14-125" name="__codelineno-14-125" href="#__codelineno-14-125"></a><span class="w">                </span><span class="nt">&lt;maxFileSize&gt;</span>5MB<span class="nt">&lt;/maxFileSize&gt;</span>
</span><span id="__span-14-126"><a id="__codelineno-14-126" name="__codelineno-14-126" href="#__codelineno-14-126"></a><span class="w">            </span><span class="nt">&lt;/timeBasedFileNamingAndTriggeringPolicy&gt;</span>
</span><span id="__span-14-127"><a id="__codelineno-14-127" name="__codelineno-14-127" href="#__codelineno-14-127"></a><span class="w">            </span><span class="nt">&lt;maxHistory&gt;</span>2<span class="nt">&lt;/maxHistory&gt;</span>
</span><span id="__span-14-128"><a id="__codelineno-14-128" name="__codelineno-14-128" href="#__codelineno-14-128"></a><span class="w">        </span><span class="nt">&lt;/rollingPolicy&gt;</span>
</span><span id="__span-14-129"><a id="__codelineno-14-129" name="__codelineno-14-129" href="#__codelineno-14-129"></a><span class="w">        </span><span class="nt">&lt;layout</span><span class="w"> </span><span class="na">class=</span><span class="s">&quot;ch.qos.logback.classic.PatternLayout&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-130"><a id="__codelineno-14-130" name="__codelineno-14-130" href="#__codelineno-14-130"></a><span class="w">            </span><span class="nt">&lt;Pattern&gt;</span>${CONSOLE_LOGBACK_PATTERN}<span class="nt">&lt;/Pattern&gt;</span>
</span><span id="__span-14-131"><a id="__codelineno-14-131" name="__codelineno-14-131" href="#__codelineno-14-131"></a><span class="w">        </span><span class="nt">&lt;/layout&gt;</span>
</span><span id="__span-14-132"><a id="__codelineno-14-132" name="__codelineno-14-132" href="#__codelineno-14-132"></a><span class="w">    </span><span class="nt">&lt;/appender&gt;</span>
</span><span id="__span-14-133"><a id="__codelineno-14-133" name="__codelineno-14-133" href="#__codelineno-14-133"></a>
</span><span id="__span-14-134"><a id="__codelineno-14-134" name="__codelineno-14-134" href="#__codelineno-14-134"></a><span class="w">    </span><span class="nt">&lt;root</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;TRACE&quot;</span><span class="w"> </span><span class="na">additivity=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-14-135"><a id="__codelineno-14-135" name="__codelineno-14-135" href="#__codelineno-14-135"></a><span class="w">        </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;CONSOLE&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-136"><a id="__codelineno-14-136" name="__codelineno-14-136" href="#__codelineno-14-136"></a><span class="w">        </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;WARN_FILE&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-137"><a id="__codelineno-14-137" name="__codelineno-14-137" href="#__codelineno-14-137"></a><span class="w">        </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;ERROR_FILE&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-138"><a id="__codelineno-14-138" name="__codelineno-14-138" href="#__codelineno-14-138"></a><span class="w">        </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;INFO_FILE&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-139"><a id="__codelineno-14-139" name="__codelineno-14-139" href="#__codelineno-14-139"></a><span class="w">        </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;TRACE_FILE&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-140"><a id="__codelineno-14-140" name="__codelineno-14-140" href="#__codelineno-14-140"></a><span class="w">        </span><span class="nt">&lt;appender-ref</span><span class="w"> </span><span class="na">ref=</span><span class="s">&quot;FULL_LEVEL_FILE&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-141"><a id="__codelineno-14-141" name="__codelineno-14-141" href="#__codelineno-14-141"></a><span class="w">    </span><span class="nt">&lt;/root&gt;</span>
</span><span id="__span-14-142"><a id="__codelineno-14-142" name="__codelineno-14-142" href="#__codelineno-14-142"></a>
</span><span id="__span-14-143"><a id="__codelineno-14-143" name="__codelineno-14-143" href="#__codelineno-14-143"></a><span class="w">    </span><span class="cm">&lt;!-- TRACE, DEBUG, INFO, WARN, ERROR, ALL 和 OFF --&gt;</span>
</span><span id="__span-14-144"><a id="__codelineno-14-144" name="__codelineno-14-144" href="#__codelineno-14-144"></a><span class="w">    </span><span class="nt">&lt;logger</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;org&quot;</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;TRACE&quot;</span><span class="w"> </span><span class="na">additivity=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;&lt;/logger&gt;</span>
</span><span id="__span-14-145"><a id="__codelineno-14-145" name="__codelineno-14-145" href="#__codelineno-14-145"></a><span class="w">    </span><span class="nt">&lt;logger</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;org.springframework.context&quot;</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;TRACE&quot;</span><span class="w"> </span><span class="na">additivity=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;&lt;/logger&gt;</span>
</span><span id="__span-14-146"><a id="__codelineno-14-146" name="__codelineno-14-146" href="#__codelineno-14-146"></a><span class="w">    </span><span class="nt">&lt;logger</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;org.apache&quot;</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;TRACE&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-147"><a id="__codelineno-14-147" name="__codelineno-14-147" href="#__codelineno-14-147"></a><span class="w">    </span><span class="nt">&lt;logger</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;com.alibaba&quot;</span><span class="w"> </span><span class="na">level=</span><span class="s">&quot;TRACE&quot;</span><span class="nt">/&gt;</span>
</span><span id="__span-14-148"><a id="__codelineno-14-148" name="__codelineno-14-148" href="#__codelineno-14-148"></a><span class="w">    </span><span class="cm">&lt;!-- 如果这里设置了additivity=true 代码打印信息向上传递,将打印信息传递到root ，并且自己的appender-ref 也会打印，这样就是打印了俩次日志--&gt;</span>
</span><span id="__span-14-149"><a id="__codelineno-14-149" name="__codelineno-14-149" href="#__codelineno-14-149"></a><span class="nt">&lt;/configuration&gt;</span>
</span></code></pre></div>
<h1 id="3spring-ioc">3.Spring IOC容器的创建<a class="headerlink" href="#3spring-ioc" title="Permanent link">&para;</a></h1>
<h2 id="31-filesystemxmlapplicationcontextabstractxmlapplicationcontext">3.1 进入FileSystemXmlApplicationContext（AbstractXmlApplicationContext抽象类的具体实现类）<a class="headerlink" href="#31-filesystemxmlapplicationcontextabstractxmlapplicationcontext" title="Permanent link">&para;</a></h2>
<ul>
<li>代码位置: org.springframework.context.support.FileSystemXmlApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">FileSystemXmlApplicationContext</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">configLocation</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">        </span><span class="k">this</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="p">{</span><span class="n">configLocation</span><span class="p">},</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span><span class="c1">// 上面的this 来到下面的重载构造方法</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">FileSystemXmlApplicationContext</span><span class="p">(</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">            </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">configLocations</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">refresh</span><span class="p">,</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">parent</span><span class="p">)</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span><span class="w">  </span><span class="c1">// 初始化父容器AbstractApplicationContext</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="w">        </span><span class="n">setConfigLocations</span><span class="p">(</span><span class="n">configLocations</span><span class="p">);</span><span class="w"> </span><span class="c1">// 设置资源文件的位置</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">refresh</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="w">            </span><span class="n">refresh</span><span class="p">();</span><span class="c1">// 核心方法，具体定义在超类AbstractApplicationContext（抽象类）中，是一个模板方法</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h2 id="32-abstractapplicationcontext">3.2 初始化父容器AbstractApplicationContext<a class="headerlink" href="#32-abstractapplicationcontext" title="Permanent link">&para;</a></h2>
<h3 id="321-abstractxmlapplicationcontextfilesystemxmlapplicationcontext">3.2.1 AbstractXmlApplicationContext抽象类（FileSystemXmlApplicationContext的父类）<a class="headerlink" href="#321-abstractxmlapplicationcontextfilesystemxmlapplicationcontext" title="Permanent link">&para;</a></h3>
<ul>
<li>代码位置: org.springframework.context.support.AbstractXmlApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">AbstractXmlApplicationContext</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="322-abstractrefreshableconfigapplicationcontext-abstractxmlapplicationcontext">3.2.2 AbstractRefreshableConfigApplicationContext抽象类（ AbstractXmlApplicationContext的父类）<a class="headerlink" href="#322-abstractrefreshableconfigapplicationcontext-abstractxmlapplicationcontext" title="Permanent link">&para;</a></h3>
<ul>
<li>代码位置:org.springframework.context.support.AbstractRefreshableConfigApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">AbstractRefreshableConfigApplicationContext</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="323-abstractrefreshableapplicationcontext">3.2.3 AbstractRefreshableApplicationContext抽象类<a class="headerlink" href="#323-abstractrefreshableapplicationcontext" title="Permanent link">&para;</a></h3>
<ul>
<li>代码位置:org.springframework.context.support.AbstractRefreshableApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">AbstractRefreshableApplicationContext</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="324-abstractapplicationcontext">3.2.4 AbstractApplicationContext抽象类<a class="headerlink" href="#324-abstractapplicationcontext" title="Permanent link">&para;</a></h3>
<ul>
<li>代码位置:org.springframework.context.support.AbstractApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">AbstractApplicationContext</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">        </span><span class="k">this</span><span class="p">();</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">        </span><span class="n">setParent</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">    </span><span class="c1">//上面对应的this()方法 </span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">AbstractApplicationContext</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">resourcePatternResolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getResourcePatternResolver</span><span class="p">();</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">    </span><span class="c1">//上面对应的 getResourcePatternResolver()方法</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">ResourcePatternResolver</span><span class="w"> </span><span class="nf">getResourcePatternResolver</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PathMatchingResourcePatternResolver</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="w">    </span><span class="c1">// this()之后的setParent(parent);方法</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="w">    </span><span class="nd">@Override</span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setParent</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">ApplicationContext</span><span class="w"> </span><span class="n">parent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">;</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a><span class="w">            </span><span class="n">Environment</span><span class="w"> </span><span class="n">parentEnvironment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="na">getEnvironment</span><span class="p">();</span>
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parentEnvironment</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ConfigurableEnvironment</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a><span class="w">                </span><span class="n">getEnvironment</span><span class="p">().</span><span class="na">merge</span><span class="p">((</span><span class="n">ConfigurableEnvironment</span><span class="p">)</span><span class="w"> </span><span class="n">parentEnvironment</span><span class="p">);</span>
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24" href="#__codelineno-19-24"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-19-25"><a id="__codelineno-19-25" name="__codelineno-19-25" href="#__codelineno-19-25"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-19-26"><a id="__codelineno-19-26" name="__codelineno-19-26" href="#__codelineno-19-26"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h2 id="35-pathmatchingresourcepatternresolver">3.5 PathMatchingResourcePatternResolver类<a class="headerlink" href="#35-pathmatchingresourcepatternresolver" title="Permanent link">&para;</a></h2>
<ul>
<li>PathMatchingResourcePatternResolver(this)对应的构造方法</li>
<li>代码位置:org.springframework.core.io.support.PathMatchingResourcePatternResolver.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">PathMatchingResourcePatternResolver</span><span class="p">(</span><span class="n">ResourceLoader</span><span class="w"> </span><span class="n">resourceLoader</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">        </span><span class="n">Assert</span><span class="p">.</span><span class="na">notNull</span><span class="p">(</span><span class="n">resourceLoader</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ResourceLoader must not be null&quot;</span><span class="p">);</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">resourceLoader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resourceLoader</span><span class="p">;</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h1 id="4setconfiglocationsstring-locations">4.setConfigLocations(String... locations) 方法<a class="headerlink" href="#4setconfiglocationsstring-locations" title="Permanent link">&para;</a></h1>
<ul>
<li>设置资源文件的位置</li>
</ul>
<h2 id="41-abstractrefreshableconfigapplicationcontextsetconfiglocationsnullable-string-locations">4.1 AbstractRefreshableConfigApplicationContext.setConfigLocations(@Nullable String... locations) 方法<a class="headerlink" href="#41-abstractrefreshableconfigapplicationcontextsetconfiglocationsnullable-string-locations" title="Permanent link">&para;</a></h2>
<ul>
<li>代码位置:org.springframework.context.support.AbstractRefreshableConfigApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setConfigLocations</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="p">...</span><span class="w"> </span><span class="n">locations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">locations</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">            </span><span class="n">Assert</span><span class="p">.</span><span class="na">noNullElements</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Config locations must not be null&quot;</span><span class="p">);</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">configLocations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">String</span><span class="o">[</span><span class="n">locations</span><span class="p">.</span><span class="na">length</span><span class="o">]</span><span class="p">;</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">locations</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="na">configLocations</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resolvePath</span><span class="p">(</span><span class="n">locations</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">).</span><span class="na">trim</span><span class="p">();</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">configLocations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h1 id="5-refresh">5. refresh()方法<a class="headerlink" href="#5-refresh" title="Permanent link">&para;</a></h1>
<ul>
<li>AbstractApplicationContext抽象类中定义的refresh()模板方法</li>
<li>定义了需要执行刷新操作的一些步骤，只是一个模板，个性化的逻辑由其子类来具体实现</li>
</ul>
<h2 id="51-refresh">5.1 refresh()方法定义<a class="headerlink" href="#51-refresh" title="Permanent link">&para;</a></h2>
<ul>
<li>代码位置:org.springframework.context.support.AbstractApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nd">@Override</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">refresh</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">,</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">    </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">startupShutdownMonitor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">        </span><span class="c1">// Prepare this context for refreshing.</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">        </span><span class="n">prepareRefresh</span><span class="p">();</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">        </span><span class="c1">// Tell the subclass to refresh the internal bean factory.</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">        </span><span class="c1">// 创建BeanFactory</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">        </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obtainFreshBeanFactory</span><span class="p">();</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="w">        </span><span class="c1">// Prepare the bean factory for use in this context.</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="w">        </span><span class="n">prepareBeanFactory</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="w">            </span><span class="c1">// Allows post-processing of the bean factory in context subclasses.</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="w">            </span><span class="n">postProcessBeanFactory</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a><span class="w">            </span><span class="c1">// Invoke factory processors registered as beans in the context.</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a><span class="w">            </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a>
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a><span class="w">            </span><span class="c1">// Register bean processors that intercept bean creation.</span>
</span><span id="__span-22-22"><a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a><span class="w">            </span><span class="n">registerBeanPostProcessors</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-22-23"><a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a>
</span><span id="__span-22-24"><a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a><span class="w">            </span><span class="c1">// Initialize message source for this context.</span>
</span><span id="__span-22-25"><a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a><span class="w">            </span><span class="n">initMessageSource</span><span class="p">();</span>
</span><span id="__span-22-26"><a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a>
</span><span id="__span-22-27"><a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a><span class="w">            </span><span class="c1">// Initialize event multicaster for this context.</span>
</span><span id="__span-22-28"><a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a><span class="w">            </span><span class="n">initApplicationEventMulticaster</span><span class="p">();</span>
</span><span id="__span-22-29"><a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a>
</span><span id="__span-22-30"><a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a><span class="w">            </span><span class="c1">// Initialize other special beans in specific context subclasses.</span>
</span><span id="__span-22-31"><a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a><span class="w">            </span><span class="n">onRefresh</span><span class="p">();</span>
</span><span id="__span-22-32"><a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a>
</span><span id="__span-22-33"><a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a><span class="w">            </span><span class="c1">// Check for listener beans and register them.</span>
</span><span id="__span-22-34"><a id="__codelineno-22-34" name="__codelineno-22-34" href="#__codelineno-22-34"></a><span class="w">            </span><span class="n">registerListeners</span><span class="p">();</span>
</span><span id="__span-22-35"><a id="__codelineno-22-35" name="__codelineno-22-35" href="#__codelineno-22-35"></a>
</span><span id="__span-22-36"><a id="__codelineno-22-36" name="__codelineno-22-36" href="#__codelineno-22-36"></a><span class="w">            </span><span class="c1">// Instantiate all remaining (non-lazy-init) singletons.</span>
</span><span id="__span-22-37"><a id="__codelineno-22-37" name="__codelineno-22-37" href="#__codelineno-22-37"></a><span class="w">            </span><span class="c1">// 实例化Bean</span>
</span><span id="__span-22-38"><a id="__codelineno-22-38" name="__codelineno-22-38" href="#__codelineno-22-38"></a><span class="w">            </span><span class="n">finishBeanFactoryInitialization</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-22-39"><a id="__codelineno-22-39" name="__codelineno-22-39" href="#__codelineno-22-39"></a>
</span><span id="__span-22-40"><a id="__codelineno-22-40" name="__codelineno-22-40" href="#__codelineno-22-40"></a><span class="w">            </span><span class="c1">// Last step: publish corresponding event.</span>
</span><span id="__span-22-41"><a id="__codelineno-22-41" name="__codelineno-22-41" href="#__codelineno-22-41"></a><span class="w">            </span><span class="n">finishRefresh</span><span class="p">();</span>
</span><span id="__span-22-42"><a id="__codelineno-22-42" name="__codelineno-22-42" href="#__codelineno-22-42"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-22-43"><a id="__codelineno-22-43" name="__codelineno-22-43" href="#__codelineno-22-43"></a>
</span><span id="__span-22-44"><a id="__codelineno-22-44" name="__codelineno-22-44" href="#__codelineno-22-44"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeansException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-45"><a id="__codelineno-22-45" name="__codelineno-22-45" href="#__codelineno-22-45"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isWarnEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-46"><a id="__codelineno-22-46" name="__codelineno-22-46" href="#__codelineno-22-46"></a><span class="w">                </span><span class="n">logger</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Exception encountered during context initialization - &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-22-47"><a id="__codelineno-22-47" name="__codelineno-22-47" href="#__codelineno-22-47"></a><span class="w">                        </span><span class="s">&quot;cancelling refresh attempt: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-22-48"><a id="__codelineno-22-48" name="__codelineno-22-48" href="#__codelineno-22-48"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-22-49"><a id="__codelineno-22-49" name="__codelineno-22-49" href="#__codelineno-22-49"></a>
</span><span id="__span-22-50"><a id="__codelineno-22-50" name="__codelineno-22-50" href="#__codelineno-22-50"></a><span class="w">            </span><span class="c1">// Destroy already created singletons to avoid dangling resources.</span>
</span><span id="__span-22-51"><a id="__codelineno-22-51" name="__codelineno-22-51" href="#__codelineno-22-51"></a><span class="w">            </span><span class="n">destroyBeans</span><span class="p">();</span>
</span><span id="__span-22-52"><a id="__codelineno-22-52" name="__codelineno-22-52" href="#__codelineno-22-52"></a>
</span><span id="__span-22-53"><a id="__codelineno-22-53" name="__codelineno-22-53" href="#__codelineno-22-53"></a><span class="w">            </span><span class="c1">// Reset &#39;active&#39; flag.</span>
</span><span id="__span-22-54"><a id="__codelineno-22-54" name="__codelineno-22-54" href="#__codelineno-22-54"></a><span class="w">            </span><span class="n">cancelRefresh</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-22-55"><a id="__codelineno-22-55" name="__codelineno-22-55" href="#__codelineno-22-55"></a>
</span><span id="__span-22-56"><a id="__codelineno-22-56" name="__codelineno-22-56" href="#__codelineno-22-56"></a><span class="w">            </span><span class="c1">// Propagate exception to caller.</span>
</span><span id="__span-22-57"><a id="__codelineno-22-57" name="__codelineno-22-57" href="#__codelineno-22-57"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">ex</span><span class="p">;</span>
</span><span id="__span-22-58"><a id="__codelineno-22-58" name="__codelineno-22-58" href="#__codelineno-22-58"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-22-59"><a id="__codelineno-22-59" name="__codelineno-22-59" href="#__codelineno-22-59"></a>
</span><span id="__span-22-60"><a id="__codelineno-22-60" name="__codelineno-22-60" href="#__codelineno-22-60"></a><span class="w">        </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-61"><a id="__codelineno-22-61" name="__codelineno-22-61" href="#__codelineno-22-61"></a><span class="w">            </span><span class="c1">// Reset common introspection caches in Spring&#39;s core, since we</span>
</span><span id="__span-22-62"><a id="__codelineno-22-62" name="__codelineno-22-62" href="#__codelineno-22-62"></a><span class="w">            </span><span class="c1">// might not ever need metadata for singleton beans anymore...</span>
</span><span id="__span-22-63"><a id="__codelineno-22-63" name="__codelineno-22-63" href="#__codelineno-22-63"></a><span class="w">            </span><span class="n">resetCommonCaches</span><span class="p">();</span>
</span><span id="__span-22-64"><a id="__codelineno-22-64" name="__codelineno-22-64" href="#__codelineno-22-64"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-22-65"><a id="__codelineno-22-65" name="__codelineno-22-65" href="#__codelineno-22-65"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-22-66"><a id="__codelineno-22-66" name="__codelineno-22-66" href="#__codelineno-22-66"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h2 id="52-preparerefresh">5.2 prepareRefresh()方法<a class="headerlink" href="#52-preparerefresh" title="Permanent link">&para;</a></h2>
<ul>
<li>正式Refresh()操作前的准备工作</li>
<li>代码位置:org.springframework.context.support.AbstractApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">prepareRefresh</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">    </span><span class="c1">// Switch to active.</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">startupDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">closed</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">active</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isDebugEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Refreshing &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Refreshing &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">getDisplayName</span><span class="p">());</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">    </span><span class="c1">// Initialize any placeholder property sources in the context environment.</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="w">    </span><span class="n">initPropertySources</span><span class="p">();</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="w">    </span><span class="c1">// Validate that all properties marked as required are resolvable:</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="w">    </span><span class="c1">// see ConfigurablePropertyResolver#setRequiredProperties</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">    </span><span class="n">getEnvironment</span><span class="p">().</span><span class="na">validateRequiredProperties</span><span class="p">();</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a><span class="w">    </span><span class="c1">// Store pre-refresh ApplicationListeners...</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">earlyApplicationListeners</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">earlyApplicationListeners</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedHashSet</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">applicationListeners</span><span class="p">);</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="w">        </span><span class="c1">// Reset local application listeners to pre-refresh state.</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">applicationListeners</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">applicationListeners</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">earlyApplicationListeners</span><span class="p">);</span>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a><span class="w">    </span><span class="c1">// Allow for the collection of early ApplicationEvents,</span>
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a><span class="w">    </span><span class="c1">// to be published once the multicaster is available...</span>
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">earlyApplicationEvents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedHashSet</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-23-36"><a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a><span class="p">}</span>
</span><span id="__span-23-37"><a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a>
</span><span id="__span-23-38"><a id="__codelineno-23-38" name="__codelineno-23-38" href="#__codelineno-23-38"></a><span class="c1">// 上述定义的initPropertySources()方法，具体由子类实现</span>
</span><span id="__span-23-39"><a id="__codelineno-23-39" name="__codelineno-23-39" href="#__codelineno-23-39"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initPropertySources</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-40"><a id="__codelineno-23-40" name="__codelineno-23-40" href="#__codelineno-23-40"></a><span class="w">    </span><span class="c1">// For subclasses: do nothing by default.</span>
</span><span id="__span-23-41"><a id="__codelineno-23-41" name="__codelineno-23-41" href="#__codelineno-23-41"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h2 id="53-obtainfreshbeanfactory">5.3 obtainFreshBeanFactory()方法<a class="headerlink" href="#53-obtainfreshbeanfactory" title="Permanent link">&para;</a></h2>
<ul>
<li>创建BeanFactory的核心方法</li>
<li>代码位置:org.springframework.context.support.AbstractApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="nf">obtainFreshBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">        </span><span class="n">refreshBeanFactory</span><span class="p">();</span><span class="c1">// 刷新BeanFactory，抽象方法由其子类实现,5.3.1中有说明</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">getBeanFactory</span><span class="p">();</span><span class="c1">// 获取BeanFactory，父类的抽象方法继承并由其子类实现</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">refreshBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">,</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">;</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">    </span><span class="nd">@Override</span><span class="w"> </span><span class="c1">// 该方法在ConfigurableApplicationContext接口中定义</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="nf">getBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">;</span>
</span></code></pre></div></li>
</ul>
<h3 id="531-refreshbeanfactory">5.3.1 refreshBeanFactory()方法的一种实现<a class="headerlink" href="#531-refreshbeanfactory" title="Permanent link">&para;</a></h3>
<ul>
<li>org.springframework.context.support.AbstractRefreshableApplicationContext中的具体实现如下</li>
<li>refreshBeanFactory()方法是AbstractApplicationContext中定义的抽象方法</li>
<li>AbstractRefreshableApplicationContext中的refreshBeanFactory()方法是该抽象方法的一个具体实现</li>
<li>主要作用：刷新BeanFactory
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="c1">// AbstractRefreshableApplicationContext中refreshBeanFactory()方法的一种实现</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="nd">@Override</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="kd">protected</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">refreshBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">    </span><span class="c1">// 检查上下文中是否已存在BeanFactory</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hasBeanFactory</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">        </span><span class="c1">// 存在BeanFactory时先销毁已存在的BeanFactory</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="w">        </span><span class="n">destroyBeans</span><span class="p">();</span><span class="c1">//调用AbstractApplicationContext中的实现</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="w">        </span><span class="cm">/**</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="cm">        * 以下是AbstractApplicationContext中destroyBeans()方法的实现</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="cm">        * protected void destroyBeans() {</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="cm">        *    getBeanFactory().destroySingletons();</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="cm">        * }</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a><span class="cm">        */</span>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="w">        </span><span class="n">closeBeanFactory</span><span class="p">();</span><span class="c1">// 调用本抽象类中的closeBeanFactory()方法，具体代码在下面列出</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">        </span><span class="c1">// 创建新的BeanFactory</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">        </span><span class="c1">// 下面这行代码只会创建一个空的BeanFactory，并未有任何Bean</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="w">        </span><span class="n">DefaultListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBeanFactory</span><span class="p">();</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">setSerializationId</span><span class="p">(</span><span class="n">getId</span><span class="p">());</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="w">        </span><span class="n">customizeBeanFactory</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a><span class="w">        </span><span class="n">loadBeanDefinitions</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">);</span><span class="c1">// refreshBeanFactory()方法实现的核心</span>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a><span class="w">        </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanFactoryMonitor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">;</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ApplicationContextException</span><span class="p">(</span><span class="s">&quot;I/O error parsing bean definition source for &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">getDisplayName</span><span class="p">(),</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a><span class="p">}</span>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a>
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a><span class="c1">// AbstractRefreshableApplicationContext抽象类中refreshBeanFactory()方法内调用的closeBeanFactory()方法</span>
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a><span class="nd">@Override</span>
</span><span id="__span-25-34"><a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a><span class="kd">protected</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">closeBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-35"><a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a><span class="w">    </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanFactoryMonitor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-36"><a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-37"><a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a><span class="w">            </span><span class="c1">//销毁已存在的BeanFactory</span>
</span><span id="__span-25-38"><a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">setSerializationId</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-25-39"><a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-25-40"><a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-25-41"><a id="__codelineno-25-41" name="__codelineno-25-41" href="#__codelineno-25-41"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-25-42"><a id="__codelineno-25-42" name="__codelineno-25-42" href="#__codelineno-25-42"></a><span class="p">}</span>
</span><span id="__span-25-43"><a id="__codelineno-25-43" name="__codelineno-25-43" href="#__codelineno-25-43"></a>
</span><span id="__span-25-44"><a id="__codelineno-25-44" name="__codelineno-25-44" href="#__codelineno-25-44"></a><span class="c1">//AbstractRefreshableApplicationContext抽象类中refreshBeanFactory()方法内调用createBeanFactory()方法</span>
</span><span id="__span-25-45"><a id="__codelineno-25-45" name="__codelineno-25-45" href="#__codelineno-25-45"></a><span class="kd">protected</span><span class="w"> </span><span class="n">DefaultListableBeanFactory</span><span class="w"> </span><span class="nf">createBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-46"><a id="__codelineno-25-46" name="__codelineno-25-46" href="#__codelineno-25-46"></a><span class="w">    </span><span class="c1">// 调用下面 AbstractApplicationContext中的getInternalParentBeanFactory()方法</span>
</span><span id="__span-25-47"><a id="__codelineno-25-47" name="__codelineno-25-47" href="#__codelineno-25-47"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultListableBeanFactory</span><span class="p">(</span><span class="n">getInternalParentBeanFactory</span><span class="p">());</span>
</span><span id="__span-25-48"><a id="__codelineno-25-48" name="__codelineno-25-48" href="#__codelineno-25-48"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="abstractapplicationcontextgetinternalparentbeanfactory">AbstractApplicationContext中的getInternalParentBeanFactory()方法<a class="headerlink" href="#abstractapplicationcontextgetinternalparentbeanfactory" title="Permanent link">&para;</a></h4>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nd">@Nullable</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="kd">protected</span><span class="w"> </span><span class="n">BeanFactory</span><span class="w"> </span><span class="nf">getInternalParentBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">getParent</span><span class="p">()</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ConfigurableApplicationContext</span><span class="w"> </span><span class="o">?</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">            </span><span class="p">((</span><span class="n">ConfigurableApplicationContext</span><span class="p">)</span><span class="w"> </span><span class="n">getParent</span><span class="p">()).</span><span class="na">getBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">getParent</span><span class="p">());</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="defaultlistablebeanfactory">DefaultListableBeanFactory的构造方法<a class="headerlink" href="#defaultlistablebeanfactory" title="Permanent link">&para;</a></h4>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kd">public</span><span class="w"> </span><span class="nf">DefaultListableBeanFactory</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">BeanFactory</span><span class="w"> </span><span class="n">parentBeanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="kd">super</span><span class="p">(</span><span class="n">parentBeanFactory</span><span class="p">);</span><span class="c1">// 调用AbstractAutowireCapableBeanFactory(抽象类)的构造方法</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="defaultlistablebeanfactoryabstractautowirecapablebeanfactory">DefaultListableBeanFactory父类AbstractAutowireCapableBeanFactory(抽象类)的构造方法<a class="headerlink" href="#defaultlistablebeanfactoryabstractautowirecapablebeanfactory" title="Permanent link">&para;</a></h4>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kd">public</span><span class="w"> </span><span class="nf">AbstractAutowireCapableBeanFactory</span><span class="p">(</span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">BeanFactory</span><span class="w"> </span><span class="n">parentBeanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">    </span><span class="k">this</span><span class="p">();</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">    </span><span class="n">setParentBeanFactory</span><span class="p">(</span><span class="n">parentBeanFactory</span><span class="p">);</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="abstractrefreshableapplicationcontextcustomizebeanfactorybeanfactory">AbstractRefreshableApplicationContext中的customizeBeanFactory(beanFactory)方法<a class="headerlink" href="#abstractrefreshableapplicationcontextcustomizebeanfactorybeanfactory" title="Permanent link">&para;</a></h4>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">customizeBeanFactory</span><span class="p">(</span><span class="n">DefaultListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">allowBeanDefinitionOverriding</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">setAllowBeanDefinitionOverriding</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">allowBeanDefinitionOverriding</span><span class="p">);</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">allowCircularReferences</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">setAllowCircularReferences</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">allowCircularReferences</span><span class="p">);</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="abstractrefreshableapplicationcontextloadbeandefinitionsbeanfactory">AbstractRefreshableApplicationContext中的loadBeanDefinitions(beanFactory)方法<a class="headerlink" href="#abstractrefreshableapplicationcontextloadbeandefinitionsbeanfactory" title="Permanent link">&para;</a></h4>
<ul>
<li>是实现refreshBeanFactory()方法的核心</li>
<li>org.springframework.context.support.AbstractRefreshableApplicationContext中定义的抽象方法
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kd">abstract</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">loadBeanDefinitions</span><span class="p">(</span><span class="n">DefaultListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">,</span><span class="w"> </span><span class="n">IOException</span><span class="p">;</span>
</span></code></pre></div></li>
<li>该抽象方法的一个具体实现在org.springframework.context.support.AbstractXmlApplicationContext中</li>
</ul>
<h4 id="orgspringframeworkcontextsupportabstractxmlapplicationcontextloadbeandefinitionsdefaultlistablebeanfactory-beanfactory">org.springframework.context.support.AbstractXmlApplicationContext中的loadBeanDefinitions(DefaultListableBeanFactory beanFactory)方法<a class="headerlink" href="#orgspringframeworkcontextsupportabstractxmlapplicationcontextloadbeandefinitionsdefaultlistablebeanfactory-beanfactory" title="Permanent link">&para;</a></h4>
<ul>
<li>org.springframework.context.support.AbstractRefreshableApplicationContext中定义的抽象方法loadBeanDefinitions(DefaultListableBeanFactory beanFactory)的一个实现
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="nd">@Override</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">loadBeanDefinitions</span><span class="p">(</span><span class="n">DefaultListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">,</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="w">    </span><span class="c1">// Create a new XmlBeanDefinitionReader for the given BeanFactory.</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="w">    </span><span class="c1">// 通过上一步创建的空BeanFactory来创建新的XmlBeanDefinitionReader对象</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="w">    </span><span class="c1">// XmlBeanDefinitionReader用于解析xml文件中定义的bean</span>
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a><span class="w">    </span><span class="n">XmlBeanDefinitionReader</span><span class="w"> </span><span class="n">beanDefinitionReader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">XmlBeanDefinitionReader</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">);</span><span class="w"> </span><span class="c1">//</span>
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a><span class="w">    </span><span class="c1">// Configure the bean definition reader with this context&#39;s</span>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a><span class="w">    </span><span class="c1">// resource loading environment.</span>
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a><span class="w">    </span><span class="n">beanDefinitionReader</span><span class="p">.</span><span class="na">setEnvironment</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">getEnvironment</span><span class="p">());</span>
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a><span class="w">    </span><span class="n">beanDefinitionReader</span><span class="p">.</span><span class="na">setResourceLoader</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a><span class="w">    </span><span class="n">beanDefinitionReader</span><span class="p">.</span><span class="na">setEntityResolver</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ResourceEntityResolver</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a><span class="w">    </span><span class="c1">// Allow a subclass to provide custom initialization of the reader,</span>
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a><span class="w">    </span><span class="c1">// then proceed with actually loading the bean definitions.</span>
</span><span id="__span-31-16"><a id="__codelineno-31-16" name="__codelineno-31-16" href="#__codelineno-31-16"></a><span class="w">    </span><span class="n">initBeanDefinitionReader</span><span class="p">(</span><span class="n">beanDefinitionReader</span><span class="p">);</span>
</span><span id="__span-31-17"><a id="__codelineno-31-17" name="__codelineno-31-17" href="#__codelineno-31-17"></a><span class="w">    </span><span class="n">loadBeanDefinitions</span><span class="p">(</span><span class="n">beanDefinitionReader</span><span class="p">);</span><span class="w"> </span><span class="c1">//这是一个重载方法，入参是上面生成的beanDefinitionReader</span>
</span><span id="__span-31-18"><a id="__codelineno-31-18" name="__codelineno-31-18" href="#__codelineno-31-18"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="new-xmlbeandefinitionreaderbeanfactory">new XmlBeanDefinitionReader(beanFactory)<a class="headerlink" href="#new-xmlbeandefinitionreaderbeanfactory" title="Permanent link">&para;</a></h4>
<ul>
<li>XmlBeanDefinitionReader(beanFactory)构造方法调用其父类AbstractBeanDefinitionReader的构造方法，具体如下
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="kd">protected</span><span class="w"> </span><span class="nf">AbstractBeanDefinitionReader</span><span class="p">(</span><span class="n">BeanDefinitionRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="na">notNull</span><span class="p">(</span><span class="n">registry</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BeanDefinitionRegistry must not be null&quot;</span><span class="p">);</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">registry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">registry</span><span class="p">;</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="w">    </span><span class="c1">// Determine ResourceLoader to use.</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">registry</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ResourceLoader</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">resourceLoader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ResourceLoader</span><span class="p">)</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">registry</span><span class="p">;</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">resourceLoader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PathMatchingResourcePatternResolver</span><span class="p">();</span>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="w">    </span><span class="c1">// Inherit Environment if possible</span>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">registry</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">EnvironmentCapable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">EnvironmentCapable</span><span class="p">)</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">registry</span><span class="p">).</span><span class="na">getEnvironment</span><span class="p">();</span>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-17"><a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-18"><a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StandardEnvironment</span><span class="p">();</span>
</span><span id="__span-32-19"><a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-20"><a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="abstractxmlapplicationcontextinitbeandefinitionreaderbeandefinitionreader">AbstractXmlApplicationContext抽象类中的initBeanDefinitionReader(beanDefinitionReader)方法<a class="headerlink" href="#abstractxmlapplicationcontextinitbeandefinitionreaderbeandefinitionreader" title="Permanent link">&para;</a></h4>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initBeanDefinitionReader</span><span class="p">(</span><span class="n">XmlBeanDefinitionReader</span><span class="w"> </span><span class="n">reader</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="w">    </span><span class="n">reader</span><span class="p">.</span><span class="na">setValidating</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">validating</span><span class="p">);</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="abstractxmlapplicationcontextloadbeandefinitionsxmlbeandefinitionreader-reader">AbstractXmlApplicationContext抽象类中的loadBeanDefinitions(XmlBeanDefinitionReader reader)方法<a class="headerlink" href="#abstractxmlapplicationcontextloadbeandefinitionsxmlbeandefinitionreader-reader" title="Permanent link">&para;</a></h4>
<ul>
<li>主要功能是解析资源文件的位置</li>
<li>调用XmlBeanDefinitionReader对象的loadBeanDefinitions方法解析bean的定义
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">loadBeanDefinitions</span><span class="p">(</span><span class="n">XmlBeanDefinitionReader</span><span class="w"> </span><span class="n">reader</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="p">,</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">    </span><span class="n">Resource</span><span class="o">[]</span><span class="w"> </span><span class="n">configResources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getConfigResources</span><span class="p">();</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">configResources</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="w">        </span><span class="n">reader</span><span class="p">.</span><span class="na">loadBeanDefinitions</span><span class="p">(</span><span class="n">configResources</span><span class="p">);</span><span class="w"> </span><span class="c1">//具体调用AbstractBeanDefinitionReader中实现的loadBeanDefinitions(Resource... resources)方法</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">configLocations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getConfigLocations</span><span class="p">();</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">configLocations</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="w">        </span><span class="n">reader</span><span class="p">.</span><span class="na">loadBeanDefinitions</span><span class="p">(</span><span class="n">configLocations</span><span class="p">);</span><span class="c1">//具体调用AbstractBeanDefinitionReader中实现的loadBeanDefinitions(String... locations)</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h5 id="readerloadbeandefinitionsconfigresourcesreaderloadbeandefinitionsconfiglocations">reader.loadBeanDefinitions(configResources)方法与reader.loadBeanDefinitions(configLocations)方法<a class="headerlink" href="#readerloadbeandefinitionsconfigresourcesreaderloadbeandefinitionsconfiglocations" title="Permanent link">&para;</a></h5>
<ul>
<li>XmlBeanDefinitionReader对象的loadBeanDefinitions方法用于解析bean的定义</li>
<li>reader是XmlBeanDefinitionReader类型的对象，loadBeanDefinitions方法定义在BeanDefinitionReader接口中，</li>
<li>loadBeanDefinitions方法具体是在AbstractBeanDefinitionReader抽象类中实现的，具体代码如下：
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="nd">@Override</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">loadBeanDefinitions</span><span class="p">(</span><span class="n">Resource</span><span class="p">...</span><span class="w"> </span><span class="n">resources</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="na">notNull</span><span class="p">(</span><span class="n">resources</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Resource array must not be null&quot;</span><span class="p">);</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="w">    </span><span class="c1">// 遍历每一个资源并依次调用重载方法loadBeanDefinitions(Resource resource)，定义在XmlBeanDefinitionReader中，具体实现在XmlBeanDefinitionReader中</span>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Resource</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">resources</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a><span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">loadBeanDefinitions</span><span class="p">(</span><span class="n">resource</span><span class="p">);</span><span class="c1">//</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a><span class="p">}</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a><span class="nd">@Override</span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">loadBeanDefinitions</span><span class="p">(</span><span class="n">String</span><span class="p">...</span><span class="w"> </span><span class="n">locations</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a><span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="na">notNull</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Location array must not be null&quot;</span><span class="p">);</span>
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a><span class="w">    </span><span class="c1">//遍历资源数组，调用重载方法loadBeanDefinitions(String location)</span>
</span><span id="__span-35-17"><a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">locations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-18"><a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a><span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">loadBeanDefinitions</span><span class="p">(</span><span class="n">location</span><span class="p">);</span><span class="c1">//</span>
</span><span id="__span-35-19"><a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-35-20"><a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
</span><span id="__span-35-21"><a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="count-loadbeandefinitionsresourceloadbeandefinitionsresource">count += loadBeanDefinitions(resource)中的loadBeanDefinitions(resource)方法<a class="headerlink" href="#count-loadbeandefinitionsresourceloadbeandefinitionsresource" title="Permanent link">&para;</a></h4>
<ul>
<li>loadBeanDefinitions(resource)方法在BeanDefinitionReader接口中定义，具体实现是在XmlBeanDefinitionReader中</li>
<li>XmlBeanDefinitionReader中的实现代码如下：
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="nd">@Override</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">loadBeanDefinitions</span><span class="p">(</span><span class="n">Resource</span><span class="w"> </span><span class="n">resource</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">loadBeanDefinitions</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">EncodedResource</span><span class="p">(</span><span class="n">resource</span><span class="p">));</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>可以看到，上面的方法又调用了loadBeanDefinitions(new EncodedResource(resource))方法，该方法在BeanDefinitionReader接口中定义，具体实现在XmlBeanDefinitionReader中,具体实现，详细代码如下：
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">loadBeanDefinitions</span><span class="p">(</span><span class="n">EncodedResource</span><span class="w"> </span><span class="n">encodedResource</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="na">notNull</span><span class="p">(</span><span class="n">encodedResource</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;EncodedResource must not be null&quot;</span><span class="p">);</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Loading XML bean definitions from &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">encodedResource</span><span class="p">);</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a><span class="w">    </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">EncodedResource</span><span class="o">&gt;</span><span class="w"> </span><span class="n">currentResources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">resourcesCurrentlyBeingLoaded</span><span class="p">.</span><span class="na">get</span><span class="p">();</span>
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentResources</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-9"><a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a><span class="w">        </span><span class="n">currentResources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashSet</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span><span id="__span-37-10"><a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">resourcesCurrentlyBeingLoaded</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">currentResources</span><span class="p">);</span>
</span><span id="__span-37-11"><a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-37-12"><a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">currentResources</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">encodedResource</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-13"><a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="p">(</span><span class="s">&quot;Detected cyclic loading of &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">encodedResource</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; - check your import definitions!&quot;</span><span class="p">);</span>
</span><span id="__span-37-14"><a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-37-15"><a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-16"><a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a><span class="w">        </span><span class="c1">//以流的形式读取资源文件</span>
</span><span id="__span-37-17"><a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a><span class="w">        </span><span class="n">InputStream</span><span class="w"> </span><span class="n">inputStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encodedResource</span><span class="p">.</span><span class="na">getResource</span><span class="p">().</span><span class="na">getInputStream</span><span class="p">();</span>
</span><span id="__span-37-18"><a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-19"><a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a><span class="w">            </span><span class="n">InputSource</span><span class="w"> </span><span class="n">inputSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">InputSource</span><span class="p">(</span><span class="n">inputStream</span><span class="p">);</span>
</span><span id="__span-37-20"><a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">encodedResource</span><span class="p">.</span><span class="na">getEncoding</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-21"><a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a><span class="w">                </span><span class="n">inputSource</span><span class="p">.</span><span class="na">setEncoding</span><span class="p">(</span><span class="n">encodedResource</span><span class="p">.</span><span class="na">getEncoding</span><span class="p">());</span>
</span><span id="__span-37-22"><a id="__codelineno-37-22" name="__codelineno-37-22" href="#__codelineno-37-22"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-37-23"><a id="__codelineno-37-23" name="__codelineno-37-23" href="#__codelineno-37-23"></a><span class="w">            </span><span class="c1">// 调用doLoadBeanDefinitions解析载入文件中的bean定义</span>
</span><span id="__span-37-24"><a id="__codelineno-37-24" name="__codelineno-37-24" href="#__codelineno-37-24"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">doLoadBeanDefinitions</span><span class="p">(</span><span class="n">inputSource</span><span class="p">,</span><span class="w"> </span><span class="n">encodedResource</span><span class="p">.</span><span class="na">getResource</span><span class="p">());</span>
</span><span id="__span-37-25"><a id="__codelineno-37-25" name="__codelineno-37-25" href="#__codelineno-37-25"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-37-26"><a id="__codelineno-37-26" name="__codelineno-37-26" href="#__codelineno-37-26"></a><span class="w">        </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-27"><a id="__codelineno-37-27" name="__codelineno-37-27" href="#__codelineno-37-27"></a><span class="w">            </span><span class="n">inputStream</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>
</span><span id="__span-37-28"><a id="__codelineno-37-28" name="__codelineno-37-28" href="#__codelineno-37-28"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-37-29"><a id="__codelineno-37-29" name="__codelineno-37-29" href="#__codelineno-37-29"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-37-30"><a id="__codelineno-37-30" name="__codelineno-37-30" href="#__codelineno-37-30"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-31"><a id="__codelineno-37-31" name="__codelineno-37-31" href="#__codelineno-37-31"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="p">(</span>
</span><span id="__span-37-32"><a id="__codelineno-37-32" name="__codelineno-37-32" href="#__codelineno-37-32"></a><span class="w">                </span><span class="s">&quot;IOException parsing XML document from &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">encodedResource</span><span class="p">.</span><span class="na">getResource</span><span class="p">(),</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-37-33"><a id="__codelineno-37-33" name="__codelineno-37-33" href="#__codelineno-37-33"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-37-34"><a id="__codelineno-37-34" name="__codelineno-37-34" href="#__codelineno-37-34"></a><span class="w">    </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-35"><a id="__codelineno-37-35" name="__codelineno-37-35" href="#__codelineno-37-35"></a><span class="w">        </span><span class="n">currentResources</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">encodedResource</span><span class="p">);</span>
</span><span id="__span-37-36"><a id="__codelineno-37-36" name="__codelineno-37-36" href="#__codelineno-37-36"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentResources</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-37"><a id="__codelineno-37-37" name="__codelineno-37-37" href="#__codelineno-37-37"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">resourcesCurrentlyBeingLoaded</span><span class="p">.</span><span class="na">remove</span><span class="p">();</span>
</span><span id="__span-37-38"><a id="__codelineno-37-38" name="__codelineno-37-38" href="#__codelineno-37-38"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-37-39"><a id="__codelineno-37-39" name="__codelineno-37-39" href="#__codelineno-37-39"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-37-40"><a id="__codelineno-37-40" name="__codelineno-37-40" href="#__codelineno-37-40"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="count-loadbeandefinitionslocationloadbeandefinitionslocation">count += loadBeanDefinitions(location)中的loadBeanDefinitions(location)方法<a class="headerlink" href="#count-loadbeandefinitionslocationloadbeandefinitionslocation" title="Permanent link">&para;</a></h4>
<ul>
<li>loadBeanDefinitions(location)方法的具体实现AbstractBeanDefinitionReader中；
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="nd">@Override</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">loadBeanDefinitions</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">location</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">loadBeanDefinitions</span><span class="p">(</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>解析资源文件的路径，得到Resource[]资源数组</li>
<li>上面AbstractBeanDefinitionReader中的loadBeanDefinitions(String location)方法又调用了同类里面的一个重载方法loadBeanDefinitions(String location, @Nullable Set<Resource> actualResources) 具体实现如下：
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">loadBeanDefinitions</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Resource</span><span class="o">&gt;</span><span class="w"> </span><span class="n">actualResources</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="w">        </span><span class="n">ResourceLoader</span><span class="w"> </span><span class="n">resourceLoader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getResourceLoader</span><span class="p">();</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resourceLoader</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="p">(</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">                    </span><span class="s">&quot;Cannot load bean definitions from location [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]: no ResourceLoader available&quot;</span><span class="p">);</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resourceLoader</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ResourcePatternResolver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="w">            </span><span class="c1">// Resource pattern matching available.</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="w">                </span><span class="n">Resource</span><span class="o">[]</span><span class="w"> </span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">ResourcePatternResolver</span><span class="p">)</span><span class="w"> </span><span class="n">resourceLoader</span><span class="p">).</span><span class="na">getResources</span><span class="p">(</span><span class="n">location</span><span class="p">);</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="w">                </span><span class="c1">//下一行的核心逻辑  调用上面提到的重载方法loadBeanDefinitions(Resource resource)</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="w">                </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loadBeanDefinitions</span><span class="p">(</span><span class="n">resources</span><span class="p">);</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">actualResources</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="w">                    </span><span class="n">Collections</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="n">actualResources</span><span class="p">,</span><span class="w"> </span><span class="n">resources</span><span class="p">);</span>
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a><span class="w">                    </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Loaded &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; bean definitions from location pattern [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">);</span>
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-39-20"><a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
</span><span id="__span-39-21"><a id="__codelineno-39-21" name="__codelineno-39-21" href="#__codelineno-39-21"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-39-22"><a id="__codelineno-39-22" name="__codelineno-39-22" href="#__codelineno-39-22"></a><span class="w">            </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-23"><a id="__codelineno-39-23" name="__codelineno-39-23" href="#__codelineno-39-23"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="p">(</span>
</span><span id="__span-39-24"><a id="__codelineno-39-24" name="__codelineno-39-24" href="#__codelineno-39-24"></a><span class="w">                        </span><span class="s">&quot;Could not resolve bean definition resource pattern [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-39-25"><a id="__codelineno-39-25" name="__codelineno-39-25" href="#__codelineno-39-25"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-39-26"><a id="__codelineno-39-26" name="__codelineno-39-26" href="#__codelineno-39-26"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-39-27"><a id="__codelineno-39-27" name="__codelineno-39-27" href="#__codelineno-39-27"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-28"><a id="__codelineno-39-28" name="__codelineno-39-28" href="#__codelineno-39-28"></a><span class="w">            </span><span class="c1">// Can only load single resources by absolute URL.</span>
</span><span id="__span-39-29"><a id="__codelineno-39-29" name="__codelineno-39-29" href="#__codelineno-39-29"></a><span class="w">            </span><span class="n">Resource</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resourceLoader</span><span class="p">.</span><span class="na">getResource</span><span class="p">(</span><span class="n">location</span><span class="p">);</span>
</span><span id="__span-39-30"><a id="__codelineno-39-30" name="__codelineno-39-30" href="#__codelineno-39-30"></a><span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">loadBeanDefinitions</span><span class="p">(</span><span class="n">resource</span><span class="p">);</span>
</span><span id="__span-39-31"><a id="__codelineno-39-31" name="__codelineno-39-31" href="#__codelineno-39-31"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">actualResources</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-32"><a id="__codelineno-39-32" name="__codelineno-39-32" href="#__codelineno-39-32"></a><span class="w">                </span><span class="n">actualResources</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">resource</span><span class="p">);</span>
</span><span id="__span-39-33"><a id="__codelineno-39-33" name="__codelineno-39-33" href="#__codelineno-39-33"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-39-34"><a id="__codelineno-39-34" name="__codelineno-39-34" href="#__codelineno-39-34"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-39-35"><a id="__codelineno-39-35" name="__codelineno-39-35" href="#__codelineno-39-35"></a><span class="w">                </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Loaded &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; bean definitions from location [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">);</span>
</span><span id="__span-39-36"><a id="__codelineno-39-36" name="__codelineno-39-36" href="#__codelineno-39-36"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-39-37"><a id="__codelineno-39-37" name="__codelineno-39-37" href="#__codelineno-39-37"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
</span><span id="__span-39-38"><a id="__codelineno-39-38" name="__codelineno-39-38" href="#__codelineno-39-38"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-39-39"><a id="__codelineno-39-39" name="__codelineno-39-39" href="#__codelineno-39-39"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="xmlbeandefinitionreaderdoloadbeandefinitionsinputsource-inputsource-resource-resource">XmlBeanDefinitionReader类中的doLoadBeanDefinitions(InputSource inputSource, Resource resource)方法<a class="headerlink" href="#xmlbeandefinitionreaderdoloadbeandefinitionsinputsource-inputsource-resource-resource" title="Permanent link">&para;</a></h4>
<ul>
<li>该方法是载入定义bean的核心方法</li>
<li>代码位置：org.springframework.beans.factory.xml.XmlBeanDefinitionReader
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">doLoadBeanDefinitions</span><span class="p">(</span><span class="n">InputSource</span><span class="w"> </span><span class="n">inputSource</span><span class="p">,</span><span class="w"> </span><span class="n">Resource</span><span class="w"> </span><span class="n">resource</span><span class="p">)</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="w">        </span><span class="c1">// 解析XML文档</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="w">        </span><span class="n">Document</span><span class="w"> </span><span class="n">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">doLoadDocument</span><span class="p">(</span><span class="n">inputSource</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">);</span>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a><span class="w">        </span><span class="c1">// 下面一行代码 注册Bean</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">registerBeanDefinitions</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="p">);</span>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isDebugEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a><span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Loaded &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; bean definitions from &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">resource</span><span class="p">);</span>
</span><span id="__span-40-11"><a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-40-12"><a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">;</span>
</span><span id="__span-40-13"><a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-40-14"><a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-15"><a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">ex</span><span class="p">;</span>
</span><span id="__span-40-16"><a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-40-17"><a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SAXParseException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-18"><a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">XmlBeanDefinitionStoreException</span><span class="p">(</span><span class="n">resource</span><span class="p">.</span><span class="na">getDescription</span><span class="p">(),</span>
</span><span id="__span-40-19"><a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a><span class="w">                </span><span class="s">&quot;Line &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; in XML document from &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; is invalid&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-40-20"><a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-40-21"><a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SAXException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-22"><a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">XmlBeanDefinitionStoreException</span><span class="p">(</span><span class="n">resource</span><span class="p">.</span><span class="na">getDescription</span><span class="p">(),</span>
</span><span id="__span-40-23"><a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a><span class="w">                </span><span class="s">&quot;XML document from &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; is invalid&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-40-24"><a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-40-25"><a id="__codelineno-40-25" name="__codelineno-40-25" href="#__codelineno-40-25"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ParserConfigurationException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-26"><a id="__codelineno-40-26" name="__codelineno-40-26" href="#__codelineno-40-26"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="p">(</span><span class="n">resource</span><span class="p">.</span><span class="na">getDescription</span><span class="p">(),</span>
</span><span id="__span-40-27"><a id="__codelineno-40-27" name="__codelineno-40-27" href="#__codelineno-40-27"></a><span class="w">                </span><span class="s">&quot;Parser configuration exception parsing XML from &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">resource</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-40-28"><a id="__codelineno-40-28" name="__codelineno-40-28" href="#__codelineno-40-28"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-40-29"><a id="__codelineno-40-29" name="__codelineno-40-29" href="#__codelineno-40-29"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-30"><a id="__codelineno-40-30" name="__codelineno-40-30" href="#__codelineno-40-30"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="p">(</span><span class="n">resource</span><span class="p">.</span><span class="na">getDescription</span><span class="p">(),</span>
</span><span id="__span-40-31"><a id="__codelineno-40-31" name="__codelineno-40-31" href="#__codelineno-40-31"></a><span class="w">                </span><span class="s">&quot;IOException parsing XML document from &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">resource</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-40-32"><a id="__codelineno-40-32" name="__codelineno-40-32" href="#__codelineno-40-32"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-40-33"><a id="__codelineno-40-33" name="__codelineno-40-33" href="#__codelineno-40-33"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-34"><a id="__codelineno-40-34" name="__codelineno-40-34" href="#__codelineno-40-34"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="p">(</span><span class="n">resource</span><span class="p">.</span><span class="na">getDescription</span><span class="p">(),</span>
</span><span id="__span-40-35"><a id="__codelineno-40-35" name="__codelineno-40-35" href="#__codelineno-40-35"></a><span class="w">                </span><span class="s">&quot;Unexpected exception parsing XML document from &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">resource</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-40-36"><a id="__codelineno-40-36" name="__codelineno-40-36" href="#__codelineno-40-36"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-40-37"><a id="__codelineno-40-37" name="__codelineno-40-37" href="#__codelineno-40-37"></a><span class="p">}</span>
</span><span id="__span-40-38"><a id="__codelineno-40-38" name="__codelineno-40-38" href="#__codelineno-40-38"></a>
</span><span id="__span-40-39"><a id="__codelineno-40-39" name="__codelineno-40-39" href="#__codelineno-40-39"></a><span class="c1">// 注册Bean的方法</span>
</span><span id="__span-40-40"><a id="__codelineno-40-40" name="__codelineno-40-40" href="#__codelineno-40-40"></a><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">registerBeanDefinitions</span><span class="p">(</span><span class="n">Document</span><span class="w"> </span><span class="n">doc</span><span class="p">,</span><span class="w"> </span><span class="n">Resource</span><span class="w"> </span><span class="n">resource</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-41"><a id="__codelineno-40-41" name="__codelineno-40-41" href="#__codelineno-40-41"></a><span class="w">    </span><span class="n">BeanDefinitionDocumentReader</span><span class="w"> </span><span class="n">documentReader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBeanDefinitionDocumentReader</span><span class="p">();</span>
</span><span id="__span-40-42"><a id="__codelineno-40-42" name="__codelineno-40-42" href="#__codelineno-40-42"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">countBefore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getRegistry</span><span class="p">().</span><span class="na">getBeanDefinitionCount</span><span class="p">();</span>
</span><span id="__span-40-43"><a id="__codelineno-40-43" name="__codelineno-40-43" href="#__codelineno-40-43"></a><span class="w">    </span><span class="c1">// 注册bean的核心逻辑</span>
</span><span id="__span-40-44"><a id="__codelineno-40-44" name="__codelineno-40-44" href="#__codelineno-40-44"></a><span class="w">    </span><span class="n">documentReader</span><span class="p">.</span><span class="na">registerBeanDefinitions</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span><span class="w"> </span><span class="n">createReaderContext</span><span class="p">(</span><span class="n">resource</span><span class="p">));</span>
</span><span id="__span-40-45"><a id="__codelineno-40-45" name="__codelineno-40-45" href="#__codelineno-40-45"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">getRegistry</span><span class="p">().</span><span class="na">getBeanDefinitionCount</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">countBefore</span><span class="p">;</span>
</span><span id="__span-40-46"><a id="__codelineno-40-46" name="__codelineno-40-46" href="#__codelineno-40-46"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="defaultbeandefinitiondocumentreaderregisterbeandefinitionsdocument-doc-xmlreadercontext-readercontext">DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(Document doc, XmlReaderContext readerContext)<a class="headerlink" href="#defaultbeandefinitiondocumentreaderregisterbeandefinitionsdocument-doc-xmlreadercontext-readercontext" title="Permanent link">&para;</a></h4>
<ul>
<li>功能：</li>
<li>代码位置：org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="nd">@Override</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerBeanDefinitions</span><span class="p">(</span><span class="n">Document</span><span class="w"> </span><span class="n">doc</span><span class="p">,</span><span class="w"> </span><span class="n">XmlReaderContext</span><span class="w"> </span><span class="n">readerContext</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">readerContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readerContext</span><span class="p">;</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">    </span><span class="c1">// 核心逻辑</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">    </span><span class="n">doRegisterBeanDefinitions</span><span class="p">(</span><span class="n">doc</span><span class="p">.</span><span class="na">getDocumentElement</span><span class="p">());</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="p">}</span>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a><span class="c1">// registerBeanDefinitions方法中调用的doRegisterBeanDefinitions方法</span>
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a><span class="nd">@SuppressWarnings</span><span class="p">(</span><span class="s">&quot;deprecation&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// for Environment.acceptsProfiles(String...)</span>
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">doRegisterBeanDefinitions</span><span class="p">(</span><span class="n">Element</span><span class="w"> </span><span class="n">root</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-11"><a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a><span class="w">    </span><span class="c1">// Any nested &lt;beans&gt; elements will cause recursion in this method. In</span>
</span><span id="__span-41-12"><a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a><span class="w">    </span><span class="c1">// order to propagate and preserve &lt;beans&gt; default-* attributes correctly,</span>
</span><span id="__span-41-13"><a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a><span class="w">    </span><span class="c1">// keep track of the current (parent) delegate, which may be null. Create</span>
</span><span id="__span-41-14"><a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a><span class="w">    </span><span class="c1">// the new (child) delegate with a reference to the parent for fallback purposes,</span>
</span><span id="__span-41-15"><a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a><span class="w">    </span><span class="c1">// then ultimately reset this.delegate back to its original (parent) reference.</span>
</span><span id="__span-41-16"><a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a><span class="w">    </span><span class="c1">// this behavior emulates a stack of delegates without actually necessitating one.</span>
</span><span id="__span-41-17"><a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a><span class="w">    </span><span class="n">BeanDefinitionParserDelegate</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">delegate</span><span class="p">;</span>
</span><span id="__span-41-18"><a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">delegate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createDelegate</span><span class="p">(</span><span class="n">getReaderContext</span><span class="p">(),</span><span class="w"> </span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
</span><span id="__span-41-19"><a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a>
</span><span id="__span-41-20"><a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">delegate</span><span class="p">.</span><span class="na">isDefaultNamespace</span><span class="p">(</span><span class="n">root</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-21"><a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">profileSpec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">root</span><span class="p">.</span><span class="na">getAttribute</span><span class="p">(</span><span class="n">PROFILE_ATTRIBUTE</span><span class="p">);</span>
</span><span id="__span-41-22"><a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">StringUtils</span><span class="p">.</span><span class="na">hasText</span><span class="p">(</span><span class="n">profileSpec</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-23"><a id="__codelineno-41-23" name="__codelineno-41-23" href="#__codelineno-41-23"></a><span class="w">            </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">specifiedProfiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">StringUtils</span><span class="p">.</span><span class="na">tokenizeToStringArray</span><span class="p">(</span>
</span><span id="__span-41-24"><a id="__codelineno-41-24" name="__codelineno-41-24" href="#__codelineno-41-24"></a><span class="w">                    </span><span class="n">profileSpec</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionParserDelegate</span><span class="p">.</span><span class="na">MULTI_VALUE_ATTRIBUTE_DELIMITERS</span><span class="p">);</span>
</span><span id="__span-41-25"><a id="__codelineno-41-25" name="__codelineno-41-25" href="#__codelineno-41-25"></a><span class="w">            </span><span class="c1">// We cannot use Profiles.of(...) since profile expressions are not supported</span>
</span><span id="__span-41-26"><a id="__codelineno-41-26" name="__codelineno-41-26" href="#__codelineno-41-26"></a><span class="w">            </span><span class="c1">// in XML config. See SPR-12458 for details.</span>
</span><span id="__span-41-27"><a id="__codelineno-41-27" name="__codelineno-41-27" href="#__codelineno-41-27"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">getReaderContext</span><span class="p">().</span><span class="na">getEnvironment</span><span class="p">().</span><span class="na">acceptsProfiles</span><span class="p">(</span><span class="n">specifiedProfiles</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-28"><a id="__codelineno-41-28" name="__codelineno-41-28" href="#__codelineno-41-28"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isDebugEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-29"><a id="__codelineno-41-29" name="__codelineno-41-29" href="#__codelineno-41-29"></a><span class="w">                    </span><span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Skipped XML bean definition file due to specified profiles [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">profileSpec</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-41-30"><a id="__codelineno-41-30" name="__codelineno-41-30" href="#__codelineno-41-30"></a><span class="w">                            </span><span class="s">&quot;] not matching: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">getReaderContext</span><span class="p">().</span><span class="na">getResource</span><span class="p">());</span>
</span><span id="__span-41-31"><a id="__codelineno-41-31" name="__codelineno-41-31" href="#__codelineno-41-31"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-41-32"><a id="__codelineno-41-32" name="__codelineno-41-32" href="#__codelineno-41-32"></a><span class="w">                </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-41-33"><a id="__codelineno-41-33" name="__codelineno-41-33" href="#__codelineno-41-33"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-41-34"><a id="__codelineno-41-34" name="__codelineno-41-34" href="#__codelineno-41-34"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-41-35"><a id="__codelineno-41-35" name="__codelineno-41-35" href="#__codelineno-41-35"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-36"><a id="__codelineno-41-36" name="__codelineno-41-36" href="#__codelineno-41-36"></a>
</span><span id="__span-41-37"><a id="__codelineno-41-37" name="__codelineno-41-37" href="#__codelineno-41-37"></a><span class="w">    </span><span class="n">preProcessXml</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>
</span><span id="__span-41-38"><a id="__codelineno-41-38" name="__codelineno-41-38" href="#__codelineno-41-38"></a><span class="w">    </span><span class="c1">// 核心逻辑</span>
</span><span id="__span-41-39"><a id="__codelineno-41-39" name="__codelineno-41-39" href="#__codelineno-41-39"></a><span class="w">    </span><span class="n">parseBeanDefinitions</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">delegate</span><span class="p">);</span>
</span><span id="__span-41-40"><a id="__codelineno-41-40" name="__codelineno-41-40" href="#__codelineno-41-40"></a><span class="w">    </span><span class="n">postProcessXml</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>
</span><span id="__span-41-41"><a id="__codelineno-41-41" name="__codelineno-41-41" href="#__codelineno-41-41"></a>
</span><span id="__span-41-42"><a id="__codelineno-41-42" name="__codelineno-41-42" href="#__codelineno-41-42"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">delegate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">;</span>
</span><span id="__span-41-43"><a id="__codelineno-41-43" name="__codelineno-41-43" href="#__codelineno-41-43"></a><span class="p">}</span>
</span><span id="__span-41-44"><a id="__codelineno-41-44" name="__codelineno-41-44" href="#__codelineno-41-44"></a>
</span><span id="__span-41-45"><a id="__codelineno-41-45" name="__codelineno-41-45" href="#__codelineno-41-45"></a><span class="c1">// 上面方法中调用的parseBeanDefinitions(root, this.delegate)对应的方法实现</span>
</span><span id="__span-41-46"><a id="__codelineno-41-46" name="__codelineno-41-46" href="#__codelineno-41-46"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">parseBeanDefinitions</span><span class="p">(</span><span class="n">Element</span><span class="w"> </span><span class="n">root</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionParserDelegate</span><span class="w"> </span><span class="n">delegate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-47"><a id="__codelineno-41-47" name="__codelineno-41-47" href="#__codelineno-41-47"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">delegate</span><span class="p">.</span><span class="na">isDefaultNamespace</span><span class="p">(</span><span class="n">root</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-48"><a id="__codelineno-41-48" name="__codelineno-41-48" href="#__codelineno-41-48"></a><span class="w">        </span><span class="n">NodeList</span><span class="w"> </span><span class="n">nl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">root</span><span class="p">.</span><span class="na">getChildNodes</span><span class="p">();</span>
</span><span id="__span-41-49"><a id="__codelineno-41-49" name="__codelineno-41-49" href="#__codelineno-41-49"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nl</span><span class="p">.</span><span class="na">getLength</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-50"><a id="__codelineno-41-50" name="__codelineno-41-50" href="#__codelineno-41-50"></a><span class="w">            </span><span class="n">Node</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nl</span><span class="p">.</span><span class="na">item</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span><span id="__span-41-51"><a id="__codelineno-41-51" name="__codelineno-41-51" href="#__codelineno-41-51"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">Element</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-52"><a id="__codelineno-41-52" name="__codelineno-41-52" href="#__codelineno-41-52"></a><span class="w">                </span><span class="n">Element</span><span class="w"> </span><span class="n">ele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Element</span><span class="p">)</span><span class="w"> </span><span class="n">node</span><span class="p">;</span>
</span><span id="__span-41-53"><a id="__codelineno-41-53" name="__codelineno-41-53" href="#__codelineno-41-53"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">delegate</span><span class="p">.</span><span class="na">isDefaultNamespace</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-54"><a id="__codelineno-41-54" name="__codelineno-41-54" href="#__codelineno-41-54"></a><span class="w">                    </span><span class="c1">// 本方法的核心逻辑</span>
</span><span id="__span-41-55"><a id="__codelineno-41-55" name="__codelineno-41-55" href="#__codelineno-41-55"></a><span class="w">                    </span><span class="n">parseDefaultElement</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span><span class="w"> </span><span class="n">delegate</span><span class="p">);</span>
</span><span id="__span-41-56"><a id="__codelineno-41-56" name="__codelineno-41-56" href="#__codelineno-41-56"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-41-57"><a id="__codelineno-41-57" name="__codelineno-41-57" href="#__codelineno-41-57"></a><span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-58"><a id="__codelineno-41-58" name="__codelineno-41-58" href="#__codelineno-41-58"></a><span class="w">                    </span><span class="n">delegate</span><span class="p">.</span><span class="na">parseCustomElement</span><span class="p">(</span><span class="n">ele</span><span class="p">);</span>
</span><span id="__span-41-59"><a id="__codelineno-41-59" name="__codelineno-41-59" href="#__codelineno-41-59"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-41-60"><a id="__codelineno-41-60" name="__codelineno-41-60" href="#__codelineno-41-60"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-41-61"><a id="__codelineno-41-61" name="__codelineno-41-61" href="#__codelineno-41-61"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-41-62"><a id="__codelineno-41-62" name="__codelineno-41-62" href="#__codelineno-41-62"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-63"><a id="__codelineno-41-63" name="__codelineno-41-63" href="#__codelineno-41-63"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-64"><a id="__codelineno-41-64" name="__codelineno-41-64" href="#__codelineno-41-64"></a><span class="w">        </span><span class="n">delegate</span><span class="p">.</span><span class="na">parseCustomElement</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>
</span><span id="__span-41-65"><a id="__codelineno-41-65" name="__codelineno-41-65" href="#__codelineno-41-65"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-66"><a id="__codelineno-41-66" name="__codelineno-41-66" href="#__codelineno-41-66"></a><span class="p">}</span>
</span><span id="__span-41-67"><a id="__codelineno-41-67" name="__codelineno-41-67" href="#__codelineno-41-67"></a>
</span><span id="__span-41-68"><a id="__codelineno-41-68" name="__codelineno-41-68" href="#__codelineno-41-68"></a>
</span><span id="__span-41-69"><a id="__codelineno-41-69" name="__codelineno-41-69" href="#__codelineno-41-69"></a><span class="c1">// 上述方法调用的parseDefaultElement(ele, delegate);的具体实现</span>
</span><span id="__span-41-70"><a id="__codelineno-41-70" name="__codelineno-41-70" href="#__codelineno-41-70"></a><span class="c1">// 根据bean配置的不同，进入不同分支</span>
</span><span id="__span-41-71"><a id="__codelineno-41-71" name="__codelineno-41-71" href="#__codelineno-41-71"></a><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">parseDefaultElement</span><span class="p">(</span><span class="n">Element</span><span class="w"> </span><span class="n">ele</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionParserDelegate</span><span class="w"> </span><span class="n">delegate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-72"><a id="__codelineno-41-72" name="__codelineno-41-72" href="#__codelineno-41-72"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">delegate</span><span class="p">.</span><span class="na">nodeNameEquals</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span><span class="w"> </span><span class="n">IMPORT_ELEMENT</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-73"><a id="__codelineno-41-73" name="__codelineno-41-73" href="#__codelineno-41-73"></a><span class="w">        </span><span class="n">importBeanDefinitionResource</span><span class="p">(</span><span class="n">ele</span><span class="p">);</span>
</span><span id="__span-41-74"><a id="__codelineno-41-74" name="__codelineno-41-74" href="#__codelineno-41-74"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-75"><a id="__codelineno-41-75" name="__codelineno-41-75" href="#__codelineno-41-75"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">delegate</span><span class="p">.</span><span class="na">nodeNameEquals</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span><span class="w"> </span><span class="n">ALIAS_ELEMENT</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-76"><a id="__codelineno-41-76" name="__codelineno-41-76" href="#__codelineno-41-76"></a><span class="w">        </span><span class="n">processAliasRegistration</span><span class="p">(</span><span class="n">ele</span><span class="p">);</span>
</span><span id="__span-41-77"><a id="__codelineno-41-77" name="__codelineno-41-77" href="#__codelineno-41-77"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-78"><a id="__codelineno-41-78" name="__codelineno-41-78" href="#__codelineno-41-78"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">delegate</span><span class="p">.</span><span class="na">nodeNameEquals</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span><span class="w"> </span><span class="n">BEAN_ELEMENT</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-79"><a id="__codelineno-41-79" name="__codelineno-41-79" href="#__codelineno-41-79"></a><span class="w">        </span><span class="c1">// 本文示例会进入该方法</span>
</span><span id="__span-41-80"><a id="__codelineno-41-80" name="__codelineno-41-80" href="#__codelineno-41-80"></a><span class="w">        </span><span class="n">processBeanDefinition</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span><span class="w"> </span><span class="n">delegate</span><span class="p">);</span>
</span><span id="__span-41-81"><a id="__codelineno-41-81" name="__codelineno-41-81" href="#__codelineno-41-81"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-82"><a id="__codelineno-41-82" name="__codelineno-41-82" href="#__codelineno-41-82"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">delegate</span><span class="p">.</span><span class="na">nodeNameEquals</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span><span class="w"> </span><span class="n">NESTED_BEANS_ELEMENT</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-83"><a id="__codelineno-41-83" name="__codelineno-41-83" href="#__codelineno-41-83"></a><span class="w">        </span><span class="c1">// recurse</span>
</span><span id="__span-41-84"><a id="__codelineno-41-84" name="__codelineno-41-84" href="#__codelineno-41-84"></a><span class="w">        </span><span class="n">doRegisterBeanDefinitions</span><span class="p">(</span><span class="n">ele</span><span class="p">);</span>
</span><span id="__span-41-85"><a id="__codelineno-41-85" name="__codelineno-41-85" href="#__codelineno-41-85"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-86"><a id="__codelineno-41-86" name="__codelineno-41-86" href="#__codelineno-41-86"></a><span class="p">}</span>
</span><span id="__span-41-87"><a id="__codelineno-41-87" name="__codelineno-41-87" href="#__codelineno-41-87"></a>
</span><span id="__span-41-88"><a id="__codelineno-41-88" name="__codelineno-41-88" href="#__codelineno-41-88"></a><span class="c1">// 上述方法最后进入processBeanDefinition(ele, delegate)后的处理过程：</span>
</span><span id="__span-41-89"><a id="__codelineno-41-89" name="__codelineno-41-89" href="#__codelineno-41-89"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">processBeanDefinition</span><span class="p">(</span><span class="n">Element</span><span class="w"> </span><span class="n">ele</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionParserDelegate</span><span class="w"> </span><span class="n">delegate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-90"><a id="__codelineno-41-90" name="__codelineno-41-90" href="#__codelineno-41-90"></a><span class="w">    </span><span class="n">BeanDefinitionHolder</span><span class="w"> </span><span class="n">bdHolder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delegate</span><span class="p">.</span><span class="na">parseBeanDefinitionElement</span><span class="p">(</span><span class="n">ele</span><span class="p">);</span>
</span><span id="__span-41-91"><a id="__codelineno-41-91" name="__codelineno-41-91" href="#__codelineno-41-91"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bdHolder</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-92"><a id="__codelineno-41-92" name="__codelineno-41-92" href="#__codelineno-41-92"></a><span class="w">        </span><span class="n">bdHolder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">delegate</span><span class="p">.</span><span class="na">decorateBeanDefinitionIfRequired</span><span class="p">(</span><span class="n">ele</span><span class="p">,</span><span class="w"> </span><span class="n">bdHolder</span><span class="p">);</span>
</span><span id="__span-41-93"><a id="__codelineno-41-93" name="__codelineno-41-93" href="#__codelineno-41-93"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-94"><a id="__codelineno-41-94" name="__codelineno-41-94" href="#__codelineno-41-94"></a><span class="w">            </span><span class="c1">// Register the final decorated instance.</span>
</span><span id="__span-41-95"><a id="__codelineno-41-95" name="__codelineno-41-95" href="#__codelineno-41-95"></a><span class="w">            </span><span class="c1">// 注册Bean的关键代码</span>
</span><span id="__span-41-96"><a id="__codelineno-41-96" name="__codelineno-41-96" href="#__codelineno-41-96"></a><span class="w">            </span><span class="n">BeanDefinitionReaderUtils</span><span class="p">.</span><span class="na">registerBeanDefinition</span><span class="p">(</span><span class="n">bdHolder</span><span class="p">,</span><span class="w"> </span><span class="n">getReaderContext</span><span class="p">().</span><span class="na">getRegistry</span><span class="p">());</span>
</span><span id="__span-41-97"><a id="__codelineno-41-97" name="__codelineno-41-97" href="#__codelineno-41-97"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-41-98"><a id="__codelineno-41-98" name="__codelineno-41-98" href="#__codelineno-41-98"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-99"><a id="__codelineno-41-99" name="__codelineno-41-99" href="#__codelineno-41-99"></a><span class="w">            </span><span class="n">getReaderContext</span><span class="p">().</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Failed to register bean definition with name &#39;&quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-41-100"><a id="__codelineno-41-100" name="__codelineno-41-100" href="#__codelineno-41-100"></a><span class="w">                    </span><span class="n">bdHolder</span><span class="p">.</span><span class="na">getBeanName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ele</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-41-101"><a id="__codelineno-41-101" name="__codelineno-41-101" href="#__codelineno-41-101"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-41-102"><a id="__codelineno-41-102" name="__codelineno-41-102" href="#__codelineno-41-102"></a><span class="w">        </span><span class="c1">// Send registration event.</span>
</span><span id="__span-41-103"><a id="__codelineno-41-103" name="__codelineno-41-103" href="#__codelineno-41-103"></a><span class="w">        </span><span class="n">getReaderContext</span><span class="p">().</span><span class="na">fireComponentRegistered</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BeanComponentDefinition</span><span class="p">(</span><span class="n">bdHolder</span><span class="p">));</span>
</span><span id="__span-41-104"><a id="__codelineno-41-104" name="__codelineno-41-104" href="#__codelineno-41-104"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-41-105"><a id="__codelineno-41-105" name="__codelineno-41-105" href="#__codelineno-41-105"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="beandefinitionreaderutilsregisterbeandefinitionbdholder-getreadercontextgetregistry">BeanDefinitionReaderUtils的registerBeanDefinition(bdHolder, getReaderContext().getRegistry())方法<a class="headerlink" href="#beandefinitionreaderutilsregisterbeandefinitionbdholder-getreadercontextgetregistry" title="Permanent link">&para;</a></h4>
<ul>
<li>主要作用：</li>
<li>代码位置：org.springframework.beans.factory.support.BeanDefinitionReaderUtils
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerBeanDefinition</span><span class="p">(</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="w">        </span><span class="n">BeanDefinitionHolder</span><span class="w"> </span><span class="n">definitionHolder</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">    </span><span class="c1">// Register bean definition under primary name.</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">definitionHolder</span><span class="p">.</span><span class="na">getBeanName</span><span class="p">();</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="w">    </span><span class="c1">// 将Bean的名字和BeanDefinition对象进行注册</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="w">    </span><span class="c1">// registerBeanDefinition(beanName, definitionHolder.getBeanDefinition());方法定义在BeanDefinitionRegistry接口中：</span>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="w">    </span><span class="c1">// 具体实现在中实现</span>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="w">    </span><span class="n">registry</span><span class="p">.</span><span class="na">registerBeanDefinition</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">definitionHolder</span><span class="p">.</span><span class="na">getBeanDefinition</span><span class="p">());</span>
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a>
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="w">    </span><span class="c1">// Register aliases for bean name, if any.</span>
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">aliases</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">definitionHolder</span><span class="p">.</span><span class="na">getAliases</span><span class="p">();</span>
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">aliases</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-15"><a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">alias</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">aliases</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-16"><a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a><span class="w">            </span><span class="n">registry</span><span class="p">.</span><span class="na">registerAlias</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">alias</span><span class="p">);</span>
</span><span id="__span-42-17"><a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-42-18"><a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-42-19"><a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="defaultlistablebeanfactoryregisterbeandefinitionstring-beanname-beandefinition-beandefinition">DefaultListableBeanFactory中registerBeanDefinition(String beanName, BeanDefinition beanDefinition)<a class="headerlink" href="#defaultlistablebeanfactoryregisterbeandefinitionstring-beanname-beandefinition-beandefinition" title="Permanent link">&para;</a></h4>
<ul>
<li>作用：</li>
<li>DefaultListableBeanFactory的字段beanDefinitionMap是一个ConcurrentHashMap<String, BeanDefinition>，用于存储bean的定义信息</li>
<li>DefaultListableBeanFactory的字段beanDefinitionNames是一个ArrayList<String>类型数据，用于存储Bean的名称</li>
<li>
<h2 id="orgspringframeworkbeansfactorysupportdefaultlistablebeanfactory">代码位置：org.springframework.beans.factory.support.DefaultListableBeanFactory<a class="headerlink" href="#orgspringframeworkbeansfactorysupportdefaultlistablebeanfactory" title="Permanent link">&para;</a></h2>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="nd">@Override</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerBeanDefinition</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinition</span><span class="w"> </span><span class="n">beanDefinition</span><span class="p">)</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="na">hasText</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Bean name must not be empty&quot;</span><span class="p">);</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="na">notNull</span><span class="p">(</span><span class="n">beanDefinition</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BeanDefinition must not be null&quot;</span><span class="p">);</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanDefinition</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">AbstractBeanDefinition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="w">            </span><span class="p">((</span><span class="n">AbstractBeanDefinition</span><span class="p">)</span><span class="w"> </span><span class="n">beanDefinition</span><span class="p">).</span><span class="na">validate</span><span class="p">();</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinitionValidationException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="p">(</span><span class="n">beanDefinition</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span>
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a><span class="w">                    </span><span class="s">&quot;Validation of bean definition failed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-43-15"><a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-43-16"><a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-43-17"><a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a>
</span><span id="__span-43-18"><a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a><span class="w">    </span><span class="n">BeanDefinition</span><span class="w"> </span><span class="n">existingDefinition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinitionMap</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-43-19"><a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a><span class="w">    </span><span class="c1">// 查找是否存在同名的bean</span>
</span><span id="__span-43-20"><a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">existingDefinition</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-21"><a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a><span class="w">        </span><span class="c1">// 有同名的bean存在时</span>
</span><span id="__span-43-22"><a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isAllowBeanDefinitionOverriding</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-23"><a id="__codelineno-43-23" name="__codelineno-43-23" href="#__codelineno-43-23"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionOverrideException</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">beanDefinition</span><span class="p">,</span><span class="w"> </span><span class="n">existingDefinition</span><span class="p">);</span>
</span><span id="__span-43-24"><a id="__codelineno-43-24" name="__codelineno-43-24" href="#__codelineno-43-24"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-43-25"><a id="__codelineno-43-25" name="__codelineno-43-25" href="#__codelineno-43-25"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">existingDefinition</span><span class="p">.</span><span class="na">getRole</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">beanDefinition</span><span class="p">.</span><span class="na">getRole</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-26"><a id="__codelineno-43-26" name="__codelineno-43-26" href="#__codelineno-43-26"></a><span class="w">            </span><span class="c1">// e.g. was ROLE_APPLICATION, now overriding with ROLE_SUPPORT or ROLE_INFRASTRUCTURE</span>
</span><span id="__span-43-27"><a id="__codelineno-43-27" name="__codelineno-43-27" href="#__codelineno-43-27"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isInfoEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-28"><a id="__codelineno-43-28" name="__codelineno-43-28" href="#__codelineno-43-28"></a><span class="w">                </span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;Overriding user-defined bean definition for bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-43-29"><a id="__codelineno-43-29" name="__codelineno-43-29" href="#__codelineno-43-29"></a><span class="w">                        </span><span class="s">&quot;&#39; with a framework-generated bean definition: replacing [&quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-43-30"><a id="__codelineno-43-30" name="__codelineno-43-30" href="#__codelineno-43-30"></a><span class="w">                        </span><span class="n">existingDefinition</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;] with [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanDefinition</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">);</span>
</span><span id="__span-43-31"><a id="__codelineno-43-31" name="__codelineno-43-31" href="#__codelineno-43-31"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-43-32"><a id="__codelineno-43-32" name="__codelineno-43-32" href="#__codelineno-43-32"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-43-33"><a id="__codelineno-43-33" name="__codelineno-43-33" href="#__codelineno-43-33"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">beanDefinition</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">existingDefinition</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-34"><a id="__codelineno-43-34" name="__codelineno-43-34" href="#__codelineno-43-34"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isDebugEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-35"><a id="__codelineno-43-35" name="__codelineno-43-35" href="#__codelineno-43-35"></a><span class="w">                </span><span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Overriding bean definition for bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-43-36"><a id="__codelineno-43-36" name="__codelineno-43-36" href="#__codelineno-43-36"></a><span class="w">                        </span><span class="s">&quot;&#39; with a different definition: replacing [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">existingDefinition</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-43-37"><a id="__codelineno-43-37" name="__codelineno-43-37" href="#__codelineno-43-37"></a><span class="w">                        </span><span class="s">&quot;] with [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanDefinition</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">);</span>
</span><span id="__span-43-38"><a id="__codelineno-43-38" name="__codelineno-43-38" href="#__codelineno-43-38"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-43-39"><a id="__codelineno-43-39" name="__codelineno-43-39" href="#__codelineno-43-39"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-43-40"><a id="__codelineno-43-40" name="__codelineno-43-40" href="#__codelineno-43-40"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-41"><a id="__codelineno-43-41" name="__codelineno-43-41" href="#__codelineno-43-41"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-42"><a id="__codelineno-43-42" name="__codelineno-43-42" href="#__codelineno-43-42"></a><span class="w">                </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Overriding bean definition for bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-43-43"><a id="__codelineno-43-43" name="__codelineno-43-43" href="#__codelineno-43-43"></a><span class="w">                        </span><span class="s">&quot;&#39; with an equivalent definition: replacing [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">existingDefinition</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-43-44"><a id="__codelineno-43-44" name="__codelineno-43-44" href="#__codelineno-43-44"></a><span class="w">                        </span><span class="s">&quot;] with [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanDefinition</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">);</span>
</span><span id="__span-43-45"><a id="__codelineno-43-45" name="__codelineno-43-45" href="#__codelineno-43-45"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-43-46"><a id="__codelineno-43-46" name="__codelineno-43-46" href="#__codelineno-43-46"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-43-47"><a id="__codelineno-43-47" name="__codelineno-43-47" href="#__codelineno-43-47"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinitionMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">beanDefinition</span><span class="p">);</span>
</span><span id="__span-43-48"><a id="__codelineno-43-48" name="__codelineno-43-48" href="#__codelineno-43-48"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-43-49"><a id="__codelineno-43-49" name="__codelineno-43-49" href="#__codelineno-43-49"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-50"><a id="__codelineno-43-50" name="__codelineno-43-50" href="#__codelineno-43-50"></a><span class="w">        </span><span class="c1">// 没有同名的bean存在时</span>
</span><span id="__span-43-51"><a id="__codelineno-43-51" name="__codelineno-43-51" href="#__codelineno-43-51"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hasBeanCreationStarted</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-52"><a id="__codelineno-43-52" name="__codelineno-43-52" href="#__codelineno-43-52"></a><span class="w">            </span><span class="c1">// Cannot modify startup-time collection elements anymore (for stable iteration)</span>
</span><span id="__span-43-53"><a id="__codelineno-43-53" name="__codelineno-43-53" href="#__codelineno-43-53"></a><span class="w">            </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinitionMap</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-54"><a id="__codelineno-43-54" name="__codelineno-43-54" href="#__codelineno-43-54"></a><span class="w">                </span><span class="c1">// beanDefinitionMap存储beanName:BeanDefinition一一对应的K:V信息</span>
</span><span id="__span-43-55"><a id="__codelineno-43-55" name="__codelineno-43-55" href="#__codelineno-43-55"></a><span class="w">                </span><span class="c1">// beanName作为key， beanDefinition作为value存入DefaultListableBeanFactory对象的beanDefinitionMap字段中</span>
</span><span id="__span-43-56"><a id="__codelineno-43-56" name="__codelineno-43-56" href="#__codelineno-43-56"></a><span class="w">                </span><span class="c1">// 完成Bean的注册，将Bean注册到BeanFactory中</span>
</span><span id="__span-43-57"><a id="__codelineno-43-57" name="__codelineno-43-57" href="#__codelineno-43-57"></a><span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinitionMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">beanDefinition</span><span class="p">);</span>
</span><span id="__span-43-58"><a id="__codelineno-43-58" name="__codelineno-43-58" href="#__codelineno-43-58"></a><span class="w">                </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">updatedDefinitions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinitionNames</span><span class="p">.</span><span class="na">size</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-43-59"><a id="__codelineno-43-59" name="__codelineno-43-59" href="#__codelineno-43-59"></a><span class="w">                </span><span class="n">updatedDefinitions</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinitionNames</span><span class="p">);</span>
</span><span id="__span-43-60"><a id="__codelineno-43-60" name="__codelineno-43-60" href="#__codelineno-43-60"></a><span class="w">                </span><span class="n">updatedDefinitions</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-43-61"><a id="__codelineno-43-61" name="__codelineno-43-61" href="#__codelineno-43-61"></a><span class="w">                </span><span class="c1">// 将所有的beanName保存到beanDefinitionNames字段中，数据类型为</span>
</span><span id="__span-43-62"><a id="__codelineno-43-62" name="__codelineno-43-62" href="#__codelineno-43-62"></a><span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinitionNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updatedDefinitions</span><span class="p">;</span>
</span><span id="__span-43-63"><a id="__codelineno-43-63" name="__codelineno-43-63" href="#__codelineno-43-63"></a><span class="w">                </span><span class="n">removeManualSingletonName</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-43-64"><a id="__codelineno-43-64" name="__codelineno-43-64" href="#__codelineno-43-64"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-43-65"><a id="__codelineno-43-65" name="__codelineno-43-65" href="#__codelineno-43-65"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-43-66"><a id="__codelineno-43-66" name="__codelineno-43-66" href="#__codelineno-43-66"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-67"><a id="__codelineno-43-67" name="__codelineno-43-67" href="#__codelineno-43-67"></a><span class="w">            </span><span class="c1">// Still in startup registration phase</span>
</span><span id="__span-43-68"><a id="__codelineno-43-68" name="__codelineno-43-68" href="#__codelineno-43-68"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinitionMap</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">beanDefinition</span><span class="p">);</span>
</span><span id="__span-43-69"><a id="__codelineno-43-69" name="__codelineno-43-69" href="#__codelineno-43-69"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinitionNames</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-43-70"><a id="__codelineno-43-70" name="__codelineno-43-70" href="#__codelineno-43-70"></a><span class="w">            </span><span class="n">removeManualSingletonName</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-43-71"><a id="__codelineno-43-71" name="__codelineno-43-71" href="#__codelineno-43-71"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-43-72"><a id="__codelineno-43-72" name="__codelineno-43-72" href="#__codelineno-43-72"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">frozenBeanDefinitionNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-43-73"><a id="__codelineno-43-73" name="__codelineno-43-73" href="#__codelineno-43-73"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-43-74"><a id="__codelineno-43-74" name="__codelineno-43-74" href="#__codelineno-43-74"></a>
</span><span id="__span-43-75"><a id="__codelineno-43-75" name="__codelineno-43-75" href="#__codelineno-43-75"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">existingDefinition</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">containsSingleton</span><span class="p">(</span><span class="n">beanName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-76"><a id="__codelineno-43-76" name="__codelineno-43-76" href="#__codelineno-43-76"></a><span class="w">        </span><span class="n">resetBeanDefinition</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-43-77"><a id="__codelineno-43-77" name="__codelineno-43-77" href="#__codelineno-43-77"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-43-78"><a id="__codelineno-43-78" name="__codelineno-43-78" href="#__codelineno-43-78"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>到此上面的 loadBeanDefinitions(XmlBeanDefinitionReader reader)方法基本执行完成</li>
<li>上一级的loadBeanDefinitions(DefaultListableBeanFactory beanFactory)方法也执行到loadBeanDefinitions(XmlBeanDefinitionReader reader)方法后结束</li>
<li>在上述创建BeanFactory的过程中，BeanDefination注册到BeanFactory（DefaultListableBeanFactory）中的类型为ConcurrentHashMap<String, BeanDefinition>，字段名beanDefinitionMap的为对象中</li>
<li>向beanDefinitionMap中注册时beanName为key,beanDefination为value；</li>
<li>DefaultListableBeanFactory对象的字段beanDefinitionNames是一个ArrayList<String>类型数据，用于存储所有已经注册的Bean的名称</li>
<li>refreshBeanFactory()方法执行完成，接下来进入其下一行的getBeanFactory()方法</li>
</ul>
<h3 id="getbeanfactory">getBeanFactory()方法的一种实现<a class="headerlink" href="#getbeanfactory" title="Permanent link">&para;</a></h3>
<ul>
<li>AbstractRefreshableApplicationContext中getBeanFactory()方法的一种实现</li>
<li>获取BeanFactory
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="nd">@Override</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="nf">getBeanFactory</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">    </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanFactoryMonitor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="w">           </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;BeanFactory not initialized or already closed - call &#39;refresh&#39; before accessing beans via the ApplicationContext&quot;</span><span class="p">);</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">;</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>getBeanFactory()方法执行完，标志上一级的方法obtainFreshBeanFactory()执行完成，接下来将进入AbstractApplicationContext抽象类中定义的refresh()模板方法中的第三步定义的prepareBeanFactory(beanFactory)方法</li>
</ul>
<h1 id="6-preparebeanfactorybeanfactory">6 prepareBeanFactory(beanFactory)方法<a class="headerlink" href="#6-preparebeanfactorybeanfactory" title="Permanent link">&para;</a></h1>
<ul>
<li>代码位置: org.springframework.context.support.AbstractApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">prepareBeanFactory</span><span class="p">(</span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="w">        </span><span class="c1">// Tell the internal bean factory to use the context&#39;s class loader etc.</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">setBeanClassLoader</span><span class="p">(</span><span class="n">getClassLoader</span><span class="p">());</span>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">setBeanExpressionResolver</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">StandardBeanExpressionResolver</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanClassLoader</span><span class="p">()));</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">addPropertyEditorRegistrar</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ResourceEditorRegistrar</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">getEnvironment</span><span class="p">()));</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a><span class="w">        </span><span class="c1">// Configure the bean factory with context callbacks.</span>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">addBeanPostProcessor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ApplicationContextAwareProcessor</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9" href="#__codelineno-45-9"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">ignoreDependencyInterface</span><span class="p">(</span><span class="n">EnvironmentAware</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-45-10"><a id="__codelineno-45-10" name="__codelineno-45-10" href="#__codelineno-45-10"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">ignoreDependencyInterface</span><span class="p">(</span><span class="n">EmbeddedValueResolverAware</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-45-11"><a id="__codelineno-45-11" name="__codelineno-45-11" href="#__codelineno-45-11"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">ignoreDependencyInterface</span><span class="p">(</span><span class="n">ResourceLoaderAware</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-45-12"><a id="__codelineno-45-12" name="__codelineno-45-12" href="#__codelineno-45-12"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">ignoreDependencyInterface</span><span class="p">(</span><span class="n">ApplicationEventPublisherAware</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-45-13"><a id="__codelineno-45-13" name="__codelineno-45-13" href="#__codelineno-45-13"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">ignoreDependencyInterface</span><span class="p">(</span><span class="n">MessageSourceAware</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-45-14"><a id="__codelineno-45-14" name="__codelineno-45-14" href="#__codelineno-45-14"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">ignoreDependencyInterface</span><span class="p">(</span><span class="n">ApplicationContextAware</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-45-15"><a id="__codelineno-45-15" name="__codelineno-45-15" href="#__codelineno-45-15"></a>
</span><span id="__span-45-16"><a id="__codelineno-45-16" name="__codelineno-45-16" href="#__codelineno-45-16"></a><span class="w">        </span><span class="c1">// BeanFactory interface not registered as resolvable type in a plain factory.</span>
</span><span id="__span-45-17"><a id="__codelineno-45-17" name="__codelineno-45-17" href="#__codelineno-45-17"></a><span class="w">        </span><span class="c1">// MessageSource registered (and found for autowiring) as a bean.</span>
</span><span id="__span-45-18"><a id="__codelineno-45-18" name="__codelineno-45-18" href="#__codelineno-45-18"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">registerResolvableDependency</span><span class="p">(</span><span class="n">BeanFactory</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-45-19"><a id="__codelineno-45-19" name="__codelineno-45-19" href="#__codelineno-45-19"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">registerResolvableDependency</span><span class="p">(</span><span class="n">ResourceLoader</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
</span><span id="__span-45-20"><a id="__codelineno-45-20" name="__codelineno-45-20" href="#__codelineno-45-20"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">registerResolvableDependency</span><span class="p">(</span><span class="n">ApplicationEventPublisher</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
</span><span id="__span-45-21"><a id="__codelineno-45-21" name="__codelineno-45-21" href="#__codelineno-45-21"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">registerResolvableDependency</span><span class="p">(</span><span class="n">ApplicationContext</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
</span><span id="__span-45-22"><a id="__codelineno-45-22" name="__codelineno-45-22" href="#__codelineno-45-22"></a>
</span><span id="__span-45-23"><a id="__codelineno-45-23" name="__codelineno-45-23" href="#__codelineno-45-23"></a><span class="w">        </span><span class="c1">// Register early post-processor for detecting inner beans as ApplicationListeners.</span>
</span><span id="__span-45-24"><a id="__codelineno-45-24" name="__codelineno-45-24" href="#__codelineno-45-24"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">addBeanPostProcessor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ApplicationListenerDetector</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
</span><span id="__span-45-25"><a id="__codelineno-45-25" name="__codelineno-45-25" href="#__codelineno-45-25"></a>
</span><span id="__span-45-26"><a id="__codelineno-45-26" name="__codelineno-45-26" href="#__codelineno-45-26"></a><span class="w">        </span><span class="c1">// Detect a LoadTimeWeaver and prepare for weaving, if found.</span>
</span><span id="__span-45-27"><a id="__codelineno-45-27" name="__codelineno-45-27" href="#__codelineno-45-27"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">containsBean</span><span class="p">(</span><span class="n">LOAD_TIME_WEAVER_BEAN_NAME</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-28"><a id="__codelineno-45-28" name="__codelineno-45-28" href="#__codelineno-45-28"></a><span class="w">            </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">addBeanPostProcessor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">LoadTimeWeaverAwareProcessor</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">));</span>
</span><span id="__span-45-29"><a id="__codelineno-45-29" name="__codelineno-45-29" href="#__codelineno-45-29"></a><span class="w">            </span><span class="c1">// Set a temporary ClassLoader for type matching.</span>
</span><span id="__span-45-30"><a id="__codelineno-45-30" name="__codelineno-45-30" href="#__codelineno-45-30"></a><span class="w">            </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">setTempClassLoader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ContextTypeMatchClassLoader</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanClassLoader</span><span class="p">()));</span>
</span><span id="__span-45-31"><a id="__codelineno-45-31" name="__codelineno-45-31" href="#__codelineno-45-31"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-32"><a id="__codelineno-45-32" name="__codelineno-45-32" href="#__codelineno-45-32"></a>
</span><span id="__span-45-33"><a id="__codelineno-45-33" name="__codelineno-45-33" href="#__codelineno-45-33"></a><span class="w">        </span><span class="c1">// Register default environment beans.</span>
</span><span id="__span-45-34"><a id="__codelineno-45-34" name="__codelineno-45-34" href="#__codelineno-45-34"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">containsLocalBean</span><span class="p">(</span><span class="n">ENVIRONMENT_BEAN_NAME</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-35"><a id="__codelineno-45-35" name="__codelineno-45-35" href="#__codelineno-45-35"></a><span class="w">            </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">registerSingleton</span><span class="p">(</span><span class="n">ENVIRONMENT_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="n">getEnvironment</span><span class="p">());</span>
</span><span id="__span-45-36"><a id="__codelineno-45-36" name="__codelineno-45-36" href="#__codelineno-45-36"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-37"><a id="__codelineno-45-37" name="__codelineno-45-37" href="#__codelineno-45-37"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">containsLocalBean</span><span class="p">(</span><span class="n">SYSTEM_PROPERTIES_BEAN_NAME</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-38"><a id="__codelineno-45-38" name="__codelineno-45-38" href="#__codelineno-45-38"></a><span class="w">            </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">registerSingleton</span><span class="p">(</span><span class="n">SYSTEM_PROPERTIES_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="n">getEnvironment</span><span class="p">().</span><span class="na">getSystemProperties</span><span class="p">());</span>
</span><span id="__span-45-39"><a id="__codelineno-45-39" name="__codelineno-45-39" href="#__codelineno-45-39"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-40"><a id="__codelineno-45-40" name="__codelineno-45-40" href="#__codelineno-45-40"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">containsLocalBean</span><span class="p">(</span><span class="n">SYSTEM_ENVIRONMENT_BEAN_NAME</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-45-41"><a id="__codelineno-45-41" name="__codelineno-45-41" href="#__codelineno-45-41"></a><span class="w">            </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">registerSingleton</span><span class="p">(</span><span class="n">SYSTEM_ENVIRONMENT_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="n">getEnvironment</span><span class="p">().</span><span class="na">getSystemEnvironment</span><span class="p">());</span>
</span><span id="__span-45-42"><a id="__codelineno-45-42" name="__codelineno-45-42" href="#__codelineno-45-42"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-45-43"><a id="__codelineno-45-43" name="__codelineno-45-43" href="#__codelineno-45-43"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h1 id="7-postprocessbeanfactoryconfigurablelistablebeanfactory-beanfactory">7 postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory)<a class="headerlink" href="#7-postprocessbeanfactoryconfigurablelistablebeanfactory-beanfactory" title="Permanent link">&para;</a></h1>
<ul>
<li>代码位置:org.springframework.context.support.AbstractApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">postProcessBeanFactory</span><span class="p">(</span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="w">    </span><span class="c1">// 该方法是一个空方法，具体的实现依据具体的情况在其子类中继承或进行重写</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="w">    </span><span class="c1">// 观察AbstractApplicationContext到FileSystemXmlApplicationContext(location)的继承路径，其子类中并未实现具体的逻辑;</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>postProcessBeanFactory(beanFactory)执行完后进入 invokeBeanFactoryPostProcessors(beanFactory)方法</li>
</ul>
<h1 id="8-invokebeanfactorypostprocessorsbeanfactory">8. invokeBeanFactoryPostProcessors(beanFactory)方法<a class="headerlink" href="#8-invokebeanfactorypostprocessorsbeanfactory" title="Permanent link">&para;</a></h1>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="w">    </span><span class="n">PostProcessorRegistrationDelegate</span><span class="p">.</span><span class="na">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">getBeanFactoryPostProcessors</span><span class="p">());</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="w">    </span><span class="c1">// Detect a LoadTimeWeaver and prepare for weaving, if found in the meantime</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="w">    </span><span class="c1">// (e.g. through an @Bean method registered by ConfigurationClassPostProcessor)</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getTempClassLoader</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">containsBean</span><span class="p">(</span><span class="n">LOAD_TIME_WEAVER_BEAN_NAME</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">addBeanPostProcessor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">LoadTimeWeaverAwareProcessor</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">));</span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">setTempClassLoader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ContextTypeMatchClassLoader</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanClassLoader</span><span class="p">()));</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="p">}</span>
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a>
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getBeanFactoryPostProcessors</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-13"><a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactoryPostProcessors</span><span class="p">;</span>
</span><span id="__span-47-14"><a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a><span class="p">}</span>
</span></code></pre></div>
<ul>
<li>PostProcessorRegistrationDelegate的invokeBeanFactoryPostProcessors(ConfigurableListableBeanFactory beanFactory, List<BeanFactoryPostProcessor> beanFactoryPostProcessors)静态方法
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">invokeBeanFactoryPostProcessors</span><span class="p">(</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="w">        </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">beanFactoryPostProcessors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="w">    </span><span class="c1">// Invoke BeanDefinitionRegistryPostProcessors first, if any.</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="w">    </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">processedBeans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashSet</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BeanDefinitionRegistry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a><span class="w">        </span><span class="n">BeanDefinitionRegistry</span><span class="w"> </span><span class="n">registry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinitionRegistry</span><span class="p">)</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">;</span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">regularPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">registryProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a>
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">BeanFactoryPostProcessor</span><span class="w"> </span><span class="n">postProcessor</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanFactoryPostProcessors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-13"><a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">postProcessor</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-14"><a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a><span class="w">                </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="w"> </span><span class="n">registryProcessor</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-48-15"><a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a><span class="w">                        </span><span class="p">(</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="n">postProcessor</span><span class="p">;</span>
</span><span id="__span-48-16"><a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a><span class="w">                </span><span class="n">registryProcessor</span><span class="p">.</span><span class="na">postProcessBeanDefinitionRegistry</span><span class="p">(</span><span class="n">registry</span><span class="p">);</span>
</span><span id="__span-48-17"><a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a><span class="w">                </span><span class="n">registryProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">registryProcessor</span><span class="p">);</span>
</span><span id="__span-48-18"><a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-48-19"><a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-20"><a id="__codelineno-48-20" name="__codelineno-48-20" href="#__codelineno-48-20"></a><span class="w">                </span><span class="n">regularPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">postProcessor</span><span class="p">);</span>
</span><span id="__span-48-21"><a id="__codelineno-48-21" name="__codelineno-48-21" href="#__codelineno-48-21"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-48-22"><a id="__codelineno-48-22" name="__codelineno-48-22" href="#__codelineno-48-22"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-48-23"><a id="__codelineno-48-23" name="__codelineno-48-23" href="#__codelineno-48-23"></a>
</span><span id="__span-48-24"><a id="__codelineno-48-24" name="__codelineno-48-24" href="#__codelineno-48-24"></a><span class="w">        </span><span class="c1">// Do not initialize FactoryBeans here: We need to leave all regular beans</span>
</span><span id="__span-48-25"><a id="__codelineno-48-25" name="__codelineno-48-25" href="#__codelineno-48-25"></a><span class="w">        </span><span class="c1">// uninitialized to let the bean factory post-processors apply to them!</span>
</span><span id="__span-48-26"><a id="__codelineno-48-26" name="__codelineno-48-26" href="#__codelineno-48-26"></a><span class="w">        </span><span class="c1">// Separate between BeanDefinitionRegistryPostProcessors that implement</span>
</span><span id="__span-48-27"><a id="__codelineno-48-27" name="__codelineno-48-27" href="#__codelineno-48-27"></a><span class="w">        </span><span class="c1">// PriorityOrdered, Ordered, and the rest.</span>
</span><span id="__span-48-28"><a id="__codelineno-48-28" name="__codelineno-48-28" href="#__codelineno-48-28"></a><span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">currentRegistryProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-48-29"><a id="__codelineno-48-29" name="__codelineno-48-29" href="#__codelineno-48-29"></a>
</span><span id="__span-48-30"><a id="__codelineno-48-30" name="__codelineno-48-30" href="#__codelineno-48-30"></a><span class="w">        </span><span class="c1">// First, invoke the BeanDefinitionRegistryPostProcessors that implement PriorityOrdered.</span>
</span><span id="__span-48-31"><a id="__codelineno-48-31" name="__codelineno-48-31" href="#__codelineno-48-31"></a><span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-48-32"><a id="__codelineno-48-32" name="__codelineno-48-32" href="#__codelineno-48-32"></a><span class="w">                </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-48-33"><a id="__codelineno-48-33" name="__codelineno-48-33" href="#__codelineno-48-33"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-34"><a id="__codelineno-48-34" name="__codelineno-48-34" href="#__codelineno-48-34"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">PriorityOrdered</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-35"><a id="__codelineno-48-35" name="__codelineno-48-35" href="#__codelineno-48-35"></a><span class="w">                </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
</span><span id="__span-48-36"><a id="__codelineno-48-36" name="__codelineno-48-36" href="#__codelineno-48-36"></a><span class="w">                </span><span class="n">processedBeans</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
</span><span id="__span-48-37"><a id="__codelineno-48-37" name="__codelineno-48-37" href="#__codelineno-48-37"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-48-38"><a id="__codelineno-48-38" name="__codelineno-48-38" href="#__codelineno-48-38"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-48-39"><a id="__codelineno-48-39" name="__codelineno-48-39" href="#__codelineno-48-39"></a><span class="w">        </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-40"><a id="__codelineno-48-40" name="__codelineno-48-40" href="#__codelineno-48-40"></a><span class="w">        </span><span class="n">registryProcessors</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">);</span>
</span><span id="__span-48-41"><a id="__codelineno-48-41" name="__codelineno-48-41" href="#__codelineno-48-41"></a><span class="w">        </span><span class="n">invokeBeanDefinitionRegistryPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">registry</span><span class="p">);</span>
</span><span id="__span-48-42"><a id="__codelineno-48-42" name="__codelineno-48-42" href="#__codelineno-48-42"></a><span class="w">        </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
</span><span id="__span-48-43"><a id="__codelineno-48-43" name="__codelineno-48-43" href="#__codelineno-48-43"></a>
</span><span id="__span-48-44"><a id="__codelineno-48-44" name="__codelineno-48-44" href="#__codelineno-48-44"></a><span class="w">        </span><span class="c1">// Next, invoke the BeanDefinitionRegistryPostProcessors that implement Ordered.</span>
</span><span id="__span-48-45"><a id="__codelineno-48-45" name="__codelineno-48-45" href="#__codelineno-48-45"></a><span class="w">        </span><span class="n">postProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-48-46"><a id="__codelineno-48-46" name="__codelineno-48-46" href="#__codelineno-48-46"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-47"><a id="__codelineno-48-47" name="__codelineno-48-47" href="#__codelineno-48-47"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">processedBeans</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">ppName</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">Ordered</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-48"><a id="__codelineno-48-48" name="__codelineno-48-48" href="#__codelineno-48-48"></a><span class="w">                </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
</span><span id="__span-48-49"><a id="__codelineno-48-49" name="__codelineno-48-49" href="#__codelineno-48-49"></a><span class="w">                </span><span class="n">processedBeans</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
</span><span id="__span-48-50"><a id="__codelineno-48-50" name="__codelineno-48-50" href="#__codelineno-48-50"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-48-51"><a id="__codelineno-48-51" name="__codelineno-48-51" href="#__codelineno-48-51"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-48-52"><a id="__codelineno-48-52" name="__codelineno-48-52" href="#__codelineno-48-52"></a><span class="w">        </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-53"><a id="__codelineno-48-53" name="__codelineno-48-53" href="#__codelineno-48-53"></a><span class="w">        </span><span class="n">registryProcessors</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">);</span>
</span><span id="__span-48-54"><a id="__codelineno-48-54" name="__codelineno-48-54" href="#__codelineno-48-54"></a><span class="w">        </span><span class="n">invokeBeanDefinitionRegistryPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">registry</span><span class="p">);</span>
</span><span id="__span-48-55"><a id="__codelineno-48-55" name="__codelineno-48-55" href="#__codelineno-48-55"></a><span class="w">        </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
</span><span id="__span-48-56"><a id="__codelineno-48-56" name="__codelineno-48-56" href="#__codelineno-48-56"></a>
</span><span id="__span-48-57"><a id="__codelineno-48-57" name="__codelineno-48-57" href="#__codelineno-48-57"></a><span class="w">        </span><span class="c1">// Finally, invoke all other BeanDefinitionRegistryPostProcessors until no further ones appear.</span>
</span><span id="__span-48-58"><a id="__codelineno-48-58" name="__codelineno-48-58" href="#__codelineno-48-58"></a><span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">reiterate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-48-59"><a id="__codelineno-48-59" name="__codelineno-48-59" href="#__codelineno-48-59"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">reiterate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-60"><a id="__codelineno-48-60" name="__codelineno-48-60" href="#__codelineno-48-60"></a><span class="w">            </span><span class="n">reiterate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-48-61"><a id="__codelineno-48-61" name="__codelineno-48-61" href="#__codelineno-48-61"></a><span class="w">            </span><span class="n">postProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-48-62"><a id="__codelineno-48-62" name="__codelineno-48-62" href="#__codelineno-48-62"></a><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-63"><a id="__codelineno-48-63" name="__codelineno-48-63" href="#__codelineno-48-63"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">processedBeans</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">ppName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-64"><a id="__codelineno-48-64" name="__codelineno-48-64" href="#__codelineno-48-64"></a><span class="w">                    </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
</span><span id="__span-48-65"><a id="__codelineno-48-65" name="__codelineno-48-65" href="#__codelineno-48-65"></a><span class="w">                    </span><span class="n">processedBeans</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
</span><span id="__span-48-66"><a id="__codelineno-48-66" name="__codelineno-48-66" href="#__codelineno-48-66"></a><span class="w">                    </span><span class="n">reiterate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-48-67"><a id="__codelineno-48-67" name="__codelineno-48-67" href="#__codelineno-48-67"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-48-68"><a id="__codelineno-48-68" name="__codelineno-48-68" href="#__codelineno-48-68"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-48-69"><a id="__codelineno-48-69" name="__codelineno-48-69" href="#__codelineno-48-69"></a><span class="w">            </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-70"><a id="__codelineno-48-70" name="__codelineno-48-70" href="#__codelineno-48-70"></a><span class="w">            </span><span class="n">registryProcessors</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">);</span>
</span><span id="__span-48-71"><a id="__codelineno-48-71" name="__codelineno-48-71" href="#__codelineno-48-71"></a><span class="w">            </span><span class="n">invokeBeanDefinitionRegistryPostProcessors</span><span class="p">(</span><span class="n">currentRegistryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">registry</span><span class="p">);</span>
</span><span id="__span-48-72"><a id="__codelineno-48-72" name="__codelineno-48-72" href="#__codelineno-48-72"></a><span class="w">            </span><span class="n">currentRegistryProcessors</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
</span><span id="__span-48-73"><a id="__codelineno-48-73" name="__codelineno-48-73" href="#__codelineno-48-73"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-48-74"><a id="__codelineno-48-74" name="__codelineno-48-74" href="#__codelineno-48-74"></a>
</span><span id="__span-48-75"><a id="__codelineno-48-75" name="__codelineno-48-75" href="#__codelineno-48-75"></a><span class="w">        </span><span class="c1">// Now, invoke the postProcessBeanFactory callback of all processors handled so far.</span>
</span><span id="__span-48-76"><a id="__codelineno-48-76" name="__codelineno-48-76" href="#__codelineno-48-76"></a><span class="w">        </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">registryProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-77"><a id="__codelineno-48-77" name="__codelineno-48-77" href="#__codelineno-48-77"></a><span class="w">        </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">regularPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-78"><a id="__codelineno-48-78" name="__codelineno-48-78" href="#__codelineno-48-78"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-79"><a id="__codelineno-48-79" name="__codelineno-48-79" href="#__codelineno-48-79"></a>
</span><span id="__span-48-80"><a id="__codelineno-48-80" name="__codelineno-48-80" href="#__codelineno-48-80"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-81"><a id="__codelineno-48-81" name="__codelineno-48-81" href="#__codelineno-48-81"></a><span class="w">        </span><span class="c1">// Invoke factory processors registered with the context instance.</span>
</span><span id="__span-48-82"><a id="__codelineno-48-82" name="__codelineno-48-82" href="#__codelineno-48-82"></a><span class="w">        </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">beanFactoryPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-83"><a id="__codelineno-48-83" name="__codelineno-48-83" href="#__codelineno-48-83"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-84"><a id="__codelineno-48-84" name="__codelineno-48-84" href="#__codelineno-48-84"></a>
</span><span id="__span-48-85"><a id="__codelineno-48-85" name="__codelineno-48-85" href="#__codelineno-48-85"></a><span class="w">    </span><span class="c1">// Do not initialize FactoryBeans here: We need to leave all regular beans</span>
</span><span id="__span-48-86"><a id="__codelineno-48-86" name="__codelineno-48-86" href="#__codelineno-48-86"></a><span class="w">    </span><span class="c1">// uninitialized to let the bean factory post-processors apply to them!</span>
</span><span id="__span-48-87"><a id="__codelineno-48-87" name="__codelineno-48-87" href="#__codelineno-48-87"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-48-88"><a id="__codelineno-48-88" name="__codelineno-48-88" href="#__codelineno-48-88"></a><span class="w">            </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">BeanFactoryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-48-89"><a id="__codelineno-48-89" name="__codelineno-48-89" href="#__codelineno-48-89"></a>
</span><span id="__span-48-90"><a id="__codelineno-48-90" name="__codelineno-48-90" href="#__codelineno-48-90"></a><span class="w">    </span><span class="c1">// Separate between BeanFactoryPostProcessors that implement PriorityOrdered,</span>
</span><span id="__span-48-91"><a id="__codelineno-48-91" name="__codelineno-48-91" href="#__codelineno-48-91"></a><span class="w">    </span><span class="c1">// Ordered, and the rest.</span>
</span><span id="__span-48-92"><a id="__codelineno-48-92" name="__codelineno-48-92" href="#__codelineno-48-92"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">priorityOrderedPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-48-93"><a id="__codelineno-48-93" name="__codelineno-48-93" href="#__codelineno-48-93"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderedPostProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-48-94"><a id="__codelineno-48-94" name="__codelineno-48-94" href="#__codelineno-48-94"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">nonOrderedPostProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-48-95"><a id="__codelineno-48-95" name="__codelineno-48-95" href="#__codelineno-48-95"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-96"><a id="__codelineno-48-96" name="__codelineno-48-96" href="#__codelineno-48-96"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">processedBeans</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">ppName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-97"><a id="__codelineno-48-97" name="__codelineno-48-97" href="#__codelineno-48-97"></a><span class="w">            </span><span class="c1">// skip - already processed in first phase above</span>
</span><span id="__span-48-98"><a id="__codelineno-48-98" name="__codelineno-48-98" href="#__codelineno-48-98"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-48-99"><a id="__codelineno-48-99" name="__codelineno-48-99" href="#__codelineno-48-99"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">PriorityOrdered</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-100"><a id="__codelineno-48-100" name="__codelineno-48-100" href="#__codelineno-48-100"></a><span class="w">            </span><span class="n">priorityOrderedPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanFactoryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
</span><span id="__span-48-101"><a id="__codelineno-48-101" name="__codelineno-48-101" href="#__codelineno-48-101"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-48-102"><a id="__codelineno-48-102" name="__codelineno-48-102" href="#__codelineno-48-102"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">Ordered</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-103"><a id="__codelineno-48-103" name="__codelineno-48-103" href="#__codelineno-48-103"></a><span class="w">            </span><span class="n">orderedPostProcessorNames</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
</span><span id="__span-48-104"><a id="__codelineno-48-104" name="__codelineno-48-104" href="#__codelineno-48-104"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-48-105"><a id="__codelineno-48-105" name="__codelineno-48-105" href="#__codelineno-48-105"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-106"><a id="__codelineno-48-106" name="__codelineno-48-106" href="#__codelineno-48-106"></a><span class="w">            </span><span class="n">nonOrderedPostProcessorNames</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
</span><span id="__span-48-107"><a id="__codelineno-48-107" name="__codelineno-48-107" href="#__codelineno-48-107"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-48-108"><a id="__codelineno-48-108" name="__codelineno-48-108" href="#__codelineno-48-108"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-109"><a id="__codelineno-48-109" name="__codelineno-48-109" href="#__codelineno-48-109"></a>
</span><span id="__span-48-110"><a id="__codelineno-48-110" name="__codelineno-48-110" href="#__codelineno-48-110"></a><span class="w">    </span><span class="c1">// First, invoke the BeanFactoryPostProcessors that implement PriorityOrdered.</span>
</span><span id="__span-48-111"><a id="__codelineno-48-111" name="__codelineno-48-111" href="#__codelineno-48-111"></a><span class="w">    </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">priorityOrderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-112"><a id="__codelineno-48-112" name="__codelineno-48-112" href="#__codelineno-48-112"></a><span class="w">    </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">priorityOrderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-113"><a id="__codelineno-48-113" name="__codelineno-48-113" href="#__codelineno-48-113"></a>
</span><span id="__span-48-114"><a id="__codelineno-48-114" name="__codelineno-48-114" href="#__codelineno-48-114"></a><span class="w">    </span><span class="c1">// Next, invoke the BeanFactoryPostProcessors that implement Ordered.</span>
</span><span id="__span-48-115"><a id="__codelineno-48-115" name="__codelineno-48-115" href="#__codelineno-48-115"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderedPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">orderedPostProcessorNames</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
</span><span id="__span-48-116"><a id="__codelineno-48-116" name="__codelineno-48-116" href="#__codelineno-48-116"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">postProcessorName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">orderedPostProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-117"><a id="__codelineno-48-117" name="__codelineno-48-117" href="#__codelineno-48-117"></a><span class="w">        </span><span class="n">orderedPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">postProcessorName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanFactoryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
</span><span id="__span-48-118"><a id="__codelineno-48-118" name="__codelineno-48-118" href="#__codelineno-48-118"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-119"><a id="__codelineno-48-119" name="__codelineno-48-119" href="#__codelineno-48-119"></a><span class="w">    </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">orderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-120"><a id="__codelineno-48-120" name="__codelineno-48-120" href="#__codelineno-48-120"></a><span class="w">    </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">orderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-121"><a id="__codelineno-48-121" name="__codelineno-48-121" href="#__codelineno-48-121"></a>
</span><span id="__span-48-122"><a id="__codelineno-48-122" name="__codelineno-48-122" href="#__codelineno-48-122"></a><span class="w">    </span><span class="c1">// Finally, invoke all other BeanFactoryPostProcessors.</span>
</span><span id="__span-48-123"><a id="__codelineno-48-123" name="__codelineno-48-123" href="#__codelineno-48-123"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanFactoryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">nonOrderedPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">nonOrderedPostProcessorNames</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
</span><span id="__span-48-124"><a id="__codelineno-48-124" name="__codelineno-48-124" href="#__codelineno-48-124"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">postProcessorName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nonOrderedPostProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-125"><a id="__codelineno-48-125" name="__codelineno-48-125" href="#__codelineno-48-125"></a><span class="w">        </span><span class="n">nonOrderedPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">postProcessorName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanFactoryPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
</span><span id="__span-48-126"><a id="__codelineno-48-126" name="__codelineno-48-126" href="#__codelineno-48-126"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-127"><a id="__codelineno-48-127" name="__codelineno-48-127" href="#__codelineno-48-127"></a><span class="w">    </span><span class="n">invokeBeanFactoryPostProcessors</span><span class="p">(</span><span class="n">nonOrderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-48-128"><a id="__codelineno-48-128" name="__codelineno-48-128" href="#__codelineno-48-128"></a>
</span><span id="__span-48-129"><a id="__codelineno-48-129" name="__codelineno-48-129" href="#__codelineno-48-129"></a><span class="w">    </span><span class="c1">// Clear cached merged bean definitions since the post-processors might have</span>
</span><span id="__span-48-130"><a id="__codelineno-48-130" name="__codelineno-48-130" href="#__codelineno-48-130"></a><span class="w">    </span><span class="c1">// modified the original metadata, e.g. replacing placeholders in values...</span>
</span><span id="__span-48-131"><a id="__codelineno-48-131" name="__codelineno-48-131" href="#__codelineno-48-131"></a><span class="w">    </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">clearMetadataCache</span><span class="p">();</span>
</span><span id="__span-48-132"><a id="__codelineno-48-132" name="__codelineno-48-132" href="#__codelineno-48-132"></a><span class="p">}</span>
</span><span id="__span-48-133"><a id="__codelineno-48-133" name="__codelineno-48-133" href="#__codelineno-48-133"></a>
</span><span id="__span-48-134"><a id="__codelineno-48-134" name="__codelineno-48-134" href="#__codelineno-48-134"></a><span class="c1">// 上面的方法内部有调用该重载方法</span>
</span><span id="__span-48-135"><a id="__codelineno-48-135" name="__codelineno-48-135" href="#__codelineno-48-135"></a><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">invokeBeanDefinitionRegistryPostProcessors</span><span class="p">(</span>
</span><span id="__span-48-136"><a id="__codelineno-48-136" name="__codelineno-48-136" href="#__codelineno-48-136"></a><span class="w">        </span><span class="n">Collection</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">postProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinitionRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-137"><a id="__codelineno-48-137" name="__codelineno-48-137" href="#__codelineno-48-137"></a>
</span><span id="__span-48-138"><a id="__codelineno-48-138" name="__codelineno-48-138" href="#__codelineno-48-138"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinitionRegistryPostProcessor</span><span class="w"> </span><span class="n">postProcessor</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-139"><a id="__codelineno-48-139" name="__codelineno-48-139" href="#__codelineno-48-139"></a><span class="w">        </span><span class="n">postProcessor</span><span class="p">.</span><span class="na">postProcessBeanDefinitionRegistry</span><span class="p">(</span><span class="n">registry</span><span class="p">);</span>
</span><span id="__span-48-140"><a id="__codelineno-48-140" name="__codelineno-48-140" href="#__codelineno-48-140"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-141"><a id="__codelineno-48-141" name="__codelineno-48-141" href="#__codelineno-48-141"></a><span class="p">}</span>
</span><span id="__span-48-142"><a id="__codelineno-48-142" name="__codelineno-48-142" href="#__codelineno-48-142"></a>
</span><span id="__span-48-143"><a id="__codelineno-48-143" name="__codelineno-48-143" href="#__codelineno-48-143"></a><span class="c1">// 上面的方法内部有调用该方法</span>
</span><span id="__span-48-144"><a id="__codelineno-48-144" name="__codelineno-48-144" href="#__codelineno-48-144"></a><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">sortPostProcessors</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">postProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-145"><a id="__codelineno-48-145" name="__codelineno-48-145" href="#__codelineno-48-145"></a><span class="w">    </span><span class="n">Comparator</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">comparatorToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-48-146"><a id="__codelineno-48-146" name="__codelineno-48-146" href="#__codelineno-48-146"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">DefaultListableBeanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-147"><a id="__codelineno-48-147" name="__codelineno-48-147" href="#__codelineno-48-147"></a><span class="w">        </span><span class="n">comparatorToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">DefaultListableBeanFactory</span><span class="p">)</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">).</span><span class="na">getDependencyComparator</span><span class="p">();</span>
</span><span id="__span-48-148"><a id="__codelineno-48-148" name="__codelineno-48-148" href="#__codelineno-48-148"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-149"><a id="__codelineno-48-149" name="__codelineno-48-149" href="#__codelineno-48-149"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">comparatorToUse</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-48-150"><a id="__codelineno-48-150" name="__codelineno-48-150" href="#__codelineno-48-150"></a><span class="w">        </span><span class="n">comparatorToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OrderComparator</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">;</span>
</span><span id="__span-48-151"><a id="__codelineno-48-151" name="__codelineno-48-151" href="#__codelineno-48-151"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-48-152"><a id="__codelineno-48-152" name="__codelineno-48-152" href="#__codelineno-48-152"></a><span class="w">    </span><span class="n">postProcessors</span><span class="p">.</span><span class="na">sort</span><span class="p">(</span><span class="n">comparatorToUse</span><span class="p">);</span>
</span><span id="__span-48-153"><a id="__codelineno-48-153" name="__codelineno-48-153" href="#__codelineno-48-153"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h1 id="9-registerbeanpostprocessorsbeanfactory">9. registerBeanPostProcessors(beanFactory);方法<a class="headerlink" href="#9-registerbeanpostprocessorsbeanfactory" title="Permanent link">&para;</a></h1>
<p><div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerBeanPostProcessors</span><span class="p">(</span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="w">    </span><span class="n">PostProcessorRegistrationDelegate</span><span class="p">.</span><span class="na">registerBeanPostProcessors</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="p">}</span>
</span></code></pre></div>
- PostProcessorRegistrationDelegate的registerBeanPostProcessors(ConfigurableListableBeanFactory beanFactory, AbstractApplicationContext applicationContexs)静态方法，具体代码如下：
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerBeanPostProcessors</span><span class="p">(</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">        </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">AbstractApplicationContext</span><span class="w"> </span><span class="n">applicationContext</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">BeanPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="w">    </span><span class="c1">// Register BeanPostProcessorChecker that logs an info message when</span>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="w">    </span><span class="c1">// a bean is created during BeanPostProcessor instantiation, i.e. when</span>
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="w">    </span><span class="c1">// a bean is not eligible for getting processed by all BeanPostProcessors.</span>
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">beanProcessorTargetCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanPostProcessorCount</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="p">.</span><span class="na">length</span><span class="p">;</span>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="w">    </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">addBeanPostProcessor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BeanPostProcessorChecker</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">beanProcessorTargetCount</span><span class="p">));</span>
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a><span class="w">    </span><span class="c1">// Separate between BeanPostProcessors that implement PriorityOrdered,</span>
</span><span id="__span-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a><span class="w">    </span><span class="c1">// Ordered, and the rest.</span>
</span><span id="__span-50-14"><a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">priorityOrderedPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-50-15"><a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">internalPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-50-16"><a id="__codelineno-50-16" name="__codelineno-50-16" href="#__codelineno-50-16"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderedPostProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-50-17"><a id="__codelineno-50-17" name="__codelineno-50-17" href="#__codelineno-50-17"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">nonOrderedPostProcessorNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-50-18"><a id="__codelineno-50-18" name="__codelineno-50-18" href="#__codelineno-50-18"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-19"><a id="__codelineno-50-19" name="__codelineno-50-19" href="#__codelineno-50-19"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">PriorityOrdered</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-20"><a id="__codelineno-50-20" name="__codelineno-50-20" href="#__codelineno-50-20"></a><span class="w">            </span><span class="n">BeanPostProcessor</span><span class="w"> </span><span class="n">pp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-50-21"><a id="__codelineno-50-21" name="__codelineno-50-21" href="#__codelineno-50-21"></a><span class="w">            </span><span class="n">priorityOrderedPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">pp</span><span class="p">);</span>
</span><span id="__span-50-22"><a id="__codelineno-50-22" name="__codelineno-50-22" href="#__codelineno-50-22"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pp</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">MergedBeanDefinitionPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-23"><a id="__codelineno-50-23" name="__codelineno-50-23" href="#__codelineno-50-23"></a><span class="w">                </span><span class="n">internalPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">pp</span><span class="p">);</span>
</span><span id="__span-50-24"><a id="__codelineno-50-24" name="__codelineno-50-24" href="#__codelineno-50-24"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-50-25"><a id="__codelineno-50-25" name="__codelineno-50-25" href="#__codelineno-50-25"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-50-26"><a id="__codelineno-50-26" name="__codelineno-50-26" href="#__codelineno-50-26"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">Ordered</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-27"><a id="__codelineno-50-27" name="__codelineno-50-27" href="#__codelineno-50-27"></a><span class="w">            </span><span class="n">orderedPostProcessorNames</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
</span><span id="__span-50-28"><a id="__codelineno-50-28" name="__codelineno-50-28" href="#__codelineno-50-28"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-50-29"><a id="__codelineno-50-29" name="__codelineno-50-29" href="#__codelineno-50-29"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-30"><a id="__codelineno-50-30" name="__codelineno-50-30" href="#__codelineno-50-30"></a><span class="w">            </span><span class="n">nonOrderedPostProcessorNames</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ppName</span><span class="p">);</span>
</span><span id="__span-50-31"><a id="__codelineno-50-31" name="__codelineno-50-31" href="#__codelineno-50-31"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-50-32"><a id="__codelineno-50-32" name="__codelineno-50-32" href="#__codelineno-50-32"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-50-33"><a id="__codelineno-50-33" name="__codelineno-50-33" href="#__codelineno-50-33"></a>
</span><span id="__span-50-34"><a id="__codelineno-50-34" name="__codelineno-50-34" href="#__codelineno-50-34"></a><span class="w">    </span><span class="c1">// First, register the BeanPostProcessors that implement PriorityOrdered.</span>
</span><span id="__span-50-35"><a id="__codelineno-50-35" name="__codelineno-50-35" href="#__codelineno-50-35"></a><span class="w">    </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">priorityOrderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-50-36"><a id="__codelineno-50-36" name="__codelineno-50-36" href="#__codelineno-50-36"></a><span class="w">    </span><span class="n">registerBeanPostProcessors</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">priorityOrderedPostProcessors</span><span class="p">);</span>
</span><span id="__span-50-37"><a id="__codelineno-50-37" name="__codelineno-50-37" href="#__codelineno-50-37"></a>
</span><span id="__span-50-38"><a id="__codelineno-50-38" name="__codelineno-50-38" href="#__codelineno-50-38"></a><span class="w">    </span><span class="c1">// Next, register the BeanPostProcessors that implement Ordered.</span>
</span><span id="__span-50-39"><a id="__codelineno-50-39" name="__codelineno-50-39" href="#__codelineno-50-39"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">orderedPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">orderedPostProcessorNames</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
</span><span id="__span-50-40"><a id="__codelineno-50-40" name="__codelineno-50-40" href="#__codelineno-50-40"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">orderedPostProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-41"><a id="__codelineno-50-41" name="__codelineno-50-41" href="#__codelineno-50-41"></a><span class="w">        </span><span class="n">BeanPostProcessor</span><span class="w"> </span><span class="n">pp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-50-42"><a id="__codelineno-50-42" name="__codelineno-50-42" href="#__codelineno-50-42"></a><span class="w">        </span><span class="n">orderedPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">pp</span><span class="p">);</span>
</span><span id="__span-50-43"><a id="__codelineno-50-43" name="__codelineno-50-43" href="#__codelineno-50-43"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pp</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">MergedBeanDefinitionPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-44"><a id="__codelineno-50-44" name="__codelineno-50-44" href="#__codelineno-50-44"></a><span class="w">            </span><span class="n">internalPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">pp</span><span class="p">);</span>
</span><span id="__span-50-45"><a id="__codelineno-50-45" name="__codelineno-50-45" href="#__codelineno-50-45"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-50-46"><a id="__codelineno-50-46" name="__codelineno-50-46" href="#__codelineno-50-46"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-50-47"><a id="__codelineno-50-47" name="__codelineno-50-47" href="#__codelineno-50-47"></a><span class="w">    </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">orderedPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-50-48"><a id="__codelineno-50-48" name="__codelineno-50-48" href="#__codelineno-50-48"></a><span class="w">    </span><span class="n">registerBeanPostProcessors</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">orderedPostProcessors</span><span class="p">);</span>
</span><span id="__span-50-49"><a id="__codelineno-50-49" name="__codelineno-50-49" href="#__codelineno-50-49"></a>
</span><span id="__span-50-50"><a id="__codelineno-50-50" name="__codelineno-50-50" href="#__codelineno-50-50"></a><span class="w">    </span><span class="c1">// Now, register all regular BeanPostProcessors.</span>
</span><span id="__span-50-51"><a id="__codelineno-50-51" name="__codelineno-50-51" href="#__codelineno-50-51"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">nonOrderedPostProcessors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">nonOrderedPostProcessorNames</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
</span><span id="__span-50-52"><a id="__codelineno-50-52" name="__codelineno-50-52" href="#__codelineno-50-52"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">ppName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">nonOrderedPostProcessorNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-53"><a id="__codelineno-50-53" name="__codelineno-50-53" href="#__codelineno-50-53"></a><span class="w">        </span><span class="n">BeanPostProcessor</span><span class="w"> </span><span class="n">pp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ppName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanPostProcessor</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-50-54"><a id="__codelineno-50-54" name="__codelineno-50-54" href="#__codelineno-50-54"></a><span class="w">        </span><span class="n">nonOrderedPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">pp</span><span class="p">);</span>
</span><span id="__span-50-55"><a id="__codelineno-50-55" name="__codelineno-50-55" href="#__codelineno-50-55"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pp</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">MergedBeanDefinitionPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-56"><a id="__codelineno-50-56" name="__codelineno-50-56" href="#__codelineno-50-56"></a><span class="w">            </span><span class="n">internalPostProcessors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">pp</span><span class="p">);</span>
</span><span id="__span-50-57"><a id="__codelineno-50-57" name="__codelineno-50-57" href="#__codelineno-50-57"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-50-58"><a id="__codelineno-50-58" name="__codelineno-50-58" href="#__codelineno-50-58"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-50-59"><a id="__codelineno-50-59" name="__codelineno-50-59" href="#__codelineno-50-59"></a><span class="w">    </span><span class="n">registerBeanPostProcessors</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">nonOrderedPostProcessors</span><span class="p">);</span>
</span><span id="__span-50-60"><a id="__codelineno-50-60" name="__codelineno-50-60" href="#__codelineno-50-60"></a>
</span><span id="__span-50-61"><a id="__codelineno-50-61" name="__codelineno-50-61" href="#__codelineno-50-61"></a><span class="w">    </span><span class="c1">// Finally, re-register all internal BeanPostProcessors.</span>
</span><span id="__span-50-62"><a id="__codelineno-50-62" name="__codelineno-50-62" href="#__codelineno-50-62"></a><span class="w">    </span><span class="n">sortPostProcessors</span><span class="p">(</span><span class="n">internalPostProcessors</span><span class="p">,</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-50-63"><a id="__codelineno-50-63" name="__codelineno-50-63" href="#__codelineno-50-63"></a><span class="w">    </span><span class="n">registerBeanPostProcessors</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">internalPostProcessors</span><span class="p">);</span>
</span><span id="__span-50-64"><a id="__codelineno-50-64" name="__codelineno-50-64" href="#__codelineno-50-64"></a>
</span><span id="__span-50-65"><a id="__codelineno-50-65" name="__codelineno-50-65" href="#__codelineno-50-65"></a><span class="w">    </span><span class="c1">// Re-register post-processor for detecting inner beans as ApplicationListeners,</span>
</span><span id="__span-50-66"><a id="__codelineno-50-66" name="__codelineno-50-66" href="#__codelineno-50-66"></a><span class="w">    </span><span class="c1">// moving it to the end of the processor chain (for picking up proxies etc).</span>
</span><span id="__span-50-67"><a id="__codelineno-50-67" name="__codelineno-50-67" href="#__codelineno-50-67"></a><span class="w">    </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">addBeanPostProcessor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ApplicationListenerDetector</span><span class="p">(</span><span class="n">applicationContext</span><span class="p">));</span>
</span><span id="__span-50-68"><a id="__codelineno-50-68" name="__codelineno-50-68" href="#__codelineno-50-68"></a><span class="p">}</span>
</span><span id="__span-50-69"><a id="__codelineno-50-69" name="__codelineno-50-69" href="#__codelineno-50-69"></a>
</span><span id="__span-50-70"><a id="__codelineno-50-70" name="__codelineno-50-70" href="#__codelineno-50-70"></a>
</span><span id="__span-50-71"><a id="__codelineno-50-71" name="__codelineno-50-71" href="#__codelineno-50-71"></a><span class="c1">//上面的方法内部有调用该重载方法</span>
</span><span id="__span-50-72"><a id="__codelineno-50-72" name="__codelineno-50-72" href="#__codelineno-50-72"></a><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerBeanPostProcessors</span><span class="p">(</span>
</span><span id="__span-50-73"><a id="__codelineno-50-73" name="__codelineno-50-73" href="#__codelineno-50-73"></a><span class="w">        </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">BeanPostProcessor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">postProcessors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-74"><a id="__codelineno-50-74" name="__codelineno-50-74" href="#__codelineno-50-74"></a>
</span><span id="__span-50-75"><a id="__codelineno-50-75" name="__codelineno-50-75" href="#__codelineno-50-75"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">BeanPostProcessor</span><span class="w"> </span><span class="n">postProcessor</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">postProcessors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-76"><a id="__codelineno-50-76" name="__codelineno-50-76" href="#__codelineno-50-76"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">addBeanPostProcessor</span><span class="p">(</span><span class="n">postProcessor</span><span class="p">);</span>
</span><span id="__span-50-77"><a id="__codelineno-50-77" name="__codelineno-50-77" href="#__codelineno-50-77"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-50-78"><a id="__codelineno-50-78" name="__codelineno-50-78" href="#__codelineno-50-78"></a><span class="p">}</span>
</span></code></pre></div></p>
<h1 id="10-initmessagesource">10. initMessageSource();方法<a class="headerlink" href="#10-initmessagesource" title="Permanent link">&para;</a></h1>
<ul>
<li>org.springframework.context.support.AbstractApplicationContext中的initMessageSource()方法
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initMessageSource</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="w">    </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getBeanFactory</span><span class="p">();</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">containsLocalBean</span><span class="p">(</span><span class="n">MESSAGE_SOURCE_BEAN_NAME</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">messageSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">MESSAGE_SOURCE_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="n">MessageSource</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="w">        </span><span class="c1">// Make MessageSource aware of parent MessageSource.</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">parent</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">messageSource</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">HierarchicalMessageSource</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="w">            </span><span class="n">HierarchicalMessageSource</span><span class="w"> </span><span class="n">hms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">HierarchicalMessageSource</span><span class="p">)</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">messageSource</span><span class="p">;</span>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hms</span><span class="p">.</span><span class="na">getParentMessageSource</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a><span class="w">                </span><span class="c1">// Only set parent context as parent MessageSource if no parent MessageSource</span>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="w">                </span><span class="c1">// registered already.</span>
</span><span id="__span-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a><span class="w">                </span><span class="n">hms</span><span class="p">.</span><span class="na">setParentMessageSource</span><span class="p">(</span><span class="n">getInternalParentMessageSource</span><span class="p">());</span>
</span><span id="__span-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-51-13"><a id="__codelineno-51-13" name="__codelineno-51-13" href="#__codelineno-51-13"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-51-14"><a id="__codelineno-51-14" name="__codelineno-51-14" href="#__codelineno-51-14"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-15"><a id="__codelineno-51-15" name="__codelineno-51-15" href="#__codelineno-51-15"></a><span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Using MessageSource [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">messageSource</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">);</span>
</span><span id="__span-51-16"><a id="__codelineno-51-16" name="__codelineno-51-16" href="#__codelineno-51-16"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-51-17"><a id="__codelineno-51-17" name="__codelineno-51-17" href="#__codelineno-51-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-51-18"><a id="__codelineno-51-18" name="__codelineno-51-18" href="#__codelineno-51-18"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-19"><a id="__codelineno-51-19" name="__codelineno-51-19" href="#__codelineno-51-19"></a><span class="w">        </span><span class="c1">// Use empty MessageSource to be able to accept getMessage calls.</span>
</span><span id="__span-51-20"><a id="__codelineno-51-20" name="__codelineno-51-20" href="#__codelineno-51-20"></a><span class="w">        </span><span class="n">DelegatingMessageSource</span><span class="w"> </span><span class="n">dms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DelegatingMessageSource</span><span class="p">();</span>
</span><span id="__span-51-21"><a id="__codelineno-51-21" name="__codelineno-51-21" href="#__codelineno-51-21"></a><span class="w">        </span><span class="n">dms</span><span class="p">.</span><span class="na">setParentMessageSource</span><span class="p">(</span><span class="n">getInternalParentMessageSource</span><span class="p">());</span>
</span><span id="__span-51-22"><a id="__codelineno-51-22" name="__codelineno-51-22" href="#__codelineno-51-22"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">messageSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dms</span><span class="p">;</span>
</span><span id="__span-51-23"><a id="__codelineno-51-23" name="__codelineno-51-23" href="#__codelineno-51-23"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">registerSingleton</span><span class="p">(</span><span class="n">MESSAGE_SOURCE_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">messageSource</span><span class="p">);</span>
</span><span id="__span-51-24"><a id="__codelineno-51-24" name="__codelineno-51-24" href="#__codelineno-51-24"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-25"><a id="__codelineno-51-25" name="__codelineno-51-25" href="#__codelineno-51-25"></a><span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;No &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MESSAGE_SOURCE_BEAN_NAME</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; bean, using [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">messageSource</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">);</span>
</span><span id="__span-51-26"><a id="__codelineno-51-26" name="__codelineno-51-26" href="#__codelineno-51-26"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-51-27"><a id="__codelineno-51-27" name="__codelineno-51-27" href="#__codelineno-51-27"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-51-28"><a id="__codelineno-51-28" name="__codelineno-51-28" href="#__codelineno-51-28"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h1 id="11-initapplicationeventmulticaster">11. initApplicationEventMulticaster();方法<a class="headerlink" href="#11-initapplicationeventmulticaster" title="Permanent link">&para;</a></h1>
<ul>
<li>org.springframework.context.support.AbstractApplicationContext中的initApplicationEventMulticaster()方法
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initApplicationEventMulticaster</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="w">    </span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getBeanFactory</span><span class="p">();</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">containsLocalBean</span><span class="p">(</span><span class="n">APPLICATION_EVENT_MULTICASTER_BEAN_NAME</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">applicationEventMulticaster</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a><span class="w">                </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">APPLICATION_EVENT_MULTICASTER_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="n">ApplicationEventMulticaster</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a><span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Using ApplicationEventMulticaster [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">applicationEventMulticaster</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">);</span>
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">applicationEventMulticaster</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SimpleApplicationEventMulticaster</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">);</span>
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">registerSingleton</span><span class="p">(</span><span class="n">APPLICATION_EVENT_MULTICASTER_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">applicationEventMulticaster</span><span class="p">);</span>
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a><span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;No &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">APPLICATION_EVENT_MULTICASTER_BEAN_NAME</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; bean, using &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a><span class="w">                    </span><span class="s">&quot;[&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">applicationEventMulticaster</span><span class="p">.</span><span class="na">getClass</span><span class="p">().</span><span class="na">getSimpleName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">);</span>
</span><span id="__span-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h1 id="12-onrefresh">12. onRefresh();方法<a class="headerlink" href="#12-onrefresh" title="Permanent link">&para;</a></h1>
<ul>
<li>org.springframework.context.support.AbstractApplicationContext中的onRefresh()方法
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onRefresh</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="w">    </span><span class="c1">// 该方法是一个空方法，具体的实现依据具体的情况在其子类中继承或进行重写</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="w">    </span><span class="c1">// For subclasses: do nothing by default.</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h1 id="13-registerlisteners">13. registerListeners();方法<a class="headerlink" href="#13-registerlisteners" title="Permanent link">&para;</a></h1>
<ul>
<li>org.springframework.context.support.AbstractApplicationContext中的registerListeners()方法
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="w">    </span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">registerListeners</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="w">        </span><span class="c1">// Register statically specified listeners first.</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">ApplicationListener</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">listener</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">getApplicationListeners</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="w">            </span><span class="n">getApplicationEventMulticaster</span><span class="p">().</span><span class="na">addApplicationListener</span><span class="p">(</span><span class="n">listener</span><span class="p">);</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="w">        </span><span class="c1">// Do not initialize FactoryBeans here: We need to leave all regular beans</span>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a><span class="w">        </span><span class="c1">// uninitialized to let post-processors apply to them!</span>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a><span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">listenerBeanNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getBeanNamesForType</span><span class="p">(</span><span class="n">ApplicationListener</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">listenerBeanName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">listenerBeanNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a><span class="w">            </span><span class="n">getApplicationEventMulticaster</span><span class="p">().</span><span class="na">addApplicationListenerBean</span><span class="p">(</span><span class="n">listenerBeanName</span><span class="p">);</span>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a>
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a><span class="w">        </span><span class="c1">// Publish early application events now that we finally have a multicaster...</span>
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a><span class="w">        </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">ApplicationEvent</span><span class="o">&gt;</span><span class="w"> </span><span class="n">earlyEventsToProcess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">earlyApplicationEvents</span><span class="p">;</span>
</span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">earlyApplicationEvents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-54-17"><a id="__codelineno-54-17" name="__codelineno-54-17" href="#__codelineno-54-17"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">earlyEventsToProcess</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-18"><a id="__codelineno-54-18" name="__codelineno-54-18" href="#__codelineno-54-18"></a><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">ApplicationEvent</span><span class="w"> </span><span class="n">earlyEvent</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">earlyEventsToProcess</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-19"><a id="__codelineno-54-19" name="__codelineno-54-19" href="#__codelineno-54-19"></a><span class="w">                </span><span class="n">getApplicationEventMulticaster</span><span class="p">().</span><span class="na">multicastEvent</span><span class="p">(</span><span class="n">earlyEvent</span><span class="p">);</span>
</span><span id="__span-54-20"><a id="__codelineno-54-20" name="__codelineno-54-20" href="#__codelineno-54-20"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-54-21"><a id="__codelineno-54-21" name="__codelineno-54-21" href="#__codelineno-54-21"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-54-22"><a id="__codelineno-54-22" name="__codelineno-54-22" href="#__codelineno-54-22"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h1 id="14-finishbeanfactoryinitializationbeanfactory">14. finishBeanFactoryInitialization(beanFactory);方法<a class="headerlink" href="#14-finishbeanfactoryinitializationbeanfactory" title="Permanent link">&para;</a></h1>
<ul>
<li>org.springframework.context.support.AbstractApplicationContext中的finishBeanFactoryInitialization(beanFactory)方法</li>
<li>实例化Bean的核心方法
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">finishBeanFactoryInitialization</span><span class="p">(</span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="w">    </span><span class="c1">// Initialize conversion service for this context.</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">containsBean</span><span class="p">(</span><span class="n">CONVERSION_SERVICE_BEAN_NAME</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="w">            </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">isTypeMatch</span><span class="p">(</span><span class="n">CONVERSION_SERVICE_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="n">ConversionService</span><span class="p">.</span><span class="na">class</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">setConversionService</span><span class="p">(</span>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="w">                </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">CONVERSION_SERVICE_BEAN_NAME</span><span class="p">,</span><span class="w"> </span><span class="n">ConversionService</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a><span class="w">    </span><span class="c1">// Register a default embedded value resolver if no bean post-processor</span>
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a><span class="w">    </span><span class="c1">// (such as a PropertyPlaceholderConfigurer bean) registered any before:</span>
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a><span class="w">    </span><span class="c1">// at this point, primarily for resolution in annotation attribute values.</span>
</span><span id="__span-55-12"><a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">hasEmbeddedValueResolver</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-13"><a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a><span class="w">        </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">addEmbeddedValueResolver</span><span class="p">(</span><span class="n">strVal</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">getEnvironment</span><span class="p">().</span><span class="na">resolvePlaceholders</span><span class="p">(</span><span class="n">strVal</span><span class="p">));</span>
</span><span id="__span-55-14"><a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-55-15"><a id="__codelineno-55-15" name="__codelineno-55-15" href="#__codelineno-55-15"></a>
</span><span id="__span-55-16"><a id="__codelineno-55-16" name="__codelineno-55-16" href="#__codelineno-55-16"></a><span class="w">    </span><span class="c1">// Initialize LoadTimeWeaverAware beans early to allow for registering their transformers early.</span>
</span><span id="__span-55-17"><a id="__codelineno-55-17" name="__codelineno-55-17" href="#__codelineno-55-17"></a><span class="w">    </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">weaverAwareNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBeanNamesForType</span><span class="p">(</span><span class="n">LoadTimeWeaverAware</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-55-18"><a id="__codelineno-55-18" name="__codelineno-55-18" href="#__codelineno-55-18"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">weaverAwareName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">weaverAwareNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-19"><a id="__codelineno-55-19" name="__codelineno-55-19" href="#__codelineno-55-19"></a><span class="w">        </span><span class="n">getBean</span><span class="p">(</span><span class="n">weaverAwareName</span><span class="p">);</span>
</span><span id="__span-55-20"><a id="__codelineno-55-20" name="__codelineno-55-20" href="#__codelineno-55-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-55-21"><a id="__codelineno-55-21" name="__codelineno-55-21" href="#__codelineno-55-21"></a>
</span><span id="__span-55-22"><a id="__codelineno-55-22" name="__codelineno-55-22" href="#__codelineno-55-22"></a><span class="w">    </span><span class="c1">// Stop using the temporary ClassLoader for type matching.</span>
</span><span id="__span-55-23"><a id="__codelineno-55-23" name="__codelineno-55-23" href="#__codelineno-55-23"></a><span class="w">    </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">setTempClassLoader</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-55-24"><a id="__codelineno-55-24" name="__codelineno-55-24" href="#__codelineno-55-24"></a>
</span><span id="__span-55-25"><a id="__codelineno-55-25" name="__codelineno-55-25" href="#__codelineno-55-25"></a><span class="w">    </span><span class="c1">// Allow for caching all bean definition metadata, not expecting further changes.</span>
</span><span id="__span-55-26"><a id="__codelineno-55-26" name="__codelineno-55-26" href="#__codelineno-55-26"></a><span class="w">    </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">freezeConfiguration</span><span class="p">();</span>
</span><span id="__span-55-27"><a id="__codelineno-55-27" name="__codelineno-55-27" href="#__codelineno-55-27"></a>
</span><span id="__span-55-28"><a id="__codelineno-55-28" name="__codelineno-55-28" href="#__codelineno-55-28"></a><span class="w">    </span><span class="c1">// Instantiate all remaining (non-lazy-init) singletons.</span>
</span><span id="__span-55-29"><a id="__codelineno-55-29" name="__codelineno-55-29" href="#__codelineno-55-29"></a><span class="w">    </span><span class="c1">// 实例化bean的核心代码</span>
</span><span id="__span-55-30"><a id="__codelineno-55-30" name="__codelineno-55-30" href="#__codelineno-55-30"></a><span class="w">    </span><span class="n">beanFactory</span><span class="p">.</span><span class="na">preInstantiateSingletons</span><span class="p">();</span><span class="w"> </span>
</span><span id="__span-55-31"><a id="__codelineno-55-31" name="__codelineno-55-31" href="#__codelineno-55-31"></a><span class="w">    </span><span class="c1">// 上一行的preInstantiateSingletons()方法定义在ConfigurableListableBeanFactory接口中，</span>
</span><span id="__span-55-32"><a id="__codelineno-55-32" name="__codelineno-55-32" href="#__codelineno-55-32"></a><span class="w">    </span><span class="c1">// 具体实现是在DefaultListableBeanFactory中preInstantiateSingletons()方法</span>
</span><span id="__span-55-33"><a id="__codelineno-55-33" name="__codelineno-55-33" href="#__codelineno-55-33"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="defaultlistablebeanfactorypreinstantiatesingletons">DefaultListableBeanFactory中preInstantiateSingletons()方法<a class="headerlink" href="#defaultlistablebeanfactorypreinstantiatesingletons" title="Permanent link">&para;</a></h4>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="nd">@Override</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">preInstantiateSingletons</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Pre-instantiating singletons in &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">);</span>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a><span class="w">    </span><span class="c1">// Iterate over a copy to allow for init methods which in turn register new bean definitions.</span>
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="w">    </span><span class="c1">// While this may not be part of the regular factory bootstrap, it does otherwise work fine.</span>
</span><span id="__span-56-9"><a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">beanNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinitionNames</span><span class="p">);</span>
</span><span id="__span-56-10"><a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a>
</span><span id="__span-56-11"><a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="w">    </span><span class="c1">// Trigger initialization of all non-lazy singleton beans...</span>
</span><span id="__span-56-12"><a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a><span class="w">    </span><span class="c1">// 遍历beanDefinitionNames这个ArrayList对象中的beanName，</span>
</span><span id="__span-56-13"><a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-14"><a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a><span class="w">        </span><span class="n">RootBeanDefinition</span><span class="w"> </span><span class="n">bd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getMergedLocalBeanDefinition</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-56-15"><a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">bd</span><span class="p">.</span><span class="na">isAbstract</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">bd</span><span class="p">.</span><span class="na">isSingleton</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">bd</span><span class="p">.</span><span class="na">isLazyInit</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-16"><a id="__codelineno-56-16" name="__codelineno-56-16" href="#__codelineno-56-16"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isFactoryBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-17"><a id="__codelineno-56-17" name="__codelineno-56-17" href="#__codelineno-56-17"></a><span class="w">                </span><span class="n">Object</span><span class="w"> </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getBean</span><span class="p">(</span><span class="n">FACTORY_BEAN_PREFIX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-56-18"><a id="__codelineno-56-18" name="__codelineno-56-18" href="#__codelineno-56-18"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bean</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">FactoryBean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-19"><a id="__codelineno-56-19" name="__codelineno-56-19" href="#__codelineno-56-19"></a><span class="w">                    </span><span class="kd">final</span><span class="w"> </span><span class="n">FactoryBean</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">FactoryBean</span><span class="o">&lt;?&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">bean</span><span class="p">;</span>
</span><span id="__span-56-20"><a id="__codelineno-56-20" name="__codelineno-56-20" href="#__codelineno-56-20"></a><span class="w">                    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isEagerInit</span><span class="p">;</span>
</span><span id="__span-56-21"><a id="__codelineno-56-21" name="__codelineno-56-21" href="#__codelineno-56-21"></a><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getSecurityManager</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">factory</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">SmartFactoryBean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-22"><a id="__codelineno-56-22" name="__codelineno-56-22" href="#__codelineno-56-22"></a><span class="w">                        </span><span class="n">isEagerInit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AccessController</span><span class="p">.</span><span class="na">doPrivileged</span><span class="p">((</span><span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">&gt;</span><span class="p">)</span>
</span><span id="__span-56-23"><a id="__codelineno-56-23" name="__codelineno-56-23" href="#__codelineno-56-23"></a><span class="w">                                        </span><span class="p">((</span><span class="n">SmartFactoryBean</span><span class="o">&lt;?&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">factory</span><span class="p">)::</span><span class="n">isEagerInit</span><span class="p">,</span>
</span><span id="__span-56-24"><a id="__codelineno-56-24" name="__codelineno-56-24" href="#__codelineno-56-24"></a><span class="w">                                </span><span class="n">getAccessControlContext</span><span class="p">());</span>
</span><span id="__span-56-25"><a id="__codelineno-56-25" name="__codelineno-56-25" href="#__codelineno-56-25"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-56-26"><a id="__codelineno-56-26" name="__codelineno-56-26" href="#__codelineno-56-26"></a><span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-27"><a id="__codelineno-56-27" name="__codelineno-56-27" href="#__codelineno-56-27"></a><span class="w">                        </span><span class="n">isEagerInit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">factory</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">SmartFactoryBean</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="__span-56-28"><a id="__codelineno-56-28" name="__codelineno-56-28" href="#__codelineno-56-28"></a><span class="w">                                </span><span class="p">((</span><span class="n">SmartFactoryBean</span><span class="o">&lt;?&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">factory</span><span class="p">).</span><span class="na">isEagerInit</span><span class="p">());</span>
</span><span id="__span-56-29"><a id="__codelineno-56-29" name="__codelineno-56-29" href="#__codelineno-56-29"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-56-30"><a id="__codelineno-56-30" name="__codelineno-56-30" href="#__codelineno-56-30"></a><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isEagerInit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-31"><a id="__codelineno-56-31" name="__codelineno-56-31" href="#__codelineno-56-31"></a><span class="w">                        </span><span class="c1">// 创建bean并递归构建Bean之间的依赖关系</span>
</span><span id="__span-56-32"><a id="__codelineno-56-32" name="__codelineno-56-32" href="#__codelineno-56-32"></a><span class="w">                        </span><span class="n">getBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-56-33"><a id="__codelineno-56-33" name="__codelineno-56-33" href="#__codelineno-56-33"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-56-34"><a id="__codelineno-56-34" name="__codelineno-56-34" href="#__codelineno-56-34"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-56-35"><a id="__codelineno-56-35" name="__codelineno-56-35" href="#__codelineno-56-35"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-56-36"><a id="__codelineno-56-36" name="__codelineno-56-36" href="#__codelineno-56-36"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-37"><a id="__codelineno-56-37" name="__codelineno-56-37" href="#__codelineno-56-37"></a><span class="w">                </span><span class="c1">// 创建bean并递归构建Bean之间的依赖关系</span>
</span><span id="__span-56-38"><a id="__codelineno-56-38" name="__codelineno-56-38" href="#__codelineno-56-38"></a><span class="w">                </span><span class="n">getBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-56-39"><a id="__codelineno-56-39" name="__codelineno-56-39" href="#__codelineno-56-39"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-56-40"><a id="__codelineno-56-40" name="__codelineno-56-40" href="#__codelineno-56-40"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-56-41"><a id="__codelineno-56-41" name="__codelineno-56-41" href="#__codelineno-56-41"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-56-42"><a id="__codelineno-56-42" name="__codelineno-56-42" href="#__codelineno-56-42"></a>
</span><span id="__span-56-43"><a id="__codelineno-56-43" name="__codelineno-56-43" href="#__codelineno-56-43"></a><span class="w">    </span><span class="c1">// Trigger post-initialization callback for all applicable beans...</span>
</span><span id="__span-56-44"><a id="__codelineno-56-44" name="__codelineno-56-44" href="#__codelineno-56-44"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">beanNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-45"><a id="__codelineno-56-45" name="__codelineno-56-45" href="#__codelineno-56-45"></a><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">singletonInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getSingleton</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-56-46"><a id="__codelineno-56-46" name="__codelineno-56-46" href="#__codelineno-56-46"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">singletonInstance</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">SmartInitializingSingleton</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-47"><a id="__codelineno-56-47" name="__codelineno-56-47" href="#__codelineno-56-47"></a><span class="w">            </span><span class="kd">final</span><span class="w"> </span><span class="n">SmartInitializingSingleton</span><span class="w"> </span><span class="n">smartSingleton</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">SmartInitializingSingleton</span><span class="p">)</span><span class="w"> </span><span class="n">singletonInstance</span><span class="p">;</span>
</span><span id="__span-56-48"><a id="__codelineno-56-48" name="__codelineno-56-48" href="#__codelineno-56-48"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getSecurityManager</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-49"><a id="__codelineno-56-49" name="__codelineno-56-49" href="#__codelineno-56-49"></a><span class="w">                </span><span class="n">AccessController</span><span class="p">.</span><span class="na">doPrivileged</span><span class="p">((</span><span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-50"><a id="__codelineno-56-50" name="__codelineno-56-50" href="#__codelineno-56-50"></a><span class="w">                    </span><span class="n">smartSingleton</span><span class="p">.</span><span class="na">afterSingletonsInstantiated</span><span class="p">();</span>
</span><span id="__span-56-51"><a id="__codelineno-56-51" name="__codelineno-56-51" href="#__codelineno-56-51"></a><span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-56-52"><a id="__codelineno-56-52" name="__codelineno-56-52" href="#__codelineno-56-52"></a><span class="w">                </span><span class="p">},</span><span class="w"> </span><span class="n">getAccessControlContext</span><span class="p">());</span>
</span><span id="__span-56-53"><a id="__codelineno-56-53" name="__codelineno-56-53" href="#__codelineno-56-53"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-56-54"><a id="__codelineno-56-54" name="__codelineno-56-54" href="#__codelineno-56-54"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-55"><a id="__codelineno-56-55" name="__codelineno-56-55" href="#__codelineno-56-55"></a><span class="w">                </span><span class="n">smartSingleton</span><span class="p">.</span><span class="na">afterSingletonsInstantiated</span><span class="p">();</span>
</span><span id="__span-56-56"><a id="__codelineno-56-56" name="__codelineno-56-56" href="#__codelineno-56-56"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-56-57"><a id="__codelineno-56-57" name="__codelineno-56-57" href="#__codelineno-56-57"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-56-58"><a id="__codelineno-56-58" name="__codelineno-56-58" href="#__codelineno-56-58"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-56-59"><a id="__codelineno-56-59" name="__codelineno-56-59" href="#__codelineno-56-59"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="preinstantiatesingletonsgetbean">preInstantiateSingletons()方法中调用的getBean方法<a class="headerlink" href="#preinstantiatesingletonsgetbean" title="Permanent link">&para;</a></h3>
<ul>
<li>getBean方法定义在BeanFactory接口中</li>
<li>getBean方法org.springframework.beans.factory.support.AbstractBeanFactory中实现
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="nd">@Override</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">getBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">doGetBean</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="p">}</span>
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a>
</span><span id="__span-57-7"><a id="__codelineno-57-7" name="__codelineno-57-7" href="#__codelineno-57-7"></a>
</span><span id="__span-57-8"><a id="__codelineno-57-8" name="__codelineno-57-8" href="#__codelineno-57-8"></a><span class="c1">//下面是上面方法调用doGetBean(name, null, null, false)方法</span>
</span><span id="__span-57-9"><a id="__codelineno-57-9" name="__codelineno-57-9" href="#__codelineno-57-9"></a><span class="c1">// 这个方法特别长，以下是完整代码：</span>
</span><span id="__span-57-10"><a id="__codelineno-57-10" name="__codelineno-57-10" href="#__codelineno-57-10"></a><span class="nd">@SuppressWarnings</span><span class="p">(</span><span class="s">&quot;unchecked&quot;</span><span class="p">)</span>
</span><span id="__span-57-11"><a id="__codelineno-57-11" name="__codelineno-57-11" href="#__codelineno-57-11"></a><span class="kd">protected</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="nf">doGetBean</span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">requiredType</span><span class="p">,</span>
</span><span id="__span-57-12"><a id="__codelineno-57-12" name="__codelineno-57-12" href="#__codelineno-57-12"></a><span class="w">        </span><span class="nd">@Nullable</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">typeCheckOnly</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-13"><a id="__codelineno-57-13" name="__codelineno-57-13" href="#__codelineno-57-13"></a>
</span><span id="__span-57-14"><a id="__codelineno-57-14" name="__codelineno-57-14" href="#__codelineno-57-14"></a><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformedBeanName</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-57-15"><a id="__codelineno-57-15" name="__codelineno-57-15" href="#__codelineno-57-15"></a><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="n">bean</span><span class="p">;</span>
</span><span id="__span-57-16"><a id="__codelineno-57-16" name="__codelineno-57-16" href="#__codelineno-57-16"></a>
</span><span id="__span-57-17"><a id="__codelineno-57-17" name="__codelineno-57-17" href="#__codelineno-57-17"></a><span class="w">    </span><span class="c1">// Eagerly check singleton cache for manually registered singletons.</span>
</span><span id="__span-57-18"><a id="__codelineno-57-18" name="__codelineno-57-18" href="#__codelineno-57-18"></a><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="n">sharedInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getSingleton</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-19"><a id="__codelineno-57-19" name="__codelineno-57-19" href="#__codelineno-57-19"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sharedInstance</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-20"><a id="__codelineno-57-20" name="__codelineno-57-20" href="#__codelineno-57-20"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-21"><a id="__codelineno-57-21" name="__codelineno-57-21" href="#__codelineno-57-21"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isSingletonCurrentlyInCreation</span><span class="p">(</span><span class="n">beanName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-22"><a id="__codelineno-57-22" name="__codelineno-57-22" href="#__codelineno-57-22"></a><span class="w">                </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Returning eagerly cached instance of singleton bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-57-23"><a id="__codelineno-57-23" name="__codelineno-57-23" href="#__codelineno-57-23"></a><span class="w">                        </span><span class="s">&quot;&#39; that is not fully initialized yet - a consequence of a circular reference&quot;</span><span class="p">);</span>
</span><span id="__span-57-24"><a id="__codelineno-57-24" name="__codelineno-57-24" href="#__codelineno-57-24"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-25"><a id="__codelineno-57-25" name="__codelineno-57-25" href="#__codelineno-57-25"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-26"><a id="__codelineno-57-26" name="__codelineno-57-26" href="#__codelineno-57-26"></a><span class="w">                </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Returning cached instance of singleton bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">);</span>
</span><span id="__span-57-27"><a id="__codelineno-57-27" name="__codelineno-57-27" href="#__codelineno-57-27"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-28"><a id="__codelineno-57-28" name="__codelineno-57-28" href="#__codelineno-57-28"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-57-29"><a id="__codelineno-57-29" name="__codelineno-57-29" href="#__codelineno-57-29"></a><span class="w">        </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getObjectForBeanInstance</span><span class="p">(</span><span class="n">sharedInstance</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-57-30"><a id="__codelineno-57-30" name="__codelineno-57-30" href="#__codelineno-57-30"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-57-31"><a id="__codelineno-57-31" name="__codelineno-57-31" href="#__codelineno-57-31"></a>
</span><span id="__span-57-32"><a id="__codelineno-57-32" name="__codelineno-57-32" href="#__codelineno-57-32"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-33"><a id="__codelineno-57-33" name="__codelineno-57-33" href="#__codelineno-57-33"></a><span class="w">        </span><span class="c1">// Fail if we&#39;re already creating this bean instance:</span>
</span><span id="__span-57-34"><a id="__codelineno-57-34" name="__codelineno-57-34" href="#__codelineno-57-34"></a><span class="w">        </span><span class="c1">// We&#39;re assumably within a circular reference.</span>
</span><span id="__span-57-35"><a id="__codelineno-57-35" name="__codelineno-57-35" href="#__codelineno-57-35"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isPrototypeCurrentlyInCreation</span><span class="p">(</span><span class="n">beanName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-36"><a id="__codelineno-57-36" name="__codelineno-57-36" href="#__codelineno-57-36"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCurrentlyInCreationException</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-37"><a id="__codelineno-57-37" name="__codelineno-57-37" href="#__codelineno-57-37"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-57-38"><a id="__codelineno-57-38" name="__codelineno-57-38" href="#__codelineno-57-38"></a>
</span><span id="__span-57-39"><a id="__codelineno-57-39" name="__codelineno-57-39" href="#__codelineno-57-39"></a><span class="w">        </span><span class="c1">// Check if bean definition exists in this factory.</span>
</span><span id="__span-57-40"><a id="__codelineno-57-40" name="__codelineno-57-40" href="#__codelineno-57-40"></a><span class="w">        </span><span class="n">BeanFactory</span><span class="w"> </span><span class="n">parentBeanFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getParentBeanFactory</span><span class="p">();</span>
</span><span id="__span-57-41"><a id="__codelineno-57-41" name="__codelineno-57-41" href="#__codelineno-57-41"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parentBeanFactory</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">containsBeanDefinition</span><span class="p">(</span><span class="n">beanName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-42"><a id="__codelineno-57-42" name="__codelineno-57-42" href="#__codelineno-57-42"></a><span class="w">            </span><span class="c1">// Not found -&gt; check parent.</span>
</span><span id="__span-57-43"><a id="__codelineno-57-43" name="__codelineno-57-43" href="#__codelineno-57-43"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">nameToLookup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">originalBeanName</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
</span><span id="__span-57-44"><a id="__codelineno-57-44" name="__codelineno-57-44" href="#__codelineno-57-44"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parentBeanFactory</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">AbstractBeanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-45"><a id="__codelineno-57-45" name="__codelineno-57-45" href="#__codelineno-57-45"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="p">((</span><span class="n">AbstractBeanFactory</span><span class="p">)</span><span class="w"> </span><span class="n">parentBeanFactory</span><span class="p">).</span><span class="na">doGetBean</span><span class="p">(</span>
</span><span id="__span-57-46"><a id="__codelineno-57-46" name="__codelineno-57-46" href="#__codelineno-57-46"></a><span class="w">                        </span><span class="n">nameToLookup</span><span class="p">,</span><span class="w"> </span><span class="n">requiredType</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">typeCheckOnly</span><span class="p">);</span>
</span><span id="__span-57-47"><a id="__codelineno-57-47" name="__codelineno-57-47" href="#__codelineno-57-47"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-48"><a id="__codelineno-57-48" name="__codelineno-57-48" href="#__codelineno-57-48"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-49"><a id="__codelineno-57-49" name="__codelineno-57-49" href="#__codelineno-57-49"></a><span class="w">                </span><span class="c1">// Delegation to parent with explicit args.</span>
</span><span id="__span-57-50"><a id="__codelineno-57-50" name="__codelineno-57-50" href="#__codelineno-57-50"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="n">parentBeanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">nameToLookup</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-57-51"><a id="__codelineno-57-51" name="__codelineno-57-51" href="#__codelineno-57-51"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-52"><a id="__codelineno-57-52" name="__codelineno-57-52" href="#__codelineno-57-52"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">requiredType</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-53"><a id="__codelineno-57-53" name="__codelineno-57-53" href="#__codelineno-57-53"></a><span class="w">                </span><span class="c1">// No args -&gt; delegate to standard getBean method.</span>
</span><span id="__span-57-54"><a id="__codelineno-57-54" name="__codelineno-57-54" href="#__codelineno-57-54"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">parentBeanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">nameToLookup</span><span class="p">,</span><span class="w"> </span><span class="n">requiredType</span><span class="p">);</span>
</span><span id="__span-57-55"><a id="__codelineno-57-55" name="__codelineno-57-55" href="#__codelineno-57-55"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-56"><a id="__codelineno-57-56" name="__codelineno-57-56" href="#__codelineno-57-56"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-57"><a id="__codelineno-57-57" name="__codelineno-57-57" href="#__codelineno-57-57"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="n">parentBeanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">nameToLookup</span><span class="p">);</span>
</span><span id="__span-57-58"><a id="__codelineno-57-58" name="__codelineno-57-58" href="#__codelineno-57-58"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-59"><a id="__codelineno-57-59" name="__codelineno-57-59" href="#__codelineno-57-59"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-57-60"><a id="__codelineno-57-60" name="__codelineno-57-60" href="#__codelineno-57-60"></a>
</span><span id="__span-57-61"><a id="__codelineno-57-61" name="__codelineno-57-61" href="#__codelineno-57-61"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">typeCheckOnly</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-62"><a id="__codelineno-57-62" name="__codelineno-57-62" href="#__codelineno-57-62"></a><span class="w">            </span><span class="n">markBeanAsCreated</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-63"><a id="__codelineno-57-63" name="__codelineno-57-63" href="#__codelineno-57-63"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-57-64"><a id="__codelineno-57-64" name="__codelineno-57-64" href="#__codelineno-57-64"></a>
</span><span id="__span-57-65"><a id="__codelineno-57-65" name="__codelineno-57-65" href="#__codelineno-57-65"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-66"><a id="__codelineno-57-66" name="__codelineno-57-66" href="#__codelineno-57-66"></a><span class="w">            </span><span class="kd">final</span><span class="w"> </span><span class="n">RootBeanDefinition</span><span class="w"> </span><span class="n">mbd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getMergedLocalBeanDefinition</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-67"><a id="__codelineno-57-67" name="__codelineno-57-67" href="#__codelineno-57-67"></a><span class="w">            </span><span class="n">checkMergedBeanDefinition</span><span class="p">(</span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-57-68"><a id="__codelineno-57-68" name="__codelineno-57-68" href="#__codelineno-57-68"></a>
</span><span id="__span-57-69"><a id="__codelineno-57-69" name="__codelineno-57-69" href="#__codelineno-57-69"></a><span class="w">            </span><span class="c1">// Guarantee initialization of beans that the current bean depends on.</span>
</span><span id="__span-57-70"><a id="__codelineno-57-70" name="__codelineno-57-70" href="#__codelineno-57-70"></a><span class="w">            </span><span class="c1">// 获取当前bean的依赖关系</span>
</span><span id="__span-57-71"><a id="__codelineno-57-71" name="__codelineno-57-71" href="#__codelineno-57-71"></a><span class="w">            </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">dependsOn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">getDependsOn</span><span class="p">();</span>
</span><span id="__span-57-72"><a id="__codelineno-57-72" name="__codelineno-57-72" href="#__codelineno-57-72"></a><span class="w">            </span><span class="c1">// 根据依赖的beanName递归调用getBean()方法，不断探寻其依赖的bean，直到getSingleton方法返回依赖的Bean，即当前正在创建的Bean</span>
</span><span id="__span-57-73"><a id="__codelineno-57-73" name="__codelineno-57-73" href="#__codelineno-57-73"></a><span class="w">            </span><span class="c1">// 直到依赖关系最底层的bean没有依赖对象了，至此整个递归过程结束  </span>
</span><span id="__span-57-74"><a id="__codelineno-57-74" name="__codelineno-57-74" href="#__codelineno-57-74"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dependsOn</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-75"><a id="__codelineno-57-75" name="__codelineno-57-75" href="#__codelineno-57-75"></a><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">dep</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">dependsOn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-76"><a id="__codelineno-57-76" name="__codelineno-57-76" href="#__codelineno-57-76"></a><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isDependent</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">dep</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-77"><a id="__codelineno-57-77" name="__codelineno-57-77" href="#__codelineno-57-77"></a><span class="w">                        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span>
</span><span id="__span-57-78"><a id="__codelineno-57-78" name="__codelineno-57-78" href="#__codelineno-57-78"></a><span class="w">                                </span><span class="s">&quot;Circular depends-on relationship between &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; and &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dep</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">);</span>
</span><span id="__span-57-79"><a id="__codelineno-57-79" name="__codelineno-57-79" href="#__codelineno-57-79"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-57-80"><a id="__codelineno-57-80" name="__codelineno-57-80" href="#__codelineno-57-80"></a><span class="w">                    </span><span class="c1">// </span>
</span><span id="__span-57-81"><a id="__codelineno-57-81" name="__codelineno-57-81" href="#__codelineno-57-81"></a><span class="w">                    </span><span class="n">registerDependentBean</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-82"><a id="__codelineno-57-82" name="__codelineno-57-82" href="#__codelineno-57-82"></a><span class="w">                    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-83"><a id="__codelineno-57-83" name="__codelineno-57-83" href="#__codelineno-57-83"></a><span class="w">                        </span><span class="n">getBean</span><span class="p">(</span><span class="n">dep</span><span class="p">);</span>
</span><span id="__span-57-84"><a id="__codelineno-57-84" name="__codelineno-57-84" href="#__codelineno-57-84"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-57-85"><a id="__codelineno-57-85" name="__codelineno-57-85" href="#__codelineno-57-85"></a><span class="w">                    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">NoSuchBeanDefinitionException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-86"><a id="__codelineno-57-86" name="__codelineno-57-86" href="#__codelineno-57-86"></a><span class="w">                        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span>
</span><span id="__span-57-87"><a id="__codelineno-57-87" name="__codelineno-57-87" href="#__codelineno-57-87"></a><span class="w">                                </span><span class="s">&quot;&#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; depends on missing bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dep</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-57-88"><a id="__codelineno-57-88" name="__codelineno-57-88" href="#__codelineno-57-88"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-57-89"><a id="__codelineno-57-89" name="__codelineno-57-89" href="#__codelineno-57-89"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-57-90"><a id="__codelineno-57-90" name="__codelineno-57-90" href="#__codelineno-57-90"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-91"><a id="__codelineno-57-91" name="__codelineno-57-91" href="#__codelineno-57-91"></a><span class="w">            </span><span class="c1">// Create bean instance.</span>
</span><span id="__span-57-92"><a id="__codelineno-57-92" name="__codelineno-57-92" href="#__codelineno-57-92"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">isSingleton</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-93"><a id="__codelineno-57-93" name="__codelineno-57-93" href="#__codelineno-57-93"></a><span class="w">                </span><span class="c1">// getSingleton方法的参数是createBean(beanName, mbd, args)方法的返回值</span>
</span><span id="__span-57-94"><a id="__codelineno-57-94" name="__codelineno-57-94" href="#__codelineno-57-94"></a><span class="w">                </span><span class="n">sharedInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getSingleton</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-95"><a id="__codelineno-57-95" name="__codelineno-57-95" href="#__codelineno-57-95"></a><span class="w">                    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-96"><a id="__codelineno-57-96" name="__codelineno-57-96" href="#__codelineno-57-96"></a><span class="w">                        </span><span class="c1">// createBean方法在AbstractBeanFactory抽象类中定义，具体实现是在AbstractAutowireCapableBeanFactory抽象类中</span>
</span><span id="__span-57-97"><a id="__codelineno-57-97" name="__codelineno-57-97" href="#__codelineno-57-97"></a><span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="n">createBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-57-98"><a id="__codelineno-57-98" name="__codelineno-57-98" href="#__codelineno-57-98"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-57-99"><a id="__codelineno-57-99" name="__codelineno-57-99" href="#__codelineno-57-99"></a><span class="w">                    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeansException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-100"><a id="__codelineno-57-100" name="__codelineno-57-100" href="#__codelineno-57-100"></a><span class="w">                        </span><span class="c1">// Explicitly remove instance from singleton cache: It might have been put there</span>
</span><span id="__span-57-101"><a id="__codelineno-57-101" name="__codelineno-57-101" href="#__codelineno-57-101"></a><span class="w">                        </span><span class="c1">// eagerly by the creation process, to allow for circular reference resolution.</span>
</span><span id="__span-57-102"><a id="__codelineno-57-102" name="__codelineno-57-102" href="#__codelineno-57-102"></a><span class="w">                        </span><span class="c1">// Also remove any beans that received a temporary reference to the bean.</span>
</span><span id="__span-57-103"><a id="__codelineno-57-103" name="__codelineno-57-103" href="#__codelineno-57-103"></a><span class="w">                        </span><span class="n">destroySingleton</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-104"><a id="__codelineno-57-104" name="__codelineno-57-104" href="#__codelineno-57-104"></a><span class="w">                        </span><span class="k">throw</span><span class="w"> </span><span class="n">ex</span><span class="p">;</span>
</span><span id="__span-57-105"><a id="__codelineno-57-105" name="__codelineno-57-105" href="#__codelineno-57-105"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-57-106"><a id="__codelineno-57-106" name="__codelineno-57-106" href="#__codelineno-57-106"></a><span class="w">                </span><span class="p">});</span>
</span><span id="__span-57-107"><a id="__codelineno-57-107" name="__codelineno-57-107" href="#__codelineno-57-107"></a><span class="w">                </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getObjectForBeanInstance</span><span class="p">(</span><span class="n">sharedInstance</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">);</span>
</span><span id="__span-57-108"><a id="__codelineno-57-108" name="__codelineno-57-108" href="#__codelineno-57-108"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-109"><a id="__codelineno-57-109" name="__codelineno-57-109" href="#__codelineno-57-109"></a>
</span><span id="__span-57-110"><a id="__codelineno-57-110" name="__codelineno-57-110" href="#__codelineno-57-110"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">isPrototype</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-111"><a id="__codelineno-57-111" name="__codelineno-57-111" href="#__codelineno-57-111"></a><span class="w">                </span><span class="c1">// It&#39;s a prototype -&gt; create a new instance.</span>
</span><span id="__span-57-112"><a id="__codelineno-57-112" name="__codelineno-57-112" href="#__codelineno-57-112"></a><span class="w">                </span><span class="n">Object</span><span class="w"> </span><span class="n">prototypeInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-57-113"><a id="__codelineno-57-113" name="__codelineno-57-113" href="#__codelineno-57-113"></a><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-114"><a id="__codelineno-57-114" name="__codelineno-57-114" href="#__codelineno-57-114"></a><span class="w">                    </span><span class="n">beforePrototypeCreation</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-115"><a id="__codelineno-57-115" name="__codelineno-57-115" href="#__codelineno-57-115"></a><span class="w">                    </span><span class="n">prototypeInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-57-116"><a id="__codelineno-57-116" name="__codelineno-57-116" href="#__codelineno-57-116"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-57-117"><a id="__codelineno-57-117" name="__codelineno-57-117" href="#__codelineno-57-117"></a><span class="w">                </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-118"><a id="__codelineno-57-118" name="__codelineno-57-118" href="#__codelineno-57-118"></a><span class="w">                    </span><span class="n">afterPrototypeCreation</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-119"><a id="__codelineno-57-119" name="__codelineno-57-119" href="#__codelineno-57-119"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-57-120"><a id="__codelineno-57-120" name="__codelineno-57-120" href="#__codelineno-57-120"></a><span class="w">                </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getObjectForBeanInstance</span><span class="p">(</span><span class="n">prototypeInstance</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">);</span>
</span><span id="__span-57-121"><a id="__codelineno-57-121" name="__codelineno-57-121" href="#__codelineno-57-121"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-122"><a id="__codelineno-57-122" name="__codelineno-57-122" href="#__codelineno-57-122"></a>
</span><span id="__span-57-123"><a id="__codelineno-57-123" name="__codelineno-57-123" href="#__codelineno-57-123"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-124"><a id="__codelineno-57-124" name="__codelineno-57-124" href="#__codelineno-57-124"></a><span class="w">                </span><span class="n">String</span><span class="w"> </span><span class="n">scopeName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">getScope</span><span class="p">();</span>
</span><span id="__span-57-125"><a id="__codelineno-57-125" name="__codelineno-57-125" href="#__codelineno-57-125"></a><span class="w">                </span><span class="kd">final</span><span class="w"> </span><span class="n">Scope</span><span class="w"> </span><span class="n">scope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">scopes</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">scopeName</span><span class="p">);</span>
</span><span id="__span-57-126"><a id="__codelineno-57-126" name="__codelineno-57-126" href="#__codelineno-57-126"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">scope</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-127"><a id="__codelineno-57-127" name="__codelineno-57-127" href="#__codelineno-57-127"></a><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;No Scope registered for scope name &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">scopeName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">);</span>
</span><span id="__span-57-128"><a id="__codelineno-57-128" name="__codelineno-57-128" href="#__codelineno-57-128"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-57-129"><a id="__codelineno-57-129" name="__codelineno-57-129" href="#__codelineno-57-129"></a><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-130"><a id="__codelineno-57-130" name="__codelineno-57-130" href="#__codelineno-57-130"></a><span class="w">                    </span><span class="n">Object</span><span class="w"> </span><span class="n">scopedInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scope</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-131"><a id="__codelineno-57-131" name="__codelineno-57-131" href="#__codelineno-57-131"></a><span class="w">                        </span><span class="n">beforePrototypeCreation</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-132"><a id="__codelineno-57-132" name="__codelineno-57-132" href="#__codelineno-57-132"></a><span class="w">                        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-133"><a id="__codelineno-57-133" name="__codelineno-57-133" href="#__codelineno-57-133"></a><span class="w">                            </span><span class="k">return</span><span class="w"> </span><span class="n">createBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-57-134"><a id="__codelineno-57-134" name="__codelineno-57-134" href="#__codelineno-57-134"></a><span class="w">                        </span><span class="p">}</span>
</span><span id="__span-57-135"><a id="__codelineno-57-135" name="__codelineno-57-135" href="#__codelineno-57-135"></a><span class="w">                        </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-136"><a id="__codelineno-57-136" name="__codelineno-57-136" href="#__codelineno-57-136"></a><span class="w">                            </span><span class="n">afterPrototypeCreation</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-137"><a id="__codelineno-57-137" name="__codelineno-57-137" href="#__codelineno-57-137"></a><span class="w">                        </span><span class="p">}</span>
</span><span id="__span-57-138"><a id="__codelineno-57-138" name="__codelineno-57-138" href="#__codelineno-57-138"></a><span class="w">                    </span><span class="p">});</span>
</span><span id="__span-57-139"><a id="__codelineno-57-139" name="__codelineno-57-139" href="#__codelineno-57-139"></a><span class="w">                    </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getObjectForBeanInstance</span><span class="p">(</span><span class="n">scopedInstance</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">);</span>
</span><span id="__span-57-140"><a id="__codelineno-57-140" name="__codelineno-57-140" href="#__codelineno-57-140"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-57-141"><a id="__codelineno-57-141" name="__codelineno-57-141" href="#__codelineno-57-141"></a><span class="w">                </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IllegalStateException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-142"><a id="__codelineno-57-142" name="__codelineno-57-142" href="#__codelineno-57-142"></a><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span>
</span><span id="__span-57-143"><a id="__codelineno-57-143" name="__codelineno-57-143" href="#__codelineno-57-143"></a><span class="w">                            </span><span class="s">&quot;Scope &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">scopeName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; is not active for the current thread; consider &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-57-144"><a id="__codelineno-57-144" name="__codelineno-57-144" href="#__codelineno-57-144"></a><span class="w">                            </span><span class="s">&quot;defining a scoped proxy for this bean if you intend to refer to it from a singleton&quot;</span><span class="p">,</span>
</span><span id="__span-57-145"><a id="__codelineno-57-145" name="__codelineno-57-145" href="#__codelineno-57-145"></a><span class="w">                            </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-57-146"><a id="__codelineno-57-146" name="__codelineno-57-146" href="#__codelineno-57-146"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-57-147"><a id="__codelineno-57-147" name="__codelineno-57-147" href="#__codelineno-57-147"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-148"><a id="__codelineno-57-148" name="__codelineno-57-148" href="#__codelineno-57-148"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-57-149"><a id="__codelineno-57-149" name="__codelineno-57-149" href="#__codelineno-57-149"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeansException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-150"><a id="__codelineno-57-150" name="__codelineno-57-150" href="#__codelineno-57-150"></a><span class="w">            </span><span class="n">cleanupAfterBeanCreationFailure</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-57-151"><a id="__codelineno-57-151" name="__codelineno-57-151" href="#__codelineno-57-151"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">ex</span><span class="p">;</span>
</span><span id="__span-57-152"><a id="__codelineno-57-152" name="__codelineno-57-152" href="#__codelineno-57-152"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-57-153"><a id="__codelineno-57-153" name="__codelineno-57-153" href="#__codelineno-57-153"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-57-154"><a id="__codelineno-57-154" name="__codelineno-57-154" href="#__codelineno-57-154"></a>
</span><span id="__span-57-155"><a id="__codelineno-57-155" name="__codelineno-57-155" href="#__codelineno-57-155"></a><span class="w">    </span><span class="c1">// Check if required type matches the type of the actual bean instance.</span>
</span><span id="__span-57-156"><a id="__codelineno-57-156" name="__codelineno-57-156" href="#__codelineno-57-156"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">requiredType</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">requiredType</span><span class="p">.</span><span class="na">isInstance</span><span class="p">(</span><span class="n">bean</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-157"><a id="__codelineno-57-157" name="__codelineno-57-157" href="#__codelineno-57-157"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-158"><a id="__codelineno-57-158" name="__codelineno-57-158" href="#__codelineno-57-158"></a><span class="w">            </span><span class="n">T</span><span class="w"> </span><span class="n">convertedBean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getTypeConverter</span><span class="p">().</span><span class="na">convertIfNecessary</span><span class="p">(</span><span class="n">bean</span><span class="p">,</span><span class="w"> </span><span class="n">requiredType</span><span class="p">);</span>
</span><span id="__span-57-159"><a id="__codelineno-57-159" name="__codelineno-57-159" href="#__codelineno-57-159"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">convertedBean</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-160"><a id="__codelineno-57-160" name="__codelineno-57-160" href="#__codelineno-57-160"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanNotOfRequiredTypeException</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">requiredType</span><span class="p">,</span><span class="w"> </span><span class="n">bean</span><span class="p">.</span><span class="na">getClass</span><span class="p">());</span>
</span><span id="__span-57-161"><a id="__codelineno-57-161" name="__codelineno-57-161" href="#__codelineno-57-161"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-162"><a id="__codelineno-57-162" name="__codelineno-57-162" href="#__codelineno-57-162"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">convertedBean</span><span class="p">;</span>
</span><span id="__span-57-163"><a id="__codelineno-57-163" name="__codelineno-57-163" href="#__codelineno-57-163"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-57-164"><a id="__codelineno-57-164" name="__codelineno-57-164" href="#__codelineno-57-164"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">TypeMismatchException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-165"><a id="__codelineno-57-165" name="__codelineno-57-165" href="#__codelineno-57-165"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-57-166"><a id="__codelineno-57-166" name="__codelineno-57-166" href="#__codelineno-57-166"></a><span class="w">                </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Failed to convert bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; to required type &#39;&quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-57-167"><a id="__codelineno-57-167" name="__codelineno-57-167" href="#__codelineno-57-167"></a><span class="w">                        </span><span class="n">ClassUtils</span><span class="p">.</span><span class="na">getQualifiedName</span><span class="p">(</span><span class="n">requiredType</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-57-168"><a id="__codelineno-57-168" name="__codelineno-57-168" href="#__codelineno-57-168"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-57-169"><a id="__codelineno-57-169" name="__codelineno-57-169" href="#__codelineno-57-169"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanNotOfRequiredTypeException</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">requiredType</span><span class="p">,</span><span class="w"> </span><span class="n">bean</span><span class="p">.</span><span class="na">getClass</span><span class="p">());</span>
</span><span id="__span-57-170"><a id="__codelineno-57-170" name="__codelineno-57-170" href="#__codelineno-57-170"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-57-171"><a id="__codelineno-57-171" name="__codelineno-57-171" href="#__codelineno-57-171"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-57-172"><a id="__codelineno-57-172" name="__codelineno-57-172" href="#__codelineno-57-172"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="n">bean</span><span class="p">;</span>
</span><span id="__span-57-173"><a id="__codelineno-57-173" name="__codelineno-57-173" href="#__codelineno-57-173"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="abstractautowirecapablebeanfactorycreatebeanstring-beanname-rootbeandefinition-mbd-nullable-object-args">AbstractAutowireCapableBeanFactory类中的createBean(String beanName, RootBeanDefinition mbd, @Nullable Object[] args)方法<a class="headerlink" href="#abstractautowirecapablebeanfactorycreatebeanstring-beanname-rootbeandefinition-mbd-nullable-object-args" title="Permanent link">&para;</a></h4>
<ul>
<li>代码位置：org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="nd">@Override</span>
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a><span class="kd">protected</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">createBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">RootBeanDefinition</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a><span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a><span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Creating instance of bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">);</span>
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-8"><a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a><span class="w">    </span><span class="n">RootBeanDefinition</span><span class="w"> </span><span class="n">mbdToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbd</span><span class="p">;</span>
</span><span id="__span-58-9"><a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a>
</span><span id="__span-58-10"><a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a><span class="w">    </span><span class="c1">// Make sure bean class is actually resolved at this point, and</span>
</span><span id="__span-58-11"><a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a><span class="w">    </span><span class="c1">// clone the bean definition in case of a dynamically resolved Class</span>
</span><span id="__span-58-12"><a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a><span class="w">    </span><span class="c1">// which cannot be stored in the shared merged bean definition.</span>
</span><span id="__span-58-13"><a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a><span class="w">    </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">resolvedClass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resolveBeanClass</span><span class="p">(</span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-58-14"><a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resolvedClass</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">mbd</span><span class="p">.</span><span class="na">hasBeanClass</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">getBeanClassName</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-15"><a id="__codelineno-58-15" name="__codelineno-58-15" href="#__codelineno-58-15"></a><span class="w">        </span><span class="n">mbdToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RootBeanDefinition</span><span class="p">(</span><span class="n">mbd</span><span class="p">);</span>
</span><span id="__span-58-16"><a id="__codelineno-58-16" name="__codelineno-58-16" href="#__codelineno-58-16"></a><span class="w">        </span><span class="n">mbdToUse</span><span class="p">.</span><span class="na">setBeanClass</span><span class="p">(</span><span class="n">resolvedClass</span><span class="p">);</span>
</span><span id="__span-58-17"><a id="__codelineno-58-17" name="__codelineno-58-17" href="#__codelineno-58-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-18"><a id="__codelineno-58-18" name="__codelineno-58-18" href="#__codelineno-58-18"></a>
</span><span id="__span-58-19"><a id="__codelineno-58-19" name="__codelineno-58-19" href="#__codelineno-58-19"></a><span class="w">    </span><span class="c1">// Prepare method overrides.</span>
</span><span id="__span-58-20"><a id="__codelineno-58-20" name="__codelineno-58-20" href="#__codelineno-58-20"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-21"><a id="__codelineno-58-21" name="__codelineno-58-21" href="#__codelineno-58-21"></a><span class="w">        </span><span class="n">mbdToUse</span><span class="p">.</span><span class="na">prepareMethodOverrides</span><span class="p">();</span>
</span><span id="__span-58-22"><a id="__codelineno-58-22" name="__codelineno-58-22" href="#__codelineno-58-22"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-23"><a id="__codelineno-58-23" name="__codelineno-58-23" href="#__codelineno-58-23"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinitionValidationException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-24"><a id="__codelineno-58-24" name="__codelineno-58-24" href="#__codelineno-58-24"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="p">(</span><span class="n">mbdToUse</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span>
</span><span id="__span-58-25"><a id="__codelineno-58-25" name="__codelineno-58-25" href="#__codelineno-58-25"></a><span class="w">                </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Validation of method overrides failed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-58-26"><a id="__codelineno-58-26" name="__codelineno-58-26" href="#__codelineno-58-26"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-27"><a id="__codelineno-58-27" name="__codelineno-58-27" href="#__codelineno-58-27"></a>
</span><span id="__span-58-28"><a id="__codelineno-58-28" name="__codelineno-58-28" href="#__codelineno-58-28"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-29"><a id="__codelineno-58-29" name="__codelineno-58-29" href="#__codelineno-58-29"></a><span class="w">        </span><span class="c1">// Give BeanPostProcessors a chance to return a proxy instead of the target bean instance.</span>
</span><span id="__span-58-30"><a id="__codelineno-58-30" name="__codelineno-58-30" href="#__codelineno-58-30"></a><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resolveBeforeInstantiation</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbdToUse</span><span class="p">);</span>
</span><span id="__span-58-31"><a id="__codelineno-58-31" name="__codelineno-58-31" href="#__codelineno-58-31"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bean</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-32"><a id="__codelineno-58-32" name="__codelineno-58-32" href="#__codelineno-58-32"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">bean</span><span class="p">;</span>
</span><span id="__span-58-33"><a id="__codelineno-58-33" name="__codelineno-58-33" href="#__codelineno-58-33"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-34"><a id="__codelineno-58-34" name="__codelineno-58-34" href="#__codelineno-58-34"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-35"><a id="__codelineno-58-35" name="__codelineno-58-35" href="#__codelineno-58-35"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-36"><a id="__codelineno-58-36" name="__codelineno-58-36" href="#__codelineno-58-36"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span><span class="n">mbdToUse</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span>
</span><span id="__span-58-37"><a id="__codelineno-58-37" name="__codelineno-58-37" href="#__codelineno-58-37"></a><span class="w">                </span><span class="s">&quot;BeanPostProcessor before instantiation of bean failed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-58-38"><a id="__codelineno-58-38" name="__codelineno-58-38" href="#__codelineno-58-38"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-39"><a id="__codelineno-58-39" name="__codelineno-58-39" href="#__codelineno-58-39"></a>
</span><span id="__span-58-40"><a id="__codelineno-58-40" name="__codelineno-58-40" href="#__codelineno-58-40"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-41"><a id="__codelineno-58-41" name="__codelineno-58-41" href="#__codelineno-58-41"></a><span class="w">        </span><span class="c1">// createBean方法的核心  该方法会返回Bean对象的实例，具体代码在下面贴出</span>
</span><span id="__span-58-42"><a id="__codelineno-58-42" name="__codelineno-58-42" href="#__codelineno-58-42"></a><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">beanInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">doCreateBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbdToUse</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-58-43"><a id="__codelineno-58-43" name="__codelineno-58-43" href="#__codelineno-58-43"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-44"><a id="__codelineno-58-44" name="__codelineno-58-44" href="#__codelineno-58-44"></a><span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Finished creating instance of bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">);</span>
</span><span id="__span-58-45"><a id="__codelineno-58-45" name="__codelineno-58-45" href="#__codelineno-58-45"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-46"><a id="__codelineno-58-46" name="__codelineno-58-46" href="#__codelineno-58-46"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">beanInstance</span><span class="p">;</span>
</span><span id="__span-58-47"><a id="__codelineno-58-47" name="__codelineno-58-47" href="#__codelineno-58-47"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-48"><a id="__codelineno-58-48" name="__codelineno-58-48" href="#__codelineno-58-48"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeanCreationException</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ImplicitlyAppearedSingletonException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-49"><a id="__codelineno-58-49" name="__codelineno-58-49" href="#__codelineno-58-49"></a><span class="w">        </span><span class="c1">// A previously detected exception with proper bean creation context already,</span>
</span><span id="__span-58-50"><a id="__codelineno-58-50" name="__codelineno-58-50" href="#__codelineno-58-50"></a><span class="w">        </span><span class="c1">// or illegal singleton state to be communicated up to DefaultSingletonBeanRegistry.</span>
</span><span id="__span-58-51"><a id="__codelineno-58-51" name="__codelineno-58-51" href="#__codelineno-58-51"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">ex</span><span class="p">;</span>
</span><span id="__span-58-52"><a id="__codelineno-58-52" name="__codelineno-58-52" href="#__codelineno-58-52"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-53"><a id="__codelineno-58-53" name="__codelineno-58-53" href="#__codelineno-58-53"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-54"><a id="__codelineno-58-54" name="__codelineno-58-54" href="#__codelineno-58-54"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-58-55"><a id="__codelineno-58-55" name="__codelineno-58-55" href="#__codelineno-58-55"></a><span class="w">                </span><span class="n">mbdToUse</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Unexpected exception during bean creation&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-58-56"><a id="__codelineno-58-56" name="__codelineno-58-56" href="#__codelineno-58-56"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-57"><a id="__codelineno-58-57" name="__codelineno-58-57" href="#__codelineno-58-57"></a><span class="p">}</span>
</span><span id="__span-58-58"><a id="__codelineno-58-58" name="__codelineno-58-58" href="#__codelineno-58-58"></a>
</span><span id="__span-58-59"><a id="__codelineno-58-59" name="__codelineno-58-59" href="#__codelineno-58-59"></a>
</span><span id="__span-58-60"><a id="__codelineno-58-60" name="__codelineno-58-60" href="#__codelineno-58-60"></a>
</span><span id="__span-58-61"><a id="__codelineno-58-61" name="__codelineno-58-61" href="#__codelineno-58-61"></a><span class="c1">// 在AbstractAutowireCapableBeanFactory抽象类的createBean方法中调用的doCreateBean(beanName, mbdToUse, args)方法</span>
</span><span id="__span-58-62"><a id="__codelineno-58-62" name="__codelineno-58-62" href="#__codelineno-58-62"></a><span class="kd">protected</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">doCreateBean</span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">RootBeanDefinition</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span>
</span><span id="__span-58-63"><a id="__codelineno-58-63" name="__codelineno-58-63" href="#__codelineno-58-63"></a><span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-64"><a id="__codelineno-58-64" name="__codelineno-58-64" href="#__codelineno-58-64"></a>
</span><span id="__span-58-65"><a id="__codelineno-58-65" name="__codelineno-58-65" href="#__codelineno-58-65"></a><span class="w">    </span><span class="c1">// Instantiate the bean.</span>
</span><span id="__span-58-66"><a id="__codelineno-58-66" name="__codelineno-58-66" href="#__codelineno-58-66"></a><span class="w">    </span><span class="n">BeanWrapper</span><span class="w"> </span><span class="n">instanceWrapper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-58-67"><a id="__codelineno-58-67" name="__codelineno-58-67" href="#__codelineno-58-67"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">isSingleton</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-68"><a id="__codelineno-58-68" name="__codelineno-58-68" href="#__codelineno-58-68"></a><span class="w">        </span><span class="n">instanceWrapper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">factoryBeanInstanceCache</span><span class="p">.</span><span class="na">remove</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-58-69"><a id="__codelineno-58-69" name="__codelineno-58-69" href="#__codelineno-58-69"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-70"><a id="__codelineno-58-70" name="__codelineno-58-70" href="#__codelineno-58-70"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">instanceWrapper</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-71"><a id="__codelineno-58-71" name="__codelineno-58-71" href="#__codelineno-58-71"></a><span class="w">        </span><span class="c1">// 创建Bean实例</span>
</span><span id="__span-58-72"><a id="__codelineno-58-72" name="__codelineno-58-72" href="#__codelineno-58-72"></a><span class="w">        </span><span class="n">instanceWrapper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createBeanInstance</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-58-73"><a id="__codelineno-58-73" name="__codelineno-58-73" href="#__codelineno-58-73"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-74"><a id="__codelineno-58-74" name="__codelineno-58-74" href="#__codelineno-58-74"></a><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">instanceWrapper</span><span class="p">.</span><span class="na">getWrappedInstance</span><span class="p">();</span>
</span><span id="__span-58-75"><a id="__codelineno-58-75" name="__codelineno-58-75" href="#__codelineno-58-75"></a><span class="w">    </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">beanType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">instanceWrapper</span><span class="p">.</span><span class="na">getWrappedClass</span><span class="p">();</span>
</span><span id="__span-58-76"><a id="__codelineno-58-76" name="__codelineno-58-76" href="#__codelineno-58-76"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanType</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NullBean</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-77"><a id="__codelineno-58-77" name="__codelineno-58-77" href="#__codelineno-58-77"></a><span class="w">        </span><span class="n">mbd</span><span class="p">.</span><span class="na">resolvedTargetType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanType</span><span class="p">;</span>
</span><span id="__span-58-78"><a id="__codelineno-58-78" name="__codelineno-58-78" href="#__codelineno-58-78"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-79"><a id="__codelineno-58-79" name="__codelineno-58-79" href="#__codelineno-58-79"></a>
</span><span id="__span-58-80"><a id="__codelineno-58-80" name="__codelineno-58-80" href="#__codelineno-58-80"></a><span class="w">    </span><span class="c1">// Allow post-processors to modify the merged bean definition.</span>
</span><span id="__span-58-81"><a id="__codelineno-58-81" name="__codelineno-58-81" href="#__codelineno-58-81"></a><span class="w">    </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">postProcessingLock</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-82"><a id="__codelineno-58-82" name="__codelineno-58-82" href="#__codelineno-58-82"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">mbd</span><span class="p">.</span><span class="na">postProcessed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-83"><a id="__codelineno-58-83" name="__codelineno-58-83" href="#__codelineno-58-83"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-84"><a id="__codelineno-58-84" name="__codelineno-58-84" href="#__codelineno-58-84"></a><span class="w">                </span><span class="n">applyMergedBeanDefinitionPostProcessors</span><span class="p">(</span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">beanType</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-58-85"><a id="__codelineno-58-85" name="__codelineno-58-85" href="#__codelineno-58-85"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-58-86"><a id="__codelineno-58-86" name="__codelineno-58-86" href="#__codelineno-58-86"></a><span class="w">            </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-87"><a id="__codelineno-58-87" name="__codelineno-58-87" href="#__codelineno-58-87"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span>
</span><span id="__span-58-88"><a id="__codelineno-58-88" name="__codelineno-58-88" href="#__codelineno-58-88"></a><span class="w">                        </span><span class="s">&quot;Post-processing of merged bean definition failed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-58-89"><a id="__codelineno-58-89" name="__codelineno-58-89" href="#__codelineno-58-89"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-58-90"><a id="__codelineno-58-90" name="__codelineno-58-90" href="#__codelineno-58-90"></a><span class="w">            </span><span class="n">mbd</span><span class="p">.</span><span class="na">postProcessed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-58-91"><a id="__codelineno-58-91" name="__codelineno-58-91" href="#__codelineno-58-91"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-92"><a id="__codelineno-58-92" name="__codelineno-58-92" href="#__codelineno-58-92"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-93"><a id="__codelineno-58-93" name="__codelineno-58-93" href="#__codelineno-58-93"></a>
</span><span id="__span-58-94"><a id="__codelineno-58-94" name="__codelineno-58-94" href="#__codelineno-58-94"></a><span class="w">    </span><span class="c1">// Eagerly cache singletons to be able to resolve circular references</span>
</span><span id="__span-58-95"><a id="__codelineno-58-95" name="__codelineno-58-95" href="#__codelineno-58-95"></a><span class="w">    </span><span class="c1">// even when triggered by lifecycle interfaces like BeanFactoryAware.</span>
</span><span id="__span-58-96"><a id="__codelineno-58-96" name="__codelineno-58-96" href="#__codelineno-58-96"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">earlySingletonExposure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">isSingleton</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">allowCircularReferences</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="__span-58-97"><a id="__codelineno-58-97" name="__codelineno-58-97" href="#__codelineno-58-97"></a><span class="w">            </span><span class="n">isSingletonCurrentlyInCreation</span><span class="p">(</span><span class="n">beanName</span><span class="p">));</span>
</span><span id="__span-58-98"><a id="__codelineno-58-98" name="__codelineno-58-98" href="#__codelineno-58-98"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">earlySingletonExposure</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-99"><a id="__codelineno-58-99" name="__codelineno-58-99" href="#__codelineno-58-99"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isTraceEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-100"><a id="__codelineno-58-100" name="__codelineno-58-100" href="#__codelineno-58-100"></a><span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="na">trace</span><span class="p">(</span><span class="s">&quot;Eagerly caching bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-58-101"><a id="__codelineno-58-101" name="__codelineno-58-101" href="#__codelineno-58-101"></a><span class="w">                    </span><span class="s">&quot;&#39; to allow for resolving potential circular references&quot;</span><span class="p">);</span>
</span><span id="__span-58-102"><a id="__codelineno-58-102" name="__codelineno-58-102" href="#__codelineno-58-102"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-103"><a id="__codelineno-58-103" name="__codelineno-58-103" href="#__codelineno-58-103"></a><span class="w">        </span><span class="n">addSingletonFactory</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">getEarlyBeanReference</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">bean</span><span class="p">));</span>
</span><span id="__span-58-104"><a id="__codelineno-58-104" name="__codelineno-58-104" href="#__codelineno-58-104"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-105"><a id="__codelineno-58-105" name="__codelineno-58-105" href="#__codelineno-58-105"></a>
</span><span id="__span-58-106"><a id="__codelineno-58-106" name="__codelineno-58-106" href="#__codelineno-58-106"></a><span class="w">    </span><span class="c1">// Initialize the bean instance.</span>
</span><span id="__span-58-107"><a id="__codelineno-58-107" name="__codelineno-58-107" href="#__codelineno-58-107"></a><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="n">exposedObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bean</span><span class="p">;</span>
</span><span id="__span-58-108"><a id="__codelineno-58-108" name="__codelineno-58-108" href="#__codelineno-58-108"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-109"><a id="__codelineno-58-109" name="__codelineno-58-109" href="#__codelineno-58-109"></a><span class="w">        </span><span class="c1">// 填充bean，实际进行依赖注入的地方</span>
</span><span id="__span-58-110"><a id="__codelineno-58-110" name="__codelineno-58-110" href="#__codelineno-58-110"></a><span class="w">        </span><span class="n">populateBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">instanceWrapper</span><span class="p">);</span>
</span><span id="__span-58-111"><a id="__codelineno-58-111" name="__codelineno-58-111" href="#__codelineno-58-111"></a><span class="w">        </span><span class="n">exposedObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">initializeBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">exposedObject</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">);</span>
</span><span id="__span-58-112"><a id="__codelineno-58-112" name="__codelineno-58-112" href="#__codelineno-58-112"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-113"><a id="__codelineno-58-113" name="__codelineno-58-113" href="#__codelineno-58-113"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-114"><a id="__codelineno-58-114" name="__codelineno-58-114" href="#__codelineno-58-114"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ex</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">beanName</span><span class="p">.</span><span class="na">equals</span><span class="p">(((</span><span class="n">BeanCreationException</span><span class="p">)</span><span class="w"> </span><span class="n">ex</span><span class="p">).</span><span class="na">getBeanName</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-115"><a id="__codelineno-58-115" name="__codelineno-58-115" href="#__codelineno-58-115"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="p">(</span><span class="n">BeanCreationException</span><span class="p">)</span><span class="w"> </span><span class="n">ex</span><span class="p">;</span>
</span><span id="__span-58-116"><a id="__codelineno-58-116" name="__codelineno-58-116" href="#__codelineno-58-116"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-117"><a id="__codelineno-58-117" name="__codelineno-58-117" href="#__codelineno-58-117"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-118"><a id="__codelineno-58-118" name="__codelineno-58-118" href="#__codelineno-58-118"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-58-119"><a id="__codelineno-58-119" name="__codelineno-58-119" href="#__codelineno-58-119"></a><span class="w">                    </span><span class="n">mbd</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Initialization of bean failed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-58-120"><a id="__codelineno-58-120" name="__codelineno-58-120" href="#__codelineno-58-120"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-121"><a id="__codelineno-58-121" name="__codelineno-58-121" href="#__codelineno-58-121"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-122"><a id="__codelineno-58-122" name="__codelineno-58-122" href="#__codelineno-58-122"></a>
</span><span id="__span-58-123"><a id="__codelineno-58-123" name="__codelineno-58-123" href="#__codelineno-58-123"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">earlySingletonExposure</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-124"><a id="__codelineno-58-124" name="__codelineno-58-124" href="#__codelineno-58-124"></a><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">earlySingletonReference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getSingleton</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-58-125"><a id="__codelineno-58-125" name="__codelineno-58-125" href="#__codelineno-58-125"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">earlySingletonReference</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-126"><a id="__codelineno-58-126" name="__codelineno-58-126" href="#__codelineno-58-126"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">exposedObject</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">bean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-127"><a id="__codelineno-58-127" name="__codelineno-58-127" href="#__codelineno-58-127"></a><span class="w">                </span><span class="n">exposedObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">earlySingletonReference</span><span class="p">;</span>
</span><span id="__span-58-128"><a id="__codelineno-58-128" name="__codelineno-58-128" href="#__codelineno-58-128"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-58-129"><a id="__codelineno-58-129" name="__codelineno-58-129" href="#__codelineno-58-129"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="na">allowRawInjectionDespiteWrapping</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">hasDependentBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-130"><a id="__codelineno-58-130" name="__codelineno-58-130" href="#__codelineno-58-130"></a><span class="w">                </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">dependentBeans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getDependentBeans</span><span class="p">(</span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-58-131"><a id="__codelineno-58-131" name="__codelineno-58-131" href="#__codelineno-58-131"></a><span class="w">                </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">actualDependentBeans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedHashSet</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">dependentBeans</span><span class="p">.</span><span class="na">length</span><span class="p">);</span>
</span><span id="__span-58-132"><a id="__codelineno-58-132" name="__codelineno-58-132" href="#__codelineno-58-132"></a><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">dependentBean</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">dependentBeans</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-133"><a id="__codelineno-58-133" name="__codelineno-58-133" href="#__codelineno-58-133"></a><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">removeSingletonIfCreatedForTypeCheckOnly</span><span class="p">(</span><span class="n">dependentBean</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-134"><a id="__codelineno-58-134" name="__codelineno-58-134" href="#__codelineno-58-134"></a><span class="w">                        </span><span class="n">actualDependentBeans</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">dependentBean</span><span class="p">);</span>
</span><span id="__span-58-135"><a id="__codelineno-58-135" name="__codelineno-58-135" href="#__codelineno-58-135"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-58-136"><a id="__codelineno-58-136" name="__codelineno-58-136" href="#__codelineno-58-136"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-58-137"><a id="__codelineno-58-137" name="__codelineno-58-137" href="#__codelineno-58-137"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">actualDependentBeans</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-138"><a id="__codelineno-58-138" name="__codelineno-58-138" href="#__codelineno-58-138"></a><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCurrentlyInCreationException</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span>
</span><span id="__span-58-139"><a id="__codelineno-58-139" name="__codelineno-58-139" href="#__codelineno-58-139"></a><span class="w">                            </span><span class="s">&quot;Bean with name &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; has been injected into other beans [&quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-58-140"><a id="__codelineno-58-140" name="__codelineno-58-140" href="#__codelineno-58-140"></a><span class="w">                            </span><span class="n">StringUtils</span><span class="p">.</span><span class="na">collectionToCommaDelimitedString</span><span class="p">(</span><span class="n">actualDependentBeans</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-58-141"><a id="__codelineno-58-141" name="__codelineno-58-141" href="#__codelineno-58-141"></a><span class="w">                            </span><span class="s">&quot;] in its raw version as part of a circular reference, but has eventually been &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-58-142"><a id="__codelineno-58-142" name="__codelineno-58-142" href="#__codelineno-58-142"></a><span class="w">                            </span><span class="s">&quot;wrapped. This means that said other beans do not use the final version of the &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-58-143"><a id="__codelineno-58-143" name="__codelineno-58-143" href="#__codelineno-58-143"></a><span class="w">                            </span><span class="s">&quot;bean. This is often the result of over-eager type matching - consider using &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-58-144"><a id="__codelineno-58-144" name="__codelineno-58-144" href="#__codelineno-58-144"></a><span class="w">                            </span><span class="s">&quot;&#39;getBeanNamesOfType&#39; with the &#39;allowEagerInit&#39; flag turned off, for example.&quot;</span><span class="p">);</span>
</span><span id="__span-58-145"><a id="__codelineno-58-145" name="__codelineno-58-145" href="#__codelineno-58-145"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-58-146"><a id="__codelineno-58-146" name="__codelineno-58-146" href="#__codelineno-58-146"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-58-147"><a id="__codelineno-58-147" name="__codelineno-58-147" href="#__codelineno-58-147"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-148"><a id="__codelineno-58-148" name="__codelineno-58-148" href="#__codelineno-58-148"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-149"><a id="__codelineno-58-149" name="__codelineno-58-149" href="#__codelineno-58-149"></a>
</span><span id="__span-58-150"><a id="__codelineno-58-150" name="__codelineno-58-150" href="#__codelineno-58-150"></a><span class="w">    </span><span class="c1">// Register bean as disposable.</span>
</span><span id="__span-58-151"><a id="__codelineno-58-151" name="__codelineno-58-151" href="#__codelineno-58-151"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-152"><a id="__codelineno-58-152" name="__codelineno-58-152" href="#__codelineno-58-152"></a><span class="w">        </span><span class="n">registerDisposableBeanIfNecessary</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">bean</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">);</span>
</span><span id="__span-58-153"><a id="__codelineno-58-153" name="__codelineno-58-153" href="#__codelineno-58-153"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-154"><a id="__codelineno-58-154" name="__codelineno-58-154" href="#__codelineno-58-154"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinitionValidationException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-155"><a id="__codelineno-58-155" name="__codelineno-58-155" href="#__codelineno-58-155"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-58-156"><a id="__codelineno-58-156" name="__codelineno-58-156" href="#__codelineno-58-156"></a><span class="w">                </span><span class="n">mbd</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Invalid destruction signature&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-58-157"><a id="__codelineno-58-157" name="__codelineno-58-157" href="#__codelineno-58-157"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-158"><a id="__codelineno-58-158" name="__codelineno-58-158" href="#__codelineno-58-158"></a>
</span><span id="__span-58-159"><a id="__codelineno-58-159" name="__codelineno-58-159" href="#__codelineno-58-159"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">exposedObject</span><span class="p">;</span>
</span><span id="__span-58-160"><a id="__codelineno-58-160" name="__codelineno-58-160" href="#__codelineno-58-160"></a><span class="p">}</span>
</span><span id="__span-58-161"><a id="__codelineno-58-161" name="__codelineno-58-161" href="#__codelineno-58-161"></a>
</span><span id="__span-58-162"><a id="__codelineno-58-162" name="__codelineno-58-162" href="#__codelineno-58-162"></a>
</span><span id="__span-58-163"><a id="__codelineno-58-163" name="__codelineno-58-163" href="#__codelineno-58-163"></a><span class="c1">// 在AbstractAutowireCapableBeanFactory抽象类的doCreateBean方法中调用的 createBeanInstance(beanName, mbd, args)方法</span>
</span><span id="__span-58-164"><a id="__codelineno-58-164" name="__codelineno-58-164" href="#__codelineno-58-164"></a><span class="kd">protected</span><span class="w"> </span><span class="n">BeanWrapper</span><span class="w"> </span><span class="nf">createBeanInstance</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">RootBeanDefinition</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-165"><a id="__codelineno-58-165" name="__codelineno-58-165" href="#__codelineno-58-165"></a><span class="w">    </span><span class="c1">// Make sure bean class is actually resolved at this point.</span>
</span><span id="__span-58-166"><a id="__codelineno-58-166" name="__codelineno-58-166" href="#__codelineno-58-166"></a><span class="w">    </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">beanClass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resolveBeanClass</span><span class="p">(</span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-58-167"><a id="__codelineno-58-167" name="__codelineno-58-167" href="#__codelineno-58-167"></a>
</span><span id="__span-58-168"><a id="__codelineno-58-168" name="__codelineno-58-168" href="#__codelineno-58-168"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanClass</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">Modifier</span><span class="p">.</span><span class="na">isPublic</span><span class="p">(</span><span class="n">beanClass</span><span class="p">.</span><span class="na">getModifiers</span><span class="p">())</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">mbd</span><span class="p">.</span><span class="na">isNonPublicAccessAllowed</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-169"><a id="__codelineno-58-169" name="__codelineno-58-169" href="#__codelineno-58-169"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span>
</span><span id="__span-58-170"><a id="__codelineno-58-170" name="__codelineno-58-170" href="#__codelineno-58-170"></a><span class="w">                </span><span class="s">&quot;Bean class isn&#39;t public, and non-public access not allowed: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beanClass</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
</span><span id="__span-58-171"><a id="__codelineno-58-171" name="__codelineno-58-171" href="#__codelineno-58-171"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-172"><a id="__codelineno-58-172" name="__codelineno-58-172" href="#__codelineno-58-172"></a>
</span><span id="__span-58-173"><a id="__codelineno-58-173" name="__codelineno-58-173" href="#__codelineno-58-173"></a><span class="w">    </span><span class="n">Supplier</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">instanceSupplier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">getInstanceSupplier</span><span class="p">();</span>
</span><span id="__span-58-174"><a id="__codelineno-58-174" name="__codelineno-58-174" href="#__codelineno-58-174"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">instanceSupplier</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-175"><a id="__codelineno-58-175" name="__codelineno-58-175" href="#__codelineno-58-175"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">obtainFromSupplier</span><span class="p">(</span><span class="n">instanceSupplier</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-58-176"><a id="__codelineno-58-176" name="__codelineno-58-176" href="#__codelineno-58-176"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-177"><a id="__codelineno-58-177" name="__codelineno-58-177" href="#__codelineno-58-177"></a>
</span><span id="__span-58-178"><a id="__codelineno-58-178" name="__codelineno-58-178" href="#__codelineno-58-178"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">getFactoryMethodName</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-179"><a id="__codelineno-58-179" name="__codelineno-58-179" href="#__codelineno-58-179"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">instantiateUsingFactoryMethod</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-58-180"><a id="__codelineno-58-180" name="__codelineno-58-180" href="#__codelineno-58-180"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-181"><a id="__codelineno-58-181" name="__codelineno-58-181" href="#__codelineno-58-181"></a>
</span><span id="__span-58-182"><a id="__codelineno-58-182" name="__codelineno-58-182" href="#__codelineno-58-182"></a><span class="w">    </span><span class="c1">// Shortcut when re-creating the same bean...</span>
</span><span id="__span-58-183"><a id="__codelineno-58-183" name="__codelineno-58-183" href="#__codelineno-58-183"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">resolved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-58-184"><a id="__codelineno-58-184" name="__codelineno-58-184" href="#__codelineno-58-184"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">autowireNecessary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-58-185"><a id="__codelineno-58-185" name="__codelineno-58-185" href="#__codelineno-58-185"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-186"><a id="__codelineno-58-186" name="__codelineno-58-186" href="#__codelineno-58-186"></a><span class="w">        </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">constructorArgumentLock</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-187"><a id="__codelineno-58-187" name="__codelineno-58-187" href="#__codelineno-58-187"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">resolvedConstructorOrFactoryMethod</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-188"><a id="__codelineno-58-188" name="__codelineno-58-188" href="#__codelineno-58-188"></a><span class="w">                </span><span class="n">resolved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-58-189"><a id="__codelineno-58-189" name="__codelineno-58-189" href="#__codelineno-58-189"></a><span class="w">                </span><span class="n">autowireNecessary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">constructorArgumentsResolved</span><span class="p">;</span>
</span><span id="__span-58-190"><a id="__codelineno-58-190" name="__codelineno-58-190" href="#__codelineno-58-190"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-58-191"><a id="__codelineno-58-191" name="__codelineno-58-191" href="#__codelineno-58-191"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-192"><a id="__codelineno-58-192" name="__codelineno-58-192" href="#__codelineno-58-192"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-193"><a id="__codelineno-58-193" name="__codelineno-58-193" href="#__codelineno-58-193"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resolved</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-194"><a id="__codelineno-58-194" name="__codelineno-58-194" href="#__codelineno-58-194"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">autowireNecessary</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-195"><a id="__codelineno-58-195" name="__codelineno-58-195" href="#__codelineno-58-195"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">autowireConstructor</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-58-196"><a id="__codelineno-58-196" name="__codelineno-58-196" href="#__codelineno-58-196"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-197"><a id="__codelineno-58-197" name="__codelineno-58-197" href="#__codelineno-58-197"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-198"><a id="__codelineno-58-198" name="__codelineno-58-198" href="#__codelineno-58-198"></a><span class="w">            </span><span class="c1">// 调用instantiateBean方法</span>
</span><span id="__span-58-199"><a id="__codelineno-58-199" name="__codelineno-58-199" href="#__codelineno-58-199"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">instantiateBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">);</span>
</span><span id="__span-58-200"><a id="__codelineno-58-200" name="__codelineno-58-200" href="#__codelineno-58-200"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-201"><a id="__codelineno-58-201" name="__codelineno-58-201" href="#__codelineno-58-201"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-202"><a id="__codelineno-58-202" name="__codelineno-58-202" href="#__codelineno-58-202"></a>
</span><span id="__span-58-203"><a id="__codelineno-58-203" name="__codelineno-58-203" href="#__codelineno-58-203"></a><span class="w">    </span><span class="c1">// Candidate constructors for autowiring?</span>
</span><span id="__span-58-204"><a id="__codelineno-58-204" name="__codelineno-58-204" href="#__codelineno-58-204"></a><span class="w">    </span><span class="n">Constructor</span><span class="o">&lt;?&gt;[]</span><span class="w"> </span><span class="n">ctors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">determineConstructorsFromBeanPostProcessors</span><span class="p">(</span><span class="n">beanClass</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-58-205"><a id="__codelineno-58-205" name="__codelineno-58-205" href="#__codelineno-58-205"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ctors</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">getResolvedAutowireMode</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">AUTOWIRE_CONSTRUCTOR</span><span class="w"> </span><span class="o">||</span>
</span><span id="__span-58-206"><a id="__codelineno-58-206" name="__codelineno-58-206" href="#__codelineno-58-206"></a><span class="w">            </span><span class="n">mbd</span><span class="p">.</span><span class="na">hasConstructorArgumentValues</span><span class="p">()</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">ObjectUtils</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">(</span><span class="n">args</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-207"><a id="__codelineno-58-207" name="__codelineno-58-207" href="#__codelineno-58-207"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">autowireConstructor</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">ctors</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-58-208"><a id="__codelineno-58-208" name="__codelineno-58-208" href="#__codelineno-58-208"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-209"><a id="__codelineno-58-209" name="__codelineno-58-209" href="#__codelineno-58-209"></a>
</span><span id="__span-58-210"><a id="__codelineno-58-210" name="__codelineno-58-210" href="#__codelineno-58-210"></a><span class="w">    </span><span class="c1">// Preferred constructors for default construction?</span>
</span><span id="__span-58-211"><a id="__codelineno-58-211" name="__codelineno-58-211" href="#__codelineno-58-211"></a><span class="w">    </span><span class="n">ctors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">getPreferredConstructors</span><span class="p">();</span>
</span><span id="__span-58-212"><a id="__codelineno-58-212" name="__codelineno-58-212" href="#__codelineno-58-212"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ctors</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-213"><a id="__codelineno-58-213" name="__codelineno-58-213" href="#__codelineno-58-213"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">autowireConstructor</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">ctors</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-58-214"><a id="__codelineno-58-214" name="__codelineno-58-214" href="#__codelineno-58-214"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-215"><a id="__codelineno-58-215" name="__codelineno-58-215" href="#__codelineno-58-215"></a>
</span><span id="__span-58-216"><a id="__codelineno-58-216" name="__codelineno-58-216" href="#__codelineno-58-216"></a><span class="w">    </span><span class="c1">// No special handling: simply use no-arg constructor.</span>
</span><span id="__span-58-217"><a id="__codelineno-58-217" name="__codelineno-58-217" href="#__codelineno-58-217"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">instantiateBean</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">);</span>
</span><span id="__span-58-218"><a id="__codelineno-58-218" name="__codelineno-58-218" href="#__codelineno-58-218"></a><span class="p">}</span>
</span><span id="__span-58-219"><a id="__codelineno-58-219" name="__codelineno-58-219" href="#__codelineno-58-219"></a>
</span><span id="__span-58-220"><a id="__codelineno-58-220" name="__codelineno-58-220" href="#__codelineno-58-220"></a><span class="c1">// 在AbstractAutowireCapableBeanFactory抽象类的createBeanInstance方法中调用的instantiateBean(beanName, mbd)方法</span>
</span><span id="__span-58-221"><a id="__codelineno-58-221" name="__codelineno-58-221" href="#__codelineno-58-221"></a><span class="kd">protected</span><span class="w"> </span><span class="n">BeanWrapper</span><span class="w"> </span><span class="nf">instantiateBean</span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">RootBeanDefinition</span><span class="w"> </span><span class="n">mbd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-222"><a id="__codelineno-58-222" name="__codelineno-58-222" href="#__codelineno-58-222"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-223"><a id="__codelineno-58-223" name="__codelineno-58-223" href="#__codelineno-58-223"></a><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">beanInstance</span><span class="p">;</span>
</span><span id="__span-58-224"><a id="__codelineno-58-224" name="__codelineno-58-224" href="#__codelineno-58-224"></a><span class="w">        </span><span class="kd">final</span><span class="w"> </span><span class="n">BeanFactory</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">;</span>
</span><span id="__span-58-225"><a id="__codelineno-58-225" name="__codelineno-58-225" href="#__codelineno-58-225"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getSecurityManager</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-226"><a id="__codelineno-58-226" name="__codelineno-58-226" href="#__codelineno-58-226"></a><span class="w">            </span><span class="c1">// 核心逻辑</span>
</span><span id="__span-58-227"><a id="__codelineno-58-227" name="__codelineno-58-227" href="#__codelineno-58-227"></a><span class="w">            </span><span class="n">beanInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AccessController</span><span class="p">.</span><span class="na">doPrivileged</span><span class="p">((</span><span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-58-228"><a id="__codelineno-58-228" name="__codelineno-58-228" href="#__codelineno-58-228"></a><span class="w">                    </span><span class="n">getInstantiationStrategy</span><span class="p">().</span><span class="na">instantiate</span><span class="p">(</span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">),</span>
</span><span id="__span-58-229"><a id="__codelineno-58-229" name="__codelineno-58-229" href="#__codelineno-58-229"></a><span class="w">                    </span><span class="n">getAccessControlContext</span><span class="p">());</span>
</span><span id="__span-58-230"><a id="__codelineno-58-230" name="__codelineno-58-230" href="#__codelineno-58-230"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-231"><a id="__codelineno-58-231" name="__codelineno-58-231" href="#__codelineno-58-231"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-232"><a id="__codelineno-58-232" name="__codelineno-58-232" href="#__codelineno-58-232"></a><span class="w">            </span><span class="c1">// 核心逻辑</span>
</span><span id="__span-58-233"><a id="__codelineno-58-233" name="__codelineno-58-233" href="#__codelineno-58-233"></a><span class="w">            </span><span class="n">beanInstance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getInstantiationStrategy</span><span class="p">().</span><span class="na">instantiate</span><span class="p">(</span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">parent</span><span class="p">);</span>
</span><span id="__span-58-234"><a id="__codelineno-58-234" name="__codelineno-58-234" href="#__codelineno-58-234"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-58-235"><a id="__codelineno-58-235" name="__codelineno-58-235" href="#__codelineno-58-235"></a><span class="w">        </span><span class="n">BeanWrapper</span><span class="w"> </span><span class="n">bw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanWrapperImpl</span><span class="p">(</span><span class="n">beanInstance</span><span class="p">);</span>
</span><span id="__span-58-236"><a id="__codelineno-58-236" name="__codelineno-58-236" href="#__codelineno-58-236"></a><span class="w">        </span><span class="n">initBeanWrapper</span><span class="p">(</span><span class="n">bw</span><span class="p">);</span>
</span><span id="__span-58-237"><a id="__codelineno-58-237" name="__codelineno-58-237" href="#__codelineno-58-237"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">bw</span><span class="p">;</span>
</span><span id="__span-58-238"><a id="__codelineno-58-238" name="__codelineno-58-238" href="#__codelineno-58-238"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-239"><a id="__codelineno-58-239" name="__codelineno-58-239" href="#__codelineno-58-239"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-240"><a id="__codelineno-58-240" name="__codelineno-58-240" href="#__codelineno-58-240"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-58-241"><a id="__codelineno-58-241" name="__codelineno-58-241" href="#__codelineno-58-241"></a><span class="w">                </span><span class="n">mbd</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Instantiation of bean failed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-58-242"><a id="__codelineno-58-242" name="__codelineno-58-242" href="#__codelineno-58-242"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-58-243"><a id="__codelineno-58-243" name="__codelineno-58-243" href="#__codelineno-58-243"></a><span class="p">}</span>
</span><span id="__span-58-244"><a id="__codelineno-58-244" name="__codelineno-58-244" href="#__codelineno-58-244"></a>
</span><span id="__span-58-245"><a id="__codelineno-58-245" name="__codelineno-58-245" href="#__codelineno-58-245"></a><span class="c1">// 上面的getInstantiationStrategy()方法代码</span>
</span><span id="__span-58-246"><a id="__codelineno-58-246" name="__codelineno-58-246" href="#__codelineno-58-246"></a><span class="kd">protected</span><span class="w"> </span><span class="n">InstantiationStrategy</span><span class="w"> </span><span class="nf">getInstantiationStrategy</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-58-247"><a id="__codelineno-58-247" name="__codelineno-58-247" href="#__codelineno-58-247"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">instantiationStrategy</span><span class="p">;</span>
</span><span id="__span-58-248"><a id="__codelineno-58-248" name="__codelineno-58-248" href="#__codelineno-58-248"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="getinstantiationstrategysimpleinstantiationstrategy">getInstantiationStrategy()方法的返回接口对象的策略对象的一个实现SimpleInstantiationStrategy<a class="headerlink" href="#getinstantiationstrategysimpleinstantiationstrategy" title="Permanent link">&para;</a></h3>
<ul>
<li>org.springframework.beans.factory.support.SimpleInstantiationStrategy</li>
<li>SimpleInstantiationStrategy.instantiate(RootBeanDefinition bd, @Nullable String beanName, BeanFactory owner)方法的具体实现：
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="nd">@Override</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">instantiate</span><span class="p">(</span><span class="n">RootBeanDefinition</span><span class="w"> </span><span class="n">bd</span><span class="p">,</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanFactory</span><span class="w"> </span><span class="n">owner</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a><span class="w">    </span><span class="c1">// Don&#39;t override the class with CGLIB if no overrides.</span>
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">bd</span><span class="p">.</span><span class="na">hasMethodOverrides</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a><span class="w">        </span><span class="n">Constructor</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">constructorToUse</span><span class="p">;</span>
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a><span class="w">        </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">bd</span><span class="p">.</span><span class="na">constructorArgumentLock</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a><span class="w">            </span><span class="n">constructorToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Constructor</span><span class="o">&lt;?&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">bd</span><span class="p">.</span><span class="na">resolvedConstructorOrFactoryMethod</span><span class="p">;</span>
</span><span id="__span-59-8"><a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">constructorToUse</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-9"><a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a><span class="w">                </span><span class="kd">final</span><span class="w"> </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">clazz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bd</span><span class="p">.</span><span class="na">getBeanClass</span><span class="p">();</span>
</span><span id="__span-59-10"><a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">clazz</span><span class="p">.</span><span class="na">isInterface</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-11"><a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanInstantiationException</span><span class="p">(</span><span class="n">clazz</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Specified class is an interface&quot;</span><span class="p">);</span>
</span><span id="__span-59-12"><a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-59-13"><a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-14"><a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getSecurityManager</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-15"><a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a><span class="w">                        </span><span class="n">constructorToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AccessController</span><span class="p">.</span><span class="na">doPrivileged</span><span class="p">(</span>
</span><span id="__span-59-16"><a id="__codelineno-59-16" name="__codelineno-59-16" href="#__codelineno-59-16"></a><span class="w">                                </span><span class="p">(</span><span class="n">PrivilegedExceptionAction</span><span class="o">&lt;</span><span class="n">Constructor</span><span class="o">&lt;?&gt;&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">clazz</span><span class="p">::</span><span class="n">getDeclaredConstructor</span><span class="p">);</span>
</span><span id="__span-59-17"><a id="__codelineno-59-17" name="__codelineno-59-17" href="#__codelineno-59-17"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-59-18"><a id="__codelineno-59-18" name="__codelineno-59-18" href="#__codelineno-59-18"></a><span class="w">                    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-19"><a id="__codelineno-59-19" name="__codelineno-59-19" href="#__codelineno-59-19"></a><span class="w">                        </span><span class="n">constructorToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clazz</span><span class="p">.</span><span class="na">getDeclaredConstructor</span><span class="p">();</span>
</span><span id="__span-59-20"><a id="__codelineno-59-20" name="__codelineno-59-20" href="#__codelineno-59-20"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-59-21"><a id="__codelineno-59-21" name="__codelineno-59-21" href="#__codelineno-59-21"></a><span class="w">                    </span><span class="n">bd</span><span class="p">.</span><span class="na">resolvedConstructorOrFactoryMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">constructorToUse</span><span class="p">;</span>
</span><span id="__span-59-22"><a id="__codelineno-59-22" name="__codelineno-59-22" href="#__codelineno-59-22"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-59-23"><a id="__codelineno-59-23" name="__codelineno-59-23" href="#__codelineno-59-23"></a><span class="w">                </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-24"><a id="__codelineno-59-24" name="__codelineno-59-24" href="#__codelineno-59-24"></a><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanInstantiationException</span><span class="p">(</span><span class="n">clazz</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;No default constructor found&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-59-25"><a id="__codelineno-59-25" name="__codelineno-59-25" href="#__codelineno-59-25"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-59-26"><a id="__codelineno-59-26" name="__codelineno-59-26" href="#__codelineno-59-26"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-59-27"><a id="__codelineno-59-27" name="__codelineno-59-27" href="#__codelineno-59-27"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-59-28"><a id="__codelineno-59-28" name="__codelineno-59-28" href="#__codelineno-59-28"></a><span class="w">        </span><span class="c1">// 调用静态方法BeanUtils.instantiateClass(constructorToUse);</span>
</span><span id="__span-59-29"><a id="__codelineno-59-29" name="__codelineno-59-29" href="#__codelineno-59-29"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">BeanUtils</span><span class="p">.</span><span class="na">instantiateClass</span><span class="p">(</span><span class="n">constructorToUse</span><span class="p">);</span>
</span><span id="__span-59-30"><a id="__codelineno-59-30" name="__codelineno-59-30" href="#__codelineno-59-30"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-59-31"><a id="__codelineno-59-31" name="__codelineno-59-31" href="#__codelineno-59-31"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-32"><a id="__codelineno-59-32" name="__codelineno-59-32" href="#__codelineno-59-32"></a><span class="w">        </span><span class="c1">// Must generate CGLIB subclass.</span>
</span><span id="__span-59-33"><a id="__codelineno-59-33" name="__codelineno-59-33" href="#__codelineno-59-33"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">instantiateWithMethodInjection</span><span class="p">(</span><span class="n">bd</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">owner</span><span class="p">);</span>
</span><span id="__span-59-34"><a id="__codelineno-59-34" name="__codelineno-59-34" href="#__codelineno-59-34"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-59-35"><a id="__codelineno-59-35" name="__codelineno-59-35" href="#__codelineno-59-35"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="beanutilsinstantiateclassconstructortouse">静态方法BeanUtils.instantiateClass(constructorToUse)的实现细节<a class="headerlink" href="#beanutilsinstantiateclassconstructortouse" title="Permanent link">&para;</a></h4>
<ul>
<li>代码位置：org.springframework.beans.BeanUtils
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="nf">instantiateClass</span><span class="p">(</span><span class="n">Constructor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ctor</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="p">...</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeanInstantiationException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2" href="#__codelineno-60-2"></a><span class="w">    </span><span class="n">Assert</span><span class="p">.</span><span class="na">notNull</span><span class="p">(</span><span class="n">ctor</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Constructor must not be null&quot;</span><span class="p">);</span>
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3" href="#__codelineno-60-3"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4" href="#__codelineno-60-4"></a><span class="w">        </span><span class="n">ReflectionUtils</span><span class="p">.</span><span class="na">makeAccessible</span><span class="p">(</span><span class="n">ctor</span><span class="p">);</span>
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5" href="#__codelineno-60-5"></a><span class="w">        </span><span class="c1">// 判断是否是Kotlin类型</span>
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6" href="#__codelineno-60-6"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">KotlinDetector</span><span class="p">.</span><span class="na">isKotlinReflectPresent</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">KotlinDetector</span><span class="p">.</span><span class="na">isKotlinType</span><span class="p">(</span><span class="n">ctor</span><span class="p">.</span><span class="na">getDeclaringClass</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7" href="#__codelineno-60-7"></a><span class="w">            </span><span class="c1">// 是Kotlin类型</span>
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8" href="#__codelineno-60-8"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">KotlinDelegate</span><span class="p">.</span><span class="na">instantiateClass</span><span class="p">(</span><span class="n">ctor</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9" href="#__codelineno-60-9"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10" href="#__codelineno-60-10"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11" href="#__codelineno-60-11"></a><span class="w">            </span><span class="c1">// 不是Kotlin类型</span>
</span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12" href="#__codelineno-60-12"></a><span class="w">            </span><span class="n">Class</span><span class="o">&lt;?&gt;[]</span><span class="w"> </span><span class="n">parameterTypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctor</span><span class="p">.</span><span class="na">getParameterTypes</span><span class="p">();</span>
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13" href="#__codelineno-60-13"></a><span class="w">            </span><span class="n">Assert</span><span class="p">.</span><span class="na">isTrue</span><span class="p">(</span><span class="n">args</span><span class="p">.</span><span class="na">length</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">parameterTypes</span><span class="p">.</span><span class="na">length</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Can&#39;t specify more arguments than constructor parameters&quot;</span><span class="p">);</span>
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14" href="#__codelineno-60-14"></a><span class="w">            </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">argsWithDefaultValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Object</span><span class="o">[</span><span class="n">args</span><span class="p">.</span><span class="na">length</span><span class="o">]</span><span class="p">;</span>
</span><span id="__span-60-15"><a id="__codelineno-60-15" name="__codelineno-60-15" href="#__codelineno-60-15"></a><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">args</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-16"><a id="__codelineno-60-16" name="__codelineno-60-16" href="#__codelineno-60-16"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">args</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-17"><a id="__codelineno-60-17" name="__codelineno-60-17" href="#__codelineno-60-17"></a><span class="w">                    </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">parameterType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parameterTypes</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span>
</span><span id="__span-60-18"><a id="__codelineno-60-18" name="__codelineno-60-18" href="#__codelineno-60-18"></a><span class="w">                    </span><span class="n">argsWithDefaultValues</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">parameterType</span><span class="p">.</span><span class="na">isPrimitive</span><span class="p">()</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">DEFAULT_TYPE_VALUES</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">parameterType</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-60-19"><a id="__codelineno-60-19" name="__codelineno-60-19" href="#__codelineno-60-19"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-60-20"><a id="__codelineno-60-20" name="__codelineno-60-20" href="#__codelineno-60-20"></a><span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-21"><a id="__codelineno-60-21" name="__codelineno-60-21" href="#__codelineno-60-21"></a><span class="w">                    </span><span class="n">argsWithDefaultValues</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">args</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">;</span>
</span><span id="__span-60-22"><a id="__codelineno-60-22" name="__codelineno-60-22" href="#__codelineno-60-22"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-60-23"><a id="__codelineno-60-23" name="__codelineno-60-23" href="#__codelineno-60-23"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-60-24"><a id="__codelineno-60-24" name="__codelineno-60-24" href="#__codelineno-60-24"></a><span class="w">            </span><span class="c1">// 调用Constructor的newInstance方法，使用反射创建实例</span>
</span><span id="__span-60-25"><a id="__codelineno-60-25" name="__codelineno-60-25" href="#__codelineno-60-25"></a><span class="w">            </span><span class="c1">// 到此之后bean实例创建完成</span>
</span><span id="__span-60-26"><a id="__codelineno-60-26" name="__codelineno-60-26" href="#__codelineno-60-26"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ctor</span><span class="p">.</span><span class="na">newInstance</span><span class="p">(</span><span class="n">argsWithDefaultValues</span><span class="p">);</span>
</span><span id="__span-60-27"><a id="__codelineno-60-27" name="__codelineno-60-27" href="#__codelineno-60-27"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-60-28"><a id="__codelineno-60-28" name="__codelineno-60-28" href="#__codelineno-60-28"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-60-29"><a id="__codelineno-60-29" name="__codelineno-60-29" href="#__codelineno-60-29"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InstantiationException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-30"><a id="__codelineno-60-30" name="__codelineno-60-30" href="#__codelineno-60-30"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanInstantiationException</span><span class="p">(</span><span class="n">ctor</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Is it an abstract class?&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-60-31"><a id="__codelineno-60-31" name="__codelineno-60-31" href="#__codelineno-60-31"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-60-32"><a id="__codelineno-60-32" name="__codelineno-60-32" href="#__codelineno-60-32"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IllegalAccessException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-33"><a id="__codelineno-60-33" name="__codelineno-60-33" href="#__codelineno-60-33"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanInstantiationException</span><span class="p">(</span><span class="n">ctor</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Is the constructor accessible?&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-60-34"><a id="__codelineno-60-34" name="__codelineno-60-34" href="#__codelineno-60-34"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-60-35"><a id="__codelineno-60-35" name="__codelineno-60-35" href="#__codelineno-60-35"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IllegalArgumentException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-36"><a id="__codelineno-60-36" name="__codelineno-60-36" href="#__codelineno-60-36"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanInstantiationException</span><span class="p">(</span><span class="n">ctor</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Illegal arguments for constructor&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-60-37"><a id="__codelineno-60-37" name="__codelineno-60-37" href="#__codelineno-60-37"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-60-38"><a id="__codelineno-60-38" name="__codelineno-60-38" href="#__codelineno-60-38"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InvocationTargetException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-60-39"><a id="__codelineno-60-39" name="__codelineno-60-39" href="#__codelineno-60-39"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanInstantiationException</span><span class="p">(</span><span class="n">ctor</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Constructor threw exception&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getTargetException</span><span class="p">());</span>
</span><span id="__span-60-40"><a id="__codelineno-60-40" name="__codelineno-60-40" href="#__codelineno-60-40"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-60-41"><a id="__codelineno-60-41" name="__codelineno-60-41" href="#__codelineno-60-41"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="abstractautowirecapablebeanfactorydocreatebeanpopulatebeanbeanname-mbd-instancewrapper">AbstractAutowireCapableBeanFactory抽象类的中doCreateBean方法中调用的populateBean(beanName, mbd, instanceWrapper)方法<a class="headerlink" href="#abstractautowirecapablebeanfactorydocreatebeanpopulatebeanbeanname-mbd-instancewrapper" title="Permanent link">&para;</a></h4>
<ul>
<li>在AbstractAutowireCapableBeanFactory抽象类中的方法populateBean方法</li>
<li>该方法用于填充bean 具体发生依赖注入的地方
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="nd">@SuppressWarnings</span><span class="p">(</span><span class="s">&quot;deprecation&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// for postProcessPropertyValues</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">populateBean</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">RootBeanDefinition</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">BeanWrapper</span><span class="w"> </span><span class="n">bw</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bw</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">hasPropertyValues</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-61-6"><a id="__codelineno-61-6" name="__codelineno-61-6" href="#__codelineno-61-6"></a><span class="w">                    </span><span class="n">mbd</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Cannot apply property values to null instance&quot;</span><span class="p">);</span>
</span><span id="__span-61-7"><a id="__codelineno-61-7" name="__codelineno-61-7" href="#__codelineno-61-7"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-8"><a id="__codelineno-61-8" name="__codelineno-61-8" href="#__codelineno-61-8"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-9"><a id="__codelineno-61-9" name="__codelineno-61-9" href="#__codelineno-61-9"></a><span class="w">            </span><span class="c1">// Skip property population phase for null instance.</span>
</span><span id="__span-61-10"><a id="__codelineno-61-10" name="__codelineno-61-10" href="#__codelineno-61-10"></a><span class="w">            </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-61-11"><a id="__codelineno-61-11" name="__codelineno-61-11" href="#__codelineno-61-11"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-12"><a id="__codelineno-61-12" name="__codelineno-61-12" href="#__codelineno-61-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-13"><a id="__codelineno-61-13" name="__codelineno-61-13" href="#__codelineno-61-13"></a>
</span><span id="__span-61-14"><a id="__codelineno-61-14" name="__codelineno-61-14" href="#__codelineno-61-14"></a><span class="w">    </span><span class="c1">// Give any InstantiationAwareBeanPostProcessors the opportunity to modify the</span>
</span><span id="__span-61-15"><a id="__codelineno-61-15" name="__codelineno-61-15" href="#__codelineno-61-15"></a><span class="w">    </span><span class="c1">// state of the bean before properties are set. This can be used, for example,</span>
</span><span id="__span-61-16"><a id="__codelineno-61-16" name="__codelineno-61-16" href="#__codelineno-61-16"></a><span class="w">    </span><span class="c1">// to support styles of field injection.</span>
</span><span id="__span-61-17"><a id="__codelineno-61-17" name="__codelineno-61-17" href="#__codelineno-61-17"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">continueWithPropertyPopulation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-61-18"><a id="__codelineno-61-18" name="__codelineno-61-18" href="#__codelineno-61-18"></a>
</span><span id="__span-61-19"><a id="__codelineno-61-19" name="__codelineno-61-19" href="#__codelineno-61-19"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">mbd</span><span class="p">.</span><span class="na">isSynthetic</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">hasInstantiationAwareBeanPostProcessors</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-20"><a id="__codelineno-61-20" name="__codelineno-61-20" href="#__codelineno-61-20"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">BeanPostProcessor</span><span class="w"> </span><span class="n">bp</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">getBeanPostProcessors</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-21"><a id="__codelineno-61-21" name="__codelineno-61-21" href="#__codelineno-61-21"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bp</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">InstantiationAwareBeanPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-22"><a id="__codelineno-61-22" name="__codelineno-61-22" href="#__codelineno-61-22"></a><span class="w">                </span><span class="n">InstantiationAwareBeanPostProcessor</span><span class="w"> </span><span class="n">ibp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">InstantiationAwareBeanPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="n">bp</span><span class="p">;</span>
</span><span id="__span-61-23"><a id="__codelineno-61-23" name="__codelineno-61-23" href="#__codelineno-61-23"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ibp</span><span class="p">.</span><span class="na">postProcessAfterInstantiation</span><span class="p">(</span><span class="n">bw</span><span class="p">.</span><span class="na">getWrappedInstance</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-24"><a id="__codelineno-61-24" name="__codelineno-61-24" href="#__codelineno-61-24"></a><span class="w">                    </span><span class="n">continueWithPropertyPopulation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-61-25"><a id="__codelineno-61-25" name="__codelineno-61-25" href="#__codelineno-61-25"></a><span class="w">                    </span><span class="k">break</span><span class="p">;</span>
</span><span id="__span-61-26"><a id="__codelineno-61-26" name="__codelineno-61-26" href="#__codelineno-61-26"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-61-27"><a id="__codelineno-61-27" name="__codelineno-61-27" href="#__codelineno-61-27"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-61-28"><a id="__codelineno-61-28" name="__codelineno-61-28" href="#__codelineno-61-28"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-29"><a id="__codelineno-61-29" name="__codelineno-61-29" href="#__codelineno-61-29"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-30"><a id="__codelineno-61-30" name="__codelineno-61-30" href="#__codelineno-61-30"></a>
</span><span id="__span-61-31"><a id="__codelineno-61-31" name="__codelineno-61-31" href="#__codelineno-61-31"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">continueWithPropertyPopulation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-32"><a id="__codelineno-61-32" name="__codelineno-61-32" href="#__codelineno-61-32"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-61-33"><a id="__codelineno-61-33" name="__codelineno-61-33" href="#__codelineno-61-33"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-34"><a id="__codelineno-61-34" name="__codelineno-61-34" href="#__codelineno-61-34"></a><span class="w">    </span><span class="c1">// 获取bean的所有属性 用于后面配置Property元素 即依赖关系</span>
</span><span id="__span-61-35"><a id="__codelineno-61-35" name="__codelineno-61-35" href="#__codelineno-61-35"></a><span class="w">    </span><span class="n">PropertyValues</span><span class="w"> </span><span class="n">pvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">hasPropertyValues</span><span class="p">()</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">getPropertyValues</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-61-36"><a id="__codelineno-61-36" name="__codelineno-61-36" href="#__codelineno-61-36"></a>
</span><span id="__span-61-37"><a id="__codelineno-61-37" name="__codelineno-61-37" href="#__codelineno-61-37"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">resolvedAutowireMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">getResolvedAutowireMode</span><span class="p">();</span>
</span><span id="__span-61-38"><a id="__codelineno-61-38" name="__codelineno-61-38" href="#__codelineno-61-38"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resolvedAutowireMode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">AUTOWIRE_BY_NAME</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">resolvedAutowireMode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">AUTOWIRE_BY_TYPE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-39"><a id="__codelineno-61-39" name="__codelineno-61-39" href="#__codelineno-61-39"></a><span class="w">        </span><span class="n">MutablePropertyValues</span><span class="w"> </span><span class="n">newPvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MutablePropertyValues</span><span class="p">(</span><span class="n">pvs</span><span class="p">);</span>
</span><span id="__span-61-40"><a id="__codelineno-61-40" name="__codelineno-61-40" href="#__codelineno-61-40"></a><span class="w">        </span><span class="c1">// Add property values based on autowire by name if applicable.</span>
</span><span id="__span-61-41"><a id="__codelineno-61-41" name="__codelineno-61-41" href="#__codelineno-61-41"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resolvedAutowireMode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">AUTOWIRE_BY_NAME</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-42"><a id="__codelineno-61-42" name="__codelineno-61-42" href="#__codelineno-61-42"></a><span class="w">            </span><span class="n">autowireByName</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">bw</span><span class="p">,</span><span class="w"> </span><span class="n">newPvs</span><span class="p">);</span>
</span><span id="__span-61-43"><a id="__codelineno-61-43" name="__codelineno-61-43" href="#__codelineno-61-43"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-44"><a id="__codelineno-61-44" name="__codelineno-61-44" href="#__codelineno-61-44"></a><span class="w">        </span><span class="c1">// Add property values based on autowire by type if applicable.</span>
</span><span id="__span-61-45"><a id="__codelineno-61-45" name="__codelineno-61-45" href="#__codelineno-61-45"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resolvedAutowireMode</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">AUTOWIRE_BY_TYPE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-46"><a id="__codelineno-61-46" name="__codelineno-61-46" href="#__codelineno-61-46"></a><span class="w">            </span><span class="n">autowireByType</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">bw</span><span class="p">,</span><span class="w"> </span><span class="n">newPvs</span><span class="p">);</span>
</span><span id="__span-61-47"><a id="__codelineno-61-47" name="__codelineno-61-47" href="#__codelineno-61-47"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-48"><a id="__codelineno-61-48" name="__codelineno-61-48" href="#__codelineno-61-48"></a><span class="w">        </span><span class="n">pvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newPvs</span><span class="p">;</span>
</span><span id="__span-61-49"><a id="__codelineno-61-49" name="__codelineno-61-49" href="#__codelineno-61-49"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-50"><a id="__codelineno-61-50" name="__codelineno-61-50" href="#__codelineno-61-50"></a>
</span><span id="__span-61-51"><a id="__codelineno-61-51" name="__codelineno-61-51" href="#__codelineno-61-51"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">hasInstAwareBpps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hasInstantiationAwareBeanPostProcessors</span><span class="p">();</span>
</span><span id="__span-61-52"><a id="__codelineno-61-52" name="__codelineno-61-52" href="#__codelineno-61-52"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">needsDepCheck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">mbd</span><span class="p">.</span><span class="na">getDependencyCheck</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">AbstractBeanDefinition</span><span class="p">.</span><span class="na">DEPENDENCY_CHECK_NONE</span><span class="p">);</span>
</span><span id="__span-61-53"><a id="__codelineno-61-53" name="__codelineno-61-53" href="#__codelineno-61-53"></a>
</span><span id="__span-61-54"><a id="__codelineno-61-54" name="__codelineno-61-54" href="#__codelineno-61-54"></a><span class="w">    </span><span class="n">PropertyDescriptor</span><span class="o">[]</span><span class="w"> </span><span class="n">filteredPds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-61-55"><a id="__codelineno-61-55" name="__codelineno-61-55" href="#__codelineno-61-55"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hasInstAwareBpps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-56"><a id="__codelineno-61-56" name="__codelineno-61-56" href="#__codelineno-61-56"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pvs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-57"><a id="__codelineno-61-57" name="__codelineno-61-57" href="#__codelineno-61-57"></a><span class="w">            </span><span class="n">pvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">getPropertyValues</span><span class="p">();</span>
</span><span id="__span-61-58"><a id="__codelineno-61-58" name="__codelineno-61-58" href="#__codelineno-61-58"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-59"><a id="__codelineno-61-59" name="__codelineno-61-59" href="#__codelineno-61-59"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">BeanPostProcessor</span><span class="w"> </span><span class="n">bp</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">getBeanPostProcessors</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-60"><a id="__codelineno-61-60" name="__codelineno-61-60" href="#__codelineno-61-60"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bp</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">InstantiationAwareBeanPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-61"><a id="__codelineno-61-61" name="__codelineno-61-61" href="#__codelineno-61-61"></a><span class="w">                </span><span class="n">InstantiationAwareBeanPostProcessor</span><span class="w"> </span><span class="n">ibp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">InstantiationAwareBeanPostProcessor</span><span class="p">)</span><span class="w"> </span><span class="n">bp</span><span class="p">;</span>
</span><span id="__span-61-62"><a id="__codelineno-61-62" name="__codelineno-61-62" href="#__codelineno-61-62"></a><span class="w">                </span><span class="n">PropertyValues</span><span class="w"> </span><span class="n">pvsToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibp</span><span class="p">.</span><span class="na">postProcessProperties</span><span class="p">(</span><span class="n">pvs</span><span class="p">,</span><span class="w"> </span><span class="n">bw</span><span class="p">.</span><span class="na">getWrappedInstance</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-61-63"><a id="__codelineno-61-63" name="__codelineno-61-63" href="#__codelineno-61-63"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pvsToUse</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-64"><a id="__codelineno-61-64" name="__codelineno-61-64" href="#__codelineno-61-64"></a><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">filteredPds</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-65"><a id="__codelineno-61-65" name="__codelineno-61-65" href="#__codelineno-61-65"></a><span class="w">                        </span><span class="n">filteredPds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filterPropertyDescriptorsForDependencyCheck</span><span class="p">(</span><span class="n">bw</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">allowCaching</span><span class="p">);</span>
</span><span id="__span-61-66"><a id="__codelineno-61-66" name="__codelineno-61-66" href="#__codelineno-61-66"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-61-67"><a id="__codelineno-61-67" name="__codelineno-61-67" href="#__codelineno-61-67"></a><span class="w">                    </span><span class="n">pvsToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibp</span><span class="p">.</span><span class="na">postProcessPropertyValues</span><span class="p">(</span><span class="n">pvs</span><span class="p">,</span><span class="w"> </span><span class="n">filteredPds</span><span class="p">,</span><span class="w"> </span><span class="n">bw</span><span class="p">.</span><span class="na">getWrappedInstance</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">);</span>
</span><span id="__span-61-68"><a id="__codelineno-61-68" name="__codelineno-61-68" href="#__codelineno-61-68"></a><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pvsToUse</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-69"><a id="__codelineno-61-69" name="__codelineno-61-69" href="#__codelineno-61-69"></a><span class="w">                        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-61-70"><a id="__codelineno-61-70" name="__codelineno-61-70" href="#__codelineno-61-70"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-61-71"><a id="__codelineno-61-71" name="__codelineno-61-71" href="#__codelineno-61-71"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-61-72"><a id="__codelineno-61-72" name="__codelineno-61-72" href="#__codelineno-61-72"></a><span class="w">                </span><span class="n">pvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvsToUse</span><span class="p">;</span>
</span><span id="__span-61-73"><a id="__codelineno-61-73" name="__codelineno-61-73" href="#__codelineno-61-73"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-61-74"><a id="__codelineno-61-74" name="__codelineno-61-74" href="#__codelineno-61-74"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-75"><a id="__codelineno-61-75" name="__codelineno-61-75" href="#__codelineno-61-75"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-76"><a id="__codelineno-61-76" name="__codelineno-61-76" href="#__codelineno-61-76"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">needsDepCheck</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-77"><a id="__codelineno-61-77" name="__codelineno-61-77" href="#__codelineno-61-77"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">filteredPds</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-78"><a id="__codelineno-61-78" name="__codelineno-61-78" href="#__codelineno-61-78"></a><span class="w">            </span><span class="n">filteredPds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filterPropertyDescriptorsForDependencyCheck</span><span class="p">(</span><span class="n">bw</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">.</span><span class="na">allowCaching</span><span class="p">);</span>
</span><span id="__span-61-79"><a id="__codelineno-61-79" name="__codelineno-61-79" href="#__codelineno-61-79"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-80"><a id="__codelineno-61-80" name="__codelineno-61-80" href="#__codelineno-61-80"></a><span class="w">        </span><span class="n">checkDependencies</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">filteredPds</span><span class="p">,</span><span class="w"> </span><span class="n">pvs</span><span class="p">);</span>
</span><span id="__span-61-81"><a id="__codelineno-61-81" name="__codelineno-61-81" href="#__codelineno-61-81"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-82"><a id="__codelineno-61-82" name="__codelineno-61-82" href="#__codelineno-61-82"></a>
</span><span id="__span-61-83"><a id="__codelineno-61-83" name="__codelineno-61-83" href="#__codelineno-61-83"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pvs</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-84"><a id="__codelineno-61-84" name="__codelineno-61-84" href="#__codelineno-61-84"></a><span class="w">        </span><span class="c1">// 核心逻辑 applyPropertyValues方法的具体代码在下面</span>
</span><span id="__span-61-85"><a id="__codelineno-61-85" name="__codelineno-61-85" href="#__codelineno-61-85"></a><span class="w">        </span><span class="n">applyPropertyValues</span><span class="p">(</span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">bw</span><span class="p">,</span><span class="w"> </span><span class="n">pvs</span><span class="p">);</span>
</span><span id="__span-61-86"><a id="__codelineno-61-86" name="__codelineno-61-86" href="#__codelineno-61-86"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-87"><a id="__codelineno-61-87" name="__codelineno-61-87" href="#__codelineno-61-87"></a><span class="p">}</span>
</span><span id="__span-61-88"><a id="__codelineno-61-88" name="__codelineno-61-88" href="#__codelineno-61-88"></a>
</span><span id="__span-61-89"><a id="__codelineno-61-89" name="__codelineno-61-89" href="#__codelineno-61-89"></a><span class="c1">// 上面方法中调用的applyPropertyValues方法具体代码</span>
</span><span id="__span-61-90"><a id="__codelineno-61-90" name="__codelineno-61-90" href="#__codelineno-61-90"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">applyPropertyValues</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">BeanDefinition</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">BeanWrapper</span><span class="w"> </span><span class="n">bw</span><span class="p">,</span><span class="w"> </span><span class="n">PropertyValues</span><span class="w"> </span><span class="n">pvs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-91"><a id="__codelineno-61-91" name="__codelineno-61-91" href="#__codelineno-61-91"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pvs</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-92"><a id="__codelineno-61-92" name="__codelineno-61-92" href="#__codelineno-61-92"></a><span class="w">        </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-61-93"><a id="__codelineno-61-93" name="__codelineno-61-93" href="#__codelineno-61-93"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-94"><a id="__codelineno-61-94" name="__codelineno-61-94" href="#__codelineno-61-94"></a>
</span><span id="__span-61-95"><a id="__codelineno-61-95" name="__codelineno-61-95" href="#__codelineno-61-95"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getSecurityManager</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">bw</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BeanWrapperImpl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-96"><a id="__codelineno-61-96" name="__codelineno-61-96" href="#__codelineno-61-96"></a><span class="w">        </span><span class="p">((</span><span class="n">BeanWrapperImpl</span><span class="p">)</span><span class="w"> </span><span class="n">bw</span><span class="p">).</span><span class="na">setSecurityContext</span><span class="p">(</span><span class="n">getAccessControlContext</span><span class="p">());</span>
</span><span id="__span-61-97"><a id="__codelineno-61-97" name="__codelineno-61-97" href="#__codelineno-61-97"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-98"><a id="__codelineno-61-98" name="__codelineno-61-98" href="#__codelineno-61-98"></a>
</span><span id="__span-61-99"><a id="__codelineno-61-99" name="__codelineno-61-99" href="#__codelineno-61-99"></a><span class="w">    </span><span class="n">MutablePropertyValues</span><span class="w"> </span><span class="n">mpvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-61-100"><a id="__codelineno-61-100" name="__codelineno-61-100" href="#__codelineno-61-100"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PropertyValue</span><span class="o">&gt;</span><span class="w"> </span><span class="n">original</span><span class="p">;</span>
</span><span id="__span-61-101"><a id="__codelineno-61-101" name="__codelineno-61-101" href="#__codelineno-61-101"></a>
</span><span id="__span-61-102"><a id="__codelineno-61-102" name="__codelineno-61-102" href="#__codelineno-61-102"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pvs</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">MutablePropertyValues</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-103"><a id="__codelineno-61-103" name="__codelineno-61-103" href="#__codelineno-61-103"></a><span class="w">        </span><span class="n">mpvs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">MutablePropertyValues</span><span class="p">)</span><span class="w"> </span><span class="n">pvs</span><span class="p">;</span>
</span><span id="__span-61-104"><a id="__codelineno-61-104" name="__codelineno-61-104" href="#__codelineno-61-104"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpvs</span><span class="p">.</span><span class="na">isConverted</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-105"><a id="__codelineno-61-105" name="__codelineno-61-105" href="#__codelineno-61-105"></a><span class="w">            </span><span class="c1">// Shortcut: use the pre-converted values as-is.</span>
</span><span id="__span-61-106"><a id="__codelineno-61-106" name="__codelineno-61-106" href="#__codelineno-61-106"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-107"><a id="__codelineno-61-107" name="__codelineno-61-107" href="#__codelineno-61-107"></a><span class="w">                </span><span class="n">bw</span><span class="p">.</span><span class="na">setPropertyValues</span><span class="p">(</span><span class="n">mpvs</span><span class="p">);</span>
</span><span id="__span-61-108"><a id="__codelineno-61-108" name="__codelineno-61-108" href="#__codelineno-61-108"></a><span class="w">                </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-61-109"><a id="__codelineno-61-109" name="__codelineno-61-109" href="#__codelineno-61-109"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-61-110"><a id="__codelineno-61-110" name="__codelineno-61-110" href="#__codelineno-61-110"></a><span class="w">            </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeansException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-111"><a id="__codelineno-61-111" name="__codelineno-61-111" href="#__codelineno-61-111"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-61-112"><a id="__codelineno-61-112" name="__codelineno-61-112" href="#__codelineno-61-112"></a><span class="w">                        </span><span class="n">mbd</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Error setting property values&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-61-113"><a id="__codelineno-61-113" name="__codelineno-61-113" href="#__codelineno-61-113"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-61-114"><a id="__codelineno-61-114" name="__codelineno-61-114" href="#__codelineno-61-114"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-115"><a id="__codelineno-61-115" name="__codelineno-61-115" href="#__codelineno-61-115"></a><span class="w">        </span><span class="n">original</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpvs</span><span class="p">.</span><span class="na">getPropertyValueList</span><span class="p">();</span>
</span><span id="__span-61-116"><a id="__codelineno-61-116" name="__codelineno-61-116" href="#__codelineno-61-116"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-117"><a id="__codelineno-61-117" name="__codelineno-61-117" href="#__codelineno-61-117"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-118"><a id="__codelineno-61-118" name="__codelineno-61-118" href="#__codelineno-61-118"></a><span class="w">        </span><span class="n">original</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">pvs</span><span class="p">.</span><span class="na">getPropertyValues</span><span class="p">());</span>
</span><span id="__span-61-119"><a id="__codelineno-61-119" name="__codelineno-61-119" href="#__codelineno-61-119"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-120"><a id="__codelineno-61-120" name="__codelineno-61-120" href="#__codelineno-61-120"></a>
</span><span id="__span-61-121"><a id="__codelineno-61-121" name="__codelineno-61-121" href="#__codelineno-61-121"></a><span class="w">    </span><span class="n">TypeConverter</span><span class="w"> </span><span class="n">converter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCustomTypeConverter</span><span class="p">();</span>
</span><span id="__span-61-122"><a id="__codelineno-61-122" name="__codelineno-61-122" href="#__codelineno-61-122"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">converter</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-123"><a id="__codelineno-61-123" name="__codelineno-61-123" href="#__codelineno-61-123"></a><span class="w">        </span><span class="n">converter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bw</span><span class="p">;</span>
</span><span id="__span-61-124"><a id="__codelineno-61-124" name="__codelineno-61-124" href="#__codelineno-61-124"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-125"><a id="__codelineno-61-125" name="__codelineno-61-125" href="#__codelineno-61-125"></a><span class="w">    </span><span class="n">BeanDefinitionValueResolver</span><span class="w"> </span><span class="n">valueResolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionValueResolver</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">mbd</span><span class="p">,</span><span class="w"> </span><span class="n">converter</span><span class="p">);</span>
</span><span id="__span-61-126"><a id="__codelineno-61-126" name="__codelineno-61-126" href="#__codelineno-61-126"></a>
</span><span id="__span-61-127"><a id="__codelineno-61-127" name="__codelineno-61-127" href="#__codelineno-61-127"></a><span class="w">    </span><span class="c1">// Create a deep copy, resolving any references for values.</span>
</span><span id="__span-61-128"><a id="__codelineno-61-128" name="__codelineno-61-128" href="#__codelineno-61-128"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PropertyValue</span><span class="o">&gt;</span><span class="w"> </span><span class="n">deepCopy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">original</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
</span><span id="__span-61-129"><a id="__codelineno-61-129" name="__codelineno-61-129" href="#__codelineno-61-129"></a><span class="w">    </span><span class="kt">boolean</span><span class="w"> </span><span class="n">resolveNecessary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span id="__span-61-130"><a id="__codelineno-61-130" name="__codelineno-61-130" href="#__codelineno-61-130"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">PropertyValue</span><span class="w"> </span><span class="n">pv</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">original</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-131"><a id="__codelineno-61-131" name="__codelineno-61-131" href="#__codelineno-61-131"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pv</span><span class="p">.</span><span class="na">isConverted</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-132"><a id="__codelineno-61-132" name="__codelineno-61-132" href="#__codelineno-61-132"></a><span class="w">            </span><span class="n">deepCopy</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">pv</span><span class="p">);</span>
</span><span id="__span-61-133"><a id="__codelineno-61-133" name="__codelineno-61-133" href="#__codelineno-61-133"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-134"><a id="__codelineno-61-134" name="__codelineno-61-134" href="#__codelineno-61-134"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-135"><a id="__codelineno-61-135" name="__codelineno-61-135" href="#__codelineno-61-135"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">propertyName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pv</span><span class="p">.</span><span class="na">getName</span><span class="p">();</span>
</span><span id="__span-61-136"><a id="__codelineno-61-136" name="__codelineno-61-136" href="#__codelineno-61-136"></a><span class="w">            </span><span class="n">Object</span><span class="w"> </span><span class="n">originalValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pv</span><span class="p">.</span><span class="na">getValue</span><span class="p">();</span>
</span><span id="__span-61-137"><a id="__codelineno-61-137" name="__codelineno-61-137" href="#__codelineno-61-137"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">originalValue</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">AutowiredPropertyMarker</span><span class="p">.</span><span class="na">INSTANCE</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-138"><a id="__codelineno-61-138" name="__codelineno-61-138" href="#__codelineno-61-138"></a><span class="w">                </span><span class="n">Method</span><span class="w"> </span><span class="n">writeMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bw</span><span class="p">.</span><span class="na">getPropertyDescriptor</span><span class="p">(</span><span class="n">propertyName</span><span class="p">).</span><span class="na">getWriteMethod</span><span class="p">();</span>
</span><span id="__span-61-139"><a id="__codelineno-61-139" name="__codelineno-61-139" href="#__codelineno-61-139"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">writeMethod</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-140"><a id="__codelineno-61-140" name="__codelineno-61-140" href="#__codelineno-61-140"></a><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Autowire marker for property without write method: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pv</span><span class="p">);</span>
</span><span id="__span-61-141"><a id="__codelineno-61-141" name="__codelineno-61-141" href="#__codelineno-61-141"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-61-142"><a id="__codelineno-61-142" name="__codelineno-61-142" href="#__codelineno-61-142"></a><span class="w">                </span><span class="n">originalValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DependencyDescriptor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">MethodParameter</span><span class="p">(</span><span class="n">writeMethod</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</span><span id="__span-61-143"><a id="__codelineno-61-143" name="__codelineno-61-143" href="#__codelineno-61-143"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-61-144"><a id="__codelineno-61-144" name="__codelineno-61-144" href="#__codelineno-61-144"></a><span class="w">            </span><span class="c1">// 获取property对应的值   resolveValueIfNecessary方法的代码在下面给出</span>
</span><span id="__span-61-145"><a id="__codelineno-61-145" name="__codelineno-61-145" href="#__codelineno-61-145"></a><span class="w">            </span><span class="n">Object</span><span class="w"> </span><span class="n">resolvedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valueResolver</span><span class="p">.</span><span class="na">resolveValueIfNecessary</span><span class="p">(</span><span class="n">pv</span><span class="p">,</span><span class="w"> </span><span class="n">originalValue</span><span class="p">);</span>
</span><span id="__span-61-146"><a id="__codelineno-61-146" name="__codelineno-61-146" href="#__codelineno-61-146"></a><span class="w">            </span><span class="n">Object</span><span class="w"> </span><span class="n">convertedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resolvedValue</span><span class="p">;</span>
</span><span id="__span-61-147"><a id="__codelineno-61-147" name="__codelineno-61-147" href="#__codelineno-61-147"></a><span class="w">            </span><span class="kt">boolean</span><span class="w"> </span><span class="n">convertible</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bw</span><span class="p">.</span><span class="na">isWritableProperty</span><span class="p">(</span><span class="n">propertyName</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="__span-61-148"><a id="__codelineno-61-148" name="__codelineno-61-148" href="#__codelineno-61-148"></a><span class="w">                    </span><span class="o">!</span><span class="n">PropertyAccessorUtils</span><span class="p">.</span><span class="na">isNestedOrIndexedProperty</span><span class="p">(</span><span class="n">propertyName</span><span class="p">);</span>
</span><span id="__span-61-149"><a id="__codelineno-61-149" name="__codelineno-61-149" href="#__codelineno-61-149"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">convertible</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-150"><a id="__codelineno-61-150" name="__codelineno-61-150" href="#__codelineno-61-150"></a><span class="w">                </span><span class="n">convertedValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convertForProperty</span><span class="p">(</span><span class="n">resolvedValue</span><span class="p">,</span><span class="w"> </span><span class="n">propertyName</span><span class="p">,</span><span class="w"> </span><span class="n">bw</span><span class="p">,</span><span class="w"> </span><span class="n">converter</span><span class="p">);</span>
</span><span id="__span-61-151"><a id="__codelineno-61-151" name="__codelineno-61-151" href="#__codelineno-61-151"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-61-152"><a id="__codelineno-61-152" name="__codelineno-61-152" href="#__codelineno-61-152"></a><span class="w">            </span><span class="c1">// Possibly store converted value in merged bean definition,</span>
</span><span id="__span-61-153"><a id="__codelineno-61-153" name="__codelineno-61-153" href="#__codelineno-61-153"></a><span class="w">            </span><span class="c1">// in order to avoid re-conversion for every created bean instance.</span>
</span><span id="__span-61-154"><a id="__codelineno-61-154" name="__codelineno-61-154" href="#__codelineno-61-154"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resolvedValue</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">originalValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-155"><a id="__codelineno-61-155" name="__codelineno-61-155" href="#__codelineno-61-155"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">convertible</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-156"><a id="__codelineno-61-156" name="__codelineno-61-156" href="#__codelineno-61-156"></a><span class="w">                    </span><span class="n">pv</span><span class="p">.</span><span class="na">setConvertedValue</span><span class="p">(</span><span class="n">convertedValue</span><span class="p">);</span>
</span><span id="__span-61-157"><a id="__codelineno-61-157" name="__codelineno-61-157" href="#__codelineno-61-157"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-61-158"><a id="__codelineno-61-158" name="__codelineno-61-158" href="#__codelineno-61-158"></a><span class="w">                </span><span class="n">deepCopy</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">pv</span><span class="p">);</span>
</span><span id="__span-61-159"><a id="__codelineno-61-159" name="__codelineno-61-159" href="#__codelineno-61-159"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-61-160"><a id="__codelineno-61-160" name="__codelineno-61-160" href="#__codelineno-61-160"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">convertible</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">originalValue</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">TypedStringValue</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="__span-61-161"><a id="__codelineno-61-161" name="__codelineno-61-161" href="#__codelineno-61-161"></a><span class="w">                    </span><span class="o">!</span><span class="p">((</span><span class="n">TypedStringValue</span><span class="p">)</span><span class="w"> </span><span class="n">originalValue</span><span class="p">).</span><span class="na">isDynamic</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span>
</span><span id="__span-61-162"><a id="__codelineno-61-162" name="__codelineno-61-162" href="#__codelineno-61-162"></a><span class="w">                    </span><span class="o">!</span><span class="p">(</span><span class="n">convertedValue</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">Collection</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ObjectUtils</span><span class="p">.</span><span class="na">isArray</span><span class="p">(</span><span class="n">convertedValue</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-163"><a id="__codelineno-61-163" name="__codelineno-61-163" href="#__codelineno-61-163"></a><span class="w">                </span><span class="n">pv</span><span class="p">.</span><span class="na">setConvertedValue</span><span class="p">(</span><span class="n">convertedValue</span><span class="p">);</span>
</span><span id="__span-61-164"><a id="__codelineno-61-164" name="__codelineno-61-164" href="#__codelineno-61-164"></a><span class="w">                </span><span class="n">deepCopy</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">pv</span><span class="p">);</span>
</span><span id="__span-61-165"><a id="__codelineno-61-165" name="__codelineno-61-165" href="#__codelineno-61-165"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-61-166"><a id="__codelineno-61-166" name="__codelineno-61-166" href="#__codelineno-61-166"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-167"><a id="__codelineno-61-167" name="__codelineno-61-167" href="#__codelineno-61-167"></a><span class="w">                </span><span class="n">resolveNecessary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
</span><span id="__span-61-168"><a id="__codelineno-61-168" name="__codelineno-61-168" href="#__codelineno-61-168"></a><span class="w">                </span><span class="n">deepCopy</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">PropertyValue</span><span class="p">(</span><span class="n">pv</span><span class="p">,</span><span class="w"> </span><span class="n">convertedValue</span><span class="p">));</span>
</span><span id="__span-61-169"><a id="__codelineno-61-169" name="__codelineno-61-169" href="#__codelineno-61-169"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-61-170"><a id="__codelineno-61-170" name="__codelineno-61-170" href="#__codelineno-61-170"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-61-171"><a id="__codelineno-61-171" name="__codelineno-61-171" href="#__codelineno-61-171"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-172"><a id="__codelineno-61-172" name="__codelineno-61-172" href="#__codelineno-61-172"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">mpvs</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">resolveNecessary</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-173"><a id="__codelineno-61-173" name="__codelineno-61-173" href="#__codelineno-61-173"></a><span class="w">        </span><span class="n">mpvs</span><span class="p">.</span><span class="na">setConverted</span><span class="p">();</span>
</span><span id="__span-61-174"><a id="__codelineno-61-174" name="__codelineno-61-174" href="#__codelineno-61-174"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-175"><a id="__codelineno-61-175" name="__codelineno-61-175" href="#__codelineno-61-175"></a>
</span><span id="__span-61-176"><a id="__codelineno-61-176" name="__codelineno-61-176" href="#__codelineno-61-176"></a><span class="w">    </span><span class="c1">// Set our (possibly massaged) deep copy.</span>
</span><span id="__span-61-177"><a id="__codelineno-61-177" name="__codelineno-61-177" href="#__codelineno-61-177"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-178"><a id="__codelineno-61-178" name="__codelineno-61-178" href="#__codelineno-61-178"></a><span class="w">        </span><span class="c1">// 获取到依赖的对象值后 将依赖值注入</span>
</span><span id="__span-61-179"><a id="__codelineno-61-179" name="__codelineno-61-179" href="#__codelineno-61-179"></a><span class="w">        </span><span class="n">bw</span><span class="p">.</span><span class="na">setPropertyValues</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">MutablePropertyValues</span><span class="p">(</span><span class="n">deepCopy</span><span class="p">));</span>
</span><span id="__span-61-180"><a id="__codelineno-61-180" name="__codelineno-61-180" href="#__codelineno-61-180"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-181"><a id="__codelineno-61-181" name="__codelineno-61-181" href="#__codelineno-61-181"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeansException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-61-182"><a id="__codelineno-61-182" name="__codelineno-61-182" href="#__codelineno-61-182"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-61-183"><a id="__codelineno-61-183" name="__codelineno-61-183" href="#__codelineno-61-183"></a><span class="w">                </span><span class="n">mbd</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="n">beanName</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Error setting property values&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-61-184"><a id="__codelineno-61-184" name="__codelineno-61-184" href="#__codelineno-61-184"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-61-185"><a id="__codelineno-61-185" name="__codelineno-61-185" href="#__codelineno-61-185"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h6 id="33">##############################################################################################################################################33<a class="headerlink" href="#33" title="Permanent link">&para;</a></h6>
<h4 id="valueresolverresolvevalueifnecessarypv-originalvalue">valueResolver.resolveValueIfNecessary(pv, originalValue);对应的方法<a class="headerlink" href="#valueresolverresolvevalueifnecessarypv-originalvalue" title="Permanent link">&para;</a></h4>
<ul>
<li>代码位置：org.springframework.beans.factory.support.BeanDefinitionValueResolver
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="nd">@Nullable</span>
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a><span class="kd">public</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">resolveValueIfNecessary</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a><span class="w">    </span><span class="c1">// We must check each value to see whether it requires a runtime reference</span>
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a><span class="w">    </span><span class="c1">// to another bean to be resolved.</span>
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">RuntimeBeanReference</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a><span class="w">        </span><span class="n">RuntimeBeanReference</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">RuntimeBeanReference</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a><span class="w">        </span><span class="c1">// 核心逻辑 解决Bean依赖关系 具体代码在下方贴出</span>
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">resolveReference</span><span class="p">(</span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="n">ref</span><span class="p">);</span>
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-10"><a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">RuntimeBeanNameReference</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-11"><a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">refName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">RuntimeBeanNameReference</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">).</span><span class="na">getBeanName</span><span class="p">();</span>
</span><span id="__span-62-12"><a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a><span class="w">        </span><span class="n">refName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">doEvaluate</span><span class="p">(</span><span class="n">refName</span><span class="p">));</span>
</span><span id="__span-62-13"><a id="__codelineno-62-13" name="__codelineno-62-13" href="#__codelineno-62-13"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">containsBean</span><span class="p">(</span><span class="n">refName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-14"><a id="__codelineno-62-14" name="__codelineno-62-14" href="#__codelineno-62-14"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanDefinitionStoreException</span><span class="p">(</span>
</span><span id="__span-62-15"><a id="__codelineno-62-15" name="__codelineno-62-15" href="#__codelineno-62-15"></a><span class="w">                    </span><span class="s">&quot;Invalid bean name &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">refName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; in bean reference for &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">argName</span><span class="p">);</span>
</span><span id="__span-62-16"><a id="__codelineno-62-16" name="__codelineno-62-16" href="#__codelineno-62-16"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-62-17"><a id="__codelineno-62-17" name="__codelineno-62-17" href="#__codelineno-62-17"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">refName</span><span class="p">;</span>
</span><span id="__span-62-18"><a id="__codelineno-62-18" name="__codelineno-62-18" href="#__codelineno-62-18"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-19"><a id="__codelineno-62-19" name="__codelineno-62-19" href="#__codelineno-62-19"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BeanDefinitionHolder</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-20"><a id="__codelineno-62-20" name="__codelineno-62-20" href="#__codelineno-62-20"></a><span class="w">        </span><span class="c1">// Resolve BeanDefinitionHolder: contains BeanDefinition with name and aliases.</span>
</span><span id="__span-62-21"><a id="__codelineno-62-21" name="__codelineno-62-21" href="#__codelineno-62-21"></a><span class="w">        </span><span class="n">BeanDefinitionHolder</span><span class="w"> </span><span class="n">bdHolder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinitionHolder</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
</span><span id="__span-62-22"><a id="__codelineno-62-22" name="__codelineno-62-22" href="#__codelineno-62-22"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">resolveInnerBean</span><span class="p">(</span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="n">bdHolder</span><span class="p">.</span><span class="na">getBeanName</span><span class="p">(),</span><span class="w"> </span><span class="n">bdHolder</span><span class="p">.</span><span class="na">getBeanDefinition</span><span class="p">());</span>
</span><span id="__span-62-23"><a id="__codelineno-62-23" name="__codelineno-62-23" href="#__codelineno-62-23"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-24"><a id="__codelineno-62-24" name="__codelineno-62-24" href="#__codelineno-62-24"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BeanDefinition</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-25"><a id="__codelineno-62-25" name="__codelineno-62-25" href="#__codelineno-62-25"></a><span class="w">        </span><span class="c1">// Resolve plain BeanDefinition, without contained name: use dummy name.</span>
</span><span id="__span-62-26"><a id="__codelineno-62-26" name="__codelineno-62-26" href="#__codelineno-62-26"></a><span class="w">        </span><span class="n">BeanDefinition</span><span class="w"> </span><span class="n">bd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">BeanDefinition</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
</span><span id="__span-62-27"><a id="__codelineno-62-27" name="__codelineno-62-27" href="#__codelineno-62-27"></a><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">innerBeanName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;(inner bean)&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">BeanFactoryUtils</span><span class="p">.</span><span class="na">GENERATED_BEAN_NAME_SEPARATOR</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-62-28"><a id="__codelineno-62-28" name="__codelineno-62-28" href="#__codelineno-62-28"></a><span class="w">                </span><span class="n">ObjectUtils</span><span class="p">.</span><span class="na">getIdentityHexString</span><span class="p">(</span><span class="n">bd</span><span class="p">);</span>
</span><span id="__span-62-29"><a id="__codelineno-62-29" name="__codelineno-62-29" href="#__codelineno-62-29"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">resolveInnerBean</span><span class="p">(</span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="n">innerBeanName</span><span class="p">,</span><span class="w"> </span><span class="n">bd</span><span class="p">);</span>
</span><span id="__span-62-30"><a id="__codelineno-62-30" name="__codelineno-62-30" href="#__codelineno-62-30"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-31"><a id="__codelineno-62-31" name="__codelineno-62-31" href="#__codelineno-62-31"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">DependencyDescriptor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-32"><a id="__codelineno-62-32" name="__codelineno-62-32" href="#__codelineno-62-32"></a><span class="w">        </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">autowiredBeanNames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedHashSet</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span><span id="__span-62-33"><a id="__codelineno-62-33" name="__codelineno-62-33" href="#__codelineno-62-33"></a><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">resolveDependency</span><span class="p">(</span>
</span><span id="__span-62-34"><a id="__codelineno-62-34" name="__codelineno-62-34" href="#__codelineno-62-34"></a><span class="w">                </span><span class="p">(</span><span class="n">DependencyDescriptor</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanName</span><span class="p">,</span><span class="w"> </span><span class="n">autowiredBeanNames</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">typeConverter</span><span class="p">);</span>
</span><span id="__span-62-35"><a id="__codelineno-62-35" name="__codelineno-62-35" href="#__codelineno-62-35"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">autowiredBeanName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">autowiredBeanNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-36"><a id="__codelineno-62-36" name="__codelineno-62-36" href="#__codelineno-62-36"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">containsBean</span><span class="p">(</span><span class="n">autowiredBeanName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-37"><a id="__codelineno-62-37" name="__codelineno-62-37" href="#__codelineno-62-37"></a><span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">registerDependentBean</span><span class="p">(</span><span class="n">autowiredBeanName</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanName</span><span class="p">);</span>
</span><span id="__span-62-38"><a id="__codelineno-62-38" name="__codelineno-62-38" href="#__codelineno-62-38"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-39"><a id="__codelineno-62-39" name="__codelineno-62-39" href="#__codelineno-62-39"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-62-40"><a id="__codelineno-62-40" name="__codelineno-62-40" href="#__codelineno-62-40"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
</span><span id="__span-62-41"><a id="__codelineno-62-41" name="__codelineno-62-41" href="#__codelineno-62-41"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-42"><a id="__codelineno-62-42" name="__codelineno-62-42" href="#__codelineno-62-42"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ManagedArray</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-43"><a id="__codelineno-62-43" name="__codelineno-62-43" href="#__codelineno-62-43"></a><span class="w">        </span><span class="c1">// May need to resolve contained runtime references.</span>
</span><span id="__span-62-44"><a id="__codelineno-62-44" name="__codelineno-62-44" href="#__codelineno-62-44"></a><span class="w">        </span><span class="n">ManagedArray</span><span class="w"> </span><span class="n">array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ManagedArray</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
</span><span id="__span-62-45"><a id="__codelineno-62-45" name="__codelineno-62-45" href="#__codelineno-62-45"></a><span class="w">        </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">elementType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">.</span><span class="na">resolvedElementType</span><span class="p">;</span>
</span><span id="__span-62-46"><a id="__codelineno-62-46" name="__codelineno-62-46" href="#__codelineno-62-46"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">elementType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-47"><a id="__codelineno-62-47" name="__codelineno-62-47" href="#__codelineno-62-47"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">elementTypeName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">array</span><span class="p">.</span><span class="na">getElementTypeName</span><span class="p">();</span>
</span><span id="__span-62-48"><a id="__codelineno-62-48" name="__codelineno-62-48" href="#__codelineno-62-48"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">StringUtils</span><span class="p">.</span><span class="na">hasText</span><span class="p">(</span><span class="n">elementTypeName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-49"><a id="__codelineno-62-49" name="__codelineno-62-49" href="#__codelineno-62-49"></a><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-50"><a id="__codelineno-62-50" name="__codelineno-62-50" href="#__codelineno-62-50"></a><span class="w">                    </span><span class="n">elementType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ClassUtils</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="n">elementTypeName</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">getBeanClassLoader</span><span class="p">());</span>
</span><span id="__span-62-51"><a id="__codelineno-62-51" name="__codelineno-62-51" href="#__codelineno-62-51"></a><span class="w">                    </span><span class="n">array</span><span class="p">.</span><span class="na">resolvedElementType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elementType</span><span class="p">;</span>
</span><span id="__span-62-52"><a id="__codelineno-62-52" name="__codelineno-62-52" href="#__codelineno-62-52"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-62-53"><a id="__codelineno-62-53" name="__codelineno-62-53" href="#__codelineno-62-53"></a><span class="w">                </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-54"><a id="__codelineno-62-54" name="__codelineno-62-54" href="#__codelineno-62-54"></a><span class="w">                    </span><span class="c1">// Improve the message by showing the context.</span>
</span><span id="__span-62-55"><a id="__codelineno-62-55" name="__codelineno-62-55" href="#__codelineno-62-55"></a><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-62-56"><a id="__codelineno-62-56" name="__codelineno-62-56" href="#__codelineno-62-56"></a><span class="w">                            </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinition</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanName</span><span class="p">,</span>
</span><span id="__span-62-57"><a id="__codelineno-62-57" name="__codelineno-62-57" href="#__codelineno-62-57"></a><span class="w">                            </span><span class="s">&quot;Error resolving array type for &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-62-58"><a id="__codelineno-62-58" name="__codelineno-62-58" href="#__codelineno-62-58"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-62-59"><a id="__codelineno-62-59" name="__codelineno-62-59" href="#__codelineno-62-59"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-60"><a id="__codelineno-62-60" name="__codelineno-62-60" href="#__codelineno-62-60"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-61"><a id="__codelineno-62-61" name="__codelineno-62-61" href="#__codelineno-62-61"></a><span class="w">                </span><span class="n">elementType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Object</span><span class="p">.</span><span class="na">class</span><span class="p">;</span>
</span><span id="__span-62-62"><a id="__codelineno-62-62" name="__codelineno-62-62" href="#__codelineno-62-62"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-63"><a id="__codelineno-62-63" name="__codelineno-62-63" href="#__codelineno-62-63"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-62-64"><a id="__codelineno-62-64" name="__codelineno-62-64" href="#__codelineno-62-64"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">resolveManagedArray</span><span class="p">(</span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">elementType</span><span class="p">);</span>
</span><span id="__span-62-65"><a id="__codelineno-62-65" name="__codelineno-62-65" href="#__codelineno-62-65"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-66"><a id="__codelineno-62-66" name="__codelineno-62-66" href="#__codelineno-62-66"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ManagedList</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-67"><a id="__codelineno-62-67" name="__codelineno-62-67" href="#__codelineno-62-67"></a><span class="w">        </span><span class="c1">// May need to resolve contained runtime references.</span>
</span><span id="__span-62-68"><a id="__codelineno-62-68" name="__codelineno-62-68" href="#__codelineno-62-68"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">resolveManagedList</span><span class="p">(</span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
</span><span id="__span-62-69"><a id="__codelineno-62-69" name="__codelineno-62-69" href="#__codelineno-62-69"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-70"><a id="__codelineno-62-70" name="__codelineno-62-70" href="#__codelineno-62-70"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ManagedSet</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-71"><a id="__codelineno-62-71" name="__codelineno-62-71" href="#__codelineno-62-71"></a><span class="w">        </span><span class="c1">// May need to resolve contained runtime references.</span>
</span><span id="__span-62-72"><a id="__codelineno-62-72" name="__codelineno-62-72" href="#__codelineno-62-72"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">resolveManagedSet</span><span class="p">(</span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">Set</span><span class="o">&lt;?&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
</span><span id="__span-62-73"><a id="__codelineno-62-73" name="__codelineno-62-73" href="#__codelineno-62-73"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-74"><a id="__codelineno-62-74" name="__codelineno-62-74" href="#__codelineno-62-74"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ManagedMap</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-75"><a id="__codelineno-62-75" name="__codelineno-62-75" href="#__codelineno-62-75"></a><span class="w">        </span><span class="c1">// May need to resolve contained runtime references.</span>
</span><span id="__span-62-76"><a id="__codelineno-62-76" name="__codelineno-62-76" href="#__codelineno-62-76"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">resolveManagedMap</span><span class="p">(</span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">Map</span><span class="o">&lt;?</span><span class="p">,</span><span class="w"> </span><span class="o">?&gt;</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
</span><span id="__span-62-77"><a id="__codelineno-62-77" name="__codelineno-62-77" href="#__codelineno-62-77"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-78"><a id="__codelineno-62-78" name="__codelineno-62-78" href="#__codelineno-62-78"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ManagedProperties</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-79"><a id="__codelineno-62-79" name="__codelineno-62-79" href="#__codelineno-62-79"></a><span class="w">        </span><span class="n">Properties</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Properties</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
</span><span id="__span-62-80"><a id="__codelineno-62-80" name="__codelineno-62-80" href="#__codelineno-62-80"></a><span class="w">        </span><span class="n">Properties</span><span class="w"> </span><span class="n">copy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Properties</span><span class="p">();</span>
</span><span id="__span-62-81"><a id="__codelineno-62-81" name="__codelineno-62-81" href="#__codelineno-62-81"></a><span class="w">        </span><span class="n">original</span><span class="p">.</span><span class="na">forEach</span><span class="p">((</span><span class="n">propKey</span><span class="p">,</span><span class="w"> </span><span class="n">propValue</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-82"><a id="__codelineno-62-82" name="__codelineno-62-82" href="#__codelineno-62-82"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">propKey</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">TypedStringValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-83"><a id="__codelineno-62-83" name="__codelineno-62-83" href="#__codelineno-62-83"></a><span class="w">                </span><span class="n">propKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">evaluate</span><span class="p">((</span><span class="n">TypedStringValue</span><span class="p">)</span><span class="w"> </span><span class="n">propKey</span><span class="p">);</span>
</span><span id="__span-62-84"><a id="__codelineno-62-84" name="__codelineno-62-84" href="#__codelineno-62-84"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-85"><a id="__codelineno-62-85" name="__codelineno-62-85" href="#__codelineno-62-85"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">propValue</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">TypedStringValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-86"><a id="__codelineno-62-86" name="__codelineno-62-86" href="#__codelineno-62-86"></a><span class="w">                </span><span class="n">propValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">evaluate</span><span class="p">((</span><span class="n">TypedStringValue</span><span class="p">)</span><span class="w"> </span><span class="n">propValue</span><span class="p">);</span>
</span><span id="__span-62-87"><a id="__codelineno-62-87" name="__codelineno-62-87" href="#__codelineno-62-87"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-88"><a id="__codelineno-62-88" name="__codelineno-62-88" href="#__codelineno-62-88"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">propKey</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">propValue</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-89"><a id="__codelineno-62-89" name="__codelineno-62-89" href="#__codelineno-62-89"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-62-90"><a id="__codelineno-62-90" name="__codelineno-62-90" href="#__codelineno-62-90"></a><span class="w">                        </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinition</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanName</span><span class="p">,</span>
</span><span id="__span-62-91"><a id="__codelineno-62-91" name="__codelineno-62-91" href="#__codelineno-62-91"></a><span class="w">                        </span><span class="s">&quot;Error converting Properties key/value pair for &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">argName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;: resolved to null&quot;</span><span class="p">);</span>
</span><span id="__span-62-92"><a id="__codelineno-62-92" name="__codelineno-62-92" href="#__codelineno-62-92"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-93"><a id="__codelineno-62-93" name="__codelineno-62-93" href="#__codelineno-62-93"></a><span class="w">            </span><span class="n">copy</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">propKey</span><span class="p">,</span><span class="w"> </span><span class="n">propValue</span><span class="p">);</span>
</span><span id="__span-62-94"><a id="__codelineno-62-94" name="__codelineno-62-94" href="#__codelineno-62-94"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-62-95"><a id="__codelineno-62-95" name="__codelineno-62-95" href="#__codelineno-62-95"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">copy</span><span class="p">;</span>
</span><span id="__span-62-96"><a id="__codelineno-62-96" name="__codelineno-62-96" href="#__codelineno-62-96"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-97"><a id="__codelineno-62-97" name="__codelineno-62-97" href="#__codelineno-62-97"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">TypedStringValue</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-98"><a id="__codelineno-62-98" name="__codelineno-62-98" href="#__codelineno-62-98"></a><span class="w">        </span><span class="c1">// Convert value to target type here.</span>
</span><span id="__span-62-99"><a id="__codelineno-62-99" name="__codelineno-62-99" href="#__codelineno-62-99"></a><span class="w">        </span><span class="n">TypedStringValue</span><span class="w"> </span><span class="n">typedStringValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">TypedStringValue</span><span class="p">)</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
</span><span id="__span-62-100"><a id="__codelineno-62-100" name="__codelineno-62-100" href="#__codelineno-62-100"></a><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">valueObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">evaluate</span><span class="p">(</span><span class="n">typedStringValue</span><span class="p">);</span>
</span><span id="__span-62-101"><a id="__codelineno-62-101" name="__codelineno-62-101" href="#__codelineno-62-101"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-102"><a id="__codelineno-62-102" name="__codelineno-62-102" href="#__codelineno-62-102"></a><span class="w">            </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">resolvedTargetType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resolveTargetType</span><span class="p">(</span><span class="n">typedStringValue</span><span class="p">);</span>
</span><span id="__span-62-103"><a id="__codelineno-62-103" name="__codelineno-62-103" href="#__codelineno-62-103"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">resolvedTargetType</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-104"><a id="__codelineno-62-104" name="__codelineno-62-104" href="#__codelineno-62-104"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">typeConverter</span><span class="p">.</span><span class="na">convertIfNecessary</span><span class="p">(</span><span class="n">valueObject</span><span class="p">,</span><span class="w"> </span><span class="n">resolvedTargetType</span><span class="p">);</span>
</span><span id="__span-62-105"><a id="__codelineno-62-105" name="__codelineno-62-105" href="#__codelineno-62-105"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-106"><a id="__codelineno-62-106" name="__codelineno-62-106" href="#__codelineno-62-106"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-107"><a id="__codelineno-62-107" name="__codelineno-62-107" href="#__codelineno-62-107"></a><span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">valueObject</span><span class="p">;</span>
</span><span id="__span-62-108"><a id="__codelineno-62-108" name="__codelineno-62-108" href="#__codelineno-62-108"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-109"><a id="__codelineno-62-109" name="__codelineno-62-109" href="#__codelineno-62-109"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-62-110"><a id="__codelineno-62-110" name="__codelineno-62-110" href="#__codelineno-62-110"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-111"><a id="__codelineno-62-111" name="__codelineno-62-111" href="#__codelineno-62-111"></a><span class="w">            </span><span class="c1">// Improve the message by showing the context.</span>
</span><span id="__span-62-112"><a id="__codelineno-62-112" name="__codelineno-62-112" href="#__codelineno-62-112"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-62-113"><a id="__codelineno-62-113" name="__codelineno-62-113" href="#__codelineno-62-113"></a><span class="w">                    </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinition</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanName</span><span class="p">,</span>
</span><span id="__span-62-114"><a id="__codelineno-62-114" name="__codelineno-62-114" href="#__codelineno-62-114"></a><span class="w">                    </span><span class="s">&quot;Error converting typed String value for &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-62-115"><a id="__codelineno-62-115" name="__codelineno-62-115" href="#__codelineno-62-115"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-62-116"><a id="__codelineno-62-116" name="__codelineno-62-116" href="#__codelineno-62-116"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-117"><a id="__codelineno-62-117" name="__codelineno-62-117" href="#__codelineno-62-117"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">NullBean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-118"><a id="__codelineno-62-118" name="__codelineno-62-118" href="#__codelineno-62-118"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-62-119"><a id="__codelineno-62-119" name="__codelineno-62-119" href="#__codelineno-62-119"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-120"><a id="__codelineno-62-120" name="__codelineno-62-120" href="#__codelineno-62-120"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-121"><a id="__codelineno-62-121" name="__codelineno-62-121" href="#__codelineno-62-121"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">evaluate</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
</span><span id="__span-62-122"><a id="__codelineno-62-122" name="__codelineno-62-122" href="#__codelineno-62-122"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-123"><a id="__codelineno-62-123" name="__codelineno-62-123" href="#__codelineno-62-123"></a><span class="p">}</span>
</span><span id="__span-62-124"><a id="__codelineno-62-124" name="__codelineno-62-124" href="#__codelineno-62-124"></a>
</span><span id="__span-62-125"><a id="__codelineno-62-125" name="__codelineno-62-125" href="#__codelineno-62-125"></a>
</span><span id="__span-62-126"><a id="__codelineno-62-126" name="__codelineno-62-126" href="#__codelineno-62-126"></a><span class="c1">// 上面resolveValueIfNecessary方法中调用的resolveReference方法</span>
</span><span id="__span-62-127"><a id="__codelineno-62-127" name="__codelineno-62-127" href="#__codelineno-62-127"></a><span class="c1">// 最后获取到依赖的bean</span>
</span><span id="__span-62-128"><a id="__codelineno-62-128" name="__codelineno-62-128" href="#__codelineno-62-128"></a><span class="nd">@Nullable</span>
</span><span id="__span-62-129"><a id="__codelineno-62-129" name="__codelineno-62-129" href="#__codelineno-62-129"></a><span class="kd">private</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">resolveReference</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="n">RuntimeBeanReference</span><span class="w"> </span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-130"><a id="__codelineno-62-130" name="__codelineno-62-130" href="#__codelineno-62-130"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-131"><a id="__codelineno-62-131" name="__codelineno-62-131" href="#__codelineno-62-131"></a><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">bean</span><span class="p">;</span>
</span><span id="__span-62-132"><a id="__codelineno-62-132" name="__codelineno-62-132" href="#__codelineno-62-132"></a><span class="w">        </span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">beanType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="na">getBeanType</span><span class="p">();</span>
</span><span id="__span-62-133"><a id="__codelineno-62-133" name="__codelineno-62-133" href="#__codelineno-62-133"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref</span><span class="p">.</span><span class="na">isToParent</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-134"><a id="__codelineno-62-134" name="__codelineno-62-134" href="#__codelineno-62-134"></a><span class="w">            </span><span class="n">BeanFactory</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">getParentBeanFactory</span><span class="p">();</span>
</span><span id="__span-62-135"><a id="__codelineno-62-135" name="__codelineno-62-135" href="#__codelineno-62-135"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">parent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-136"><a id="__codelineno-62-136" name="__codelineno-62-136" href="#__codelineno-62-136"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-62-137"><a id="__codelineno-62-137" name="__codelineno-62-137" href="#__codelineno-62-137"></a><span class="w">                        </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinition</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanName</span><span class="p">,</span>
</span><span id="__span-62-138"><a id="__codelineno-62-138" name="__codelineno-62-138" href="#__codelineno-62-138"></a><span class="w">                        </span><span class="s">&quot;Cannot resolve reference to bean &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-62-139"><a id="__codelineno-62-139" name="__codelineno-62-139" href="#__codelineno-62-139"></a><span class="w">                                </span><span class="s">&quot; in parent factory: no parent factory available&quot;</span><span class="p">);</span>
</span><span id="__span-62-140"><a id="__codelineno-62-140" name="__codelineno-62-140" href="#__codelineno-62-140"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-141"><a id="__codelineno-62-141" name="__codelineno-62-141" href="#__codelineno-62-141"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanType</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-142"><a id="__codelineno-62-142" name="__codelineno-62-142" href="#__codelineno-62-142"></a><span class="w">                </span><span class="c1">// 发生递归调用</span>
</span><span id="__span-62-143"><a id="__codelineno-62-143" name="__codelineno-62-143" href="#__codelineno-62-143"></a><span class="w">                </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">beanType</span><span class="p">);</span>
</span><span id="__span-62-144"><a id="__codelineno-62-144" name="__codelineno-62-144" href="#__codelineno-62-144"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-145"><a id="__codelineno-62-145" name="__codelineno-62-145" href="#__codelineno-62-145"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-146"><a id="__codelineno-62-146" name="__codelineno-62-146" href="#__codelineno-62-146"></a><span class="w">                </span><span class="c1">// 发生递归调用 根据依赖的名称从BeanFactory中递归得到依赖 最后获取到依赖的bean</span>
</span><span id="__span-62-147"><a id="__codelineno-62-147" name="__codelineno-62-147" href="#__codelineno-62-147"></a><span class="w">                </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">doEvaluate</span><span class="p">(</span><span class="n">ref</span><span class="p">.</span><span class="na">getBeanName</span><span class="p">())));</span>
</span><span id="__span-62-148"><a id="__codelineno-62-148" name="__codelineno-62-148" href="#__codelineno-62-148"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-149"><a id="__codelineno-62-149" name="__codelineno-62-149" href="#__codelineno-62-149"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-62-150"><a id="__codelineno-62-150" name="__codelineno-62-150" href="#__codelineno-62-150"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-151"><a id="__codelineno-62-151" name="__codelineno-62-151" href="#__codelineno-62-151"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">resolvedName</span><span class="p">;</span>
</span><span id="__span-62-152"><a id="__codelineno-62-152" name="__codelineno-62-152" href="#__codelineno-62-152"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">beanType</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-153"><a id="__codelineno-62-153" name="__codelineno-62-153" href="#__codelineno-62-153"></a><span class="w">                </span><span class="n">NamedBeanHolder</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">namedBean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">resolveNamedBean</span><span class="p">(</span><span class="n">beanType</span><span class="p">);</span>
</span><span id="__span-62-154"><a id="__codelineno-62-154" name="__codelineno-62-154" href="#__codelineno-62-154"></a><span class="w">                </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">namedBean</span><span class="p">.</span><span class="na">getBeanInstance</span><span class="p">();</span>
</span><span id="__span-62-155"><a id="__codelineno-62-155" name="__codelineno-62-155" href="#__codelineno-62-155"></a><span class="w">                </span><span class="n">resolvedName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">namedBean</span><span class="p">.</span><span class="na">getBeanName</span><span class="p">();</span>
</span><span id="__span-62-156"><a id="__codelineno-62-156" name="__codelineno-62-156" href="#__codelineno-62-156"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-157"><a id="__codelineno-62-157" name="__codelineno-62-157" href="#__codelineno-62-157"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-158"><a id="__codelineno-62-158" name="__codelineno-62-158" href="#__codelineno-62-158"></a><span class="w">                </span><span class="n">resolvedName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">valueOf</span><span class="p">(</span><span class="n">doEvaluate</span><span class="p">(</span><span class="n">ref</span><span class="p">.</span><span class="na">getBeanName</span><span class="p">()));</span>
</span><span id="__span-62-159"><a id="__codelineno-62-159" name="__codelineno-62-159" href="#__codelineno-62-159"></a><span class="w">                </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">resolvedName</span><span class="p">);</span>
</span><span id="__span-62-160"><a id="__codelineno-62-160" name="__codelineno-62-160" href="#__codelineno-62-160"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-62-161"><a id="__codelineno-62-161" name="__codelineno-62-161" href="#__codelineno-62-161"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">registerDependentBean</span><span class="p">(</span><span class="n">resolvedName</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanName</span><span class="p">);</span>
</span><span id="__span-62-162"><a id="__codelineno-62-162" name="__codelineno-62-162" href="#__codelineno-62-162"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-62-163"><a id="__codelineno-62-163" name="__codelineno-62-163" href="#__codelineno-62-163"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bean</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">NullBean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-164"><a id="__codelineno-62-164" name="__codelineno-62-164" href="#__codelineno-62-164"></a><span class="w">            </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-62-165"><a id="__codelineno-62-165" name="__codelineno-62-165" href="#__codelineno-62-165"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-62-166"><a id="__codelineno-62-166" name="__codelineno-62-166" href="#__codelineno-62-166"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">bean</span><span class="p">;</span>
</span><span id="__span-62-167"><a id="__codelineno-62-167" name="__codelineno-62-167" href="#__codelineno-62-167"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-168"><a id="__codelineno-62-168" name="__codelineno-62-168" href="#__codelineno-62-168"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BeansException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-62-169"><a id="__codelineno-62-169" name="__codelineno-62-169" href="#__codelineno-62-169"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanCreationException</span><span class="p">(</span>
</span><span id="__span-62-170"><a id="__codelineno-62-170" name="__codelineno-62-170" href="#__codelineno-62-170"></a><span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="na">beanDefinition</span><span class="p">.</span><span class="na">getResourceDescription</span><span class="p">(),</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanName</span><span class="p">,</span>
</span><span id="__span-62-171"><a id="__codelineno-62-171" name="__codelineno-62-171" href="#__codelineno-62-171"></a><span class="w">                </span><span class="s">&quot;Cannot resolve reference to bean &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ref</span><span class="p">.</span><span class="na">getBeanName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; while setting &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">argName</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-62-172"><a id="__codelineno-62-172" name="__codelineno-62-172" href="#__codelineno-62-172"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-62-173"><a id="__codelineno-62-173" name="__codelineno-62-173" href="#__codelineno-62-173"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="abstractpropertyaccessorsetpropertyvaluespropertyvalues-pvs">AbstractPropertyAccessor的setPropertyValues(PropertyValues pvs)方法<a class="headerlink" href="#abstractpropertyaccessorsetpropertyvaluespropertyvalues-pvs" title="Permanent link">&para;</a></h4>
<ul>
<li>代码位置：org.springframework.beans.AbstractPropertyAccessor</li>
<li>循环属性列表 
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="nd">@Override</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPropertyValues</span><span class="p">(</span><span class="n">PropertyValues</span><span class="w"> </span><span class="n">pvs</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a><span class="w">    </span><span class="n">setPropertyValues</span><span class="p">(</span><span class="n">pvs</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="p">}</span>
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a>
</span><span id="__span-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a><span class="c1">//  循环属性列表 </span>
</span><span id="__span-63-7"><a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a><span class="nd">@Override</span>
</span><span id="__span-63-8"><a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPropertyValues</span><span class="p">(</span><span class="n">PropertyValues</span><span class="w"> </span><span class="n">pvs</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">ignoreUnknown</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">ignoreInvalid</span><span class="p">)</span>
</span><span id="__span-63-9"><a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a><span class="w">        </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-10"><a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a>
</span><span id="__span-63-11"><a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PropertyAccessException</span><span class="o">&gt;</span><span class="w"> </span><span class="n">propertyAccessExceptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-63-12"><a id="__codelineno-63-12" name="__codelineno-63-12" href="#__codelineno-63-12"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PropertyValue</span><span class="o">&gt;</span><span class="w"> </span><span class="n">propertyValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pvs</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">MutablePropertyValues</span><span class="w"> </span><span class="o">?</span>
</span><span id="__span-63-13"><a id="__codelineno-63-13" name="__codelineno-63-13" href="#__codelineno-63-13"></a><span class="w">            </span><span class="p">((</span><span class="n">MutablePropertyValues</span><span class="p">)</span><span class="w"> </span><span class="n">pvs</span><span class="p">).</span><span class="na">getPropertyValueList</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="n">pvs</span><span class="p">.</span><span class="na">getPropertyValues</span><span class="p">()));</span>
</span><span id="__span-63-14"><a id="__codelineno-63-14" name="__codelineno-63-14" href="#__codelineno-63-14"></a><span class="w">    </span><span class="c1">// 循环属性列表 </span>
</span><span id="__span-63-15"><a id="__codelineno-63-15" name="__codelineno-63-15" href="#__codelineno-63-15"></a><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">PropertyValue</span><span class="w"> </span><span class="n">pv</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">propertyValues</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-16"><a id="__codelineno-63-16" name="__codelineno-63-16" href="#__codelineno-63-16"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-17"><a id="__codelineno-63-17" name="__codelineno-63-17" href="#__codelineno-63-17"></a><span class="w">            </span><span class="c1">// This method may throw any BeansException, which won&#39;t be caught</span>
</span><span id="__span-63-18"><a id="__codelineno-63-18" name="__codelineno-63-18" href="#__codelineno-63-18"></a><span class="w">            </span><span class="c1">// here, if there is a critical failure such as no matching field.</span>
</span><span id="__span-63-19"><a id="__codelineno-63-19" name="__codelineno-63-19" href="#__codelineno-63-19"></a><span class="w">            </span><span class="c1">// We can attempt to deal only with less serious exceptions.</span>
</span><span id="__span-63-20"><a id="__codelineno-63-20" name="__codelineno-63-20" href="#__codelineno-63-20"></a><span class="w">            </span><span class="c1">// 该方法通过AbstractNestablePropertyAccessor的setPropertyValue(PropertyValue pv)方法实现</span>
</span><span id="__span-63-21"><a id="__codelineno-63-21" name="__codelineno-63-21" href="#__codelineno-63-21"></a><span class="w">            </span><span class="n">setPropertyValue</span><span class="p">(</span><span class="n">pv</span><span class="p">);</span>
</span><span id="__span-63-22"><a id="__codelineno-63-22" name="__codelineno-63-22" href="#__codelineno-63-22"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-63-23"><a id="__codelineno-63-23" name="__codelineno-63-23" href="#__codelineno-63-23"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">NotWritablePropertyException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-24"><a id="__codelineno-63-24" name="__codelineno-63-24" href="#__codelineno-63-24"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ignoreUnknown</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-25"><a id="__codelineno-63-25" name="__codelineno-63-25" href="#__codelineno-63-25"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="n">ex</span><span class="p">;</span>
</span><span id="__span-63-26"><a id="__codelineno-63-26" name="__codelineno-63-26" href="#__codelineno-63-26"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-63-27"><a id="__codelineno-63-27" name="__codelineno-63-27" href="#__codelineno-63-27"></a><span class="w">            </span><span class="c1">// Otherwise, just ignore it and continue...</span>
</span><span id="__span-63-28"><a id="__codelineno-63-28" name="__codelineno-63-28" href="#__codelineno-63-28"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-63-29"><a id="__codelineno-63-29" name="__codelineno-63-29" href="#__codelineno-63-29"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">NullValueInNestedPathException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-30"><a id="__codelineno-63-30" name="__codelineno-63-30" href="#__codelineno-63-30"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ignoreInvalid</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-31"><a id="__codelineno-63-31" name="__codelineno-63-31" href="#__codelineno-63-31"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="n">ex</span><span class="p">;</span>
</span><span id="__span-63-32"><a id="__codelineno-63-32" name="__codelineno-63-32" href="#__codelineno-63-32"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-63-33"><a id="__codelineno-63-33" name="__codelineno-63-33" href="#__codelineno-63-33"></a><span class="w">            </span><span class="c1">// Otherwise, just ignore it and continue...</span>
</span><span id="__span-63-34"><a id="__codelineno-63-34" name="__codelineno-63-34" href="#__codelineno-63-34"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-63-35"><a id="__codelineno-63-35" name="__codelineno-63-35" href="#__codelineno-63-35"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">PropertyAccessException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-36"><a id="__codelineno-63-36" name="__codelineno-63-36" href="#__codelineno-63-36"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">propertyAccessExceptions</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-37"><a id="__codelineno-63-37" name="__codelineno-63-37" href="#__codelineno-63-37"></a><span class="w">                </span><span class="n">propertyAccessExceptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
</span><span id="__span-63-38"><a id="__codelineno-63-38" name="__codelineno-63-38" href="#__codelineno-63-38"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-63-39"><a id="__codelineno-63-39" name="__codelineno-63-39" href="#__codelineno-63-39"></a><span class="w">            </span><span class="n">propertyAccessExceptions</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-63-40"><a id="__codelineno-63-40" name="__codelineno-63-40" href="#__codelineno-63-40"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-63-41"><a id="__codelineno-63-41" name="__codelineno-63-41" href="#__codelineno-63-41"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-63-42"><a id="__codelineno-63-42" name="__codelineno-63-42" href="#__codelineno-63-42"></a>
</span><span id="__span-63-43"><a id="__codelineno-63-43" name="__codelineno-63-43" href="#__codelineno-63-43"></a><span class="w">    </span><span class="c1">// If we encountered individual exceptions, throw the composite exception.</span>
</span><span id="__span-63-44"><a id="__codelineno-63-44" name="__codelineno-63-44" href="#__codelineno-63-44"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">propertyAccessExceptions</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-63-45"><a id="__codelineno-63-45" name="__codelineno-63-45" href="#__codelineno-63-45"></a><span class="w">        </span><span class="n">PropertyAccessException</span><span class="o">[]</span><span class="w"> </span><span class="n">paeArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">propertyAccessExceptions</span><span class="p">.</span><span class="na">toArray</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">PropertyAccessException</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">);</span>
</span><span id="__span-63-46"><a id="__codelineno-63-46" name="__codelineno-63-46" href="#__codelineno-63-46"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PropertyBatchUpdateException</span><span class="p">(</span><span class="n">paeArray</span><span class="p">);</span>
</span><span id="__span-63-47"><a id="__codelineno-63-47" name="__codelineno-63-47" href="#__codelineno-63-47"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-63-48"><a id="__codelineno-63-48" name="__codelineno-63-48" href="#__codelineno-63-48"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="abstractnestablepropertyaccessor-setpropertyvaluepropertyvalue-pv">AbstractNestablePropertyAccessor的 setPropertyValue(PropertyValue pv)方法<a class="headerlink" href="#abstractnestablepropertyaccessor-setpropertyvaluepropertyvalue-pv" title="Permanent link">&para;</a></h4>
<ul>
<li>代码位置：org.springframework.beans.AbstractNestablePropertyAccessor
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="nd">@Override</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPropertyValue</span><span class="p">(</span><span class="n">PropertyValue</span><span class="w"> </span><span class="n">pv</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="w">        </span><span class="n">PropertyTokenHolder</span><span class="w"> </span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">PropertyTokenHolder</span><span class="p">)</span><span class="w"> </span><span class="n">pv</span><span class="p">.</span><span class="na">resolvedTokens</span><span class="p">;</span>
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tokens</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">propertyName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pv</span><span class="p">.</span><span class="na">getName</span><span class="p">();</span>
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a><span class="w">            </span><span class="n">AbstractNestablePropertyAccessor</span><span class="w"> </span><span class="n">nestedPa</span><span class="p">;</span>
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a><span class="w">                </span><span class="n">nestedPa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getPropertyAccessorForPropertyPath</span><span class="p">(</span><span class="n">propertyName</span><span class="p">);</span>
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a><span class="w">            </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">NotReadablePropertyException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">NotWritablePropertyException</span><span class="p">(</span><span class="n">getRootClass</span><span class="p">(),</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">nestedPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">propertyName</span><span class="p">,</span>
</span><span id="__span-64-12"><a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a><span class="w">                        </span><span class="s">&quot;Nested property in path &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">propertyName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39; does not exist&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-64-13"><a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-64-14"><a id="__codelineno-64-14" name="__codelineno-64-14" href="#__codelineno-64-14"></a><span class="w">            </span><span class="n">tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getPropertyNameTokens</span><span class="p">(</span><span class="n">getFinalPath</span><span class="p">(</span><span class="n">nestedPa</span><span class="p">,</span><span class="w"> </span><span class="n">propertyName</span><span class="p">));</span>
</span><span id="__span-64-15"><a id="__codelineno-64-15" name="__codelineno-64-15" href="#__codelineno-64-15"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nestedPa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">this</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-64-16"><a id="__codelineno-64-16" name="__codelineno-64-16" href="#__codelineno-64-16"></a><span class="w">                </span><span class="n">pv</span><span class="p">.</span><span class="na">getOriginalPropertyValue</span><span class="p">().</span><span class="na">resolvedTokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tokens</span><span class="p">;</span>
</span><span id="__span-64-17"><a id="__codelineno-64-17" name="__codelineno-64-17" href="#__codelineno-64-17"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-64-18"><a id="__codelineno-64-18" name="__codelineno-64-18" href="#__codelineno-64-18"></a><span class="w">            </span><span class="n">nestedPa</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span><span class="w"> </span><span class="n">pv</span><span class="p">);</span>
</span><span id="__span-64-19"><a id="__codelineno-64-19" name="__codelineno-64-19" href="#__codelineno-64-19"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-64-20"><a id="__codelineno-64-20" name="__codelineno-64-20" href="#__codelineno-64-20"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-64-21"><a id="__codelineno-64-21" name="__codelineno-64-21" href="#__codelineno-64-21"></a><span class="w">            </span><span class="n">setPropertyValue</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span><span class="w"> </span><span class="n">pv</span><span class="p">);</span>
</span><span id="__span-64-22"><a id="__codelineno-64-22" name="__codelineno-64-22" href="#__codelineno-64-22"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-64-23"><a id="__codelineno-64-23" name="__codelineno-64-23" href="#__codelineno-64-23"></a><span class="w">    </span><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h6 id="_7"><a class="headerlink" href="#_7" title="Permanent link">&para;</a></h6>
<ul>
<li>上面setPropertyValue(PropertyValue pv)方法的重载方法setPropertyValue(PropertyTokenHolder tokens, PropertyValue pv)
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPropertyValue</span><span class="p">(</span><span class="n">PropertyTokenHolder</span><span class="w"> </span><span class="n">tokens</span><span class="p">,</span><span class="w"> </span><span class="n">PropertyValue</span><span class="w"> </span><span class="n">pv</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">BeansException</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tokens</span><span class="p">.</span><span class="na">keys</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a><span class="w">        </span><span class="n">processKeyedProperty</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span><span class="w"> </span><span class="n">pv</span><span class="p">);</span>
</span><span id="__span-65-4"><a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-65-5"><a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-65-6"><a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a><span class="w">        </span><span class="n">processLocalProperty</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span><span class="w"> </span><span class="n">pv</span><span class="p">);</span>
</span><span id="__span-65-7"><a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-65-8"><a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>processLocalProperty(PropertyTokenHolder tokens, PropertyValue pv)方法
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">processLocalProperty</span><span class="p">(</span><span class="n">PropertyTokenHolder</span><span class="w"> </span><span class="n">tokens</span><span class="p">,</span><span class="w"> </span><span class="n">PropertyValue</span><span class="w"> </span><span class="n">pv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="w">    </span><span class="n">PropertyHandler</span><span class="w"> </span><span class="n">ph</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getLocalPropertyHandler</span><span class="p">(</span><span class="n">tokens</span><span class="p">.</span><span class="na">actualName</span><span class="p">);</span>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ph</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="n">ph</span><span class="p">.</span><span class="na">isWritable</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pv</span><span class="p">.</span><span class="na">isOptional</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-5"><a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isDebugEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-6"><a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a><span class="w">                </span><span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Ignoring optional value for property &#39;&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tokens</span><span class="p">.</span><span class="na">actualName</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-66-7"><a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a><span class="w">                        </span><span class="s">&quot;&#39; - property not found on bean class [&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">getRootClass</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;]&quot;</span><span class="p">);</span>
</span><span id="__span-66-8"><a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-66-9"><a id="__codelineno-66-9" name="__codelineno-66-9" href="#__codelineno-66-9"></a><span class="w">            </span><span class="k">return</span><span class="p">;</span>
</span><span id="__span-66-10"><a id="__codelineno-66-10" name="__codelineno-66-10" href="#__codelineno-66-10"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-66-11"><a id="__codelineno-66-11" name="__codelineno-66-11" href="#__codelineno-66-11"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-12"><a id="__codelineno-66-12" name="__codelineno-66-12" href="#__codelineno-66-12"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">createNotWritablePropertyException</span><span class="p">(</span><span class="n">tokens</span><span class="p">.</span><span class="na">canonicalName</span><span class="p">);</span>
</span><span id="__span-66-13"><a id="__codelineno-66-13" name="__codelineno-66-13" href="#__codelineno-66-13"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-66-14"><a id="__codelineno-66-14" name="__codelineno-66-14" href="#__codelineno-66-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-66-15"><a id="__codelineno-66-15" name="__codelineno-66-15" href="#__codelineno-66-15"></a>
</span><span id="__span-66-16"><a id="__codelineno-66-16" name="__codelineno-66-16" href="#__codelineno-66-16"></a><span class="w">    </span><span class="n">Object</span><span class="w"> </span><span class="n">oldValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-66-17"><a id="__codelineno-66-17" name="__codelineno-66-17" href="#__codelineno-66-17"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-18"><a id="__codelineno-66-18" name="__codelineno-66-18" href="#__codelineno-66-18"></a><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">originalValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pv</span><span class="p">.</span><span class="na">getValue</span><span class="p">();</span><span class="c1">//</span>
</span><span id="__span-66-19"><a id="__codelineno-66-19" name="__codelineno-66-19" href="#__codelineno-66-19"></a><span class="w">        </span><span class="n">Object</span><span class="w"> </span><span class="n">valueToApply</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">originalValue</span><span class="p">;</span><span class="c1">//</span>
</span><span id="__span-66-20"><a id="__codelineno-66-20" name="__codelineno-66-20" href="#__codelineno-66-20"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">Boolean</span><span class="p">.</span><span class="na">FALSE</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">pv</span><span class="p">.</span><span class="na">conversionNecessary</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-21"><a id="__codelineno-66-21" name="__codelineno-66-21" href="#__codelineno-66-21"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pv</span><span class="p">.</span><span class="na">isConverted</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-22"><a id="__codelineno-66-22" name="__codelineno-66-22" href="#__codelineno-66-22"></a><span class="w">                </span><span class="n">valueToApply</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pv</span><span class="p">.</span><span class="na">getConvertedValue</span><span class="p">();</span>
</span><span id="__span-66-23"><a id="__codelineno-66-23" name="__codelineno-66-23" href="#__codelineno-66-23"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-66-24"><a id="__codelineno-66-24" name="__codelineno-66-24" href="#__codelineno-66-24"></a><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-25"><a id="__codelineno-66-25" name="__codelineno-66-25" href="#__codelineno-66-25"></a><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isExtractOldValueForEditor</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ph</span><span class="p">.</span><span class="na">isReadable</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-26"><a id="__codelineno-66-26" name="__codelineno-66-26" href="#__codelineno-66-26"></a><span class="w">                    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-27"><a id="__codelineno-66-27" name="__codelineno-66-27" href="#__codelineno-66-27"></a><span class="w">                        </span><span class="n">oldValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ph</span><span class="p">.</span><span class="na">getValue</span><span class="p">();</span>
</span><span id="__span-66-28"><a id="__codelineno-66-28" name="__codelineno-66-28" href="#__codelineno-66-28"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-66-29"><a id="__codelineno-66-29" name="__codelineno-66-29" href="#__codelineno-66-29"></a><span class="w">                    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-30"><a id="__codelineno-66-30" name="__codelineno-66-30" href="#__codelineno-66-30"></a><span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ex</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">PrivilegedActionException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-31"><a id="__codelineno-66-31" name="__codelineno-66-31" href="#__codelineno-66-31"></a><span class="w">                            </span><span class="n">ex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">PrivilegedActionException</span><span class="p">)</span><span class="w"> </span><span class="n">ex</span><span class="p">).</span><span class="na">getException</span><span class="p">();</span>
</span><span id="__span-66-32"><a id="__codelineno-66-32" name="__codelineno-66-32" href="#__codelineno-66-32"></a><span class="w">                        </span><span class="p">}</span>
</span><span id="__span-66-33"><a id="__codelineno-66-33" name="__codelineno-66-33" href="#__codelineno-66-33"></a><span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">isDebugEnabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-34"><a id="__codelineno-66-34" name="__codelineno-66-34" href="#__codelineno-66-34"></a><span class="w">                            </span><span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Could not read previous value of property &#39;&quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-66-35"><a id="__codelineno-66-35" name="__codelineno-66-35" href="#__codelineno-66-35"></a><span class="w">                                    </span><span class="k">this</span><span class="p">.</span><span class="na">nestedPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tokens</span><span class="p">.</span><span class="na">canonicalName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-66-36"><a id="__codelineno-66-36" name="__codelineno-66-36" href="#__codelineno-66-36"></a><span class="w">                        </span><span class="p">}</span>
</span><span id="__span-66-37"><a id="__codelineno-66-37" name="__codelineno-66-37" href="#__codelineno-66-37"></a><span class="w">                    </span><span class="p">}</span>
</span><span id="__span-66-38"><a id="__codelineno-66-38" name="__codelineno-66-38" href="#__codelineno-66-38"></a><span class="w">                </span><span class="p">}</span>
</span><span id="__span-66-39"><a id="__codelineno-66-39" name="__codelineno-66-39" href="#__codelineno-66-39"></a><span class="w">                </span><span class="n">valueToApply</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">convertForProperty</span><span class="p">(</span>
</span><span id="__span-66-40"><a id="__codelineno-66-40" name="__codelineno-66-40" href="#__codelineno-66-40"></a><span class="w">                        </span><span class="n">tokens</span><span class="p">.</span><span class="na">canonicalName</span><span class="p">,</span><span class="w"> </span><span class="n">oldValue</span><span class="p">,</span><span class="w"> </span><span class="n">originalValue</span><span class="p">,</span><span class="w"> </span><span class="n">ph</span><span class="p">.</span><span class="na">toTypeDescriptor</span><span class="p">());</span>
</span><span id="__span-66-41"><a id="__codelineno-66-41" name="__codelineno-66-41" href="#__codelineno-66-41"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-66-42"><a id="__codelineno-66-42" name="__codelineno-66-42" href="#__codelineno-66-42"></a><span class="w">            </span><span class="n">pv</span><span class="p">.</span><span class="na">getOriginalPropertyValue</span><span class="p">().</span><span class="na">conversionNecessary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">valueToApply</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">originalValue</span><span class="p">);</span>
</span><span id="__span-66-43"><a id="__codelineno-66-43" name="__codelineno-66-43" href="#__codelineno-66-43"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-66-44"><a id="__codelineno-66-44" name="__codelineno-66-44" href="#__codelineno-66-44"></a><span class="w">        </span><span class="n">ph</span><span class="p">.</span><span class="na">setValue</span><span class="p">(</span><span class="n">valueToApply</span><span class="p">);</span><span class="c1">// 具体代码在下方列出</span>
</span><span id="__span-66-45"><a id="__codelineno-66-45" name="__codelineno-66-45" href="#__codelineno-66-45"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-66-46"><a id="__codelineno-66-46" name="__codelineno-66-46" href="#__codelineno-66-46"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">TypeMismatchException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-47"><a id="__codelineno-66-47" name="__codelineno-66-47" href="#__codelineno-66-47"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">ex</span><span class="p">;</span>
</span><span id="__span-66-48"><a id="__codelineno-66-48" name="__codelineno-66-48" href="#__codelineno-66-48"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-66-49"><a id="__codelineno-66-49" name="__codelineno-66-49" href="#__codelineno-66-49"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InvocationTargetException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-50"><a id="__codelineno-66-50" name="__codelineno-66-50" href="#__codelineno-66-50"></a><span class="w">        </span><span class="n">PropertyChangeEvent</span><span class="w"> </span><span class="n">propertyChangeEvent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PropertyChangeEvent</span><span class="p">(</span>
</span><span id="__span-66-51"><a id="__codelineno-66-51" name="__codelineno-66-51" href="#__codelineno-66-51"></a><span class="w">                </span><span class="n">getRootInstance</span><span class="p">(),</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">nestedPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tokens</span><span class="p">.</span><span class="na">canonicalName</span><span class="p">,</span><span class="w"> </span><span class="n">oldValue</span><span class="p">,</span><span class="w"> </span><span class="n">pv</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span>
</span><span id="__span-66-52"><a id="__codelineno-66-52" name="__codelineno-66-52" href="#__codelineno-66-52"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="na">getTargetException</span><span class="p">()</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ClassCastException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-53"><a id="__codelineno-66-53" name="__codelineno-66-53" href="#__codelineno-66-53"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">TypeMismatchException</span><span class="p">(</span><span class="n">propertyChangeEvent</span><span class="p">,</span><span class="w"> </span><span class="n">ph</span><span class="p">.</span><span class="na">getPropertyType</span><span class="p">(),</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getTargetException</span><span class="p">());</span>
</span><span id="__span-66-54"><a id="__codelineno-66-54" name="__codelineno-66-54" href="#__codelineno-66-54"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-66-55"><a id="__codelineno-66-55" name="__codelineno-66-55" href="#__codelineno-66-55"></a><span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-56"><a id="__codelineno-66-56" name="__codelineno-66-56" href="#__codelineno-66-56"></a><span class="w">            </span><span class="n">Throwable</span><span class="w"> </span><span class="n">cause</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getTargetException</span><span class="p">();</span>
</span><span id="__span-66-57"><a id="__codelineno-66-57" name="__codelineno-66-57" href="#__codelineno-66-57"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cause</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">UndeclaredThrowableException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-58"><a id="__codelineno-66-58" name="__codelineno-66-58" href="#__codelineno-66-58"></a><span class="w">                </span><span class="c1">// May happen e.g. with Groovy-generated methods</span>
</span><span id="__span-66-59"><a id="__codelineno-66-59" name="__codelineno-66-59" href="#__codelineno-66-59"></a><span class="w">                </span><span class="n">cause</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cause</span><span class="p">.</span><span class="na">getCause</span><span class="p">();</span>
</span><span id="__span-66-60"><a id="__codelineno-66-60" name="__codelineno-66-60" href="#__codelineno-66-60"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-66-61"><a id="__codelineno-66-61" name="__codelineno-66-61" href="#__codelineno-66-61"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MethodInvocationException</span><span class="p">(</span><span class="n">propertyChangeEvent</span><span class="p">,</span><span class="w"> </span><span class="n">cause</span><span class="p">);</span>
</span><span id="__span-66-62"><a id="__codelineno-66-62" name="__codelineno-66-62" href="#__codelineno-66-62"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-66-63"><a id="__codelineno-66-63" name="__codelineno-66-63" href="#__codelineno-66-63"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-66-64"><a id="__codelineno-66-64" name="__codelineno-66-64" href="#__codelineno-66-64"></a><span class="w">    </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-65"><a id="__codelineno-66-65" name="__codelineno-66-65" href="#__codelineno-66-65"></a><span class="w">        </span><span class="n">PropertyChangeEvent</span><span class="w"> </span><span class="n">pce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PropertyChangeEvent</span><span class="p">(</span>
</span><span id="__span-66-66"><a id="__codelineno-66-66" name="__codelineno-66-66" href="#__codelineno-66-66"></a><span class="w">                </span><span class="n">getRootInstance</span><span class="p">(),</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">nestedPath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tokens</span><span class="p">.</span><span class="na">canonicalName</span><span class="p">,</span><span class="w"> </span><span class="n">oldValue</span><span class="p">,</span><span class="w"> </span><span class="n">pv</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span>
</span><span id="__span-66-67"><a id="__codelineno-66-67" name="__codelineno-66-67" href="#__codelineno-66-67"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MethodInvocationException</span><span class="p">(</span><span class="n">pce</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span>
</span><span id="__span-66-68"><a id="__codelineno-66-68" name="__codelineno-66-68" href="#__codelineno-66-68"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-66-69"><a id="__codelineno-66-69" name="__codelineno-66-69" href="#__codelineno-66-69"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h4 id="_8"><a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<ul>
<li>上述ph.setValue方法在org.springframework.beans.AbstractNestablePropertyAccessor抽象类中定义</li>
<li>public abstract void setValue(@Nullable Object value) throws Exception; </li>
<li>一个具体实现在org.springframework.beans.BeanWrapperImp的内部类BeanPropertyHandler中，完整代码如下：
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">PropertyDescriptor</span><span class="w"> </span><span class="n">pd</span><span class="p">;</span><span class="w">  </span><span class="c1">//BeanPropertyHandler中的字段</span>
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>
</span><span id="__span-67-3"><a id="__codelineno-67-3" name="__codelineno-67-3" href="#__codelineno-67-3"></a><span class="nd">@Override</span>
</span><span id="__span-67-4"><a id="__codelineno-67-4" name="__codelineno-67-4" href="#__codelineno-67-4"></a><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setValue</span><span class="p">(</span><span class="kd">final</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-67-5"><a id="__codelineno-67-5" name="__codelineno-67-5" href="#__codelineno-67-5"></a><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">writeMethod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">pd</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">GenericTypeAwarePropertyDescriptor</span><span class="w"> </span><span class="o">?</span>
</span><span id="__span-67-6"><a id="__codelineno-67-6" name="__codelineno-67-6" href="#__codelineno-67-6"></a><span class="w">            </span><span class="p">((</span><span class="n">GenericTypeAwarePropertyDescriptor</span><span class="p">)</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">pd</span><span class="p">).</span><span class="na">getWriteMethodForActualAccess</span><span class="p">()</span><span class="w"> </span><span class="p">:</span>
</span><span id="__span-67-7"><a id="__codelineno-67-7" name="__codelineno-67-7" href="#__codelineno-67-7"></a><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">pd</span><span class="p">.</span><span class="na">getWriteMethod</span><span class="p">());</span><span class="c1">// 找到属性的set方法</span>
</span><span id="__span-67-8"><a id="__codelineno-67-8" name="__codelineno-67-8" href="#__codelineno-67-8"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="na">getSecurityManager</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-67-9"><a id="__codelineno-67-9" name="__codelineno-67-9" href="#__codelineno-67-9"></a><span class="w">        </span><span class="n">AccessController</span><span class="p">.</span><span class="na">doPrivileged</span><span class="p">((</span><span class="n">PrivilegedAction</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-67-10"><a id="__codelineno-67-10" name="__codelineno-67-10" href="#__codelineno-67-10"></a><span class="w">            </span><span class="n">ReflectionUtils</span><span class="p">.</span><span class="na">makeAccessible</span><span class="p">(</span><span class="n">writeMethod</span><span class="p">);</span>
</span><span id="__span-67-11"><a id="__codelineno-67-11" name="__codelineno-67-11" href="#__codelineno-67-11"></a><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-67-12"><a id="__codelineno-67-12" name="__codelineno-67-12" href="#__codelineno-67-12"></a><span class="w">        </span><span class="p">});</span>
</span><span id="__span-67-13"><a id="__codelineno-67-13" name="__codelineno-67-13" href="#__codelineno-67-13"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-67-14"><a id="__codelineno-67-14" name="__codelineno-67-14" href="#__codelineno-67-14"></a><span class="w">            </span><span class="n">AccessController</span><span class="p">.</span><span class="na">doPrivileged</span><span class="p">((</span><span class="n">PrivilegedExceptionAction</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span>
</span><span id="__span-67-15"><a id="__codelineno-67-15" name="__codelineno-67-15" href="#__codelineno-67-15"></a><span class="w">                    </span><span class="n">writeMethod</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">getWrappedInstance</span><span class="p">(),</span><span class="w"> </span><span class="n">value</span><span class="p">),</span><span class="w"> </span><span class="n">acc</span><span class="p">);</span>
</span><span id="__span-67-16"><a id="__codelineno-67-16" name="__codelineno-67-16" href="#__codelineno-67-16"></a><span class="w">                    </span><span class="c1">// 调用Method的invoke方法，完成属性注入</span>
</span><span id="__span-67-17"><a id="__codelineno-67-17" name="__codelineno-67-17" href="#__codelineno-67-17"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-67-18"><a id="__codelineno-67-18" name="__codelineno-67-18" href="#__codelineno-67-18"></a><span class="w">        </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">PrivilegedActionException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-67-19"><a id="__codelineno-67-19" name="__codelineno-67-19" href="#__codelineno-67-19"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">ex</span><span class="p">.</span><span class="na">getException</span><span class="p">();</span>
</span><span id="__span-67-20"><a id="__codelineno-67-20" name="__codelineno-67-20" href="#__codelineno-67-20"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-67-21"><a id="__codelineno-67-21" name="__codelineno-67-21" href="#__codelineno-67-21"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-67-22"><a id="__codelineno-67-22" name="__codelineno-67-22" href="#__codelineno-67-22"></a><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-67-23"><a id="__codelineno-67-23" name="__codelineno-67-23" href="#__codelineno-67-23"></a><span class="w">        </span><span class="n">ReflectionUtils</span><span class="p">.</span><span class="na">makeAccessible</span><span class="p">(</span><span class="n">writeMethod</span><span class="p">);</span>
</span><span id="__span-67-24"><a id="__codelineno-67-24" name="__codelineno-67-24" href="#__codelineno-67-24"></a><span class="w">        </span><span class="n">writeMethod</span><span class="p">.</span><span class="na">invoke</span><span class="p">(</span><span class="n">getWrappedInstance</span><span class="p">(),</span><span class="w"> </span><span class="n">value</span><span class="p">);</span><span class="c1">//调用Method的invoke方法，完成属性注入</span>
</span><span id="__span-67-25"><a id="__codelineno-67-25" name="__codelineno-67-25" href="#__codelineno-67-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-67-26"><a id="__codelineno-67-26" name="__codelineno-67-26" href="#__codelineno-67-26"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>至此Ioc容器的启动过程基本结束</li>
</ul>
<h1 id="15-finishrefresh">15. finishRefresh();方法<a class="headerlink" href="#15-finishrefresh" title="Permanent link">&para;</a></h1>
<ul>
<li>org.springframework.context.support.AbstractApplicationContext中的finishRefresh()方法</li>
</ul>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">finishRefresh</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a><span class="w">    </span><span class="c1">// Clear context-level resource caches (such as ASM metadata from scanning).</span>
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a><span class="w">    </span><span class="n">clearResourceCaches</span><span class="p">();</span>
</span><span id="__span-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a>
</span><span id="__span-68-5"><a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a><span class="w">    </span><span class="c1">// Initialize lifecycle processor for this context.</span>
</span><span id="__span-68-6"><a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a><span class="w">    </span><span class="n">initLifecycleProcessor</span><span class="p">();</span>
</span><span id="__span-68-7"><a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a>
</span><span id="__span-68-8"><a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a><span class="w">    </span><span class="c1">// Propagate refresh to lifecycle processor first.</span>
</span><span id="__span-68-9"><a id="__codelineno-68-9" name="__codelineno-68-9" href="#__codelineno-68-9"></a><span class="w">    </span><span class="n">getLifecycleProcessor</span><span class="p">().</span><span class="na">onRefresh</span><span class="p">();</span>
</span><span id="__span-68-10"><a id="__codelineno-68-10" name="__codelineno-68-10" href="#__codelineno-68-10"></a>
</span><span id="__span-68-11"><a id="__codelineno-68-11" name="__codelineno-68-11" href="#__codelineno-68-11"></a><span class="w">    </span><span class="c1">// Publish the final event.</span>
</span><span id="__span-68-12"><a id="__codelineno-68-12" name="__codelineno-68-12" href="#__codelineno-68-12"></a><span class="w">    </span><span class="n">publishEvent</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ContextRefreshedEvent</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
</span><span id="__span-68-13"><a id="__codelineno-68-13" name="__codelineno-68-13" href="#__codelineno-68-13"></a>
</span><span id="__span-68-14"><a id="__codelineno-68-14" name="__codelineno-68-14" href="#__codelineno-68-14"></a><span class="w">    </span><span class="c1">// Participate in LiveBeansView MBean, if active.</span>
</span><span id="__span-68-15"><a id="__codelineno-68-15" name="__codelineno-68-15" href="#__codelineno-68-15"></a><span class="w">    </span><span class="n">LiveBeansView</span><span class="p">.</span><span class="na">registerApplicationContext</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span><span id="__span-68-16"><a id="__codelineno-68-16" name="__codelineno-68-16" href="#__codelineno-68-16"></a><span class="p">}</span>
</span></code></pre></div>
<h1 id="16refresh">16refresh()过程抛出异常时<a class="headerlink" href="#16refresh" title="Permanent link">&para;</a></h1>
<ul>
<li>之中有两个处理方法destroyBeans()和cancelRefresh(ex)</li>
</ul>
<h2 id="161-destroybeans">16.1 destroyBeans();方法<a class="headerlink" href="#161-destroybeans" title="Permanent link">&para;</a></h2>
<ul>
<li>org.springframework.context.support.AbstractApplicationContext中的destroyBeans()方法</li>
</ul>
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">destroyBeans</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a><span class="w">    </span><span class="n">getBeanFactory</span><span class="p">().</span><span class="na">destroySingletons</span><span class="p">();</span>
</span><span id="__span-69-3"><a id="__codelineno-69-3" name="__codelineno-69-3" href="#__codelineno-69-3"></a><span class="p">}</span>
</span></code></pre></div>
<h2 id="162-cancelrefreshex">16.2 cancelRefresh(ex);方法<a class="headerlink" href="#162-cancelrefreshex" title="Permanent link">&para;</a></h2>
<ul>
<li>org.springframework.context.support.AbstractApplicationContext中的cancelRefresh(ex)方法
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">cancelRefresh</span><span class="p">(</span><span class="n">BeansException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">active</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h2 id="163beansexception">16.3抛出异常BeansException<a class="headerlink" href="#163beansexception" title="Permanent link">&para;</a></h2>
<h1 id="17-resetcommoncaches">17 resetCommonCaches();方法<a class="headerlink" href="#17-resetcommoncaches" title="Permanent link">&para;</a></h1>
<ul>
<li>org.springframework.context.support.AbstractApplicationContext中的resetCommonCaches()方法</li>
<li>try-catch-finally代码块中finally包裹的方法
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">resetCommonCaches</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="w">    </span><span class="n">ReflectionUtils</span><span class="p">.</span><span class="na">clearCache</span><span class="p">();</span>
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a><span class="w">    </span><span class="n">AnnotationUtils</span><span class="p">.</span><span class="na">clearCache</span><span class="p">();</span>
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a><span class="w">    </span><span class="n">ResolvableType</span><span class="p">.</span><span class="na">clearCache</span><span class="p">();</span>
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a><span class="w">    </span><span class="n">CachedIntrospectionResults</span><span class="p">.</span><span class="na">clearClassLoader</span><span class="p">(</span><span class="n">getClassLoader</span><span class="p">());</span>
</span><span id="__span-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>执行到此Ioc容器启动完成，可以正式投入使用</li>
</ul>
<h1 id="_9">总结<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h1>
<ul>
<li>Ioc的底层原理实现：Spring Ioc启动分为两步：<ul>
<li>1.创建BeanFactory</li>
<li>2.实例化Bean</li>
</ul>
</li>
<li>Spring的Bean在内存中的状态就是BeanDefination</li>
<li>在Bean的创建和依赖注入的过程中，需要根据BeanDefination的信息来递归的完成依赖注入，从代码可以看到，这些递归都是以getBean()为入口的，一个递归是在上下文体系中查找需要的bean和bean的依赖关系；另一个递归是在依赖注入时，通过递归调用容器的getBean方法得到当前依赖的Bean，同时也触发对依赖bean的创建和注入。在对bean的属性进行依赖注入时，解析过程也是一个递归过程，这样根据依赖关系，一层一层的完成Bean的创建和注入，直到当前bean相关的整个依赖链的注入完成。由于整个IoC容器启动过程较为复杂，使用下面的一张图来描述让读者更清楚厘清IoC容器的启动过程。</li>
</ul>
<p><a class="glightbox" href="/Blog/static/image/20191125/BeanFactoryInitFlowChart.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="Ioc容器启动过程" src="/Blog/static/image/20191125/BeanFactoryInitFlowChart.png" /></a></p>
<h3 id="_10">模板<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<ul>
<li>代码位置:org.springframework.context.support.AbstractApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">postProcessBeanFactory</span><span class="p">(</span><span class="n">ConfigurableListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a>
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a><span class="p">}</span>
</span></code></pre></div></li>
<li>
<p>代码位置:org.springframework.context.support.AbstractApplicationContext.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>
</span></code></pre></div></p>
</li>
<li>
<p>代码位置:.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a>
</span></code></pre></div></p>
</li>
<li>
<p>代码位置:.java
<div class="language-java highlight"><span class="filename">Java</span><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>
</span></code></pre></div></p>
</li>
</ul>
<h1 id="_11">参考资料<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h1>
<ul>
<li><a href="https://acanx.github.io/Blog/2019/11/22/Spring-IoC%E5%AE%B9%E5%99%A8%E6%BA%90%E7%A0%81%E5%AF%BC%E8%AF%BB/">Spring-IoC容器源码导读</a></li>
<li>Spring源码深度解析（第二版） 郝佳</li>
<li>Spring5企业级开发实战 周冠亚 黄文毅 <a href="https://github.com/online-demo/spring5projectdemo">配套源码</a></li>
<li>Gitee同步版本：<a href="https://gitee.com/ACANX/spring5projectdemo">https://gitee.com/ACANX/spring5projectdemo</a></li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      2025-05-15
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="页脚" >
      
        
        <a href="../5/" class="md-footer__link md-footer__link--prev" aria-label="上一页: Spring-IoC启动流程分析" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              Spring-IoC启动流程分析
            </div>
          </div>
        </a>
      
      
        
        <a href="../../3/1/" class="md-footer__link md-footer__link--next" aria-label="下一页: Kubernetes容器编排系统概念模型" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              Kubernetes容器编排系统概念模型
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy;  ACANX
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://www.acanx.com" target="_blank" rel="noopener" title="ACANX" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M341.52 285.56c33.65 0 82.34-6.94 82.34-47 .22-6.74.86-1.82-20.88-96.24-4.62-19.15-8.68-27.84-42.31-44.65-26.09-13.34-82.92-35.37-99.73-35.37-15.66 0-20.2 20.17-38.87 20.17-18 0-31.31-15.06-48.12-15.06-16.14 0-26.66 11-34.78 33.62-27.5 77.55-26.28 74.27-26.12 78.27 0 24.8 97.64 106.11 228.47 106.11M429 254.84c4.65 22 4.65 24.35 4.65 27.25 0 37.66-42.33 58.56-98 58.56-125.74.08-235.91-73.65-235.91-122.33a49.55 49.55 0 0 1 4.06-19.72C58.56 200.86 0 208.93 0 260.63c0 84.67 200.63 189 359.49 189 121.79 0 152.51-55.08 152.51-98.58 0-34.21-29.59-73.05-82.93-96.24"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "search.suggest", "search.highlight", "search.share", "content.code.annotate", "content.code.copy", "content.code.select"], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\uff0c\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d691e9de.min.js"></script>
      <script id="click-show-text" src="https://html.sqlsec.com/click-show-text.min.js" data-mobile="false" data-text="OpenCore,Hackintosh,DSDT,SSDT,Kernel,Kexts,UEFI,NVRAM,BIOS,ACPI,Clover,AWAC,XOSI,Lilu.kext,VirtualSMC.kext,WhateverGreen.kext" data-fontsize="15px" data-random="false" async="async"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>