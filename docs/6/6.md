## 综合对比

|     访问方式     | 使用体验 | 使用门槛                                                     |
| :--------------: | :------: | :----------------------------------------------------------- |
| 花生壳（免费版） |    ⭐️     | 低，浏览器即可直接访问                                       |
|   纯 IPv6 访问   |    ⭐️⭐️    | 高，需要有 IPv6 公网的浏览器才可以直接访问，而且 IPv6 很长，还可能会变 |
|   DDNS 转 IPv6   |   ⭐️⭐️⭐️    | 中，需要有 IPv6 公网的浏览器才可以直接访问，但是输入域名即可直接访问 |
|  ZeroTier 组网   |   ⭐️⭐️⭐️⭐️   | 高，需要安装 ZeroTier 客户端组网才可以，但是无 IPv6 限制，速度也不错 |

## 花生壳穿透

首先安装好「花生壳」套件：

![](https://image.3001.net/images/20230224/1677225563245.png) 

因为是免费的产品，所以还是有流量限制的：

![](https://image.3001.net/images/20230224/16772265395744.png) 而且官网查看一下发现带宽是 1M 的：

![](https://image.3001.net/images/20230224/16772268321378.png) 

不过是免费的，而且使用门槛很低，确实比较适合小白来说使用。

![](https://image.3001.net/images/20230224/16772270118080.jpg)  

建议有能力折腾的朋友可以看看下面的姿势，研究其他体验更棒的方法。  

## 纯 IPv6 访问

因为中国移动没有公网的 IPv4 地址，但是却分配了 IPv6 地址。一般来说 IPv6 都是公网可以直接访问的，浏览器也可以直接访问 IPv6 地址：

```bash
http://[IPv6地址]:端口
```

首先在群晖的网络里面查看我们的公网 IPv6 地址：

![](https://image.3001.net/images/20230224/16772278594367.png) 

然后确保我们的路由或者光猫里面对 IPv6 防火墙放行：

![](https://image.3001.net/images/20230224/16772310975187.png) 

??? Note "小米路由器的 IPv6 防火墙的玄学问题"
	 以 Redmi AX3000 为例，本以为关闭了 IPv6 防火墙，实际测试发现这个防火墙的按钮经常会不生效，明明好像是关了防火墙，实际上 IPv6 防火墙依然存在的，具体玄学原因解释不清楚：
	![](https://image.3001.net/images/20230224/16772313946457.png) 

然后我们就可以使用 IPv6  地址正常访问我们的黑群晖 DSM 了：

![](https://image.3001.net/images/20230224/16772317554645.jpg)    

## DDNS 转 IPv6 

但是这样访问依然不够优雅，IPv6 地址一大串很长很长，而且还可能 IPv6 地址发生变动。所以优雅一点的方法就是使用  DDNS 将我们的 IPv6 地址动态解析到我们的外网域名上面去，本次教程就是使用的是 DDNS-GO 配合阿里云的域名来实现的。

首先 DSM 群晖里面安装「DDNS-GO」套件：

![](https://image.3001.net/images/20230224/16772516023707.png) 

接着打开 DDNS-GO，先填写阿里云的 AK 和 SK，然后顺便取消 IPv4 的启用状态：

![](https://image.3001.net/images/20230224/16772520621973.png) 

然后选择要做 DDNS 解析的 IPv6 地址，使用`@2` 手动指定比较长的这个 IPv6 地址，接着填写我们想解析的域名（待会 DDNS-GO 会帮我自己创建这个子域名）：

![](https://image.3001.net/images/20230224/16772528412022.png)  

同时建议大家配置一下禁止公网访问，然后设置一下用户名和密码，提高安全性：

![](https://image.3001.net/images/20230224/16772523028821.png) 

可以在右侧的日志里面看到新增的 IPv6 解析成功：

![](https://image.3001.net/images/20230224/16772529275093.png)     

进阿里云域名控制台看看，果然发现 DDNS-GO 自动帮我们配置了 IPv6 的解析：

![](https://image.3001.net/images/20230224/16772525884024.png) 

接着我们的浏览器直接访问我们的  nasv6.sqlsec.com 子域名即可正常访问我们的 DSM 的 IPv6 地址了：

![](https://image.3001.net/images/20230225/1677300715604.jpg) 

而且也可以在 macOS 下使用访达直连通过我们的域名来连接 NAS：

![](https://image.3001.net/images/20230225/16773019583605.png) 

连接的效果：

![](https://image.3001.net/images/20230225/16773020269631.png) 

同理也可以 SSH 直接访问：

![](https://image.3001.net/images/20230225/16773033724570.png)              

## ZeroTier 组网

首先 DSM 群晖里面安装「ZeroTier」套件：

![](https://image.3001.net/images/20230225/16773032641347.png) 

  

 然后 SSH 到命令行下操作即：

```bash
# 切换 root
sudo -i

# 权限调整
sed -i 's/package/root/g' /var/packages/zerotier/conf/privilege
```

然后重新启动 ZeroTier 服务：

![](https://image.3001.net/images/20230225/1677304297334.png) 

最后直接加入网络即可：

```bash
# 加入网络
/var/packages/zerotier/target/bin/zerotier-one -q join d5e5xxxxxx68b0
```

返回 `200 join OK` 则表示加入成功：

![](https://image.3001.net/images/20230225/16773043907193.png) 

然后到 PVE 的控制台中勾选认证，备注一下： 

![image-20230225135252730](imgs/image-20230225135252730.png) 

  直接访问 ZertTier 分配给我们的内网 IP 试试看：

![](https://image.3001.net/images/20230225/16773044755756.png)  
